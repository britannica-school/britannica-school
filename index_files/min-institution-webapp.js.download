/*
 MIT http://www.opensource.org/licenses/mit-license.php
*/
var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return"jscomp_symbol_"+a+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=a[Symbol.iterator];if(e)return e.call(a);var f=0;return{next:function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}}}};
$jscomp.arrayFromIterator=function(a){for(var e,f=[];!(e=a.next()).done;)f.push(e.value);return f};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.inherits=function(a,e){function f(){}f.prototype=e.prototype;a.prototype=new f;a.prototype.constructor=a;for(var d in e)if(Object.defineProperties){var c=Object.getOwnPropertyDescriptor(e,d);c&&Object.defineProperty(a,d,c)}else a[d]=e[d]};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var f=0,d={next:function(){if(f<a.length){var c=f++;return{value:e(c,a[c]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};$jscomp.initSymbol();$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return d};return d};
$jscomp.findInternal=function(a,e,f){a instanceof String&&(a=String(a));for(var d=a.length,c=0;c<d;c++){var k=a[c];if(e.call(f,k,c,a))return{i:c,v:k}}return{i:-1,v:void 0}};
$jscomp.array.from=function(a,e,f){$jscomp.initSymbolIterator();e=null!=e?e:function(a){return a};var d=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=a[Symbol.iterator];"function"==typeof c&&(a=c.call(a));if("function"==typeof a.next)for(;!(c=a.next()).done;)d.push(e.call(f,c.value));else for(var c=a.length,k=0;k<c;k++)d.push(e.call(f,a[k]));return d};$jscomp.array.of=function(a){return $jscomp.array.from(arguments)};
$jscomp.array.entries=function(){return $jscomp.iteratorFromArray(this,function(a,e){return[a,e]})};$jscomp.array.installHelper_=function(a,e){!Array.prototype[a]&&Object.defineProperties&&Object.defineProperty&&Object.defineProperty(Array.prototype,a,{configurable:!0,enumerable:!1,writable:!0,value:e})};$jscomp.array.entries$install=function(){$jscomp.array.installHelper_("entries",$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.iteratorFromArray(this,function(a){return a})};
$jscomp.array.keys$install=function(){$jscomp.array.installHelper_("keys",$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.iteratorFromArray(this,function(a,e){return e})};$jscomp.array.values$install=function(){$jscomp.array.installHelper_("values",$jscomp.array.values)};
$jscomp.array.copyWithin=function(a,e,f){var d=this.length;a=Number(a);e=Number(e);f=Number(null!=f?f:d);if(a<e)for(f=Math.min(f,d);e<f;)e in this?this[a++]=this[e++]:(delete this[a++],e++);else for(f=Math.min(f,d+e-a),a+=f-e;f>e;)--f in this?this[--a]=this[f]:delete this[a];return this};$jscomp.array.copyWithin$install=function(){$jscomp.array.installHelper_("copyWithin",$jscomp.array.copyWithin)};
$jscomp.array.fill=function(a,e,f){var d=this.length||0;0>e&&(e=Math.max(0,d+e));if(null==f||f>d)f=d;f=Number(f);0>f&&(f=Math.max(0,d+f));for(e=Number(e||0);e<f;e++)this[e]=a;return this};$jscomp.array.fill$install=function(){$jscomp.array.installHelper_("fill",$jscomp.array.fill)};$jscomp.array.find=function(a,e){return $jscomp.findInternal(this,a,e).v};$jscomp.array.find$install=function(){$jscomp.array.installHelper_("find",$jscomp.array.find)};
$jscomp.array.findIndex=function(a,e){return $jscomp.findInternal(this,a,e).i};$jscomp.array.findIndex$install=function(){$jscomp.array.installHelper_("findIndex",$jscomp.array.findIndex)};$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.Map$isConformant=function(){if($jscomp.ASSUME_NO_NATIVE_MAP)return!1;var a=$jscomp.global.Map;if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),f=new a($jscomp.makeIterator([[e,"s"]]));if("s"!=f.get(e)||1!=f.size||f.get({x:4})||f.set({x:4},"t")!=f||2!=f.size)return!1;var d=f.entries(),c=d.next();if(c.done||c.value[0]!=e||"s"!=c.value[1])return!1;c=d.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!d.next().done?!1:!0}catch(k){return!1}};
$jscomp.Map=function(a){this.data_={};this.head_=$jscomp.Map.createHead();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)e=e.value,this.set(e[0],e[1])}};
$jscomp.Map.prototype.set=function(a,e){var f=$jscomp.Map.maybeGetEntry(this,a);f.list||(f.list=this.data_[f.id]=[]);f.entry?f.entry.value=e:(f.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:e},f.list.push(f.entry),this.head_.previous.next=f.entry,this.head_.previous=f.entry,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(a){a=$jscomp.Map.maybeGetEntry(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead();this.size=0};$jscomp.Map.prototype.has=function(a){return!!$jscomp.Map.maybeGetEntry(this,a).entry};
$jscomp.Map.prototype.get=function(a){return(a=$jscomp.Map.maybeGetEntry(this,a).entry)&&a.value};$jscomp.Map.prototype.entries=function(){return $jscomp.Map.makeIterator_(this,function(a){return[a.key,a.value]})};$jscomp.Map.prototype.keys=function(){return $jscomp.Map.makeIterator_(this,function(a){return a.key})};$jscomp.Map.prototype.values=function(){return $jscomp.Map.makeIterator_(this,function(a){return a.value})};
$jscomp.Map.prototype.forEach=function(a,e){for(var f=this.entries(),d;!(d=f.next()).done;)d=d.value,a.call(e,d[1],d[0],this)};$jscomp.Map.maybeGetEntry=function(a,e){var f=$jscomp.Map.getId(e),d=a.data_[f];if(d&&Object.prototype.hasOwnProperty.call(a.data_,f))for(var c=0;c<d.length;c++){var k=d[c];if(e!==e&&k.key!==k.key||e===k.key)return{id:f,list:d,index:c,entry:k}}return{id:f,list:d,index:-1,entry:void 0}};
$jscomp.Map.makeIterator_=function(a,e){var f=a.head_,d={next:function(){if(f){for(;f.head!=a.head_;)f=f.previous;for(;f.next!=f.head;)return f=f.next,{done:!1,value:e(f)};f=null}return{done:!0,value:void 0}}};$jscomp.initSymbol();$jscomp.initSymbolIterator();d[Symbol.iterator]=function(){return d};return d};$jscomp.Map.mapIndex_=0;$jscomp.Map.createHead=function(){var a={};return a.previous=a.next=a.head=a};
$jscomp.Map.getId=function(a){if(!(a instanceof Object))return"p_"+a;if(!($jscomp.Map.idKey in a))try{$jscomp.Map.defineProperty(a,$jscomp.Map.idKey,{value:++$jscomp.Map.mapIndex_})}catch(e){}return $jscomp.Map.idKey in a?a[$jscomp.Map.idKey]:"o_ "+a};$jscomp.Map.defineProperty=Object.defineProperty?function(a,e,f){Object.defineProperty(a,e,{value:String(f)})}:function(a,e,f){a[e]=String(f)};$jscomp.Map.Entry=function(){};
$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();$jscomp.Map$isConformant()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.idKey=Symbol("map-id-key"),$jscomp.Map$install=function(){})};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(a){a=Number(a)>>>0;if(0===a)return 32;var e=0;0===(a&4294901760)&&(a<<=16,e+=16);0===(a&4278190080)&&(a<<=8,e+=8);0===(a&4026531840)&&(a<<=4,e+=4);0===(a&3221225472)&&(a<<=2,e+=2);0===(a&2147483648)&&e++;return e};$jscomp.math.imul=function(a,e){a=Number(a);e=Number(e);var f=a&65535,d=e&65535;return f*d+((a>>>16&65535)*d+f*(e>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1};
$jscomp.math.log10=function(a){return Math.log(a)/Math.LN10};$jscomp.math.log2=function(a){return Math.log(a)/Math.LN2};$jscomp.math.log1p=function(a){a=Number(a);if(.25>a&&-.25<a){for(var e=a,f=1,d=a,c=0,k=1;c!=d;)e*=a,k*=-1,d=(c=d)+k*e/++f;return d}return Math.log(1+a)};$jscomp.math.expm1=function(a){a=Number(a);if(.25>a&&-.25<a){for(var e=a,f=1,d=a,c=0;c!=d;)e*=a/++f,d=(c=d)+e;return d}return Math.exp(a)-1};$jscomp.math.cosh=function(a){a=Number(a);return(Math.exp(a)+Math.exp(-a))/2};
$jscomp.math.sinh=function(a){a=Number(a);return 0===a?a:(Math.exp(a)-Math.exp(-a))/2};$jscomp.math.tanh=function(a){a=Number(a);if(0===a)return a;var e=Math.exp(-2*Math.abs(a)),e=(1-e)/(1+e);return 0>a?-e:e};$jscomp.math.acosh=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};$jscomp.math.asinh=function(a){a=Number(a);if(0===a)return a;var e=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return 0>a?-e:e};
$jscomp.math.atanh=function(a){a=Number(a);return($jscomp.math.log1p(a)-$jscomp.math.log1p(-a))/2};$jscomp.math.hypot=function(a,e,f){a=Number(a);e=Number(e);var d,c,k,g=Math.max(Math.abs(a),Math.abs(e));for(d=2;d<arguments.length;d++)g=Math.max(g,Math.abs(arguments[d]));if(1E100<g||1E-100>g){a/=g;e/=g;k=a*a+e*e;for(d=2;d<arguments.length;d++)c=Number(arguments[d])/g,k+=c*c;return Math.sqrt(k)*g}k=a*a+e*e;for(d=2;d<arguments.length;d++)c=Number(arguments[d]),k+=c*c;return Math.sqrt(k)};
$jscomp.math.trunc=function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var e=Math.floor(Math.abs(a));return 0>a?-e:e};$jscomp.math.cbrt=function(a){if(0===a)return a;a=Number(a);var e=Math.pow(Math.abs(a),1/3);return 0>a?-e:e};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a};$jscomp.number.isInteger=function(a){return $jscomp.number.isFinite(a)?a===Math.floor(a):!1};
$jscomp.number.isNaN=function(a){return"number"===typeof a&&isNaN(a)};$jscomp.number.isSafeInteger=function(a){return $jscomp.number.isInteger(a)&&Math.abs(a)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=function(){return Math.pow(2,-52)}();$jscomp.number.MAX_SAFE_INTEGER=function(){return 9007199254740991}();$jscomp.number.MIN_SAFE_INTEGER=function(){return-9007199254740991}();$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(a,e){for(var f=1;f<arguments.length;f++){var d=arguments[f];if(d)for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a};$jscomp.object.is=function(a,e){return a===e?0!==a||1/a===1/e:a!==a&&e!==e};$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.Set$isConformant=function(){if($jscomp.ASSUME_NO_NATIVE_SET)return!1;var a=$jscomp.global.Set;if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),f=new a($jscomp.makeIterator([e]));if(!f.has(e)||1!=f.size||f.add(e)!=f||1!=f.size||f.add({x:4})!=f||2!=f.size)return!1;var d=f.entries(),c=d.next();if(c.done||c.value[0]!=e||c.value[1]!=e)return!1;c=d.next();return c.done||c.value[0]==e||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:d.next().done}catch(k){return!1}};
$jscomp.Set=function(a){this.map_=new $jscomp.Map;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)this.add(e.value)}this.size=this.map_.size};$jscomp.Set.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(a){return this.map_.has(a)};
$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};$jscomp.Set.prototype.forEach=function(a,e){var f=this;this.map_.forEach(function(d){return a.call(e,d,d,f)})};$jscomp.Set$install=function(){$jscomp.Map$install();$jscomp.Set$isConformant()?$jscomp.Set=$jscomp.global.Set:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values,$jscomp.Set$install=function(){})};
$jscomp.string=$jscomp.string||{};$jscomp.checkStringArgs=function(a,e,f){if(null==a)throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression");return a+""};
$jscomp.string.fromCodePoint=function(a){for(var e="",f=0;f<arguments.length;f++){var d=Number(arguments[f]);if(0>d||1114111<d||d!==Math.floor(d))throw new RangeError("invalid_code_point "+d);65535>=d?e+=String.fromCharCode(d):(d-=65536,e+=String.fromCharCode(d>>>10&1023|55296),e+=String.fromCharCode(d&1023|56320))}return e};
$jscomp.string.repeat=function(a){var e=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var f="";a;)if(a&1&&(f+=e),a>>>=1)e+=e;return f};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(a){var e=$jscomp.checkStringArgs(this,null,"codePointAt"),f=e.length;a=Number(a)||0;if(0<=a&&a<f){a|=0;var d=e.charCodeAt(a);if(55296>d||56319<d||a+1===f)return d;a=e.charCodeAt(a+1);return 56320>a||57343<a?d:1024*(d-55296)+a+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(a,e){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,e||0)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};$jscomp.string.startsWith=function(a,e){var f=$jscomp.checkStringArgs(this,a,"startsWith");a+="";for(var d=f.length,c=a.length,k=Math.max(0,Math.min(e|0,f.length)),g=0;g<c&&k<d;)if(f[k++]!=a[g++])return!1;return g>=c};
$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};$jscomp.string.endsWith=function(a,e){var f=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===e&&(e=f.length);for(var d=Math.max(0,Math.min(e|0,f.length)),c=a.length;0<c&&0<d;)if(f[--d]!=a[--c])return!1;return 0>=c};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function(){function a(a){throw a;}function e(a){return function(){return a}}function f(h){function b(a,b,c,d,e){var g=[];a=l.j(function(){var a=b(c,e)||[];0<g.length&&(l.a.Ya(f(g),a),d&&l.r.K(d,null,[c,a,e]));g.splice(0,g.length);l.a.P(g,a)},null,{W:a,Ka:function(){return 0==g.length||!l.a.X(g[0])}});return{M:g,j:a.pa()?a:void 0}}function f(a){for(;a.length&&!l.a.X(a[0]);)a.splice(0,1);if(1<a.length){for(var b=a[0],c=a[a.length-1],d=[b];b!==c;){b=b.nextSibling;if(!b)return;d.push(b)}Array.prototype.splice.apply(a,
[0,a.length].concat(d))}return a}function n(a,b,c,d,e){var g=Math.min,h=Math.max,f=[],k,t=a.length,m,n=b.length,q=n-t||1,v=t+n+1,l,p,D;for(k=0;k<=t;k++)for(p=l,f.push(l=[]),D=g(n,k+q),m=h(0,k-1);m<=D;m++)l[m]=m?k?a[k-1]===b[m-1]?p[m-1]:g(p[m]||v,l[m-1]||v)+1:m+1:k+1;g=[];h=[];q=[];k=t;for(m=n;k||m;)n=f[k][m]-1,m&&n===f[k][m-1]?h.push(g[g.length]={status:c,value:b[--m],index:m}):k&&n===f[k-1][m]?q.push(g[g.length]={status:d,value:a[--k],index:k}):(g.push({status:"retained",value:b[--m]}),--k);if(h.length&&
q.length){a=10*t;var r;for(b=c=0;(e||b<a)&&(r=h[c]);c++){for(d=0;f=q[d];d++)if(r.value===f.value){r.moved=f.index;f.moved=r.index;q.splice(d,1);b=d=0;break}b+=d}}return g.reverse()}function p(b,c,d,e,g){g=g||{};var h=b&&q(b),h=h&&h.ownerDocument,f=g.templateEngine||X;l.za.vb(d,f,h);d=f.renderTemplate(d,e,g,h);("number"!=typeof d.length||0<d.length&&"number"!=typeof d[0].nodeType)&&a(Error("Template engine must return an array of DOM nodes"));h=!1;switch(c){case "replaceChildren":l.e.N(b,d);h=!0;break;
case "replaceNode":l.a.Ya(b,d);h=!0;break;case "ignoreTargetNode":break;default:a(Error("Unknown renderMode: "+c))}h&&(u(d,e),g.afterRender&&l.r.K(g.afterRender,null,[d,e.$data]));return d}function q(a){return a.nodeType?a:0<a.length?a[0]:null}function u(a,b){if(a.length){var c=a[0],d=a[a.length-1];x(c,d,function(a){l.Da(b,a)});x(c,d,function(a){l.s.ib(a,[b])})}}function x(a,b,c){var d;for(b=l.e.nextSibling(b);a&&(d=a)!==b;)a=l.e.nextSibling(d),1!==d.nodeType&&8!==d.nodeType||c(d)}function v(b,c,
d){b=l.g.aa(b);for(var g=l.g.Q,e=0;e<b.length;e++){var h=b[e].key;if(g.hasOwnProperty(h)){var f=g[h];"function"===typeof f?(h=f(b[e].value))&&a(Error(h)):f||a(Error("This template engine does not support the '"+h+"' binding within its templates"))}}b="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+l.g.ba(b)+" } })()})";return d.createJavaScriptEvaluatorBlock(b)+c}function r(b,c,d,e){function g(a){return function(){return k[a]}}function h(){return k}var f=0,k,t;l.j(function(){var m=
d&&d instanceof l.z?d:new l.z(l.a.d(d)),n=m.$data;e&&l.eb(b,m);if(k=("function"==typeof c?c(m,b):c)||l.J.instance.getBindings(b,m)){if(0===f){f=1;for(var q in k){var v=l.c[q];v&&8===b.nodeType&&!l.e.I[q]&&a(Error("The binding '"+q+"' cannot be used with virtual elements"));v&&"function"==typeof v.init&&(v=(0,v.init)(b,g(q),h,n,m))&&v.controlsDescendantBindings&&(void 0!==t&&a(Error("Multiple bindings ("+t+" and "+q+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")),
t=q)}f=2}if(2===f)for(q in k)(v=l.c[q])&&"function"==typeof v.update&&(0,v.update)(b,g(q),h,n,m)}},null,{W:b});return{Nb:void 0===t}}function w(a,b,c){var d=!0,e=1===b.nodeType;e&&l.e.Ta(b);if(e&&c||l.J.instance.nodeHasBindings(b))d=r(b,null,a,c).Nb;d&&y(a,b,!e)}function y(a,b,c){for(var d=l.e.firstChild(b);b=d;)d=l.e.nextSibling(b),w(a,b,c)}function t(a,b){var c=D(a,b);return c?0<c.length?c[c.length-1].nextSibling:a.nextSibling:null}function D(b,c){for(var d=b,e=1,g=[];d=d.nextSibling;){if(B(d)&&
(e--,0===e))return g;g.push(d);E(d)&&e++}c||a(Error("Cannot find closing comment tag to match: "+b.nodeValue));return null}function B(a){return 8==a.nodeType&&(O?a.text:a.nodeValue).match(T)}function E(a){return 8==a.nodeType&&(O?a.text:a.nodeValue).match(N)}function z(a,b){for(var c=null;a!=c;)c=a,a=a.replace(Q,function(a,c){return b[c]});return a}function G(){var a=[],b=[];this.save=function(c,d){var e=l.a.i(a,c);0<=e?b[e]=d:(a.push(c),b.push(d))};this.get=function(c){c=l.a.i(a,c);return 0<=c?b[c]:
void 0}}function C(a,b,c){function d(g){var h=b(a[g]);switch(typeof h){case "boolean":case "number":case "string":case "function":e[g]=h;break;case "object":case "undefined":var f=c.get(h);e[g]=void 0!==f?f:C(h,b,c)}}c=c||new G;a=b(a);if("object"!=typeof a||null===a||void 0===a||a instanceof Date)return a;var e=a instanceof Array?[]:{};c.save(a,e);var g=a;if(g instanceof Array){for(var h=0;h<g.length;h++)d(h);"function"==typeof g.toJSON&&d("toJSON")}else for(h in g)d(h);return e}function I(a,b){if(a)if(8==
a.nodeType){var c=l.s.Ua(a.nodeValue);null!=c&&b.push({sb:a,Fb:c})}else if(1==a.nodeType)for(var c=0,d=a.childNodes,e=d.length;c<e;c++)I(d[c],b)}function R(a,b,c,d){l.c[a]={init:function(a){l.a.f.set(a,S,{});return{controlsDescendantBindings:!0}},update:function(a,e,g,h,f){g=l.a.f.get(a,S);e=l.a.d(e());h=!c!==!e;var k=!g.Za;if(k||b||h!==g.qb)k&&(g.Za=l.a.Ia(l.e.childNodes(a),!0)),h?(k||l.e.N(a,l.a.Ia(g.Za)),l.Ea(d?d(f,e):f,a)):l.e.Y(a),g.qb=h}};l.g.Q[a]=!1;l.e.I[a]=!0}function P(a,b,c){c&&b!==l.k.q(a)&&
l.k.T(a,b);b!==l.k.q(a)&&l.r.K(l.a.Ba,null,[a,"change"])}var l="undefined"!==typeof h?h:{};l.b=function(a,b){for(var c=a.split("."),d=l,e=0;e<c.length-1;e++)d=d[c[e]];d[c[c.length-1]]=b};l.p=function(a,b,c){a[b]=c};l.version="2.2.1";l.b("version",l.version);l.a=new function(){function b(a,c){if("input"!==l.a.u(a)||!a.type||"click"!=c.toLowerCase())return!1;var d=a.type;return"checkbox"==d||"radio"==d}var e=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,h={},f={};h[/Firefox\/2/i.test(k.userAgent)?"KeyboardEvent":
"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");for(var t in h){var m=h[t];if(m.length)for(var n=0,q=m.length;n<q;n++)f[m[n]]=t}var v={propertychange:!0},p,h=3;t=c.createElement("div");for(m=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++h+"]><i></i><![endif]--\x3e",m[0];);p=4<h?h:void 0;return{Na:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],o:function(a,b){for(var c=
0,d=a.length;c<d;c++)b(a[c])},i:function(a,b){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},lb:function(a,b,c){for(var d=0,e=a.length;d<e;d++)if(b.call(c,a[d]))return a[d];return null},ga:function(a,b){var c=l.a.i(a,b);0<=c&&a.splice(c,1)},Ga:function(a){a=a||[];for(var b=[],c=0,d=a.length;c<d;c++)0>l.a.i(b,a[c])&&b.push(a[c]);return b},V:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)c.push(b(a[d]));
return c},fa:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)b(a[d])&&c.push(a[d]);return c},P:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,d=b.length;c<d;c++)a.push(b[c]);return a},extend:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},ka:function(a){for(;a.firstChild;)l.removeNode(a.firstChild)},Hb:function(a){a=l.a.L(a);for(var b=c.createElement("div"),d=0,e=a.length;d<e;d++)b.appendChild(l.A(a[d]));return b},Ia:function(a,b){for(var c=
0,d=a.length,e=[];c<d;c++){var g=a[c].cloneNode(!0);e.push(b?l.A(g):g)}return e},N:function(a,b){l.a.ka(a);if(b)for(var c=0,d=b.length;c<d;c++)a.appendChild(b[c])},Ya:function(a,b){var c=a.nodeType?[a]:a;if(0<c.length){for(var d=c[0],e=d.parentNode,g=0,h=b.length;g<h;g++)e.insertBefore(b[g],d);g=0;for(h=c.length;g<h;g++)l.removeNode(c[g])}},bb:function(a,b){7>p?a.setAttribute("selected",b):a.selected=b},D:function(a){return(a||"").replace(e,"")},Rb:function(a,b){for(var c=[],d=(a||"").split(b),e=
0,g=d.length;e<g;e++){var h=l.a.D(d[e]);""!==h&&c.push(h)}return c},Ob:function(a,b){a=a||"";return b.length>a.length?!1:a.substring(0,b.length)===b},tb:function(a,b){if(b.compareDocumentPosition)return 16==(b.compareDocumentPosition(a)&16);for(;null!=a;){if(a==b)return!0;a=a.parentNode}return!1},X:function(a){return l.a.tb(a,a.ownerDocument)},u:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},n:function(c,d,e){var h=p&&v[d];if(h||"undefined"==typeof g)h||"function"!=typeof c.addEventListener?
"undefined"!=typeof c.attachEvent?c.attachEvent("on"+d,function(a){e.call(c,a)}):a(Error("Browser doesn't support addEventListener or attachEvent")):c.addEventListener(d,e,!1);else{if(b(c,d)){var f=e;e=function(a,b){var c=this.checked;b&&(this.checked=!0!==b.nb);f.call(this,a);this.checked=c}}g(c).bind(d,e)}},Ba:function(e,h){e&&e.nodeType||a(Error("element must be a DOM node when calling triggerEvent"));if("undefined"!=typeof g){var k=[];b(e,h)&&k.push({nb:e.checked});g(e).trigger(h,k)}else"function"==
typeof c.createEvent?"function"==typeof e.dispatchEvent?(k=c.createEvent(f[h]||"HTMLEvents"),k.initEvent(h,!0,!0,d,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(k)):a(Error("The supplied element doesn't support dispatchEvent")):"undefined"!=typeof e.fireEvent?(b(e,h)&&(e.checked=!0!==e.checked),e.fireEvent("on"+h)):a(Error("Browser doesn't support triggering events"))},d:function(a){return l.$(a)?a():a},ua:function(a){return l.$(a)?a.t():a},da:function(a,b,c){if(b){var d=/[\w-]+/g,e=a.className.match(d)||
[];l.a.o(b.match(d),function(a){var b=l.a.i(e,a);0<=b?c||e.splice(b,1):c&&e.push(a)});a.className=e.join(" ")}},cb:function(a,b){var d=l.a.d(b);if(null===d||void 0===d)d="";if(3===a.nodeType)a.data=d;else{var e=l.e.firstChild(a);!e||3!=e.nodeType||l.e.nextSibling(e)?l.e.N(a,[c.createTextNode(d)]):e.data=d;l.a.wb(a)}},ab:function(a,b){a.name=b;if(7>=p)try{a.mergeAttributes(c.createElement("<input name='"+a.name+"'/>"),!1)}catch(d){}},wb:function(a){9<=p&&(a=1==a.nodeType?a:a.parentNode,a.style&&(a.style.zoom=
a.style.zoom))},ub:function(a){if(9<=p){var b=a.style.width;a.style.width=0;a.style.width=b}},Lb:function(a,b){a=l.a.d(a);b=l.a.d(b);for(var c=[],d=a;d<=b;d++)c.push(d);return c},L:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},Pb:6===p,Qb:7===p,Z:p,Oa:function(a,b){for(var c=l.a.L(a.getElementsByTagName("input")).concat(l.a.L(a.getElementsByTagName("textarea"))),d="string"==typeof b?function(a){return a.name===b}:function(a){return b.test(a.name)},e=[],g=c.length-1;0<=g;g--)d(c[g])&&
e.push(c[g]);return e},Ib:function(a){return"string"==typeof a&&(a=l.a.D(a))?d.JSON&&d.JSON.parse?d.JSON.parse(a):(new Function("return "+a))():null},xa:function(b,c,d){"undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify||a(Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js"));return JSON.stringify(l.a.d(b),c,d)},Jb:function(a,b,d){d=
d||{};var e=d.params||{},g=d.includeFields||this.Na,h=a;if("object"==typeof a&&"form"===l.a.u(a))for(var h=a.action,f=g.length-1;0<=f;f--)for(var k=l.a.Oa(a,g[f]),t=k.length-1;0<=t;t--)e[k[t].name]=k[t].value;b=l.a.d(b);var m=c.createElement("form");m.style.display="none";m.action=h;m.method="post";for(var n in b)a=c.createElement("input"),a.name=n,a.value=l.a.xa(l.a.d(b[n])),m.appendChild(a);for(n in e)a=c.createElement("input"),a.name=n,a.value=e[n],m.appendChild(a);c.body.appendChild(m);d.submitter?
d.submitter(m):m.submit();setTimeout(function(){m.parentNode.removeChild(m)},0)}}};l.b("utils",l.a);l.b("utils.arrayForEach",l.a.o);l.b("utils.arrayFirst",l.a.lb);l.b("utils.arrayFilter",l.a.fa);l.b("utils.arrayGetDistinctValues",l.a.Ga);l.b("utils.arrayIndexOf",l.a.i);l.b("utils.arrayMap",l.a.V);l.b("utils.arrayPushAll",l.a.P);l.b("utils.arrayRemoveItem",l.a.ga);l.b("utils.extend",l.a.extend);l.b("utils.fieldsIncludedWithJsonPost",l.a.Na);l.b("utils.getFormFields",l.a.Oa);l.b("utils.peekObservable",
l.a.ua);l.b("utils.postJson",l.a.Jb);l.b("utils.parseJson",l.a.Ib);l.b("utils.registerEventHandler",l.a.n);l.b("utils.stringifyJson",l.a.xa);l.b("utils.range",l.a.Lb);l.b("utils.toggleDomNodeCssClass",l.a.da);l.b("utils.triggerEvent",l.a.Ba);l.b("utils.unwrapObservable",l.a.d);Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=Array.prototype.slice.call(arguments);a=c.shift();return function(){return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))}});l.a.f=new function(){var a=
0,b="__ko__"+(new Date).getTime(),c={};return{get:function(a,b){var c=l.a.f.la(a,!1);return void 0===c?void 0:c[b]},set:function(a,b,c){void 0===c&&void 0===l.a.f.la(a,!1)||(l.a.f.la(a,!0)[b]=c)},la:function(d,e){var g=d[b];if(!g||"null"===g||!c[g]){if(!e)return;g=d[b]="ko"+a++;c[g]={}}return c[g]},clear:function(a){var d=a[b];return d?(delete c[d],a[b]=null,!0):!1}}};l.b("utils.domData",l.a.f);l.b("utils.domData.clear",l.a.f.clear);l.a.F=new function(){function b(a,c){var e=l.a.f.get(a,d);void 0===
e&&c&&(e=[],l.a.f.set(a,d,e));return e}function c(a){var d=b(a,!1);if(d)for(var d=d.slice(0),e=0;e<d.length;e++)d[e](a);l.a.f.clear(a);"function"==typeof g&&"function"==typeof g.cleanData&&g.cleanData([a]);if(h[a.nodeType])for(d=a.firstChild;a=d;)d=a.nextSibling,8===a.nodeType&&c(a)}var d="__ko_domNodeDisposal__"+(new Date).getTime(),e={1:!0,8:!0,9:!0},h={1:!0,9:!0};return{Ca:function(c,d){"function"!=typeof d&&a(Error("Callback must be a function"));b(c,!0).push(d)},Xa:function(a,c){var e=b(a,!1);
e&&(l.a.ga(e,c),0==e.length&&l.a.f.set(a,d,void 0))},A:function(a){if(e[a.nodeType]&&(c(a),h[a.nodeType])){var b=[];l.a.P(b,a.getElementsByTagName("*"));for(var d=0,g=b.length;d<g;d++)c(b[d])}return a},removeNode:function(a){l.A(a);a.parentNode&&a.parentNode.removeChild(a)}}};l.A=l.a.F.A;l.removeNode=l.a.F.removeNode;l.b("cleanNode",l.A);l.b("removeNode",l.removeNode);l.b("utils.domNodeDisposal",l.a.F);l.b("utils.domNodeDisposal.addDisposeCallback",l.a.F.Ca);l.b("utils.domNodeDisposal.removeDisposeCallback",
l.a.F.Xa);l.a.ta=function(a){var b;if("undefined"!=typeof g)if(g.parseHTML)b=g.parseHTML(a);else{if((b=g.clean([a]))&&b[0]){for(a=b[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode;a.parentNode&&a.parentNode.removeChild(a)}}else{var e=l.a.D(a).toLowerCase();b=c.createElement("div");e=e.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!e.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!e.indexOf("<td")||!e.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||
[0,"",""];a="ignored<div>"+e[1]+a+e[2]+"</div>";for("function"==typeof d.innerShiv?b.appendChild(d.innerShiv(a)):b.innerHTML=a;e[0]--;)b=b.lastChild;b=l.a.L(b.lastChild.childNodes)}return b};l.a.ca=function(a,b){l.a.ka(a);b=l.a.d(b);if(null!==b&&void 0!==b)if("string"!=typeof b&&(b=b.toString()),"undefined"!=typeof g)g(a).html(b);else for(var c=l.a.ta(b),d=0;d<c.length;d++)a.appendChild(c[d])};l.b("utils.parseHtmlFragment",l.a.ta);l.b("utils.setHtml",l.a.ca);var L={};l.s={ra:function(b){"function"!=
typeof b&&a(Error("You can only pass a function to ko.memoization.memoize()"));var c=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);L[c]=b;return"\x3c!--[ko_memo:"+c+"]--\x3e"},hb:function(b,c){var d=L[b];void 0===d&&a(Error("Couldn't find any memo with ID "+b+". Perhaps it's already been unmemoized."));try{return d.apply(null,c||[]),!0}finally{delete L[b]}},ib:function(a,b){var c=[];I(a,c);for(var d=0,e=c.length;d<e;d++){var g=
c[d].sb,h=[g];b&&l.a.P(h,b);l.s.hb(c[d].Fb,h);g.nodeValue="";g.parentNode&&g.parentNode.removeChild(g)}},Ua:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}};l.b("memoization",l.s);l.b("memoization.memoize",l.s.ra);l.b("memoization.unmemoize",l.s.hb);l.b("memoization.parseMemoText",l.s.Ua);l.b("memoization.unmemoizeDomNodeAndDescendants",l.s.ib);l.Ma={throttle:function(a,b){a.throttleEvaluation=b;var c=null;return l.j({read:a,write:function(d){clearTimeout(c);c=setTimeout(function(){a(d)},
b)}})},notify:function(a,b){a.equalityComparer="always"==b?e(!1):l.m.fn.equalityComparer;return a}};l.b("extenders",l.Ma);l.fb=function(a,b,c){this.target=a;this.ha=b;this.rb=c;l.p(this,"dispose",this.B)};l.fb.prototype.B=function(){this.Cb=!0;this.rb()};l.S=function(){this.w={};l.a.extend(this,l.S.fn);l.p(this,"subscribe",this.ya);l.p(this,"extend",this.extend);l.p(this,"getSubscriptionsCount",this.yb)};l.S.fn={ya:function(a,b,c){c=c||"change";var d=new l.fb(this,b?a.bind(b):a,function(){l.a.ga(this.w[c],
d)}.bind(this));this.w[c]||(this.w[c]=[]);this.w[c].push(d);return d},notifySubscribers:function(a,b){b=b||"change";this.w[b]&&l.r.K(function(){l.a.o(this.w[b].slice(0),function(b){b&&!0!==b.Cb&&b.ha(a)})},this)},yb:function(){var a=0,b;for(b in this.w)this.w.hasOwnProperty(b)&&(a+=this.w[b].length);return a},extend:function(a){var b=this;if(a)for(var c in a){var d=l.Ma[c];"function"==typeof d&&(b=d(b,a[c]))}return b}};l.Qa=function(a){return"function"==typeof a.ya&&"function"==typeof a.notifySubscribers};
l.b("subscribable",l.S);l.b("isSubscribable",l.Qa);var A=[];l.r={mb:function(a){A.push({ha:a,La:[]})},end:function(){A.pop()},Wa:function(b){l.Qa(b)||a(Error("Only subscribable things can act as dependencies"));if(0<A.length){var c=A[A.length-1];!c||0<=l.a.i(c.La,b)||(c.La.push(b),c.ha(b))}},K:function(a,b,c){try{return A.push(null),a.apply(b,c||[])}finally{A.pop()}}};var U={undefined:!0,"boolean":!0,number:!0,string:!0};l.m=function(a){function b(){if(0<arguments.length)return b.equalityComparer&&
b.equalityComparer(c,arguments[0])||(b.H(),c=arguments[0],b.G()),this;l.r.Wa(b);return c}var c=a;l.S.call(b);b.t=function(){return c};b.G=function(){b.notifySubscribers(c)};b.H=function(){b.notifySubscribers(c,"beforeChange")};l.a.extend(b,l.m.fn);l.p(b,"peek",b.t);l.p(b,"valueHasMutated",b.G);l.p(b,"valueWillMutate",b.H);return b};l.m.fn={equalityComparer:function(a,b){return null===a||typeof a in U?a===b:!1}};var H=l.m.Kb="__ko_proto__";l.m.fn[H]=l.m;l.ma=function(a,b){return null===a||void 0===
a||void 0===a[H]?!1:a[H]===b?!0:l.ma(a[H],b)};l.$=function(a){return l.ma(a,l.m)};l.Ra=function(a){return"function"==typeof a&&a[H]===l.m||"function"==typeof a&&a[H]===l.j&&a.zb?!0:!1};l.b("observable",l.m);l.b("isObservable",l.$);l.b("isWriteableObservable",l.Ra);l.R=function(b){0==arguments.length&&(b=[]);null===b||void 0===b||"length"in b||a(Error("The argument passed when initializing an observable array must be an array, or null, or undefined."));var c=l.m(b);l.a.extend(c,l.R.fn);return c};l.R.fn=
{remove:function(a){for(var b=this.t(),c=[],d="function"==typeof a?a:function(b){return b===a},e=0;e<b.length;e++){var g=b[e];d(g)&&(0===c.length&&this.H(),c.push(g),b.splice(e,1),e--)}c.length&&this.G();return c},removeAll:function(a){if(void 0===a){var b=this.t(),c=b.slice(0);this.H();b.splice(0,b.length);this.G();return c}return a?this.remove(function(b){return 0<=l.a.i(a,b)}):[]},destroy:function(a){var b=this.t(),c="function"==typeof a?a:function(b){return b===a};this.H();for(var d=b.length-
1;0<=d;d--)c(b[d])&&(b[d]._destroy=!0);this.G()},destroyAll:function(a){return void 0===a?this.destroy(e(!0)):a?this.destroy(function(b){return 0<=l.a.i(a,b)}):[]},indexOf:function(a){var b=this();return l.a.i(b,a)},replace:function(a,b){var c=this.indexOf(a);0<=c&&(this.H(),this.t()[c]=b,this.G())}};l.a.o("pop push reverse shift sort splice unshift".split(" "),function(a){l.R.fn[a]=function(){var b=this.t();this.H();b=b[a].apply(b,arguments);this.G();return b}});l.a.o(["slice"],function(a){l.R.fn[a]=
function(){var b=this();return b[a].apply(b,arguments)}});l.b("observableArray",l.R);l.j=function(b,c,d){function g(){l.a.o(w,function(a){a.B()});w=[]}function h(){var a=k.throttleEvaluation;a&&0<=a?(clearTimeout(G),G=setTimeout(f,a)):f()}function f(){if(!q)if(n&&r())x();else{q=!0;try{var a=l.a.V(w,function(a){return a.target});l.r.mb(function(b){var c;0<=(c=l.a.i(a,b))?a[c]=void 0:w.push(b.ya(h))});for(var b=v.call(c),d=a.length-1;0<=d;d--)a[d]&&w.splice(d,1)[0].B();n=!0;k.notifySubscribers(m,"beforeChange");
m=b}finally{l.r.end()}k.notifySubscribers(m);q=!1;w.length||x()}}function k(){if(0<arguments.length)return"function"===typeof p?p.apply(c,arguments):a(Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")),this;n||f();l.r.Wa(k);return m}function t(){return!n||0<w.length}var m,n=!1,q=!1,v=b;v&&"object"==typeof v?(d=v,v=d.read):(d=d||{},v||(v=d.read));"function"!=typeof v&&a(Error("Pass a function that returns the value of the ko.computed"));
var p=d.write,D=d.disposeWhenNodeIsRemoved||d.W||null,r=d.disposeWhen||d.Ka||e(!1),x=g,w=[],G=null;c||(c=d.owner);k.t=function(){n||f();return m};k.xb=function(){return w.length};k.zb="function"===typeof d.write;k.B=function(){x()};k.pa=t;l.S.call(k);l.a.extend(k,l.j.fn);l.p(k,"peek",k.t);l.p(k,"dispose",k.B);l.p(k,"isActive",k.pa);l.p(k,"getDependenciesCount",k.xb);!0!==d.deferEvaluation&&f();if(D&&t()){x=function(){l.a.F.Xa(D,arguments.callee);g()};l.a.F.Ca(D,x);var z=r,r=function(){return!l.a.X(D)||
z()}}return k};l.Bb=function(a){return l.ma(a,l.j)};h=l.m.Kb;l.j[h]=l.m;l.j.fn={};l.j.fn[h]=l.j;l.b("dependentObservable",l.j);l.b("computed",l.j);l.b("isComputed",l.Bb);l.gb=function(b){0==arguments.length&&a(Error("When calling ko.toJS, pass the object you want to convert."));return C(b,function(a){for(var b=0;l.$(a)&&10>b;b++)a=a();return a})};l.toJSON=function(a,b,c){a=l.gb(a);return l.a.xa(a,b,c)};l.b("toJS",l.gb);l.b("toJSON",l.toJSON);l.k={q:function(a){switch(l.a.u(a)){case "option":return!0===
a.__ko__hasDomDataOptionValue__?l.a.f.get(a,l.c.options.sa):7>=l.a.Z?a.getAttributeNode("value").specified?a.value:a.text:a.value;case "select":return 0<=a.selectedIndex?l.k.q(a.options[a.selectedIndex]):void 0;default:return a.value}},T:function(a,b){switch(l.a.u(a)){case "option":switch(typeof b){case "string":l.a.f.set(a,l.c.options.sa,void 0);"__ko__hasDomDataOptionValue__"in a&&delete a.__ko__hasDomDataOptionValue__;a.value=b;break;default:l.a.f.set(a,l.c.options.sa,b),a.__ko__hasDomDataOptionValue__=
!0,a.value="number"===typeof b?b:""}break;case "select":for(var c=a.options.length-1;0<=c;c--)if(l.k.q(a.options[c])==b){a.selectedIndex=c;break}break;default:if(null===b||void 0===b)b="";a.value=b}}};l.b("selectExtensions",l.k);l.b("selectExtensions.readValue",l.k.q);l.b("selectExtensions.writeValue",l.k.T);var Q=/\@ko_token_(\d+)\@/g,F=["true","false"],J=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i;l.g={Q:[],aa:function(a){var b=l.a.D(a);if(3>b.length)return[];"{"===b.charAt(0)&&(b=b.substring(1,
b.length-1));a=[];for(var c=null,d,e=0;e<b.length;e++){var g=b.charAt(e);if(null===c)switch(g){case '"':case "'":case "/":c=e,d=g}else if(g==d&&"\\"!==b.charAt(e-1)){g=b.substring(c,e+1);a.push(g);var h="@ko_token_"+(a.length-1)+"@",b=b.substring(0,c)+h+b.substring(e+1),e=e-(g.length-h.length),c=null}}d=c=null;for(var f=0,k=null,e=0;e<b.length;e++){g=b.charAt(e);if(null===c)switch(g){case "{":c=e;k=g;d="}";break;case "(":c=e;k=g;d=")";break;case "[":c=e,k=g,d="]"}g===k?f++:g===d&&(f--,0===f&&(g=b.substring(c,
e+1),a.push(g),h="@ko_token_"+(a.length-1)+"@",b=b.substring(0,c)+h+b.substring(e+1),e-=g.length-h.length,c=null))}d=[];b=b.split(",");c=0;for(e=b.length;c<e;c++)f=b[c],k=f.indexOf(":"),0<k&&k<f.length-1?(g=f.substring(k+1),d.push({key:z(f.substring(0,k),a),value:z(g,a)})):d.push({unknown:z(f,a)});return d},ba:function(a){var b="string"===typeof a?l.g.aa(a):a,c=[];a=[];for(var d,e=0;d=b[e];e++)if(0<c.length&&c.push(","),d.key){var g;a:{g=d.key;var h=l.a.D(g);switch(h.length&&h.charAt(0)){case "'":case '"':break a;
default:g="'"+h+"'"}}d=d.value;c.push(g);c.push(":");c.push(d);d=l.a.D(d);0<=l.a.i(F,l.a.D(d).toLowerCase())?d=!1:(h=d.match(J),d=null===h?!1:h[1]?"Object("+h[1]+")"+h[2]:d);d&&(0<a.length&&a.push(", "),a.push(g+" : function(__ko_value) { "+d+" = __ko_value; }"))}else d.unknown&&c.push(d.unknown);b=c.join("");0<a.length&&(b=b+", '_ko_property_writers' : { "+a.join("")+" } ");return b},Eb:function(a,b){for(var c=0;c<a.length;c++)if(l.a.D(a[c].key)==b)return!0;return!1},ea:function(a,b,c,d,e){if(a&&
l.Ra(a))e&&a.t()===d||a(d);else if((a=b()._ko_property_writers)&&a[c])a[c](d)}};l.b("expressionRewriting",l.g);l.b("expressionRewriting.bindingRewriteValidators",l.g.Q);l.b("expressionRewriting.parseObjectLiteral",l.g.aa);l.b("expressionRewriting.preProcessBindings",l.g.ba);l.b("jsonExpressionRewriting",l.g);l.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",l.g.ba);var O="\x3c!--test--\x3e"===c.createComment("test").text,N=O?/^\x3c!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*--\x3e$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/,
T=O?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,M={ul:!0,ol:!0};l.e={I:{},childNodes:function(a){return E(a)?D(a):a.childNodes},Y:function(a){if(E(a)){a=l.e.childNodes(a);for(var b=0,c=a.length;b<c;b++)l.removeNode(a[b])}else l.a.ka(a)},N:function(a,b){if(E(a)){l.e.Y(a);for(var c=a.nextSibling,d=0,e=b.length;d<e;d++)c.parentNode.insertBefore(b[d],c)}else l.a.N(a,b)},Va:function(a,b){E(a)?a.parentNode.insertBefore(b,a.nextSibling):a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b)},Pa:function(a,
b,c){c?E(a)?a.parentNode.insertBefore(b,c.nextSibling):c.nextSibling?a.insertBefore(b,c.nextSibling):a.appendChild(b):l.e.Va(a,b)},firstChild:function(a){return E(a)?!a.nextSibling||B(a.nextSibling)?null:a.nextSibling:a.firstChild},nextSibling:function(a){E(a)&&(a=t(a));return a.nextSibling&&B(a.nextSibling)?null:a.nextSibling},jb:function(a){return(a=E(a))?a[1]:null},Ta:function(a){if(M[l.a.u(a)]){var b=a.firstChild;if(b){do if(1===b.nodeType){var c;c=b.firstChild;var d=null;if(c){do if(d)d.push(c);
else if(E(c)){var e=t(c,!0);e?c=e:d=[c]}else B(c)&&(d=[c]);while(c=c.nextSibling)}if(c=d)for(d=b.nextSibling,e=0;e<c.length;e++)d?a.insertBefore(c[e],d):a.appendChild(c[e])}while(b=b.nextSibling)}}}};l.b("virtualElements",l.e);l.b("virtualElements.allowedBindings",l.e.I);l.b("virtualElements.emptyNode",l.e.Y);l.b("virtualElements.insertAfter",l.e.Pa);l.b("virtualElements.prepend",l.e.Va);l.b("virtualElements.setDomNodeChildren",l.e.N);l.J=function(){this.Ha={}};l.a.extend(l.J.prototype,{nodeHasBindings:function(a){switch(a.nodeType){case 1:return null!=
a.getAttribute("data-bind");case 8:return null!=l.e.jb(a);default:return!1}},getBindings:function(a,b){var c=this.getBindingsString(a,b);return c?this.parseBindingsString(c,b,a):null},getBindingsString:function(a){switch(a.nodeType){case 1:return a.getAttribute("data-bind");case 8:return l.e.jb(a);default:return null}},parseBindingsString:function(b,c,d){try{var e;if(!(e=this.Ha[b])){var g=this.Ha,h,f="with($context){with($data||{}){return{"+l.g.ba(b)+"}}}";h=new Function("$context","$element",f);
e=g[b]=h}return e(c,d)}catch(k){a(Error("Unable to parse bindings.\nMessage: "+k+";\nBindings value: "+b))}}});l.J.instance=new l.J;l.b("bindingProvider",l.J);l.c={};l.z=function(a,b,c){b?(l.a.extend(this,b),this.$parentContext=b,this.$parent=b.$data,this.$parents=(b.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=a,this.ko=l);this.$data=a;c&&(this[c]=a)};l.z.prototype.createChildContext=function(a,b){return new l.z(a,this,b)};l.z.prototype.extend=function(a){var b=
l.a.extend(new l.z,this);return l.a.extend(b,a)};l.eb=function(a,b){if(2==arguments.length)l.a.f.set(a,"__ko_bindingContext__",b);else return l.a.f.get(a,"__ko_bindingContext__")};l.Fa=function(a,b,c){1===a.nodeType&&l.e.Ta(a);return r(a,b,c,!0)};l.Ea=function(a,b){1!==b.nodeType&&8!==b.nodeType||y(a,b,!0)};l.Da=function(b,c){c&&1!==c.nodeType&&8!==c.nodeType&&a(Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node"));c=c||d.document.body;w(b,c,
!0)};l.ja=function(a){switch(a.nodeType){case 1:case 8:var b=l.eb(a);if(b)return b;if(a.parentNode)return l.ja(a.parentNode)}};l.pb=function(a){return(a=l.ja(a))?a.$data:void 0};l.b("bindingHandlers",l.c);l.b("applyBindings",l.Da);l.b("applyBindingsToDescendants",l.Ea);l.b("applyBindingsToNode",l.Fa);l.b("contextFor",l.ja);l.b("dataFor",l.pb);var Z={"class":"className","for":"htmlFor"};l.c.attr={update:function(a,b){var c=l.a.d(b())||{},d;for(d in c)if("string"==typeof d){var e=l.a.d(c[d]),g=!1===
e||null===e||void 0===e;g&&a.removeAttribute(d);8>=l.a.Z&&d in Z?(d=Z[d],g?a.removeAttribute(d):a[d]=e):g||a.setAttribute(d,e.toString());"name"===d&&l.a.ab(a,g?"":e.toString())}}};l.c.checked={init:function(a,b,c){l.a.n(a,"click",function(){var d;if("checkbox"==a.type)d=a.checked;else if("radio"==a.type&&a.checked)d=a.value;else return;var e=b(),g=l.a.d(e);"checkbox"==a.type&&g instanceof Array?(d=l.a.i(g,a.value),a.checked&&0>d?e.push(a.value):!a.checked&&0<=d&&e.splice(d,1)):l.g.ea(e,c,"checked",
d,!0)});"radio"==a.type&&!a.name&&l.c.uniqueName.init(a,e(!0))},update:function(a,b){var c=l.a.d(b());"checkbox"==a.type?a.checked=c instanceof Array?0<=l.a.i(c,a.value):c:"radio"==a.type&&(a.checked=a.value==c)}};l.c.css={update:function(a,b){var c=l.a.d(b());if("object"==typeof c)for(var d in c){var e=l.a.d(c[d]);l.a.da(a,d,e)}else c=String(c||""),l.a.da(a,a.__ko__cssValue,!1),a.__ko__cssValue=c,l.a.da(a,c,!0)}};l.c.enable={update:function(a,b){var c=l.a.d(b());c&&a.disabled?a.removeAttribute("disabled"):
!c&&!a.disabled&&(a.disabled=!0)}};l.c.disable={update:function(a,b){l.c.enable.update(a,function(){return!l.a.d(b())})}};l.c.event={init:function(a,b,c,d){var e=b()||{},g;for(g in e)(function(){var e=g;"string"==typeof e&&l.a.n(a,e,function(a){var g,h=b()[e];if(h){var f=c();try{var k=l.a.L(arguments);k.unshift(d);g=h.apply(d,k)}finally{!0!==g&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}!1===f[e+"Bubble"]&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())}})})()}};l.c.foreach=
{Sa:function(a){return function(){var b=a(),c=l.a.ua(b);if(!c||"number"==typeof c.length)return{foreach:b,templateEngine:l.C.oa};l.a.d(b);return{foreach:c.data,as:c.as,includeDestroyed:c.includeDestroyed,afterAdd:c.afterAdd,beforeRemove:c.beforeRemove,afterRender:c.afterRender,beforeMove:c.beforeMove,afterMove:c.afterMove,templateEngine:l.C.oa}}},init:function(a,b){return l.c.template.init(a,l.c.foreach.Sa(b))},update:function(a,b,c,d,e){return l.c.template.update(a,l.c.foreach.Sa(b),c,d,e)}};l.g.Q.foreach=
!1;l.e.I.foreach=!0;l.c.hasfocus={init:function(a,b,c){function d(e){a.__ko_hasfocusUpdating=!0;var g=a.ownerDocument;"activeElement"in g&&(e=g.activeElement===a);g=b();l.g.ea(g,c,"hasfocus",e,!0);a.__ko_hasfocusUpdating=!1}var e=d.bind(null,!0),g=d.bind(null,!1);l.a.n(a,"focus",e);l.a.n(a,"focusin",e);l.a.n(a,"blur",g);l.a.n(a,"focusout",g)},update:function(a,b){var c=l.a.d(b());a.__ko_hasfocusUpdating||(c?a.focus():a.blur(),l.r.K(l.a.Ba,null,[a,c?"focusin":"focusout"]))}};l.c.html={init:function(){return{controlsDescendantBindings:!0}},
update:function(a,b){l.a.ca(a,b())}};var S="__ko_withIfBindingData";R("if");R("ifnot",!1,!0);R("with",!0,!1,function(a,b){return a.createChildContext(b)});l.c.options={update:function(b,d,e){"select"!==l.a.u(b)&&a(Error("options binding applies only to SELECT elements"));for(var g=0==b.length,h=l.a.V(l.a.fa(b.childNodes,function(a){return a.tagName&&"option"===l.a.u(a)&&a.selected}),function(a){return l.k.q(a)||a.innerText||a.textContent}),f=b.scrollTop,k=l.a.d(d());0<b.length;)l.A(b.options[0]),
b.remove(0);if(k){e=e();var t=e.optionsIncludeDestroyed;"number"!=typeof k.length&&(k=[k]);if(e.optionsCaption){var m=c.createElement("option");l.a.ca(m,e.optionsCaption);l.k.T(m,void 0);b.appendChild(m)}d=0;for(var n=k.length;d<n;d++){var q=k[d];if(!q||!q._destroy||t){var m=c.createElement("option"),v=function(a,b,c){var d=typeof b;return"function"==d?b(a):"string"==d?a[b]:c},p=v(q,e.optionsValue,q);l.k.T(m,l.a.d(p));q=v(q,e.optionsText,p);l.a.cb(m,q);b.appendChild(m)}}k=b.getElementsByTagName("option");
d=t=0;for(n=k.length;d<n;d++)0<=l.a.i(h,l.k.q(k[d]))&&(l.a.bb(k[d],!0),t++);b.scrollTop=f;g&&"value"in e&&P(b,l.a.ua(e.value),!0);l.a.ub(b)}}};l.c.options.sa="__ko.optionValueDomData__";l.c.selectedOptions={init:function(a,b,c){l.a.n(a,"change",function(){var d=b(),e=[];l.a.o(a.getElementsByTagName("option"),function(a){a.selected&&e.push(l.k.q(a))});l.g.ea(d,c,"value",e)})},update:function(b,c){"select"!=l.a.u(b)&&a(Error("values binding applies only to SELECT elements"));var d=l.a.d(c());d&&"number"==
typeof d.length&&l.a.o(b.getElementsByTagName("option"),function(a){var b=0<=l.a.i(d,l.k.q(a));l.a.bb(a,b)})}};l.c.style={update:function(a,b){var c=l.a.d(b()||{}),d;for(d in c)if("string"==typeof d){var e=l.a.d(c[d]);a.style[d]=e||""}}};l.c.submit={init:function(b,c,d,e){"function"!=typeof c()&&a(Error("The value for a submit binding must be a function"));l.a.n(b,"submit",function(a){var d,g=c();try{d=g.call(e,b)}finally{!0!==d&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}})}};l.c.text=
{update:function(a,b){l.a.cb(a,b())}};l.e.I.text=!0;l.c.uniqueName={init:function(a,b){if(b()){var c="ko_unique_"+ ++l.c.uniqueName.ob;l.a.ab(a,c)}}};l.c.uniqueName.ob=0;l.c.value={init:function(a,b,c){function d(){h=!1;var e=b(),g=l.k.q(a);l.g.ea(e,c,"value",g)}var e=["change"],g=c().valueUpdate,h=!1;g&&("string"==typeof g&&(g=[g]),l.a.P(e,g),e=l.a.Ga(e));!l.a.Z||"input"!=a.tagName.toLowerCase()||"text"!=a.type||"off"==a.autocomplete||a.form&&"off"==a.form.autocomplete||-1!=l.a.i(e,"propertychange")||
(l.a.n(a,"propertychange",function(){h=!0}),l.a.n(a,"blur",function(){h&&d()}));l.a.o(e,function(b){var c=d;l.a.Ob(b,"after")&&(c=function(){setTimeout(d,0)},b=b.substring(5));l.a.n(a,b,c)})},update:function(a,b){var c="select"===l.a.u(a),d=l.a.d(b()),e=l.k.q(a),g=d!=e;0===d&&0!==e&&"0"!==e&&(g=!0);g&&(e=function(){l.k.T(a,d)},e(),c&&setTimeout(e,0));c&&0<a.length&&P(a,d,!1)}};l.c.visible={update:function(a,b){var c=l.a.d(b()),d="none"!=a.style.display;c&&!d?a.style.display="":!c&&d&&(a.style.display=
"none")}};l.c.click={init:function(a,b,c,d){return l.c.event.init.call(this,a,function(){var a={};a.click=b();return a},c,d)}};l.v=function(){};l.v.prototype.renderTemplateSource=function(){a(Error("Override renderTemplateSource"))};l.v.prototype.createJavaScriptEvaluatorBlock=function(){a(Error("Override createJavaScriptEvaluatorBlock"))};l.v.prototype.makeTemplateSource=function(b,d){if("string"==typeof b){d=d||c;var e=d.getElementById(b);e||a(Error("Cannot find template with ID "+b));return new l.l.h(e)}if(1==
b.nodeType||8==b.nodeType)return new l.l.O(b);a(Error("Unknown template type: "+b))};l.v.prototype.renderTemplate=function(a,b,c,d){a=this.makeTemplateSource(a,d);return this.renderTemplateSource(a,b,c)};l.v.prototype.isTemplateRewritten=function(a,b){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(a,b).data("isRewritten")};l.v.prototype.rewriteTemplate=function(a,b,c){a=this.makeTemplateSource(a,c);b=b(a.text());a.text(b);a.data("isRewritten",!0)};l.b("templateEngine",l.v);var ba=
/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,aa=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;l.za={vb:function(a,b,c){b.isTemplateRewritten(a,c)||b.rewriteTemplate(a,function(a){return l.za.Gb(a,b)},c)},Gb:function(a,b){return a.replace(ba,function(a,c,d,e,g,h,f){return v(f,c,b)}).replace(aa,function(a,c){return v(c,"\x3c!-- ko --\x3e",b)})},kb:function(a){return l.s.ra(function(b,c){b.nextSibling&&l.Fa(b.nextSibling,a,c)})}};l.b("__tr_ambtns",
l.za.kb);l.l={};l.l.h=function(a){this.h=a};l.l.h.prototype.text=function(){var a=l.a.u(this.h),a="script"===a?"text":"textarea"===a?"value":"innerHTML";if(0==arguments.length)return this.h[a];var b=arguments[0];"innerHTML"===a?l.a.ca(this.h,b):this.h[a]=b};l.l.h.prototype.data=function(a){if(1===arguments.length)return l.a.f.get(this.h,"templateSourceData_"+a);l.a.f.set(this.h,"templateSourceData_"+a,arguments[1])};l.l.O=function(a){this.h=a};l.l.O.prototype=new l.l.h;l.l.O.prototype.text=function(){if(0==
arguments.length){var a=l.a.f.get(this.h,"__ko_anon_template__")||{};void 0===a.Aa&&a.ia&&(a.Aa=a.ia.innerHTML);return a.Aa}l.a.f.set(this.h,"__ko_anon_template__",{Aa:arguments[0]})};l.l.h.prototype.nodes=function(){if(0==arguments.length)return(l.a.f.get(this.h,"__ko_anon_template__")||{}).ia;l.a.f.set(this.h,"__ko_anon_template__",{ia:arguments[0]})};l.b("templateSources",l.l);l.b("templateSources.domElement",l.l.h);l.b("templateSources.anonymousTemplate",l.l.O);var X;l.wa=function(b){void 0==
b||b instanceof l.v||a(Error("templateEngine must inherit from ko.templateEngine"));X=b};l.va=function(b,c,d,e,g){d=d||{};void 0==(d.templateEngine||X)&&a(Error("Set a template engine before calling renderTemplate"));g=g||"replaceChildren";if(e){var h=q(e);return l.j(function(){var a=c&&c instanceof l.z?c:new l.z(l.a.d(c)),f="function"==typeof b?b(a.$data,a):b,a=p(e,g,f,a,d);"replaceNode"==g&&(e=a,h=q(e))},null,{Ka:function(){return!h||!l.a.X(h)},W:h&&"replaceNode"==g?h.parentNode:h})}return l.s.ra(function(a){l.va(b,
c,d,a,"replaceNode")})};l.Mb=function(a,b,c,d,e){function g(a,b){u(b,f);c.afterRender&&c.afterRender(b,a)}function h(b,d){f=e.createChildContext(l.a.d(b),c.as);f.$index=d;var g="function"==typeof a?a(b,f):a;return p(null,"ignoreTargetNode",g,f,c)}var f;return l.j(function(){var a=l.a.d(b)||[];"undefined"==typeof a.length&&(a=[a]);a=l.a.fa(a,function(a){return c.includeDestroyed||void 0===a||null===a||!l.a.d(a._destroy)});l.r.K(l.a.$a,null,[d,a,h,c,g])},null,{W:d})};l.c.template={init:function(a,b){var c=
l.a.d(b());"string"==typeof c||c.name||1!=a.nodeType&&8!=a.nodeType||(c=1==a.nodeType?a.childNodes:l.e.childNodes(a),c=l.a.Hb(c),(new l.l.O(a)).nodes(c));return{controlsDescendantBindings:!0}},update:function(a,b,c,d,e){b=l.a.d(b());c={};d=!0;var g,h=null;"string"!=typeof b&&(c=b,b=c.name,"if"in c&&(d=l.a.d(c["if"])),d&&"ifnot"in c&&(d=!l.a.d(c.ifnot)),g=l.a.d(c.data));"foreach"in c?h=l.Mb(b||a,d&&c.foreach||[],c,a,e):d?(e="data"in c?e.createChildContext(g,c.as):e,h=l.va(b||a,e,c,a)):l.e.Y(a);e=h;
(g=l.a.f.get(a,"__ko__templateComputedDomDataKey__"))&&"function"==typeof g.B&&g.B();l.a.f.set(a,"__ko__templateComputedDomDataKey__",e&&e.pa()?e:void 0)}};l.g.Q.template=function(a){a=l.g.aa(a);return 1==a.length&&a[0].unknown||l.g.Eb(a,"name")?null:"This template engine does not support anonymous templates nested within its templates"};l.e.I.template=!0;l.b("setTemplateEngine",l.wa);l.b("renderTemplate",l.va);l.a.Ja=function(a,b,c){a=a||[];b=b||[];return a.length<=b.length?n(a,b,"added","deleted",
c):n(b,a,"deleted","added",c)};l.b("utils.compareArrays",l.a.Ja);l.a.$a=function(a,c,d,e,g){function h(a,b){z=n[b];r!==b&&(G[a]=z);z.na(r++);f(z.M);p.push(z);w.push(z)}function k(a,b){if(a)for(var c=0,d=b.length;c<d;c++)b[c]&&l.a.o(b[c].M,function(d){a(d,c,b[c].U)})}c=c||[];e=e||{};var t=void 0===l.a.f.get(a,"setDomNodeChildrenFromArrayMapping_lastMappingResult"),n=l.a.f.get(a,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],q=l.a.V(n,function(a){return a.U}),v=l.a.Ja(q,c),p=[],D=0,r=0,
x=[],w=[];c=[];for(var G=[],q=[],z,u=0,C,B;C=v[u];u++)switch(B=C.moved,C.status){case "deleted":void 0===B&&(z=n[D],z.j&&z.j.B(),x.push.apply(x,f(z.M)),e.beforeRemove&&(c[u]=z,w.push(z)));D++;break;case "retained":h(u,D++);break;case "added":void 0!==B?h(u,B):(z={U:C.value,na:l.m(r++)},p.push(z),w.push(z),t||(q[u]=z))}k(e.beforeMove,G);l.a.o(x,e.beforeRemove?l.A:l.removeNode);for(var u=0,t=l.e.firstChild(a),I;z=w[u];u++){z.M||l.a.extend(z,b(a,d,z.U,g,z.na));for(D=0;v=z.M[D];t=v.nextSibling,I=v,D++)v!==
t&&l.e.Pa(a,v,I);!z.Ab&&g&&(g(z.U,z.M,z.na),z.Ab=!0)}k(e.beforeRemove,c);k(e.afterMove,G);k(e.afterAdd,q);l.a.f.set(a,"setDomNodeChildrenFromArrayMapping_lastMappingResult",p)};l.b("utils.setDomNodeChildrenFromArrayMapping",l.a.$a);l.C=function(){this.allowTemplateRewriting=!1};l.C.prototype=new l.v;l.C.prototype.renderTemplateSource=function(a){var b=9>l.a.Z||!a.nodes?null:a.nodes();if(b)return l.a.L(b.cloneNode(!0).childNodes);a=a.text();return l.a.ta(a)};l.C.oa=new l.C;l.wa(l.C.oa);l.b("nativeTemplateEngine",
l.C);l.qa=function(){var b=this.Db=function(){if("undefined"==typeof g||!g.tmpl)return 0;try{if(0<=g.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(a){}return 1}();this.renderTemplateSource=function(d,e,h){h=h||{};2>b&&a(Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later."));var f=d.data("precompiled");f||(f=d.text()||"",f=g.template(null,"{{ko_with $item.koBindingContext}}"+f+"{{/ko_with}}"),d.data("precompiled",f));d=[e.$data];e=g.extend({koBindingContext:e},
h.templateOptions);e=g.tmpl(f,d,e);e.appendTo(c.createElement("div"));g.fragments={};return e};this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"};this.addTemplate=function(a,b){c.write("<script type='text/html' id='"+a+"'>"+b+"\x3c/script>")};0<b&&(g.tmpl.tag.ko_code={open:"__.push($1 || '');"},g.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};l.qa.prototype=new l.v;h=new l.qa;0<h.Db&&l.wa(h);l.b("jqueryTmplTemplateEngine",l.qa)}var d=window,
c=document,k=navigator,g=window.jQuery;"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?f(module.exports||exports):"function"===typeof define&&define.amd?define(["exports"],f):f(d.ko={});!0})();
(function(a,e){function f(a,b){for(var c in a)if(a.hasOwnProperty(c)&&0<=a[c].toString().indexOf(b))return c}function d(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c}a.tasks=function(){function b(a){try{for(var c=a||0;c<h.length;c++){k=c;var d=h[c],f=d.evaluator;d.processed||(d.processed=!0,f.apply(d.object,d.args||[]))}}finally{a?h.splice(a,h.length):(h=[],g=e),k=e}}function c(){b()}var d=window.setImmediate?"setImmediate":"setTimeout",g,h=[],f=[],k,t={processImmediate:function(a,
c,d){f.push(h.length);try{return a.apply(c,d||[])}finally{a=f.pop(),h.length>a&&b(a)}},processDelayed:function(b,t,m){if(t=t||t===e)a:{t=k||(f.length?f[f.length-1]:0);for(var n=h.length;t<n;t++)if(h[t].evaluator==b&&!h[t].processed){m&&a.utils.extend(h[t],m);t=!0;break a}t=!1}if(t)return!1;h.push(a.utils.extend({evaluator:b},m||{}));f.length||g||(g=window[d](c));return!0},makeProcessedCallback:function(a){return function(){return t.processImmediate(a,this,arguments)}}};a.processDeferredBindingUpdatesForNode=
a.processAllDeferredBindingUpdates=function(a){for(a=0;a<h.length;a++){var b=h[a];b.node&&!b.processed&&(b.processed=!0,b=h[a].evaluator,b())}};a.processAllDeferredUpdates=c;a.evaluateAsynchronously=function(a,b){return setTimeout(t.makeProcessedCallback(a),b)};return t}();var c=function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]&&a[c][b])return a[c]}(a,"end"),k=f(c,".push({"),g=f(c,".length"),h=a.computed,b=d(a,h),m=d(h.fn,h),n=a.computed(function(){}),p=d(n,n.peek)||"peek",q=d(n,n.isActive)||
"isActive",u=d(n,n.getDependenciesCount),x=d(n,!1),v=d(n,n.dispose),r="disposeWhenNodeIsRemoved",w="disposeWhen";if("hasWriteFunction"!=x){var n=h.toString(),y;if(y=n.match(/.\.disposeWhenNodeIsRemoved\|\|.\.([^|]+)\|\|/))r=y[1];if(n=n.match(/.\.disposeWhen\|\|.\.([^|]+)\|\|/))w=n[1]}var t=f(a.utils,"ocument)"),n=a.subscribable.fn;y=f(n,".bind(");var D=(new a.subscribable).subscribe(),B=D.constructor.prototype,E=d(B,D.dispose),z=B[E];D.dispose();D=null;a.ignoreDependencies=function(a,b,d){try{return c[k](function(){}),
a.apply(b,d||[])}finally{c.end()}};n.oldSubscribe=n[y];n[y]=function(b,c,d,e,g){d=d||"change";if(g)h=function(a){b(a,d)},"change"==d&&(this.dependents=this.dependents||[],this.dependents.push(g));else var h=function(g){(G.deferUpdates&&!1!==e||e)&&"change"==d?a.tasks.processDelayed(b,!1,{object:c,args:[g,d]}):a.ignoreDependencies(b,c,[g,d])};h=this.oldSubscribe(h,null,d);h.target=this;h.event=d;h.dependent=g;return h};n.getDependents=function(){return this.dependents?this.dependents.slice(0):[]};
B[E]=function(){z.call(this);this.dependent&&"change"==this.event&&a.utils.arrayRemoveItem(this.target.dependents,this.dependent)};var G=function(b,d,h){function f(){a.utils.arrayForEach(S,function(a){a.dispose()});a.utils.arrayForEach(ba,function(a){a.dispose()});S=[];O=N=!1}function n(b,c){var d="dirty"==c,e=d&&!O&&!N;d?O=!0:N=!0;(d=y.throttleEvaluation)&&0<=d?(clearTimeout(aa),aa=a.evaluateAsynchronously(E,d)):G.deferUpdates&&!1!==y.deferUpdates||y.deferUpdates?e=a.tasks.processDelayed(E,!0,{node:V}):
N&&(e=E());e&&y.notifySubscribers&&(y.notifySubscribers(J,"dirty"),!O&&d&&clearTimeout(aa))}function D(a){O||N?N=!0:n(a,"change")}function z(a){var b="change";a[m]===G&&(S.push(a.subscribe(D,null,"change",!1,y)),b="dirty");S.push(a.subscribe(n,null,b,!1,y))}function B(){return a.utils.arrayMap(S,function(a){return a.target})}function E(b){if(T||!N&&!0!==b)return O=N,!1;if(ca&&ca())return y.dispose(),!1;T=!0;try{var g=B();c[k](function(b){for(var c,d=!1;0<=(c=a.utils.arrayIndexOf(g,b));)g[c]=e,d=!0;
d||z(b)});for(var h=M.call(d),f=g.length-1;0<=f;f--)g[f]&&S.splice(f,1)[0].dispose();O=N=!1;y.notifySubscribers(J,"beforeChange");J=h}finally{c.end()}y.notifySubscribers(J);T=!1;return!0}function y(){if(0<arguments.length){if("function"===typeof Z){var a=y.deferUpdates;y.deferUpdates=!1;try{Z.apply(d,arguments)}finally{y.deferUpdates=a}}else throw Error('Cannot write a value to a ko.computed unless you specify a "write" option. If you wish to read the current value, don\'t pass any parameters.');
return this}(N||O)&&E(!0);c[g](y);return J}function F(){return N||O||0<S.length}var J,O=!1,N=!0,T=!1,M=b;M&&"object"==typeof M?(h=M,M=h.read):(h=h||{},M||(M=h.read));if("function"!=typeof M)throw Error("Pass a function that returns the value of the ko.computed");var Z=h.write;d||(d=h.owner);var S=[],ba=[],aa=null,X,V=h[r]||h.disposeWhenNodeIsRemoved||null;if(!0!==h.deferEvaluation){T=!0;try{c[k](z),J=M.call(d)}finally{c.end()}N=T=!1}var Y=f,ca=h[w]||h.disposeWhen||function(){return!1};if(V&&F()){Y=
function(){a.utils.domNodeDisposal.removeDisposeCallback(V,arguments.callee);f()};a.utils.domNodeDisposal.addDisposeCallback(V,Y);var da=ca,ca=function(){return!a.utils[t](V)||da()}}a.subscribable.call(y);a.utils.extend(y,G.fn);y[p]=y.peek=function(){(N||O)&&E(!0);return J};y[u]=y.getDependenciesCount=function(){return S.length};y[x]=y.hasWriteFunction="function"===typeof Z;y[v]=y.dispose=function(){Y()};y[q]=y.isActive=F;y.activeWhen=function(b){X||(X=a.computed(function(){T=!b();!T&&N&&n(e,"change")}),
X.deferUpdates=!1,ba.push(X))};y.getDependencies=function(){return a.utils.arrayMap(a.utils.arrayFilter(S,function(a){return"change"==a.event}),function(a){return a.target})};return y};G[m]=h[m];G.fn=h.fn;G.fn[m]=G;G.deferUpdates=!0;a[b]=a.computed=a.dependentObservable=G;h=n=null;a.extenders.throttle=function(b,c){if(a.isWriteableObservable(b)){var d=null;return a.dependentObservable({read:b,write:function(e){clearTimeout(d);d=a.evaluateAsynchronously(function(){b(e)},c)}})}b.throttleEvaluation=
c;return b}})(ko);(function(a,e){var f={};a.trafficCop=function(d,c){var e=d,g;2===arguments.length&&(e=a.extend(!0,c,{url:d}));g=JSON.stringify(e);if(g in f)for(i in{success:1,error:1,complete:1})f[g][i](e[i]);else f[g]=a.ajax(e).always(function(){delete f[g]});return f[g]}})(jQuery);
(function(a,e,f){var d={templates:{},storeTemplate:function(a,c){this.templates[a]=c},getTemplate:function(a){return this.templates[a]},purge:function(){this.templates={}}},c=function(a,c,d){return"<div class='infuser-error'>The template <a href='{TEMPLATEURL}'>{TEMPLATEID}</a> could not be loaded. {STATUS}</div>".replace("{STATUS}",a).replace("{TEMPLATEID}",c).replace("{TEMPLATEURL}",d)},k=[],g={getTemplatePath:function(a){var c=a.templatePrefix+a.templateId+a.templateSuffix;return a.templateUrl===
f||""===a.templateUrl?c:a.templateUrl+"/"+c},templateGetSuccess:function(a,c){return function(d){h.store.storeTemplate(a,d);c(h.store.getTemplate(a))}},templateGetError:function(b,d,e){return function(g){-1===a.inArray(b,k)&&k.push(b);g=c("HTTP Status code: "+g.status,b,d);h.store.storeTemplate(b,g);e(h.store.getTemplate(b))}},getAjaxOptions:function(a){}},h={storageOptions:{hash:d,script:{templateIds:[],storeTemplate:function(a,c){var d=document.getElementById(a);null===d&&(this.templateIds.push(a),
d=document.createElement("script"),d.type="text/html",d.id=a,document.body.appendChild(d));d.text=c},getTemplate:function(a){return document.getElementById(a)},purge:function(){for(var a=0;a<this.templateIds.length;a++)document.body.removeChild(document.getElementById(this.templateIds[a]));this.templateIds=[]}}},store:d,defaults:{templateUrl:"/resources/template",templateSuffix:".html",templatePrefix:"",ajax:{async:!0,dataType:"html",type:"GET"},target:function(a){return"#"+a},loadingTemplate:{content:'<div class="infuser-loading">Loading...</div>',
transitionIn:function(b,c){var d=a(b);d.hide();d.html(c);d.fadeIn()},transitionOut:function(b){a(b).html("")}},postRender:function(a){},preRender:function(a,c){},render:function(b,c){var d=a(b);0===d.children().length?d.append(a(c)):d.children().replaceWith(a(c))},bindingInstruction:function(a,c){return a},useLoadingTemplate:!0},get:function(b,c){var d=a.extend({},h.defaults,"object"===typeof b?b:{templateId:b}),e;d.ajax.url=g.getTemplatePath(d);(e=h.store.getTemplate(d.ajax.url))&&-1===a.inArray(d.ajax.url,
k)?c(e):(d.ajax.success=g.templateGetSuccess(d.ajax.url,c),d.ajax.error=g.templateGetError(d.templateId,d.ajax.url,c),a.trafficCop(d.ajax))},getSync:function(b){var d=a.extend({},h.defaults,"object"===typeof b?b:{templateId:b},{ajax:{async:!1}}),e;d.ajax.url=g.getTemplatePath(d);b=h.store.getTemplate(d.ajax.url);b&&-1===a.inArray(d.ajax.url,k)||(e=null,d.ajax.success=function(a){e=a},d.ajax.error=function(b){-1===a.inArray(d.ajax.url)&&k.push(d.ajax.url);e=c("HTTP Status code: exception.status",d.templateId,
d.ajax.url)},a.ajax(d.ajax),null===e?e=c("An unknown error occurred.",d.templateId,d.ajax.url):(h.store.storeTemplate(d.ajax.url,e),b=h.store.getTemplate(d.ajax.url)));return b},infuse:function(b,c){var d=a.extend({},h.defaults,"object"===typeof b?b:c,"string"===typeof b?{templateId:b}:f),e="function"===typeof d.target?d.target(b):d.target;d.useLoadingTemplate&&d.loadingTemplate.transitionIn(e,d.loadingTemplate.content);h.get(d,function(a){d.preRender(e,a);a=d.bindingInstruction(a,d.model);d.useLoadingTemplate&&
d.loadingTemplate.transitionOut(e);d.render(e,a);d.postRender(e)})}};e.infuser=h})(jQuery,window);
(function(a,e,f,d,c){var k=function(a,h){var b=this,f;b.templateId=a;b.loaded=!1;b.template=e.observable(d.defaults.useLoadingTemplate?d.defaults.loadingTemplate.content:c);b.template.data={};b.options=e.utils.extend({},h);b.options.templateId=a;b.options&&b.options.afterRender&&(f=b.options.afterRender,b.options.afterRender=function(){b.loaded&&f.apply(b.options,arguments)})};e.utils.extend(k.prototype,{data:function(a,c){if(1===arguments.length)return"precompiled"===a&&this.template(),this.template.data[a];
this.template.data[a]=c},text:function(a){this.loaded||this.getTemplate();if(0===arguments.length)return this.template();this.template(arguments[0])},getTemplate:function(){var a=this;d.get(a.options,function(c){a.data("precompiled",null);a.template(c);a.loaded=!0})}});a=function(a){var c=a?new a:new e.nativeTemplateEngine;c.templates={};c.makeTemplateSource=function(a,d,g){if("string"==typeof a){if(d=document.getElementById(a))return new e.templateSources.domElement(d);c.templates[a]||(c.templates[a]=
new k(a,g));return c.templates[a]}if(1==a.nodeType||8==a.nodeType)return new e.templateSources.anonymousTemplate(a)};c.renderTemplate=function(a,d,e){a=c.makeTemplateSource(a,d,e);return c.renderTemplateSource(a,d,e)};return c};e.KoExternalTemplateEngine=a;f.tmpl&&0<=f.tmpl.tag.tmpl.open.toString().indexOf("__")?e.setTemplateEngine(new a(e.jqueryTmplTemplateEngine)):e.setTemplateEngine(new a)})(window,ko,jQuery,infuser);
(function(a){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?a(require("knockout"),exports):"function"===typeof define&&define.amd?define(["knockout","exports"],a):a(ko,ko.mapping={})})(function(a,e){function f(a,b){var c,d;for(d in b)if(b.hasOwnProperty(d)&&b[d])if(c=e.getType(a[d]),d&&a[d]&&"array"!==c&&"string"!==c)f(a[d],b[d]);else if("array"===e.getType(a[d])&&"array"===e.getType(b[d])){c=a;for(var g=d,h=a[d],k=b[d],t={},m=h.length-1;0<=m;--m)t[h[m]]=h[m];for(m=
k.length-1;0<=m;--m)t[k[m]]=k[m];h=[];k=void 0;for(k in t)h.push(t[k]);c[g]=h}else a[d]=b[d]}function d(a,b){var c={};f(c,a);f(c,b);return c}function c(a,b){for(var c=d({},a),e=D.length-1;0<=e;e--){var g=D[e];c[g]&&(c[""]instanceof Object||(c[""]={}),c[""][g]=c[g],delete c[g])}b&&(c.ignore=k(b.ignore,c.ignore),c.include=k(b.include,c.include),c.copy=k(b.copy,c.copy),c.observe=k(b.observe,c.observe));c.ignore=k(c.ignore,z.ignore);c.include=k(c.include,z.include);c.copy=k(c.copy,z.copy);c.observe=k(c.observe,
z.observe);c.mappedProperties=c.mappedProperties||{};c.copiedProperties=c.copiedProperties||{};return c}function k(b,c){"array"!==e.getType(b)&&(b="undefined"===e.getType(b)?[]:[b]);"array"!==e.getType(c)&&(c="undefined"===e.getType(c)?[]:[c]);return a.utils.arrayGetDistinctValues(b.concat(c))}function g(b,c,f,k,D,l,x){var w="array"===e.getType(a.utils.unwrapObservable(c));l=l||"";if(e.isMapped(b)){var z=a.utils.unwrapObservable(b)[v];f=d(z,f)}var u=x||D,E=function(){return f[k]&&f[k].create instanceof
Function},F=function(b){var d=y,e=a.dependentObservable;a.dependentObservable=function(b,c,e){e=e||{};b&&"object"==typeof b&&(e=b);var g=e.deferEvaluation,h=!1;e.deferEvaluation=!0;b=new r(b,c,e);if(!g){var f=b,g=a.dependentObservable;a.dependentObservable=r;b=a.isWriteableObservable(f);a.dependentObservable=g;g=r({read:function(){h||(a.utils.arrayRemoveItem(d,f),h=!0);return f.apply(f,arguments)},write:b&&function(a){return f(a)},deferEvaluation:!0});g.__DO=f;b=g;d.push(b)}return b};a.dependentObservable.fn=
r.fn;a.computed=a.dependentObservable;b=a.utils.unwrapObservable(D)instanceof Array?f[k].create({data:b||c,parent:u,skip:B}):f[k].create({data:b||c,parent:u});a.dependentObservable=e;a.computed=a.dependentObservable;return b},J=function(){return f[k]&&f[k].update instanceof Function},O=function(b,d){var e={data:d||c,parent:u,target:a.utils.unwrapObservable(b)};a.isWriteableObservable(b)&&(e.observable=b);return f[k].update(e)};if(x=t.get(c))return x;k=k||"";if(w){var w=[],N=!1,T=function(a){return a};
f[k]&&f[k].key&&(T=f[k].key,N=!0);a.isObservable(b)||(b=a.observableArray([]),b.mappedRemove=function(a){var c="function"==typeof a?a:function(b){return b===T(a)};return b.remove(function(a){return c(T(a))})},b.mappedRemoveAll=function(c){var d=n(c,T);return b.remove(function(b){return-1!=a.utils.arrayIndexOf(d,T(b))})},b.mappedDestroy=function(a){var c="function"==typeof a?a:function(b){return b===T(a)};return b.destroy(function(a){return c(T(a))})},b.mappedDestroyAll=function(c){var d=n(c,T);return b.destroy(function(b){return-1!=
a.utils.arrayIndexOf(d,T(b))})},b.mappedIndexOf=function(c){var d=n(b(),T);c=T(c);return a.utils.arrayIndexOf(d,c)},b.mappedGet=function(a){return b()[b.mappedIndexOf(a)]},b.mappedCreate=function(c){if(-1!==b.mappedIndexOf(c))throw Error("There already is an object with the key that you specified.");var d=E()?F(c):c;J()&&(c=O(d,c),a.isWriteableObservable(d)?d(c):d=c);b.push(d);return d});x=n(a.utils.unwrapObservable(b),T).sort();z=n(c,T);N&&z.sort();N=a.utils.compareArrays(x,z);x={};var M,Z=a.utils.unwrapObservable(c),
S={},ba=!0,z=0;for(M=Z.length;z<M;z++){var aa=T(Z[z]);if(void 0===aa||aa instanceof Object){ba=!1;break}S[aa]=Z[z]}var Z=[],X=0,z=0;for(M=N.length;z<M;z++){var aa=N[z],V,Y=l+"["+z+"]";switch(aa.status){case "added":var ca=ba?S[aa.value]:m(a.utils.unwrapObservable(c),aa.value,T);V=g(void 0,ca,f,k,b,Y,D);E()||(V=a.utils.unwrapObservable(V));Y=h(a.utils.unwrapObservable(c),ca,x);V===B?X++:Z[Y-X]=V;x[Y]=!0;break;case "retained":ca=ba?S[aa.value]:m(a.utils.unwrapObservable(c),aa.value,T);V=m(b,aa.value,
T);g(V,ca,f,k,b,Y,D);Y=h(a.utils.unwrapObservable(c),ca,x);Z[Y]=V;x[Y]=!0;break;case "deleted":V=m(b,aa.value,T)}w.push({event:aa.status,item:V})}b(Z);f[k]&&f[k].arrayChanged&&a.utils.arrayForEach(w,function(a){f[k].arrayChanged(a.event,a.item)})}else if(q(c)){b=a.utils.unwrapObservable(b);if(!b){if(E())return N=F(),J()&&(N=O(N)),N;if(J())return O(N);b={}}J()&&(b=O(b));t.save(c,b);if(J())return b;p(c,function(d){var e=l.length?l+"."+d:d;if(-1==a.utils.arrayIndexOf(f.ignore,e))if(-1!=a.utils.arrayIndexOf(f.copy,
e))b[d]=c[d];else if("object"!=typeof c[d]&&"array"!=typeof c[d]&&0<f.observe.length&&-1==a.utils.arrayIndexOf(f.observe,e))b[d]=c[d],f.copiedProperties[e]=!0;else{var h=t.get(c[d]),k=g(b[d],c[d],f,d,b,e,b),h=h||k;if(0<f.observe.length&&-1==a.utils.arrayIndexOf(f.observe,e))b[d]=h(),f.copiedProperties[e]=!0;else{if(a.isWriteableObservable(b[d])){if(h=a.utils.unwrapObservable(h),b[d]()!==h)b[d](h)}else h=void 0===b[d]?h:a.utils.unwrapObservable(h),b[d]=h;f.mappedProperties[e]=!0}}})}else switch(e.getType(c)){case "function":J()?
a.isWriteableObservable(c)?(c(O(c)),b=c):b=O(c):b=c;break;default:if(a.isWriteableObservable(b))return V=J()?O(b):a.utils.unwrapObservable(c),b(V),V;E()||J();b=E()?F():a.observable(a.utils.unwrapObservable(c));J()&&b(O(b))}return b}function h(a,b,c){for(var d=0,e=a.length;d<e;d++)if(!0!==c[d]&&a[d]===b)return d;return null}function b(b,c){var d;c&&(d=c(b));"undefined"===e.getType(d)&&(d=b);return a.utils.unwrapObservable(d)}function m(c,d,e){c=a.utils.unwrapObservable(c);for(var g=0,h=c.length;g<
h;g++){var f=c[g];if(b(f,e)===d)return f}throw Error("When calling ko.update*, the key '"+d+"' was not found!");}function n(c,d){return a.utils.arrayMap(a.utils.unwrapObservable(c),function(a){return d?b(a,d):a})}function p(a,b){if("array"===e.getType(a))for(var c=0;c<a.length;c++)b(c);else for(c in a)b(c)}function q(a){var b=e.getType(a);return("object"===b||"array"===b)&&null!==a}function u(){var b=[],c=[];this.save=function(d,e){var g=a.utils.arrayIndexOf(b,d);0<=g?c[g]=e:(b.push(d),c.push(e))};
this.get=function(d){d=a.utils.arrayIndexOf(b,d);return 0<=d?c[d]:void 0}}function x(){var a={},b=function(b){var c;try{c=b}catch(d){c="$$$"}b=a[c];void 0===b&&(b=new u,a[c]=b);return b};this.save=function(a,c){b(a).save(a,c)};this.get=function(a){return b(a).get(a)}}var v="__ko_mapping__",r=a.dependentObservable,w=0,y,t,D=["create","update","key","arrayChanged"],B={},E={include:["_destroy"],ignore:[],copy:[],observe:[]},z=E;e.isMapped=function(b){return(b=a.utils.unwrapObservable(b))&&b[v]};e.fromJS=
function(a){if(0==arguments.length)throw Error("When calling ko.fromJS, pass the object you want to convert.");try{w++||(y=[],t=new x);var b,e;2==arguments.length&&(arguments[1][v]?e=arguments[1]:b=arguments[1]);3==arguments.length&&(b=arguments[1],e=arguments[2]);e&&(b=d(b,e[v]));b=c(b);var h=g(e,a,b);e&&(h=e);if(!--w)for(;y.length;){var f=y.pop();f&&(f(),f.__DO.throttleEvaluation=f.throttleEvaluation)}h[v]=d(h[v],b);return h}catch(k){throw w=0,k;}};e.fromJSON=function(b){var c=a.utils.parseJson(b);
arguments[0]=c;return e.fromJS.apply(this,arguments)};e.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!");};e.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!");};e.toJS=function(b,d){z||e.resetDefaultOptions();if(0==arguments.length)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");
if("array"!==e.getType(z.ignore))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if("array"!==e.getType(z.include))throw Error("ko.mapping.defaultOptions().include should be an array.");if("array"!==e.getType(z.copy))throw Error("ko.mapping.defaultOptions().copy should be an array.");d=c(d,b[v]);return e.visitModel(b,function(b){return a.utils.unwrapObservable(b)},d)};e.toJSON=function(b,c){var d=e.toJS(b,c);return a.utils.stringifyJson(d)};e.defaultOptions=function(){if(0<arguments.length)z=
arguments[0];else return z};e.resetDefaultOptions=function(){z={include:E.include.slice(0),ignore:E.ignore.slice(0),copy:E.copy.slice(0)}};e.getType=function(a){if(a&&"object"===typeof a){if(a.constructor===Date)return"date";if(a.constructor===Array)return"array"}return typeof a};e.visitModel=function(b,d,g){g=g||{};g.visitedObjects=g.visitedObjects||new x;var h,f=a.utils.unwrapObservable(b);if(q(f))g=c(g,f[v]),d(b,g.parentName),h="array"===e.getType(f)?[]:{};else return d(b,g.parentName);g.visitedObjects.save(b,
h);var k=g.parentName;p(f,function(b){if(!g.ignore||-1==a.utils.arrayIndexOf(g.ignore,b)){var c=f[b],t=g,m=k||"";"array"===e.getType(f)?k&&(m+="["+b+"]"):(k&&(m+="."),m+=b);t.parentName=m;if(-1!==a.utils.arrayIndexOf(g.copy,b)||-1!==a.utils.arrayIndexOf(g.include,b)||!f[v]||!f[v].mappedProperties||f[v].mappedProperties[b]||!f[v].copiedProperties||f[v].copiedProperties[b]||"array"===e.getType(f))switch(e.getType(a.utils.unwrapObservable(c))){case "object":case "array":case "undefined":t=g.visitedObjects.get(c);
h[b]="undefined"!==e.getType(t)?t:e.visitModel(c,d,g);break;default:h[b]=d(c,g.parentName)}}});return h}});
(function(a,e,f,d,c,k,g,h,b){function m(a){return a&&typeof a===e&&!(typeof a.length===f&&!a.propertyIsEnumerable(d))}function n(a){return a&&typeof a===e&&typeof a.length===f&&!a.propertyIsEnumerable(d)}function p(a){return a&&"function"===typeof a}function q(a){return p(a)&&a.prototype&&a===a.prototype.constructor}function u(a,b,c){if(n(b))for(var d=b.length;0<=--d;)u(a,b[d],c);else{c=c||{constructor:1,$super:1,prototype:1,$superb:1};var d=q(a),e=q(b),g=a.prototype,h,f;if(m(b))for(h in b){f=h;var k=
b[h],p=a,x=d,I=g;c&&c.hasOwnProperty(f)||(p[f]=k,x&&(I[f]=k))}if(e)for(h in f=b.prototype,f){var k=h,p=f[h],x=a,I=d,R=g;c&&c.hasOwnProperty(k)||(x[k]=p,I&&(R[k]=p))}d&&e&&u(g,b.prototype,c)}}function x(a,b){b||(a=(b=a,0));var c,d,e,g,h,f,k=0,m,q={constructor:1,$singleton:1,$statics:1,prototype:1,$super:1,$superp:1,main:1,toString:0};h=x.overload;var u=x.plugins;b=("function"===typeof b?b():b)||{};c=b.hasOwnProperty("constructor")?b.constructor:0;d=b.$singleton;e=b.$statics;for(g in u)q[g]=1;c=d?{}:
c?h?h("constructor",c):c:function(){};h=d?c:c.prototype;for(f=(a=!a||n(a)?a:[a])&&a.length;k<f;){m=a[k++];for(g in m)q[g]||(h[g]=m[g],d||(c[g]=m[g]));for(g in m.prototype)q[g]||(h[g]=m.prototype[g])}for(g in b)q[g]||(h[g]=b[g]);for(g in e)c[g]=h[g]=e[g];d||(m=a&&a[0]||a,c.$super=m,c.$superp=m&&m.prototype?m.prototype:m);for(g in u)u[g](c,a,b);p(b.main)&&b.main.call(c,c);return c}x.plugins={};b={version:k,Class:x,extend:u,isMap:m,isArray:n,isFunction:p,isString:function(a){return"[object String]"===
c.apply(a)},isClass:q};"undefined"!==typeof module&&module.exports?module.exports=b:(h=a.Class,a.Class=x,a.jsface=b,b.noConflict=function(){a.Class=h})})(this,"object","number","length",Object.prototype.toString,"2.1.1");
!function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=a()}(function(){return function e(f,d,c){function k(b,h){if(!d[b]){if(!f[b]){var n="function"==typeof require&&require;if(!h&&n)return n(b,!0);if(g)return g(b,!0);n=Error("Cannot find module '"+b+"'");throw n.code="MODULE_NOT_FOUND",n;}n=d[b]={exports:{}};
f[b][0].call(n.exports,function(c){var d=f[b][1][c];return k(d?d:c)},n,n.exports,e,f,d,c)}return d[b].exports}for(var g="function"==typeof require&&require,h=0;h<c.length;h++)k(c[h]);return k}({1:[function(e,f,d){var c=e("matches-selector");f.exports=function(d,e,h){for(d=h?d:d.parentNode;d&&d!==document;){if(c(d,e))return d;d=d.parentNode}}},{"matches-selector":5}],2:[function(e,f,d){function c(c,d,b,e){return function(b){b.delegateTarget=k(b.target,d,!0);b.delegateTarget&&e.call(c,b)}}var k=e("closest");
f.exports=function(d,e,b,f,k){var p=c.apply(this,arguments);return d.addEventListener(b,p,k),{destroy:function(){d.removeEventListener(b,p,k)}}}},{closest:1}],3:[function(e,f,d){d.node=function(c){return void 0!==c&&c instanceof HTMLElement&&1===c.nodeType};d.nodeList=function(c){var e=Object.prototype.toString.call(c);return void 0!==c&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in c&&(0===c.length||d.node(c[0]))};d.string=function(c){return"string"==typeof c||c instanceof
String};d.fn=function(c){return"[object Function]"===Object.prototype.toString.call(c)}},{}],4:[function(e,f,d){function c(b,c,d){return b.addEventListener(c,d),{destroy:function(){b.removeEventListener(c,d)}}}function k(b,c,d){return Array.prototype.forEach.call(b,function(b){b.addEventListener(c,d)}),{destroy:function(){Array.prototype.forEach.call(b,function(b){b.removeEventListener(c,d)})}}}var g=e("./is"),h=e("delegate");f.exports=function(b,d,e){if(!b&&!d&&!e)throw Error("Missing required arguments");
if(!g.string(d))throw new TypeError("Second argument must be a String");if(!g.fn(e))throw new TypeError("Third argument must be a Function");if(g.node(b))return c(b,d,e);if(g.nodeList(b))return k(b,d,e);if(g.string(b))return h(document.body,b,d,e);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");}},{"./is":3,delegate:2}],5:[function(e,f,d){e=Element.prototype;var c=e.matchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||
e.oMatchesSelector;f.exports=function(d,e){if(c)return c.call(d,e);for(var h=d.parentNode.querySelectorAll(e),b=0;b<h.length;++b)if(h[b]==d)return!0;return!1}},{}],6:[function(e,f,d){f.exports=function(c){if("INPUT"===c.nodeName||"TEXTAREA"===c.nodeName)c.focus(),c.setSelectionRange(0,c.value.length),c=c.value;else{c.hasAttribute("contenteditable")&&c.focus();var d=window.getSelection(),e=document.createRange();e.selectNodeContents(c);d.removeAllRanges();d.addRange(e);c=d.toString()}return c}},{}],
7:[function(e,f,d){function c(){}c.prototype={on:function(c,d,e){var b=this.e||(this.e={});return(b[c]||(b[c]=[])).push({fn:d,ctx:e}),this},once:function(c,d,e){function b(){f.off(c,b);d.apply(e,arguments)}var f=this;return b._=d,this.on(c,b,e)},emit:function(c){var d=[].slice.call(arguments,1),e=((this.e||(this.e={}))[c]||[]).slice(),b=0,f=e.length;for(b;f>b;b++)e[b].fn.apply(e[b].ctx,d);return this},off:function(c,d){var e=this.e||(this.e={}),b=e[c],f=[];if(b&&d)for(var n=0,p=b.length;p>n;n++)b[n].fn!==
d&&b[n].fn._!==d&&f.push(b[n]);return f.length?e[c]=f:delete e[c],this}};f.exports=c},{}],8:[function(e,f,d){!function(c,k){if("undefined"!=typeof d)k(f,e("select"));else{var g={exports:{}};k(g,c.select);c.clipboardAction=g.exports}}(this,function(c,d){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=d&&d.__esModule?d:{"default":d},h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){$jscomp.initSymbol();$jscomp.initSymbol();
return b&&"function"==typeof Symbol&&b.constructor===Symbol?"symbol":typeof b},b=function(){function b(c,d){for(var e=0;e<d.length;e++){var g=d[e];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(c,g.key,g)}}return function(c,d,e){return d&&b(c.prototype,d),e&&b(c,e),c}}(),f=function(){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.resolveOptions(b);this.initSelection()}return c.prototype.resolveOptions=
function(){var b=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];this.action=b.action;this.emitter=b.emitter;this.target=b.target;this.text=b.text;this.trigger=b.trigger;this.selectedText=""},c.prototype.initSelection=function(){this.text?this.selectFake():this.target&&this.selectTarget()},c.prototype.selectFake=function(){var b=this,c="rtl"==document.documentElement.getAttribute("dir");this.removeFake();this.fakeHandlerCallback=function(){return b.removeFake()};this.fakeHandler=document.body.addEventListener("click",
this.fakeHandlerCallback)||!0;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[c?"right":"left"]="-9999px";this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;document.body.appendChild(this.fakeElem);this.selectedText=
(0,e["default"])(this.fakeElem);this.copyText()},c.prototype.removeFake=function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null);this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)},c.prototype.selectTarget=function(){this.selectedText=(0,e["default"])(this.target);this.copyText()},c.prototype.copyText=function(){var b=void 0;try{b=document.execCommand(this.action)}catch(c){b=!1}this.handleResult(b)},
c.prototype.handleResult=function(b){b?this.emitter.emit("success",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)}):this.emitter.emit("error",{action:this.action,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})},c.prototype.clearSelection=function(){this.target&&this.target.blur();window.getSelection().removeAllRanges()},c.prototype.destroy=function(){this.removeFake()},b(c,[{key:"action",set:function(){if(this._action=
0>=arguments.length||void 0===arguments[0]?"copy":arguments[0],"copy"!==this._action&&"cut"!==this._action)throw Error('Invalid "action" value, use either "copy" or "cut"');},get:function(){return this._action}},{key:"target",set:function(b){if(void 0!==b){if(!b||"object"!==("undefined"==typeof b?"undefined":h(b))||1!==b.nodeType)throw Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&b.hasAttribute("disabled"))throw Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');
if("cut"===this.action&&(b.hasAttribute("readonly")||b.hasAttribute("disabled")))throw Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=b}},get:function(){return this._target}}]),c}();c.exports=f})},{select:6}],9:[function(e,f,d){!function(c,k){if("undefined"!=typeof d)k(f,e("./clipboard-action"),e("tiny-emitter"),e("good-listener"));else{var g={exports:{}};k(g,c.clipboardAction,c.tinyEmitter,c.goodListener);c.clipboard=g.exports}}(this,
function(c,d,e,h){function b(b){return b&&b.__esModule?b:{"default":b}}function f(b,c){if("function"!=typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}function n(b,c){var d="data-clipboard-"+b;if(c.hasAttribute(d))return c.getAttribute(d)}var p=b(d);d=b(e);var q=b(h);
h=function(b){function c(d,e){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var g;g=b.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");g=!g||"object"!=typeof g&&"function"!=typeof g?this:g;return g.resolveOptions(e),g.listenClick(d),g}return f(c,b),c.prototype.resolveOptions=function(){var b=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];this.action="function"==typeof b.action?b.action:this.defaultAction;
this.target="function"==typeof b.target?b.target:this.defaultTarget;this.text="function"==typeof b.text?b.text:this.defaultText},c.prototype.listenClick=function(b){var c=this;this.listener=(0,q["default"])(b,"click",function(b){return c.onClick(b)})},c.prototype.onClick=function(b){b=b.delegateTarget||b.currentTarget;this.clipboardAction&&(this.clipboardAction=null);this.clipboardAction=new p["default"]({action:this.action(b),target:this.target(b),text:this.text(b),trigger:b,emitter:this})},c.prototype.defaultAction=
function(b){return n("action",b)},c.prototype.defaultTarget=function(b){return(b=n("target",b))?document.querySelector(b):void 0},c.prototype.defaultText=function(b){return n("text",b)},c.prototype.destroy=function(){this.listener.destroy();this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)},c}(d["default"]);c.exports=h})},{"./clipboard-action":8,"good-listener":4,"tiny-emitter":7}]},{},[9])(9)});
(function(){function a(){}function e(a,c){for(var b=a.length;b--;)if(a[b].listener===c)return b;return-1}function f(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,c=this,k=c.EventEmitter;d.getListeners=function(a){var c=this._getEvents(),b,d;if("object"===typeof a)for(d in b={},c)c.hasOwnProperty(d)&&a.test(d)&&(b[d]=c[d]);else b=c[a]||(c[a]=[]);return b};d.flattenListeners=function(a){var c=[],b;for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c};d.getListenersAsObject=
function(a){var c=this.getListeners(a),b;c instanceof Array&&(b={},b[a]=c);return b||c};d.addListener=function(a,c){var b=this.getListenersAsObject(a),d="object"===typeof c,f;for(f in b)b.hasOwnProperty(f)&&-1===e(b[f],c)&&b[f].push(d?c:{listener:c,once:!1});return this};d.on=f("addListener");d.addOnceListener=function(a,c){return this.addListener(a,{listener:c,once:!0})};d.once=f("addOnceListener");d.defineEvent=function(a){this.getListeners(a);return this};d.defineEvents=function(a){for(var c=0;c<
a.length;c+=1)this.defineEvent(a[c]);return this};d.removeListener=function(a,c){var b=this.getListenersAsObject(a),d,f;for(f in b)b.hasOwnProperty(f)&&(d=e(b[f],c),-1!==d&&b[f].splice(d,1));return this};d.off=f("removeListener");d.addListeners=function(a,c){return this.manipulateListeners(!1,a,c)};d.removeListeners=function(a,c){return this.manipulateListeners(!0,a,c)};d.manipulateListeners=function(a,c,b){var d,e,f=a?this.removeListener:this.addListener;a=a?this.removeListeners:this.addListeners;
if("object"!==typeof c||c instanceof RegExp)for(d=b.length;d--;)f.call(this,c,b[d]);else for(d in c)c.hasOwnProperty(d)&&(e=c[d])&&("function"===typeof e?f.call(this,d,e):a.call(this,d,e));return this};d.removeEvent=function(a){var c=typeof a,b=this._getEvents(),d;if("string"===c)delete b[a];else if("object"===c)for(d in b)b.hasOwnProperty(d)&&a.test(d)&&delete b[d];else delete this._events;return this};d.removeAllListeners=f("removeEvent");d.emitEvent=function(a,c){var b=this.getListenersAsObject(a),
d,e,f,k;for(f in b)if(b.hasOwnProperty(f))for(e=b[f].length;e--;)d=b[f][e],!0===d.once&&this.removeListener(a,d.listener),k=d.listener.apply(this,c||[]),k===this._getOnceReturnValue()&&this.removeListener(a,d.listener);return this};d.trigger=f("emitEvent");d.emit=function(a){var c=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,c)};d.setOnceReturnValue=function(a){this._onceReturnValue=a;return this};d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:
!0};d._getEvents=function(){return this._events||(this._events={})};a.noConflict=function(){c.EventEmitter=k;return a};"function"===typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"===typeof module&&module.exports?module.exports=a:this.EventEmitter=a}).call(this);
(function(a){function e(c){var d=a.event;d.target=d.target||d.srcElement||c;return d}var f=document.documentElement,d=function(){};f.addEventListener?d=function(a,c,d){a.addEventListener(c,d,!1)}:f.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var b=e(a);d.handleEvent.call(d,b)}:function(){var b=e(a);d.call(a,b)};a.attachEvent("on"+c,a[c+d])});var c=function(){};f.removeEventListener?c=function(a,c,d){a.removeEventListener(c,d,!1)}:f.detachEvent&&(c=function(a,c,d){a.detachEvent("on"+
c,a[c+d]);try{delete a[c+d]}catch(b){a[c+d]=void 0}});f={bind:d,unbind:c};"function"===typeof define&&define.amd?define("eventie/eventie",f):a.eventie=f})(this);
(function(a){function e(a,c){for(var d in c)a[d]=c[d];return a}function f(a){var c=[];if("[object Array]"===h.call(a))c=a;else if("number"===typeof a.length)for(var d=0,e=a.length;d<e;d++)c.push(a[d]);else c.push(a);return c}function d(a,d){function h(a,b,d){if(!(this instanceof h))return new h(a,b);"string"===typeof a&&(a=document.querySelectorAll(a));this.elements=f(a);this.options=e({},this.options);"function"===typeof b?d=b:e(this.options,b);if(d)this.on("always",d);this.getImages();c&&(this.jqDeferred=
new c.Deferred);var g=this;setTimeout(function(){g.check()})}function p(a){this.img=a}function q(a){this.src=a;u[a]=this}h.prototype=new a;h.prototype.options={};h.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);for(var c=c.querySelectorAll("img"),d=0,e=c.length;d<e;d++)this.addImage(c[d])}};h.prototype.addImage=function(a){a=new p(a);this.images.push(a)};h.prototype.check=function(){function a(e,
h){b.options.debug&&g&&k.log("confirm",e,h);b.progress(e);c++;c===d&&b.complete();return!0}var b=this,c=0,d=this.images.length;this.hasAnyBroken=!1;if(d)for(var e=0;e<d;e++){var h=this.images[e];h.on("confirm",a);h.check()}else this.complete()};h.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a);b.jqDeferred&&b.jqDeferred.notify(b,a)})};h.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=
!0;var b=this;setTimeout(function(){b.emit(a,b);b.emit("always",b);if(b.jqDeferred)b.jqDeferred[b.hasAnyBroken?"reject":"resolve"](b)})};c&&(c.fn.imagesLoaded=function(a,b){return(new h(this,a,b)).jqDeferred.promise(c(this))});p.prototype=new a;p.prototype.check=function(){var a=u[this.img.src]||new q(this.img.src);if(a.isConfirmed)this.confirm(a.isLoaded,"cached was confirmed");else if(this.img.complete&&void 0!==this.img.naturalWidth)this.confirm(0!==this.img.naturalWidth,"naturalWidth");else{var b=
this;a.on("confirm",function(a,c){b.confirm(a.isLoaded,c);return!0});a.check()}};p.prototype.confirm=function(a,b){this.isLoaded=a;this.emit("confirm",this,b)};var u={};q.prototype=new a;q.prototype.check=function(){if(!this.isChecked){var a=new Image;d.bind(a,"load",this);d.bind(a,"error",this);a.src=this.src;this.isChecked=!0}};q.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};q.prototype.onload=function(a){this.confirm(!0,"onload");this.unbindProxyEvents(a)};q.prototype.onerror=
function(a){this.confirm(!1,"onerror");this.unbindProxyEvents(a)};q.prototype.confirm=function(a,b){this.isConfirmed=!0;this.isLoaded=a;this.emit("confirm",this,b)};q.prototype.unbindProxyEvents=function(a){d.unbind(a.target,"load",this);d.unbind(a.target,"error",this)};return h}var c=a.jQuery,k=a.console,g="undefined"!==typeof k,h=Object.prototype.toString;"function"===typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],d):a.imagesLoaded=d(a.EventEmitter,a.eventie)})(window);
var Handlebars=function(){var a=function(){function a(c){this.string=c}a.prototype.toString=function(){return""+this.string};return a}(),e=function(a){function c(a){return b[a]||"&amp;"}var d={},b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},e=/[&<>"'`]/g,f=/[&<>"'`]/;d.extend=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};var p=Object.prototype.toString;d.toString=p;var q=function(a){return"function"===typeof a};q(/x/)&&(q=function(a){return"function"===
typeof a&&"[object Function]"===p.call(a)});d.isFunction=q;var u=Array.isArray||function(a){return a&&"object"===typeof a?"[object Array]"===p.call(a):!1};d.isArray=u;d.escapeExpression=function(b){if(b instanceof a)return b.toString();if(!b&&0!==b)return"";b=""+b;return f.test(b)?b.replace(e,c):b};d.isEmpty=function(a){return a||0===a?u(a)&&0===a.length?!0:!1:!0};return d}(a),f=function(){function a(d,b){var e;b&&b.firstLine&&(e=b.firstLine,d+=" - "+e+":"+b.firstColumn);for(var f=Error.prototype.constructor.call(this,
d),k=0;k<c.length;k++)this[c[k]]=f[c[k]];e&&(this.lineNumber=e,this.column=b.firstColumn)}var c="description fileName lineNumber message name number stack".split(" ");a.prototype=Error();return a}(),d=function(a,c){function d(a,c){this.helpers=a||{};this.partials=c||{};b(this)}function b(a){a.registerHelper("helperMissing",function(a){if(2!==arguments.length)throw new q("Missing helper: '"+a+"'");});a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse||function(){},e=c.fn;x(b)&&(b=
b.call(this));return!0===b?e(this):!1===b||null==b?d(this):u(b)?0<b.length?a.helpers.each(b,c):d(this):e(b)});a.registerHelper("each",function(a,b){var c=b.fn,d=b.inverse,e=0,g="",h;x(a)&&(a=a.call(this));b.data&&(h=w(b.data));if(a&&"object"===typeof a)if(u(a))for(var f=a.length;e<f;e++)h&&(h.index=e,h.first=0===e,h.last=e===a.length-1),g+=c(a[e],{data:h});else for(f in a)a.hasOwnProperty(f)&&(h&&(h.key=f,h.index=e,h.first=0===e),g+=c(a[f],{data:h}),e++);0===e&&(g=d(this));return g});a.registerHelper("if",
function(a,b){x(a)&&(a=a.call(this));return!b.hash.includeZero&&!a||p.isEmpty(a)?b.inverse(this):b.fn(this)});a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})});a.registerHelper("with",function(a,b){x(a)&&(a=a.call(this));if(!p.isEmpty(a))return b.fn(a)});a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){r.log(a,b)}var f={},p=a,q=c;f.VERSION="1.3.0";f.COMPILER_REVISION=
4;f.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};var u=p.isArray,x=p.isFunction,v=p.toString;f.HandlebarsEnvironment=d;d.prototype={constructor:d,logger:r,log:e,registerHelper:function(a,b,c){if("[object Object]"===v.call(a)){if(c||b)throw new q("Arg not supported with multiple helpers");p.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){"[object Object]"===v.call(a)?p.extend(this.partials,a):this.partials[a]=b}};var r=
{methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(r.level<=a){var c=r.methodMap[a];"undefined"!==typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=r;f.log=e;var w=function(a){var b={};p.extend(b,a);return b};f.createFrame=w;return f}(e,f),c=function(a,c,d){function b(a,b,c){var d=function(a,d){d=d||{};return b(a,d.data||c)};d.program=a;d.depth=0;return d}var e={},f=d.COMPILER_REVISION,p=d.REVISION_CHANGES;e.checkRevision=
function(a){var b=a&&a[0]||1;if(b!==f){if(b<f)throw new c("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+p[f]+") or downgrade your runtime to an older version ("+p[b]+").");throw new c("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").");}};e.template=function(d,e){if(!e)throw new c("No environment passed to template");
var h={escapeExpression:a.escapeExpression,invokePartial:function(a,b,d,h,f,k){var m=e.VM.invokePartial.apply(this,arguments);if(null!=m)return m;if(e.compile)return m={helpers:h,partials:f,data:k},f[b]=e.compile(a,{data:void 0!==k},e),f[b](d,m);throw new c("The partial "+b+" could not be compiled when running in runtime-only mode");},programs:[],program:function(a,c,d){var e=this.programs[a];d?e=b(a,c,d):e||(e=this.programs[a]=b(a,c));return e},merge:function(b,c){var d=b||c;b&&c&&b!==c&&(d={},a.extend(d,
c),a.extend(d,b));return d},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(a,b){b=b||{};var c=b.partial?b:e,g,f;b.partial||(g=b.helpers,f=b.partials);c=d.call(h,c,a,g,f,b.data);b.partial||e.VM.checkRevision(h.compilerInfo);return c}};e.programWithDepth=function(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){e=e||{};return b.apply(this,[a,e.data||c].concat(d))};e.program=a;e.depth=d.length;return e};e.program=b;e.invokePartial=function(a,
b,d,e,h,f){e={partial:!0,helpers:e,partials:h,data:f};if(void 0===a)throw new c("The partial "+b+" could not be found");if(a instanceof Function)return a(d,e)};e.noop=function(){return""};return e}(e,f,d);return function(a,c,d,b,e){var f=function(){var f=new a.HandlebarsEnvironment;b.extend(f,a);f.SafeString=c;f.Exception=d;f.Utils=b;f.VM=e;f.template=function(a){return e.template(a,f)};return f},p=f();p.create=f;return p}(d,a,f,e,c)}();
(function(a){var e=a.document;if(!location.hash&&a.addEventListener){window.scrollTo(0,1);var f=1,d=function(){return a.pageYOffset||"CSS1Compat"===e.compatMode&&e.documentElement.scrollTop||e.body.scrollTop||0},c=setInterval(function(){e.body&&(clearInterval(c),f=d(),a.scrollTo(0,1===f?0:1))},15);a.addEventListener("load",function(){setTimeout(function(){20>d()&&a.scrollTo(0,1===f?0:1)},0)})}})(this);
(function(a,e){function f(a){return"string"===typeof a}function d(a){var c=b.call(arguments,1);return function(){return a.apply(this,c.concat(b.call(arguments)))}}function c(b,c,d,g,k){var p;g!==h?(c=d.match(b?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),d=c[3]||"",2===k&&f(g)?g=g.replace(b?D:t,""):(p=q(c[2]),g=f(g)?q[b?"fragment":"querystring"](g):g,g=2===k?g:1===k?a.extend({},g,p):a.extend({},p,g),g=n(g),b&&(g=g.replace(B,m))),b=c[1]+(b?"#":g||!c[1]?"?":"")+g+d):b=c(d!==h?d:e.location.href);
return b}function k(a,b,c){b===h||"boolean"===typeof b?(c=b,b=n[a?"fragment":"querystring"]()):b=f(b)?b.replace(a?D:t,""):b;return q(b,c)}function g(b,c,d,e){f(d)||"object"===typeof d||(e=d,d=c,c=h);return this.each(function(){var g=a(this),h=c||w()[(this.nodeName||"").toLowerCase()]||"",f=h&&g.attr(h)||"";g.attr(h,n[b](f,d,e))})}var h,b=Array.prototype.slice,m=decodeURIComponent,n=a.param,p,q,u,x=a.bbq=a.bbq||{},v,r,w,y=a.event.special,t=/^.*\?|#.*$/g,D=/^.*\#/,B,E={};n.querystring=d(c,0,function(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,
"$1")});n.fragment=p=d(c,1,function(a){return a.replace(/^[^#]*#?(.*)$/,"$1")});p.noEscape=function(b){b=a.map((b||"").split(""),encodeURIComponent);B=new RegExp(b.join("|"),"g")};p.noEscape(",/");a.deparam=q=function(b,c){var d={},e={"true":!0,"false":!1,"null":null};a.each(b.replace(/\+/g," ").split("&"),function(b,g){var f=g.split("="),k=m(f[0]),t=d,n=0,q=k.split("]["),p=q.length-1;/\[/.test(q[0])&&/\]$/.test(q[p])?(q[p]=q[p].replace(/\]$/,""),q=q.shift().split("[").concat(q),p=q.length-1):p=0;
if(2===f.length)if(f=m(f[1]),c&&(f=f&&!isNaN(f)?+f:"undefined"===f?h:e[f]!==h?e[f]:f),p)for(;n<=p;n++)k=""===q[n]?t.length:q[n],t=t[k]=n<p?t[k]||(q[n+1]&&isNaN(q[n+1])?{}:[]):f;else a.isArray(d[k])?d[k].push(f):d[k]=d[k]!==h?[d[k],f]:f;else k&&(d[k]=c?h:"")});return d};q.querystring=d(k,0);q.fragment=u=d(k,1);a.elemUrlAttr||(a.elemUrlAttr=function(b){return a.extend(E,b)})({a:"href",base:"href",iframe:"src",img:"src",input:"src",form:"action",link:"href",script:"src"});w=a.elemUrlAttr;a.fn.querystring=
d(g,"querystring");a.fn.fragment=d(g,"fragment");x.pushState=v=function(a,b){f(a)&&/^#/.test(a)&&b===h&&(b=2);var c=a!==h,c=p(e.location.href,c?a:{},c?b:2);e.location.href=c+(/#/.test(c)?"":"#")};x.getState=r=function(a,b){return a===h||"boolean"===typeof a?u(a):u(b)[a]};x.removeState=function(b){var c={};b!==h&&(c=r(),a.each(a.isArray(b)?b:arguments,function(a,b){delete c[b]}));v(c,2)};y.hashchange=a.extend(y.hashchange,{add:function(b){function c(a){var b=a.fragment=p();a.getState=function(a,c){return a===
h||"boolean"===typeof a?q(b,a):q(b,c)[a]};d.apply(this,arguments)}var d;if(a.isFunction(b))return d=b,c;d=b.handler;b.handler=c}})})(jQuery,this);
(function(a,e,f){function d(a){a=a||e.location.href;return a.replace(/^[^#]*#?(.*)$/,"$1")}var c,k=a.event.special,g=document.documentMode,h=a.browser.msie&&(g===f||8>g),b="onhashchange"in e&&!h;a.hashchangeDelay=100;k.hashchange=a.extend(k.hashchange,{setup:function(){if(b)return!1;a(c.start)},teardown:function(){if(b)return!1;a(c.stop)}});c=function(){function b(){k=x=function(a){return a};h&&(f=a('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,x=function(){return d(f.document.location.href)},
k=function(a,b){if(a!==b){var c=f.document;c.open().close();c.location.hash="#"+a}},k(d()))}var c={},g,f,k,x;c.start=function(){if(!g){var c=d();k||b();(function w(){var b=d(),h=x(c);b!==c?(k(c=b,h),a(e).trigger("hashchange")):h!==c&&(e.location.href=e.location.href.replace(/#.*/,"")+"#"+h);g=setTimeout(w,a.hashchangeDelay)})()}};c.stop=function(){f||(g&&clearTimeout(g),g=0)};return c}()})(jQuery,this);
(function(a){a.fn.replaceText=function(e,f,d){return this.each(function(){var c=this.firstChild,k,g,h=[];if(c){do 3===c.nodeType&&(k=c.nodeValue,g=k.replace(e,f),g!==k&&(!d&&/</.test(g)?(a(c).before(g),h.push(c)):c.nodeValue=g));while(c=c.nextSibling)}h.length&&a(h).remove()})}})(jQuery);
(function(){var a;a=function(){function a(){this.options_index=0;this.parsed=[]}a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName?this.add_group(a):this.add_option(a)};a.prototype.add_group=function(a){var d,c,e,g,h,b;d=this.parsed.length;this.parsed.push({array_index:d,group:!0,label:a.label,children:0,disabled:a.disabled});h=a.childNodes;b=[];e=0;for(g=h.length;e<g;e++)c=h[e],b.push(this.add_option(c,d,a.disabled));return b};a.prototype.add_option=function(a,d,c){if("OPTION"===a.nodeName)return""!==
a.text?(null!=d&&(this.parsed[d].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:!0===c?c:a.disabled,group_array_index:d,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1};return a}();a.select_to_array=function(e){var f,d,c,k;f=new a;k=e.childNodes;d=0;for(c=k.length;d<c;d++)e=
k[d],f.add_node(e);return f.parsed};this.SelectParser=a}).call(this);
(function(){this.AbstractChosen=function(){function a(a,f){this.form_field=a;this.options=null!=f?f:{};this.set_default_values();this.is_multiple=this.form_field.multiple;this.set_default_text();this.setup();this.set_up_html();this.register_observers();this.finish_setup()}a.prototype.set_default_values=function(){var a=this;this.click_test_action=function(f){return a.test_active_click(f)};this.activate_action=function(f){return a.activate_field(f)};this.results_showing=this.mouse_on_container=this.active_field=
!1;this.result_single_selected=this.result_highlighted=null;this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1;this.disable_search_threshold=this.options.disable_search_threshold||0;this.search_contains=this.options.search_contains||!1;this.choices=0;this.single_backstroke_delete=this.options.single_backstroke_delete||!1;return this.max_selected_options=this.options.max_selected_options||
Infinity};a.prototype.set_default_text=function(){this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.default_text=this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option";return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"};
a.prototype.mouse_enter=function(){return this.mouse_on_container=!0};a.prototype.mouse_leave=function(){return this.mouse_on_container=!1};a.prototype.input_focus=function(a){var f=this;if(!this.active_field)return setTimeout(function(){return f.container_mousedown()},50)};a.prototype.input_blur=function(a){var f=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return f.blur_test()},100)};a.prototype.result_add_option=function(a){var f,d;if(a.disabled)return"";a.dom_id=
this.container_id+"_o_"+a.array_index;f=a.selected&&this.is_multiple?[]:["active-result"];a.selected&&f.push("result-selected");null!=a.group_array_index&&f.push("group-option");""!==a.classes&&f.push(a.classes);d=""!==a.style.cssText?' style="'+a.style+'"':"";return'<li id="'+a.dom_id+'" class="'+f.join(" ")+'"'+d+">"+a.html+"</li>"};a.prototype.results_update_field=function(){this.is_multiple||this.results_reset_cleanup();this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};
a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()};a.prototype.results_search=function(a){return this.results_showing?this.winnow_results():this.results_show()};a.prototype.keyup_checker=function(a){var f,d;f=null!=(d=a.which)?d:a.keyCode;this.search_field_scale();switch(f){case 8:if(this.is_multiple&&1>this.backstroke_length&&0<this.choices)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();
break;case 13:a.preventDefault();if(this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};a.prototype.generate_field_id=function(){var a;a=this.generate_random_id();return this.form_field.id=a};a.prototype.generate_random_char=function(){var a;a=Math.floor(36*Math.random());return"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(a,a+1)};a.prototype.fixup_width=
function(a){return/(px|em|ex|%|in|cm|mm|pt|pc)$/i.test(a)?a:""+a+"px"};return a}()}).call(this);
(function(){var a,e,f,d=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var b in c)d.call(c,b)&&(a[b]=c[b]);e.prototype=c.prototype;a.prototype=new e;a.__super__=c.prototype;return a};f=this;a=jQuery;a.fn.extend({chosen:function(c){return!a.browser.msie||"6.0"!==a.browser.version&&"7.0"!==a.browser.version?this.each(function(d){d=a(this);if(!d.hasClass("chzn-done"))return d.data("chosen",new e(this,c))}):this}});e=function(d){function e(){e.__super__.constructor.apply(this,
arguments)}c(e,d);e.prototype.setup=function(){this.form_field_jq=a(this.form_field);this.current_value=this.form_field_jq.val();return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};e.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")};e.prototype.set_up_html=function(){var c,b;this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id();this.container_id+="_chzn";this.f_width=this.form_field_jq.outerWidth();b=
this.fixup_width(this.options.width?this.options.width:this.f_width);c=a("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+b+";"});this.is_multiple?c.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):c.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+
this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>');this.form_field_jq.hide().after(c);this.container=a("#"+this.container_id);this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single"));this.dropdown=this.container.find("div.chzn-drop").first();this.dropdown.css({width:b,top:""+this.container.height()+"px"});this.search_field=this.container.find("input").first();
this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first());this.results_build();this.set_tab_index();return this.form_field_jq.trigger("liszt:ready",
{chosen:this})};e.prototype.register_observers=function(){var a=this;this.container.mousedown(function(b){return a.container_mousedown(b)});this.container.mouseup(function(b){return a.container_mouseup(b)});this.container.mouseenter(function(b){return a.mouse_enter(b)});this.container.mouseleave(function(b){return a.mouse_leave(b)});this.search_results.mouseup(function(b){return a.search_results_mouseup(b)});this.search_results.mouseover(function(b){return a.search_results_mouseover(b)});this.search_results.mouseout(function(b){return a.search_results_mouseout(b)});
this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)});this.search_field.blur(function(b){return a.input_blur(b)});this.search_field.keyup(function(b){return a.keyup_checker(b)});this.search_field.keydown(function(b){return a.keydown_checker(b)});return this.is_multiple?(this.search_choices.click(function(b){return a.choices_click(b)}),this.search_field.focus(function(b){return a.input_focus(b)})):this.container.click(function(a){return a.preventDefault()})};e.prototype.search_field_disabled=
function(){if(this.is_disabled=this.form_field_jq[0].disabled)return this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field();this.container.removeClass("chzn-disabled");this.search_field[0].disabled=!1;if(!this.is_multiple)return this.selected_item.bind("focus",this.activate_action)};e.prototype.container_mousedown=function(c){var b;if(!this.is_disabled){b=null!=c?a(c.target).hasClass("search-choice-close"):
!1;c&&"mousedown"===c.type&&!this.results_showing&&c.stopPropagation();if(this.pending_destroy_click||b)return this.pending_destroy_click=!1;this.active_field?this.is_multiple||!c||a(c.target)[0]!==this.selected_item[0]&&!a(c.target).parents("a.chzn-single").length||(c.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show());return this.activate_field()}};e.prototype.container_mouseup=function(a){if("ABBR"===
a.target.nodeName&&!this.is_disabled)return this.results_reset(a)};e.prototype.blur_test=function(a){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()};e.prototype.close_field=function(){a(document).unbind("click",this.click_test_action);this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1));this.active_field=!1;this.results_hide();this.container.removeClass("chzn-container-active");
this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};e.prototype.activate_field=function(){this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1));this.container.addClass("chzn-container-active");this.active_field=!0;this.search_field.val(this.search_field.val());return this.search_field.focus()};e.prototype.test_active_click=function(c){return a(c.target).parents("#"+
this.container_id).length?this.active_field=!0:this.close_field()};e.prototype.results_build=function(){var a,b,c,d,e;this.parsing=!0;this.results_data=f.SelectParser.select_to_array(this.form_field);this.is_multiple&&0<this.choices?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):
this.container.removeClass("chzn-container-single-nosearch"));a="";e=this.results_data;c=0;for(d=e.length;c<d;c++)b=e[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();
this.search_results.html(a);return this.parsing=!1};e.prototype.result_add_group=function(c){if(c.disabled)return"";c.dom_id=this.container_id+"_g_"+c.array_index;return'<li id="'+c.dom_id+'" class="group-result">'+a("<div />").text(c.label).html()+"</li>"};e.prototype.result_do_highlight=function(a){var b,c,d,e;if(a.length){this.result_clear_highlight();this.result_highlight=a;this.result_highlight.addClass("highlighted");c=parseInt(this.search_results.css("maxHeight"),10);e=this.search_results.scrollTop();
d=c+e;b=this.result_highlight.position().top+this.search_results.scrollTop();a=b+this.result_highlight.outerHeight();if(a>=d)return this.search_results.scrollTop(0<a-c?a-c:0);if(b<e)return this.search_results.scrollTop(b)}};e.prototype.result_clear_highlight=function(){this.result_highlight&&this.result_highlight.removeClass("highlighted");return this.result_highlight=null};e.prototype.results_show=function(){var a;if(!this.is_multiple)this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&
this.result_do_highlight(this.result_single_selected);else if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;a=this.is_multiple?this.container.height():this.container.height()-1;this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this});this.dropdown.css({top:a+"px",left:0});this.results_showing=!0;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};e.prototype.results_hide=
function(){this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop");this.result_clear_highlight();this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this});this.dropdown.css({left:"-9000px"});return this.results_showing=!1};e.prototype.set_tab_index=function(a){if(this.form_field_jq.attr("tabindex")){a=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);if(this.is_multiple)return this.search_field.attr("tabindex",a);this.selected_item.attr("tabindex",
a);return this.search_field.attr("tabindex",-1)}};e.prototype.show_search_field_default=function(){if(this.is_multiple&&1>this.choices&&!this.active_field)return this.search_field.val(this.default_text),this.search_field.addClass("default");this.search_field.val("");return this.search_field.removeClass("default")};e.prototype.search_results_mouseup=function(c){var b;b=a(c.target).hasClass("active-result")?a(c.target):a(c.target).parents(".active-result").first();if(b.length)return this.result_highlight=
b,this.result_select(c)};e.prototype.search_results_mouseover=function(c){if(c=a(c.target).hasClass("active-result")?a(c.target):a(c.target).parents(".active-result").first())return this.result_do_highlight(c)};e.prototype.search_results_mouseout=function(c){if(a(c.target).hasClass("active-result"))return this.result_clear_highlight()};e.prototype.choices_click=function(c){c.preventDefault();if(this.active_field&&!a(c.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()};
e.prototype.choice_build=function(c){var b,d=this;if(this.is_multiple&&this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;b=this.container_id+"_c_"+c.array_index;this.choices+=1;this.search_container.before('<li class="search-choice" id="'+b+'"><span>'+c.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+c.array_index+'"><i class="fontello-icon-cancel"></i></a></li>');return a("#"+b).find("a").first().click(function(a){return d.choice_destroy_link_click(a)})};
e.prototype.choice_destroy_link_click=function(c){c.preventDefault();if(this.is_disabled)return c.stopPropagation;this.pending_destroy_click=!0;var b=a(c.target);"I"===c.target.tagName&&(b=b.parent());return this.choice_destroy(b)};e.prototype.choice_destroy=function(a){--this.choices;this.show_search_field_default();this.is_multiple&&0<this.choices&&1>this.search_field.val().length&&this.results_hide();this.result_deselect(a.attr("rel"));var b=this;setTimeout(function(){b.search_field.blur();b.search_field.focus()},
0);return a.parents("li").first().remove()};e.prototype.results_reset=function(){this.form_field.options[0].selected=!0;this.selected_item.find("span").text(this.default_text);this.is_multiple||this.selected_item.addClass("chzn-default");this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()};e.prototype.results_reset_cleanup=function(){return this.selected_item.find("abbr").remove()};e.prototype.result_select=
function(a){var b,c;if(this.result_highlight)return b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),b=c.substr(c.lastIndexOf("_")+1),b=this.results_data[b],b.selected=!0,this.form_field.options[b.options_index].selected=!0,this.is_multiple?this.choice_build(b):
(this.selected_item.find("span").first().text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()),a.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[b.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()};e.prototype.result_activate=function(a){return a.addClass("active-result")};
e.prototype.result_deactivate=function(a){return a.removeClass("active-result")};e.prototype.result_deselect=function(c){var b;b=this.results_data[c];b.selected=!1;this.form_field.options[b.options_index].selected=!1;a("#"+this.container_id+"_o_"+c).removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value});return this.search_field_scale()};e.prototype.single_deselect_control_build=
function(){if(this.allow_single_deselect&&1>this.selected_item.find("abbr").length)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')};e.prototype.winnow_results=function(){var c,b,d,e,g,f,k,x,v,r,w,y,t,D,B;this.no_results_clear();x=0;v=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html();g=new RegExp((this.search_contains?"":"^")+v.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");r=new RegExp(v.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&"),"i");B=this.results_data;w=0;for(t=B.length;w<t;w++)if(b=B[w],!b.disabled&&!b.empty)if(b.group)a("#"+b.dom_id).css("display","none");else if(!this.is_multiple||!b.selected){c=!1;k=b.dom_id;f=a("#"+k);if(g.test(b.html))c=!0,x+=1;else if(0<=b.html.indexOf(" ")||0===b.html.indexOf("["))if(e=b.html.replace(/\[|\]/g,"").split(" "),e.length)for(y=0,D=e.length;y<D;y++)d=e[y],g.test(d)&&(c=!0,x+=1);c?(v.length?(c=b.html.search(r),d=b.html.substr(0,c+v.length)+"</em>"+b.html.substr(c+v.length),d=d.substr(0,
c)+"<em>"+d.substr(c)):d=b.html,f.html(d),this.result_activate(f),null!=b.group_array_index&&a("#"+this.results_data[b.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&k===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(f))}return 1>x&&v.length?this.no_results(v):this.winnow_results_set_highlight()};e.prototype.winnow_results_clear=function(){var c,b,d,e,g;this.search_field.val("");b=this.search_results.find("li");g=[];d=0;for(e=
b.length;d<e;d++)c=b[d],c=a(c),c.hasClass("group-result")?g.push(c.css("display","auto")):this.is_multiple&&c.hasClass("result-selected")?g.push(void 0):g.push(this.result_activate(c));return g};e.prototype.winnow_results_set_highlight=function(){var a;if(!this.result_highlight&&(a=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=a.length?a.first():this.search_results.find(".active-result").first(),null!=a))return this.result_do_highlight(a)};e.prototype.no_results=
function(c){var b;b=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');b.find("span").first().html(c);return this.search_results.append(b)};e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};e.prototype.keydown_arrow=function(){var c;this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first())&&this.result_do_highlight(c):(c=this.search_results.find("li.active-result").first())&&this.result_do_highlight(a(c));
if(!this.results_showing)return this.results_show()};e.prototype.keyup_arrow=function(){var a;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight){a=this.result_highlight.prevAll("li.active-result");if(a.length)return this.result_do_highlight(a.first());0<this.choices&&this.results_hide();return this.result_clear_highlight()}};e.prototype.keydown_backstroke=function(){if(this.pending_backstroke)return this.choice_destroy(this.pending_backstroke.find("a").first()),
this.clear_backstroke();this.pending_backstroke=this.search_container.siblings("li.search-choice").last();return this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")};e.prototype.clear_backstroke=function(){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=null};e.prototype.keydown_checker=function(a){var b,c;b=null!=(c=a.which)?c:a.keyCode;this.search_field_scale();8!==b&&this.pending_backstroke&&
this.clear_backstroke();switch(b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a);this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow()}};e.prototype.search_field_scale=function(){var c,b,d,e,g;if(this.is_multiple){b="position:absolute; left: -1000px; top: -1000px; display:none;";d="font-size font-style font-weight font-family line-height text-transform letter-spacing".split(" ");
e=0;for(g=d.length;e<g;e++)c=d[e],b+=c+":"+this.search_field.css(c)+";";c=a("<div />",{style:b});c.text(this.search_field.val());a("body").append(c);b=c.width()+25;c.remove();b>this.f_width-10&&(b=this.f_width-10);this.search_field.css({width:b+"px"});return this.dropdown.css({top:""+this.container.height()+"px"})}};e.prototype.generate_random_id=function(){var c;for(c="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();0<a("#"+c).length;)c+=this.generate_random_char();
return c};return e}(AbstractChosen);f.get_side_border_padding=function(a){return a.outerWidth()-a.width()}}).call(this);
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){function e(a){return a}function f(a){return decodeURIComponent(a.replace(c," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return k.json?JSON.parse(a):a}catch(c){}}var c=/\+/g,k=a.cookie=function(c,h,b){if(void 0!==h){b=a.extend({},k.defaults,b);if("number"===typeof b.expires){var m=b.expires,n=b.expires=new Date;n.setDate(n.getDate()+m)}h=k.json?
JSON.stringify(h):String(h);return document.cookie=[k.raw?c:encodeURIComponent(c),"=",k.raw?h:encodeURIComponent(h),b.expires?"; expires="+b.expires.toUTCString():"",b.path?"; path="+b.path:"",b.domain?"; domain="+b.domain:"",b.secure?"; secure":""].join("")}h=k.raw?e:f;b=document.cookie.split("; ");for(var m=c?void 0:{},n=0,p=b.length;n<p;n++){var q=b[n].split("="),u=h(q.shift()),q=h(q.join("="));if(c&&c===u){m=d(q);break}c||(m[u]=d(q))}return m};k.defaults={};a.removeCookie=function(c,d){return void 0!==
a.cookie(c)?(a.cookie(c,"",a.extend({},d,{expires:-1})),!0):!1}});jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,e,f,d,c){return jQuery.easing[jQuery.easing.def](a,e,f,d,c)},easeInQuad:function(a,e,f,d,c){return d*(e/=c)*e+f},easeOutQuad:function(a,e,f,d,c){return-d*(e/=c)*(e-2)+f},easeInOutQuad:function(a,e,f,d,c){return 1>(e/=c/2)?d/2*e*e+f:-d/2*(--e*(e-2)-1)+f},easeInCubic:function(a,e,f,d,c){return d*(e/=c)*e*e+f},easeOutCubic:function(a,e,f,d,c){return d*((e=e/c-1)*e*e+1)+f},easeInOutCubic:function(a,e,f,d,c){return 1>(e/=c/2)?d/2*e*e*e+f:
d/2*((e-=2)*e*e+2)+f},easeInQuart:function(a,e,f,d,c){return d*(e/=c)*e*e*e+f},easeOutQuart:function(a,e,f,d,c){return-d*((e=e/c-1)*e*e*e-1)+f},easeInOutQuart:function(a,e,f,d,c){return 1>(e/=c/2)?d/2*e*e*e*e+f:-d/2*((e-=2)*e*e*e-2)+f},easeInQuint:function(a,e,f,d,c){return d*(e/=c)*e*e*e*e+f},easeOutQuint:function(a,e,f,d,c){return d*((e=e/c-1)*e*e*e*e+1)+f},easeInOutQuint:function(a,e,f,d,c){return 1>(e/=c/2)?d/2*e*e*e*e*e+f:d/2*((e-=2)*e*e*e*e+2)+f},easeInSine:function(a,e,f,d,c){return-d*Math.cos(e/
c*(Math.PI/2))+d+f},easeOutSine:function(a,e,f,d,c){return d*Math.sin(e/c*(Math.PI/2))+f},easeInOutSine:function(a,e,f,d,c){return-d/2*(Math.cos(Math.PI*e/c)-1)+f},easeInExpo:function(a,e,f,d,c){return 0==e?f:d*Math.pow(2,10*(e/c-1))+f},easeOutExpo:function(a,e,f,d,c){return e==c?f+d:d*(-Math.pow(2,-10*e/c)+1)+f},easeInOutExpo:function(a,e,f,d,c){return 0==e?f:e==c?f+d:1>(e/=c/2)?d/2*Math.pow(2,10*(e-1))+f:d/2*(-Math.pow(2,-10*--e)+2)+f},easeInCirc:function(a,e,f,d,c){return-d*(Math.sqrt(1-(e/=c)*
e)-1)+f},easeOutCirc:function(a,e,f,d,c){return d*Math.sqrt(1-(e=e/c-1)*e)+f},easeInOutCirc:function(a,e,f,d,c){return 1>(e/=c/2)?-d/2*(Math.sqrt(1-e*e)-1)+f:d/2*(Math.sqrt(1-(e-=2)*e)+1)+f},easeInElastic:function(a,e,f,d,c){a=0;var k=d;if(0==e)return f;if(1==(e/=c))return f+d;a||(a=.3*c);k<Math.abs(d)?(k=d,d=a/4):d=a/(2*Math.PI)*Math.asin(d/k);return-(k*Math.pow(2,10*--e)*Math.sin(2*(e*c-d)*Math.PI/a))+f},easeOutElastic:function(a,e,f,d,c){var k=0,g=d;if(0==e)return f;if(1==(e/=c))return f+d;k||
(k=.3*c);g<Math.abs(d)?(g=d,a=k/4):a=k/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*e)*Math.sin(2*(e*c-a)*Math.PI/k)+d+f},easeInOutElastic:function(a,e,f,d,c){var k=0,g=d;if(0==e)return f;if(2==(e/=c/2))return f+d;k||(k=.3*c*1.5);g<Math.abs(d)?(g=d,a=k/4):a=k/(2*Math.PI)*Math.asin(d/g);return 1>e?-.5*g*Math.pow(2,10*--e)*Math.sin(2*(e*c-a)*Math.PI/k)+f:g*Math.pow(2,-10*--e)*Math.sin(2*(e*c-a)*Math.PI/k)*.5+d+f},easeInBack:function(a,e,f,d,c,k){void 0==k&&(k=1.70158);return d*(e/=c)*e*((k+1)*
e-k)+f},easeOutBack:function(a,e,f,d,c,k){void 0==k&&(k=1.70158);return d*((e=e/c-1)*e*((k+1)*e+k)+1)+f},easeInOutBack:function(a,e,f,d,c,k){void 0==k&&(k=1.70158);return 1>(e/=c/2)?d/2*e*e*(((k*=1.525)+1)*e-k)+f:d/2*((e-=2)*e*(((k*=1.525)+1)*e+k)+2)+f},easeInBounce:function(a,e,f,d,c){return d-jQuery.easing.easeOutBounce(a,c-e,0,d,c)+f},easeOutBounce:function(a,e,f,d,c){return(e/=c)<1/2.75?7.5625*d*e*e+f:e<2/2.75?d*(7.5625*(e-=1.5/2.75)*e+.75)+f:e<2.5/2.75?d*(7.5625*(e-=2.25/2.75)*e+.9375)+f:d*(7.5625*
(e-=2.625/2.75)*e+.984375)+f},easeInOutBounce:function(a,e,f,d,c){return e<c/2?.5*jQuery.easing.easeInBounce(a,2*e,0,d,c)+f:.5*jQuery.easing.easeOutBounce(a,2*e-c,0,d,c)+.5*d+f}});
(function(a,e,f){e.fn.touchwipe=function(a){var d={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};a&&e.extend(d,a);this.each(function(){function a(){this.removeEventListener("touchmove",c);e=null;p=!1}function c(b){d.preventDefaultEvents&&b.preventDefault();if(p){var h=e-b.touches[0].pageX;b=f-b.touches[0].pageY;Math.abs(h)>=d.min_move_x?(a(),0<h?d.wipeLeft():d.wipeRight()):Math.abs(b)>=d.min_move_y&&(a(),
0<b?d.wipeDown():d.wipeUp())}}function b(a){1==a.touches.length&&(e=a.touches[0].pageX,f=a.touches[0].pageY,p=!0,this.addEventListener("touchmove",c,!1))}var e,f,p=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",b,!1)});return this};e.elastislide=function(a,d){this.$el=e(d);this._init(a)};e.elastislide.defaults={speed:450,easing:"",imageW:190,margin:3,border:2,minItems:1,current:0,onClick:function(){return!1}};e.elastislide.prototype={_init:function(a){this.options=
e.extend(!0,{},e.elastislide.defaults,a);this.$slider=this.$el.find("ul");this.$items=this.$slider.children("li");this.itemsCount=this.$items.length;this.$esCarousel=this.$slider.parent();this._validateOptions();this._configure();this._addControls();this._initEvents();this.$slider.show();this._slideToCurrent(!1)},_validateOptions:function(){0>this.options.speed&&(this.options.speed=450);0>this.options.margin&&(this.options.margin=4);0>this.options.border&&(this.options.border=1);if(1>this.options.minItems||
this.options.minItems>this.itemsCount)this.options.minItems=1;this.options.current>this.itemsCount-1&&(this.options.current=0)},_configure:function(){this.current=this.options.current;this.visibleWidth=this.$esCarousel.width();this.visibleWidth<this.options.minItems*(this.options.imageW+2*this.options.border)+(this.options.minItems-1)*this.options.margin?(this._setDim((this.visibleWidth-(this.options.minItems-1)*this.options.margin)/this.options.minItems),this._setCurrentValues(),this.fitCount=this.options.minItems):
(this._setDim(),this._setCurrentValues());this.$slider.css({width:this.sliderW})},_setDim:function(a){this.$items.css({marginRight:this.options.margin,width:a?a:this.options.imageW+2*this.options.border}).children("a").css({borderWidth:this.options.border})},_setCurrentValues:function(){this.itemW=this.$items.outerWidth(!0)+5;this.sliderW=this.itemW*this.itemsCount;this.visibleWidth=this.$esCarousel.width();this.fitCount=Math.floor(this.visibleWidth/this.itemW)},_addControls:function(){this.$navNext=
e('<span class="es-nav-next"><i class="fontello-icon-right-dir"></i></span>');this.$navPrev=e('<span class="es-nav-prev"><i class="fontello-icon-left-dir"></i></span>');var a=e('<div class="es-nav"/>').append(this.$navPrev).append(this.$navNext);this.itemsCount>this.fitCount&&this.$el.append(a)},_toggleControls:function(a,d){a&&d?1===d?"right"===a?this.$navNext.show():this.$navPrev.show():"right"===a?this.$navNext.hide():this.$navPrev.hide():(this.current===this.itemsCount-1||this.fitCount>=this.itemsCount)&&
this.$navNext.hide()},_initEvents:function(){var c=this;e(a).on("resize.elastislide",function(a){c._reload();clearTimeout(c.resetTimeout);c.resetTimeout=setTimeout(function(){c._slideToCurrent()},200)});this.$navNext.on("click.elastislide",function(a){c._slide("right")});this.$navPrev.on("click.elastislide",function(a){c._slide("left")});this.$slider.on("click.elastislide","li",function(a){c.options.onClick(e(this));return!1});c.$slider.touchwipe({wipeLeft:function(){c._slide("right")},wipeRight:function(){c._slide("left")}})},
reload:function(a){this._reload();a&&a.call()},_reload:function(){this._setCurrentValues();this.visibleWidth<this.options.minItems*(this.options.imageW+2*this.options.border)+(this.options.minItems-1)*this.options.margin?(this._setDim((this.visibleWidth-(this.options.minItems-1)*this.options.margin)/this.options.minItems),this._setCurrentValues(),this.fitCount=this.options.minItems):(this._setDim(),this._setCurrentValues());this.$slider.css({width:this.sliderW+10});this.itemsCount<=this.fitCount&&
(this.$navPrev.hide(),this.$navNext.hide())},_slide:function(a,d,g,h){var b=parseFloat(this.$slider.css("margin-left"));if(d===f){var m=this.fitCount*this.itemW;if(0>m)return!1;if("right"===a&&this.sliderW-(Math.abs(b)+m)<this.visibleWidth)m=this.sliderW-(Math.abs(b)+this.visibleWidth)-this.options.margin,this._toggleControls("right",-1),this._toggleControls("left",1);else if("left"===a&&0>Math.abs(b)-m)m=Math.abs(b),this._toggleControls("left",-1),this._toggleControls("right",1);else{var n;"right"===
a?n=Math.abs(b)+this.options.margin+Math.abs(m):n=Math.abs(b)-this.options.margin-Math.abs(m);0<n?this._toggleControls("left",1):this._toggleControls("left",-1);n<this.sliderW-this.visibleWidth?this._toggleControls("right",1):this._toggleControls("right",-1)}"right"===a?d="-="+m:d="+="+m}else n=Math.abs(d),Math.max(this.sliderW,this.visibleWidth)-n<this.visibleWidth&&(d=-(Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth),0!==d&&(d+=this.options.margin),this._toggleControls("right",-1),n=
Math.abs(d)),0<n?this._toggleControls("left",1):this._toggleControls("left",-1),Math.max(this.sliderW,this.visibleWidth)-this.visibleWidth>n+this.options.margin?this._toggleControls("right",1):this._toggleControls("right",-1);e.fn.applyStyle=g===f?e.fn.animate:e.fn.css;a={marginLeft:d};this.$slider.stop().applyStyle(a,e.extend(!0,[],{duration:this.options.speed,easing:this.options.easing,complete:function(){h&&h.call()}}))},_slideToCurrent:function(a){this._slide("",-(this.current*this.itemW),a)},
add:function(a,d){this.$items=this.$items.add(a);this.itemsCount=this.$items.length;this._setDim();this._setCurrentValues();this.$slider.css({width:this.sliderW});this._slideToCurrent();d&&d.call(a)},setCurrent:function(a,d){this.current=a;var e=Math.abs(parseFloat(this.$slider.css("margin-left"))),f=Math.abs(this.current*this.itemW);(f+this.itemW>e+this.visibleWidth||f<e)&&this._slideToCurrent();d&&d.call();this.$slider.trigger("elastislide.change")},destroy:function(a){this._destroy(a)},_destroy:function(c){this.$el.off(".elastislide").removeData("elastislide");
e(a).off(".elastislide");c&&c.call()}};var d=function(a){this.console&&console.error(a)};e.fn.elastislide=function(a){if("string"===typeof a){var f=Array.prototype.slice.call(arguments,1);this.each(function(){var g=e.data(this,"elastislide");g?e.isFunction(g[a])&&"_"!==a.charAt(0)?g[a].apply(g,f):d("no such method '"+a+"' for elastislide instance"):d("cannot call methods on elastislide prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){e.data(this,"elastislide")||
e.data(this,"elastislide",new e.elastislide(a,this))});return this}})(window,jQuery);(function(a){a.fn.equalizeCols=function(){var e=0;return this.css("height",a.browser.msie&&7>a.browser.version?"1%":"auto").each(function(){e=Math.max(e,this.offsetHeight)}).css("height",e).each(function(){var f=this.offsetHeight;f>e&&a(this).css("height",e-(f-e))})}})(jQuery);
(function(a){var e,f,d,c,k,g,h,b,m,n,p,q,u,x,v=0,r={},w=[],y=0,t={},D=[],B=null,E=new Image,z=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,G=/[^\.]\.(swf)\s*$/i,C=/[^\.]\.(flv)\s*$/i,I=/[^\.]\.(mp3)\s*$/i,R=/[^\.]\.(mp4)\s*$/i,P=/[^\.]\.(wmv)\s*$/i,l=/[^\.]\.(dcr)\s*$/i,L,A=1,U=0,H="",Q,F,J=!1,O=a.extend(a("<div/>")[0],{prop:0}),N=a.browser.msie&&7>a.browser.version&&!window.XMLHttpRequest,T=function(){f.hide();E.onerror=E.onload=null;B&&B.abort();e.empty()},M=function(){!1===r.onError(w,v,r)?(f.hide(),J=!1):
(r.titleShow=!1,r.width="auto",r.height="auto",e.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),S())},Z=function(){var b=w[v],c,d,h,k,t,m;T();r=a.extend({},a.fn.fancybox.defaults,"undefined"==typeof a(b).data("fancybox")?r:a(b).data("fancybox"));m=r.onStart(w,v,r);if(!1===m)J=!1;else{"object"==typeof m&&(r=a.extend(r,m));p=a(b).offset().left;q=a(b).offset().top;u=a(b).outerHeight();x=a(b).outerWidth();h=r.title||(b.nodeName?a(b).attr("title"):
b.title)||"";b.nodeName&&!r.orig&&(r.orig=a(b).children("img:first").length?a(b).children("img:first"):a(b));""===h&&r.orig&&r.titleFromAlt&&(h=r.orig.attr("alt"));c=r.href||(b.nodeName?a(b).attr("href"):b.href)||null;if(/^(?:javascript)/i.test(c)||"#"==c)c=null;r.type?(d=r.type,c||(c=r.content)):r.content?d="html":c&&(d=c.match(z)?"image":c.match(G)?"swf":c.match(C)?"flv":c.match(I)?"mp3":c.match(R)?"mp4":c.match(P)?"wmv":c.match(l)?"dcr":a(b).hasClass("iframe")?"iframe":0===c.indexOf("#")?"inline":
"ajax");if(d)switch("inline"==d&&(b=c.substr(c.indexOf("#")),d=0<a(b).length?"inline":"ajax"),r.type=d,r.href=c,r.title=h,r.autoDimensions&&("html"==r.type||"inline"==r.type||"ajax"==r.type?(r.width="auto",r.height="auto"):r.autoDimensions=!1),r.modal&&(r.overlayShow=!0,r.hideOnOverlayClick=!1,r.hideOnContentClick=!1,r.enableEscapeButton=!1,r.showCloseButton=!1),r.padding=parseInt(r.padding,10),r.margin=parseInt(r.margin,10),e.css("padding",r.padding+r.margin),a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",
function(){a(this).replaceWith(g.children())}),d){case "html":e.html(r.content);S();break;case "inline":if(!0===a(b).parent().is("#fancybox-content")){J=!1;break}a('<div class="fancybox-inline-tmp" />').hide().insertBefore(a(b)).bind("fancybox-cleanup",function(){a(this).replaceWith(g.children())}).bind("fancybox-cancel",function(){a(this).replaceWith(e.children())});a(b).appendTo(e);S();break;case "image":J=!1;a.fancybox.showActivity();E=new Image;E.onerror=function(){M()};E.onload=function(){J=
!0;E.onerror=E.onload=null;r.width=E.width;r.height=E.height;a("<img />").attr({id:"fancybox-img",src:E.src,alt:r.title}).appendTo(e);ba()};E.src=c;break;case "swf":r.scrolling="no";k='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+r.width+'" height="'+r.height+'"><param name="movie" value="'+c+'"></param>';t="";a.each(r.swf,function(a,b){k+='<param name="'+a+'" value="'+b+'"></param>';t+=" "+a+'="'+b+'"'});k+='<embed src="'+c+'" type="application/x-shockwave-flash" width="'+
r.width+'" height="'+r.height+'"'+t+"></embed></object>";e.html(k);S();break;case "mp3":r.scrolling="no";e.html(Handlebars.templates["media/audio"]({src:c,type:d,autoplay:/webkit/.test(navigator.userAgent.toLowerCase())?"":' autoplay="true"'})).find("audio").mediaelementplayer();S();break;case "mp4":r.scrolling="no";r.width=a(b).data("width");r.height=a(b).data("height");h=a(b).find("img").length&&a(b).find("img").attr("src")?a(b).find("img").attr("src"):null;var n=0==a(b).data("autoplay")?"":' autoplay="true"';
e.html(Handlebars.templates["media/video"]({src:c,type:d,width:a(b).data("width"),height:a(b).data("height"),poster:h,autoplay:n})).find("video").mediaelementplayer();S();break;case "wmv":r.scrolling="no";r.width=a(b).data("width");r.height=a(b).data("height");e.html(Handlebars.templates["media/video"]({src:c,type:d,width:a(b).data("width"),height:a(b).data("height"),autoplay:EB.shared.isIE8()?"":' autoplay="true"'})).find("video").mediaelementplayer();S();break;case "dcr":r.scrolling="no";e.html(Handlebars.templates["media/embed"]({src:c,
width:r.width,height:r.height,type:"application/x-director"}));S();break;case "flv":r.scrolling="no";e.html(Handlebars.templates["media/flash"]({src:c,width:r.width,height:r.height+20}));S();break;case "ajax":J=!1;a.fancybox.showActivity();r.ajax.win=r.ajax.success;B=a.ajax(a.extend({},r.ajax,{url:c,data:r.ajax.data||{},error:function(a,b,c){0<a.status&&M()},success:function(a,b,d){if(200==("object"==typeof d?d:B).status){if("function"==typeof r.ajax.win){m=r.ajax.win(c,a,b,d);if(!1===m){f.hide();
return}if("string"==typeof m||"object"==typeof m)a=m}e.html(a);S()}}}));break;case "iframe":ba()}else M()}},S=function(){var b=r.width,c=r.height,b=-1<b.toString().indexOf("%")?parseInt((a(window).width()-2*r.margin)*parseFloat(b)/100,10)+"px":"auto"==b?"auto":b+"px",c=-1<c.toString().indexOf("%")?parseInt((a(window).height()-2*r.margin)*parseFloat(c)/100,10)+"px":"auto"==c?"auto":c+"px";e.wrapInner('<div style="width:'+b+";height:"+c+";overflow: "+("auto"==r.scrolling?"auto":"yes"==r.scrolling?"scroll":
"hidden")+';position:relative;"></div>');r.width=e.width();r.height=e.height();ba()},ba=function(){var q,l;f.hide();if(c.is(":visible")&&!1===t.onCleanup(D,y,t))a.event.trigger("fancybox-cancel"),J=!1;else{J=!0;a(g.add(d)).unbind();a(window).unbind("resize.fb scroll.fb");a(document).unbind("keydown.fb");c.is(":visible")&&"outside"!==t.titlePosition&&c.css("height",c.height());D=w;y=v;t=r;if(t.overlayShow){if(d.css({"background-color":t.overlayColor,opacity:t.overlayOpacity,cursor:t.hideOnOverlayClick?
"pointer":"auto",height:a(document).height()}),!d.is(":visible")){if(N)a("select:not(#fancybox-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});d.show()}}else d.hide();F=ca();H=t.title||"";U=0;b.empty().removeAttr("style").removeClass();if(!1!==t.titleShow&&(H=a.isFunction(t.titleFormat)?t.titleFormat(H,D,y,t):H&&H.length?"float"==t.titlePosition?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+
H+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+t.titlePosition+'">'+H+"</div>":!1)&&""!==H)switch(b.addClass("fancybox-title-"+t.titlePosition).html(H).appendTo("body").show(),t.titlePosition){case "inside":b.css({width:F.width-2*t.padding,marginLeft:t.padding,marginRight:t.padding});U=b.outerHeight(!0);b.appendTo(k);F.height+=U;break;case "over":b.css({marginLeft:t.padding,width:F.width-2*t.padding,bottom:t.padding}).appendTo(k);break;case "float":b.css("left",
-1*parseInt((b.width()-F.width-40)/2,10)).appendTo(c);break;default:b.css({width:F.width-2*t.padding,paddingLeft:t.padding,paddingRight:t.padding}).appendTo(c)}b.hide();c.is(":visible")?(a(h.add(m).add(n)).hide(),q=c.position(),Q={top:q.top,left:q.left,width:c.width(),height:c.height()},l=Q.width==F.width&&Q.height==F.height,g.fadeTo(t.changeFade,.3,function(){var b=function(){g.html(e.contents()).fadeTo(t.changeFade,1,X)};a.event.trigger("fancybox-change");g.empty().removeAttr("filter").css({"border-width":t.padding,
width:F.width-2*t.padding,height:r.autoDimensions?"auto":F.height-U-2*t.padding});l?b():(O.prop=0,a(O).animate({prop:1},{duration:t.changeSpeed,easing:t.easingChange,step:V,complete:b}));setTimeout(function(){a(g).trigger("fancybox.change")},500)})):(c.removeAttr("style"),g.css("border-width",t.padding),"elastic"==t.transitionIn?(Q=da(),g.html(e.contents()),c.show(),t.opacity&&(F.opacity=0),O.prop=0,a(O).animate({prop:1},{duration:t.speedIn,easing:t.easingIn,step:V,complete:X})):("inside"==t.titlePosition&&
0<U&&b.show(),g.css({width:F.width-2*t.padding,height:r.autoDimensions?"auto":F.height-U-2*t.padding}).html(e.contents()),c.css(F).fadeIn("none"==t.transitionIn?0:t.speedIn,X),setTimeout(function(){a(g).trigger("fancybox.change")},500)))}},aa=function(){(t.enableEscapeButton||t.enableKeyboardNav)&&a(document).bind("keydown.fb",function(b){27==b.keyCode&&t.enableEscapeButton?(b.preventDefault(),a.fancybox.close()):37!=b.keyCode&&39!=b.keyCode||!t.enableKeyboardNav||"INPUT"===b.target.tagName||"TEXTAREA"===
b.target.tagName||"SELECT"===b.target.tagName||(b.preventDefault(),a.fancybox[37==b.keyCode?"prev":"next"]())});t.showNavArrows?((t.cyclic&&1<D.length||0!==y)&&m.show(),(t.cyclic&&1<D.length||y!=D.length-1)&&n.show()):(m.hide(),n.hide())},X=function(){a.support.opacity||(g.get(0).style.removeAttribute("filter"),c.get(0).style.removeAttribute("filter"));r.autoDimensions&&g.css("height","auto");c.css("height","auto");H&&H.length&&b.show();t.showCloseButton&&h.show();aa();t.hideOnContentClick&&g.bind("click",
a.fancybox.close);t.hideOnOverlayClick&&d.bind("click",a.fancybox.close);a(window).bind("resize.fb",a.fancybox.resize);t.centerOnScroll&&a(window).bind("scroll.fb",a.fancybox.center);"iframe"==t.type&&a('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(a.browser.msie?'allowtransparency="true""':"")+' scrolling="'+r.scrolling+'" src="'+t.href+'"></iframe>').appendTo(g);c.show();J=!1;a.fancybox.center();t.onComplete(D,y,t);var e,f;D.length-1>y&&
(e=D[y+1].href,"undefined"!==typeof e&&e.match(z)&&(f=new Image,f.src=e));0<y&&(e=D[y-1].href,"undefined"!==typeof e&&e.match(z)&&(f=new Image,f.src=e));a(document).trigger("fancybox.assetChange")},V=function(a){var b={width:parseInt(Q.width+(F.width-Q.width)*a,10),height:parseInt(Q.height+(F.height-Q.height)*a,10),top:parseInt(Q.top+(F.top-Q.top)*a,10),left:parseInt(Q.left+(F.left-Q.left)*a,10)};"undefined"!==typeof F.opacity&&(b.opacity=.5>a?.5:a);c.css(b);g.css({width:b.width-2*t.padding,height:b.height-
U*a-2*t.padding})},Y=function(){return[a(window).width()-2*t.margin,a(window).height()-2*t.margin,a(document).scrollLeft()+t.margin,a(document).scrollTop()+t.margin]},ca=function(){var a=Y(),b={},c=t.autoScale,d=2*t.padding;-1<t.width.toString().indexOf("%")?b.width=parseInt(a[0]*parseFloat(t.width)/100,10):b.width=t.width+d;-1<t.height.toString().indexOf("%")?b.height=parseInt(a[1]*parseFloat(t.height)/100,10):b.height=t.height+d;c&&(b.width>a[0]||b.height>a[1])&&("image"==r.type||"swf"==r.type||
"mp3"==r.type||"mp4"==r.type||"wmv"==r.type||"dcr"==r.type?(c=t.width/t.height,b.width>a[0]&&(b.width=a[0],b.height=parseInt((b.width-d)/c+d,10)),b.height>a[1]&&(b.height=a[1],b.width=parseInt((b.height-d)*c+d,10))):(b.width=Math.min(b.width,a[0]),b.height=Math.min(b.height,a[1])));r.center?(b.top=parseInt(Math.max(a[3]-20,a[3]+.1*(a[1]-b.height-40)+t.padding/5),10),b.left=parseInt(Math.max(a[2]-20,a[2]+.5*(a[0]-b.width-40)),10)):(a=r.offsetX||6,d=r.offsetY||22,c=r.position||"bottomLeft","bottomLeft"==
c?(b.top=q+u-t.margin+d,b.left=p-b.width-t.margin-a):"bottomRight"==c?(b.top=q+u-t.margin+d,b.left=p+x-t.margin+2*a):"topRight"==c?(b.top=q-b.height-t.margin,b.left=p+x-t.margin+2*a):"topLeft"==c&&(b.top=q-b.height-t.margin,b.left=p-b.width-t.margin-a));return b},da=function(){var b=r.orig?a(r.orig):!1;if(b&&b.length){var c=b.offset();c.top+=parseInt(b.css("paddingTop"),10)||0;c.left+=parseInt(b.css("paddingLeft"),10)||0;c.top+=parseInt(b.css("border-top-width"),10)||0;c.left+=parseInt(b.css("border-left-width"),
10)||0;c.width=b.width();c.height=b.height();b={width:c.width+2*t.padding,height:c.height+2*t.padding,top:c.top-t.padding-20,left:c.left-t.padding-20}}else b=Y(),b={width:2*t.padding,height:2*t.padding,top:parseInt(b[3]+.5*b[1],10),left:parseInt(b[2]+.5*b[0],10)};return b},ga=function(){f.is(":visible")?(a("div",f).css("top",-40*A+"px"),A=(A+1)%12):clearInterval(L)};a.fn.fancybox=function(b){if(!a(this).length)return this;a(this).data("fancybox",a.extend({},b,a.metadata?a(this).metadata():{})).unbind("click.fb").bind("click.fb",
function(b){b.preventDefault();J||(J=!0,a(this).blur(),w=[],v=0,(b=a(this).attr("rel")||"")&&""!=b&&"nofollow"!==b?(w=a("a[rel="+b+"], area[rel="+b+"]"),v=w.index(this)):w.push(this),Z())});return this};a.fancybox=function(b,c){var d;if(!J){J=!0;d="undefined"!==typeof c?c:{};w=[];v=parseInt(d.index,10)||0;if(a.isArray(b)){for(var e=0,f=b.length;e<f;e++)"object"==typeof b[e]?a(b[e]).data("fancybox",a.extend({},d,b[e])):b[e]=a({}).data("fancybox",a.extend({content:b[e]},d));w=jQuery.merge(w,b)}else"object"==
typeof b?a(b).data("fancybox",a.extend({},d,b)):b=a({}).data("fancybox",a.extend({content:b},d)),w.push(b);if(v>w.length||0>v)v=0;Z()}};a.fancybox.showActivity=function(){clearInterval(L);f.show();L=setInterval(ga,66)};a.fancybox.hideActivity=function(){f.hide()};a.fancybox.next=function(){return a.fancybox.pos(y+1)};a.fancybox.prev=function(){return a.fancybox.pos(y-1)};a.fancybox.pos=function(a){J||(a=parseInt(a),w=D,-1<a&&a<D.length?(v=a,Z()):t.cyclic&&1<D.length&&(v=a>=D.length?0:D.length-1,Z()))};
a.fancybox.cancel=function(){J||(J=!0,a.event.trigger("fancybox-cancel"),T(),r.onCancel(w,v,r),J=!1)};a.fancybox.close=function(){function e(){d.fadeOut("fast");b.empty().hide();c.hide();a.event.trigger("fancybox-cleanup");g.find("embed").remove();g.empty();t.onClosed(D,y,t);D=r=[];y=v=0;t=r={};J=!1}if(!J&&!c.is(":hidden"))if(J=!0,t&&!1===t.onCleanup(D,y,t))J=!1;else if(T(),a(h.add(m).add(n)).hide(),a(g.add(d)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),g.find("iframe").attr("src",
N&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==t.titlePosition&&b.empty(),c.stop(),"elastic"==t.transitionOut){Q=da();var f=c.position();F={top:f.top,left:f.left,width:c.width(),height:c.height()};t.opacity&&(F.opacity=1);b.empty().hide();O.prop=1;a(O).animate({prop:0},{duration:t.speedOut,easing:t.easingOut,step:V,complete:e})}else c.fadeOut("none"==t.transitionOut?0:t.speedOut,e)};a.fancybox.resize=function(){d.is(":visible")&&d.css("height",a(document).height());
a.fancybox.center(!0)};a.fancybox.center=function(a){if(r.center){var b,d;J||(d=!0===a?1:0,b=Y(),!d&&(c.width()>b[0]||c.height()>b[1])||c.stop().animate({top:parseInt(Math.max(b[3]-20,b[3]+.1*(b[1]-g.height()-40))),left:parseInt(Math.max(b[2]-20,b[2]+.5*(b[0]-g.width()-40)-t.padding))},"number"==typeof a?a:200))}};a.fancybox.init=function(){a("#fancybox-wrap").length||(a("body").append(e=a('<div id="fancybox-tmp"></div>'),f=a('<div id="fancybox-loading"><div></div></div>'),d=a('<div id="fancybox-overlay"></div>'),
c=a('<div id="fancybox-wrap"></div>')),k=a('<div id="fancybox-outer"></div>').appendTo(c),k.append(g=a('<div id="fancybox-content"></div>'),h=a('<a id="fancybox-close"></a>'),b=a('<div id="fancybox-title"></div>'),m=a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),n=a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),h.click(a.fancybox.close),f.click(a.fancybox.cancel),m.click(function(b){b.preventDefault();
a.fancybox.prev()}),n.click(function(b){b.preventDefault();a.fancybox.next()}),a.fn.mousewheel&&c.bind("mousewheel.fb",function(b,c){if(J)b.preventDefault();else if(0==a(b.target).get(0).clientHeight||a(b.target).get(0).scrollHeight===a(b.target).get(0).clientHeight)b.preventDefault(),a.fancybox[0<c?"prev":"next"]()}),a.support.opacity||c.addClass("fancybox-ie"),N&&(f.addClass("fancybox-ie6"),c.addClass("fancybox-ie6"),a('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||
"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(k)))};a.fn.fancybox.defaults={padding:25,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,center:!0,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,
transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};a(document).ready(function(){a.fancybox.init()})})(jQuery);
(function(a){a.extend(a,{placeholder:{browser_supported:function(){return void 0!==this._supported?this._supported:this._supported=!!("placeholder"in a('<input type="text">')[0])},shim:function(e){var f={color:"#888",cls:"placeholder",selector:"input[placeholder], textarea[placeholder]"};a.extend(f,e);return!this.browser_supported()&&a(f.selector)._placeholder_shim(f)}}});a.extend(a.fn,{_placeholder_shim:function(e){function f(c){var d=a(c).offsetParent().offset(),e=a(c).offset();return{top:e.top-
d.top,left:e.left-d.left,width:a(c).width()}}function d(c){var e=c.data("target");"undefined"!==typeof e&&(c.css(f(e)),a(window).one("resize",function(){d(c)}))}return this.each(function(){var c=a(this);if(c.is(":visible")){if(c.data("placeholder"))return c.data("placeholder").css(f(c)),!0;var k={};c.is("textarea")||"auto"==c.css("height")||(k={lineHeight:c.css("height"),whiteSpace:"nowrap"});var g="border-box"===c.css("box-sizing"),h=c.is("textarea"),b=a("<label />").text(c.attr("placeholder")).addClass(e.cls).css(a.extend({position:"absolute",
display:"inline","float":"none",overflow:"hidden",textAlign:"left",color:e.color,cursor:"text",paddingTop:!h&&g?"0":c.css("padding-top"),paddingRight:c.css("padding-right"),paddingBottom:!h&&g?"0":c.css("padding-bottom"),paddingLeft:c.css("padding-left"),fontSize:c.css("font-size"),fontFamily:c.css("font-family"),fontStyle:c.css("font-style"),fontWeight:c.css("font-weight"),textTransform:c.css("text-transform"),backgroundColor:"transparent",zIndex:99},k)).css(f(this)).attr("for",this.id).data("target",
c).click(function(){a(this).data("target").is(":disabled")||a(this).data("target").focus()}).insertBefore(this);c.data("placeholder",b).on("keydown",function(){b.hide()}).on("blur change",function(){b[c.val().length?"hide":"show"]()}).triggerHandler("blur");a(window).one("resize",function(){d(b)})}})}})})(jQuery);jQuery(document).add(window).bind("ready load",function(){jQuery.placeholder&&jQuery.placeholder.shim()});
(function(a,e){a.fn.imagesLoaded=function(f){function d(){var c=a(n),d=a(p);g&&(p.length?g.reject(b,c,d):g.resolve(b));a.isFunction(f)&&f.call(k,b,c,d)}function c(c,e){"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="!==c.src&&-1===a.inArray(c,m)&&(m.push(c),e?p.push(c):n.push(c),a.data(c,"imagesLoaded",{isBroken:e,src:c.src}),h&&g.notifyWith(a(c),[e,b,a(n),a(p)]),b.length===m.length&&(setTimeout(d),b.unbind(".imagesLoaded")))}var k=this,g=a.isFunction(a.Deferred)?a.Deferred():
0,h=a.isFunction(g.notify),b=k.find("img").add(k.filter("img")),m=[],n=[],p=[];b.length?b.bind("load.imagesLoaded error.imagesLoaded",function(a){c(a.target,"error"===a.type)}).each(function(b,d){var f=d.src,g=a.data(d,"imagesLoaded");if(g&&g.src===f)c(d,g.isBroken);else if(d.complete&&d.naturalWidth!==e)c(d,0===d.naturalWidth||0===d.naturalHeight);else if(d.readyState||d.complete)d.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",d.src=f}):d();return g?g.promise(k):k}})(jQuery);
$.ajaxPrefilter(function(a,e,f){if(void 0!=a.localCache&&a.localCache){var d=36E5*(a.cacheTTL||12),c=a.cacheKey||a.url+a.type+(a.data||"");a.isCacheValid&&!a.isCacheValid()&&$.jStorage.deleteKey(c);$.jStorage.get(c)?(a.success($.jStorage.get(c)),f.abort()):(a.success&&(a.realSuccess=a.success),a.success=function(e){$.jStorage.set(c,e);$.jStorage.setTTL(c,d);a.realSuccess&&a.realSuccess(e)})}});
(function(a){var e=a.jCarousel={};e.version="0.3.1";var f=/^([+\-]=)?(.+)$/;e.parseTarget=function(a){var c=!1,e="object"!=typeof a?f.exec(a):null;return e?(a=parseInt(e[2],10)||0,e[1]&&(c=!0,"-="===e[1]&&(a*=-1))):"object"!=typeof a&&(a=parseInt(a,10)||0),{target:a,relative:c}};e.detectCarousel=function(a){for(var c;0<a.length;){if((c=a.filter("[data-jcarousel]"),0<c.length)||(c=a.find("[data-jcarousel]"),0<c.length))return c;a=a.parent()}return null};e.base=function(d){return{version:e.version,
_options:{},_element:null,_carousel:null,_init:a.noop,_create:a.noop,_destroy:a.noop,_reload:a.noop,create:function(){return this._element.attr("data-"+d.toLowerCase(),!0).data(d,this),!1===this._trigger("create")?this:(this._create(),this._trigger("createend"),this)},destroy:function(){return!1===this._trigger("destroy")?this:(this._destroy(),this._trigger("destroyend"),this._element.removeData(d).removeAttr("data-"+d.toLowerCase()),this)},reload:function(a){return!1===this._trigger("reload")?this:
(a&&this.options(a),this._reload(),this._trigger("reloadend"),this)},element:function(){return this._element},options:function(c,d){if(0===arguments.length)return a.extend({},this._options);if("string"==typeof c){if(void 0===d)return void 0===this._options[c]?null:this._options[c];this._options[c]=d}else this._options=a.extend({},this._options,c);return this},carousel:function(){return this._carousel||(this._carousel=e.detectCarousel(this.options("carousel")||this._element),this._carousel||a.error('Could not detect carousel for plugin "'+
d+'"')),this._carousel},_trigger:function(c,e,f){var h,b=!1;return f=[this].concat(f||[]),(e||this._element).each(function(){h=a.Event((d+":"+c).toLowerCase());a(this).trigger(h,f);h.isDefaultPrevented()&&(b=!0)}),!b}}};e.plugin=function(d,c){var f=a[d]=function(c,d){this._element=a(c);this.options(d);this._init();this.create()};return f.fn=f.prototype=a.extend({},e.base(d),c),a.fn[d]=function(c){var e=Array.prototype.slice.call(arguments,1),b=this;return"string"==typeof c?this.each(function(){var f=
a(this).data(d);if(!f)return a.error("Cannot call methods on "+d+' prior to initialization; attempted to call method "'+c+'"');if(!a.isFunction(f[c])||"_"===c.charAt(0))return a.error('No such method "'+c+'" for '+d+" instance");var k=f[c].apply(f,e);return k!==f&&void 0!==k?(b=k,!1):void 0}):this.each(function(){var b=a(this).data(d);b instanceof f?b.reload(c):new f(this,c)}),b},f}})(jQuery);
(function(a,e){var f=function(a){return parseFloat(a)||0};a.jCarousel.plugin("jcarousel",{animating:!1,tail:0,inTail:!1,resizeTimer:null,lt:null,vertical:!1,rtl:!1,circular:!1,underflow:!1,relative:!1,_options:{list:function(){return this.element().children().eq(0)},items:function(){return this.list().children()},animation:400,transitions:!1,wrap:null,vertical:null,rtl:null,center:!1},_list:null,_items:null,_target:null,_first:null,_last:null,_visible:null,_fullyvisible:null,_init:function(){var a=
this;return this.onWindowResize=function(){a.resizeTimer&&clearTimeout(a.resizeTimer);a.resizeTimer=setTimeout(function(){a.reload()},100)},this},_create:function(){this._reload();a(e).on("resize.jcarousel",this.onWindowResize)},_destroy:function(){a(e).off("resize.jcarousel",this.onWindowResize)},_reload:function(){this.vertical=this.options("vertical");null==this.vertical&&(this.vertical=this.list().height()>this.list().width());this.rtl=this.options("rtl");null==this.rtl&&(this.rtl=function(c){if("rtl"===
(""+c.attr("dir")).toLowerCase())return!0;var d=!1;return c.parents("[dir]").each(function(){return/rtl/i.test(a(this).attr("dir"))?(d=!0,!1):void 0}),d}(this._element));this.lt=this.vertical?"top":"left";this.relative="relative"===this.list().css("position");this._items=this._list=null;var d=this._target&&0<=this.index(this._target)?this._target:this.closest();this.circular="circular"===this.options("wrap");this.underflow=!1;var c={left:0,top:0};return 0<d.length&&(this._prepare(d),this.list().find("[data-jcarousel-clone]").remove(),
this._items=null,this.underflow=this._fullyvisible.length>=this.items().length,this.circular=this.circular&&!this.underflow,c[this.lt]=this._position(d)+"px"),this.move(c),this},list:function(){if(null===this._list){var d=this.options("list");this._list=a.isFunction(d)?d.call(this):this._element.find(d)}return this._list},items:function(){if(null===this._items){var d=this.options("items");this._items=(a.isFunction(d)?d.call(this):this.list().find(d)).not("[data-jcarousel-clone]")}return this._items},
index:function(a){return this.items().index(a)},closest:function(){var d,c=this,e=this.list().position()[this.lt],g=a(),h=!1,b=this.vertical?"bottom":this.rtl&&!this.relative?"left":"right";return this.rtl&&this.relative&&!this.vertical&&(e+=this.list().width()-this.clipping()),this.items().each(function(){if(g=a(this),h)return!1;var m=c.dimension(g);if(e+=m,0<=e){if(d=m-f(g.css("margin-"+b)),!(0>=Math.abs(e)-m+d/2))return!1;h=!0}}),g},target:function(){return this._target},first:function(){return this._first},
last:function(){return this._last},visible:function(){return this._visible},fullyvisible:function(){return this._fullyvisible},hasNext:function(){if(!1===this._trigger("hasnext"))return!0;var a=this.options("wrap"),c=this.items().length-1;return 0<=c&&!this.underflow&&(a&&"first"!==a||c>this.index(this._last)||this.tail&&!this.inTail)?!0:!1},hasPrev:function(){if(!1===this._trigger("hasprev"))return!0;var a=this.options("wrap");return 0<this.items().length&&!this.underflow&&(a&&"last"!==a||0<this.index(this._first)||
this.tail&&this.inTail)?!0:!1},clipping:function(){return this._element["inner"+(this.vertical?"Height":"Width")]()},dimension:function(a){return a["outer"+(this.vertical?"Height":"Width")](!0)},scroll:function(d,c,e){if(this.animating||!1===this._trigger("scroll",null,[d,c]))return this;a.isFunction(c)&&(e=c,c=!0);var f=a.jCarousel.parseTarget(d);if(f.relative){var h,b,m,n,p;d=this.items().length-1;var q=Math.abs(f.target),u=this.options("wrap");if(0<f.target)if(b=this.index(this._last),b>=d&&this.tail)this.inTail?
"both"===u||"last"===u?this._scroll(0,c,e):a.isFunction(e)&&e.call(this,!1):this._scrollTail(c,e);else if(h=this.index(this._target),this.underflow&&h===d&&("circular"===u||"both"===u||"last"===u)||!this.underflow&&b===d&&("both"===u||"last"===u))this._scroll(0,c,e);else if(m=h+q,this.circular&&m>d){b=d;for(h=this.items().get(-1);m>b++;)h=this.items().eq(0),(n=0<=this._visible.index(h))&&h.after(h.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(h),n||(p={},p[this.lt]=this.dimension(h),
this.moveBy(p)),this._items=null;this._scroll(h,c,e)}else this._scroll(Math.min(m,d),c,e);else if(this.inTail)this._scroll(Math.max(this.index(this._first)-q+1,0),c,e);else if(b=this.index(this._first),h=this.index(this._target),n=this.underflow?h:b,m=n-q,0>=n&&(this.underflow&&"circular"===u||"both"===u||"first"===u))this._scroll(d,c,e);else if(this.circular&&0>m){b=m;for(h=this.items().get(0);0>b++;)h=this.items().eq(-1),(n=0<=this._visible.index(h))&&h.after(h.clone(!0).attr("data-jcarousel-clone",
!0)),this.list().prepend(h),this._items=null,m=this.dimension(h),p={},p[this.lt]=-m,this.moveBy(p);this._scroll(h,c,e)}else this._scroll(Math.max(m,0),c,e)}else this._scroll(f.target,c,e);return this._trigger("scrollend"),this},moveBy:function(a,c){var e=this.list().position(),g=1,h=0;return this.rtl&&!this.vertical&&(g=-1,this.relative&&(h=this.list().width()-this.clipping())),a.left&&(a.left=e.left+h+f(a.left)*g+"px"),a.top&&(a.top=e.top+h+f(a.top)*g+"px"),this.move(a,c)},move:function(d,c){c=c||
{};var e=this.options("transitions"),f=!!e,h=!!e.transforms,b=!!e.transforms3d,m=c.duration||0,n=this.list();if(!f&&0<m)return n.animate(d,c),void 0;var p=c.complete||a.noop,q={};if(f)var u=n.css(["transitionDuration","transitionTimingFunction","transitionProperty"]),x=p,p=function(){a(this).css(u);x.call(this)},q={transitionDuration:(0<m?m/1E3:0)+"s",transitionTimingFunction:e.easing||c.easing,transitionProperty:0<m?h||b?"all":d.left?"left":"top":"none",transform:"none"};b?q.transform="translate3d("+
(d.left||0)+","+(d.top||0)+",0)":h?q.transform="translate("+(d.left||0)+","+(d.top||0)+")":a.extend(q,d);f&&0<m&&n.one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",p);n.css(q);0>=m&&n.each(function(){p.call(this)})},_scroll:function(d,c,e){if(this.animating||("object"!=typeof d?d=this.items().eq(d):void 0===d.jquery&&(d=a(d)),0===d.length))return a.isFunction(e)&&e.call(this,!1),this;this.inTail=!1;this._prepare(d);d=this._position(d);var f=this.list().position()[this.lt];
if(d===f)return a.isFunction(e)&&e.call(this,!1),this;f={};return f[this.lt]=d+"px",this._animate(f,c,e),this},_scrollTail:function(d,c){if(this.animating||!this.tail)return a.isFunction(c)&&c.call(this,!1),this;var e=this.list().position()[this.lt];this.rtl&&this.relative&&!this.vertical&&(e+=this.list().width()-this.clipping());this.rtl&&!this.vertical?e+=this.tail:e-=this.tail;this.inTail=!0;var f={};return f[this.lt]=e+"px",this._update({target:this._target.next(),fullyvisible:this._fullyvisible.slice(1).add(this._visible.last())}),
this._animate(f,d,c),this},_animate:function(d,c,e){if(e=e||a.noop,!1===this._trigger("animate"))return e.call(this,!1),this;this.animating=!0;var f=this.options("animation"),h=a.proxy(function(){this.animating=!1;var a=this.list().find("[data-jcarousel-clone]");0<a.length&&(a.remove(),this._reload());this._trigger("animateend");e.call(this,!0)},this),f="object"==typeof f?a.extend({},f):{duration:f},b=f.complete||a.noop;return!1===c?f.duration=0:void 0!==a.fx.speeds[f.duration]&&(f.duration=a.fx.speeds[f.duration]),
f.complete=function(){h();b.call(this)},this.move(d,f),this},_prepare:function(d){var c,e,g,h,b=this.index(d),m=b,n=this.dimension(d),p=this.clipping(),q=this.vertical?"bottom":this.rtl?"left":"right",u=this.options("center"),x={target:d,first:d,last:d,visible:d,fullyvisible:p>=n?d:a()};if(u&&(n/=2,p/=2),p>n)for(;;){if(c=this.items().eq(++m),0===c.length){if(!this.circular)break;if(c=this.items().eq(0),d.get(0)===c.get(0))break;if(e=0<=this._visible.index(c),e&&c.after(c.clone(!0).attr("data-jcarousel-clone",
!0)),this.list().append(c),!e){var v={};v[this.lt]=this.dimension(c);this.moveBy(v)}this._items=null}if(h=this.dimension(c),0===h)break;if(n+=h,x.last=c,x.visible=x.visible.add(c),g=f(c.css("margin-"+q)),p>=n-g&&(x.fullyvisible=x.fullyvisible.add(c)),n>=p)break}if(!this.circular&&!u&&p>n)for(m=b;!(0>--m||(c=this.items().eq(m),0===c.length)||(h=this.dimension(c),0===h)||(n+=h,x.first=c,x.visible=x.visible.add(c),g=f(c.css("margin-"+q)),p>=n-g&&(x.fullyvisible=x.fullyvisible.add(c)),n>=p)););return this._update(x),
this.tail=0,u||"circular"===this.options("wrap")||"custom"===this.options("wrap")||this.index(x.last)!==this.items().length-1||(n-=f(x.last.css("margin-"+q)),n>p&&(this.tail=n-p)),this},_position:function(a){var c=this._first,e=c.position()[this.lt],f=this.options("center"),h=f?this.clipping()/2-this.dimension(c)/2:0;return this.rtl&&!this.vertical?(e-=this.relative?this.list().width()-this.dimension(c):this.clipping()-this.dimension(c),e+=h):e-=h,!f&&(this.index(a)>this.index(c)||this.inTail)&&this.tail?
(e=this.rtl&&!this.vertical?e-this.tail:e+this.tail,this.inTail=!0):this.inTail=!1,-e},_update:function(d){var c,e=this,f={target:this._target||a(),first:this._first||a(),last:this._last||a(),visible:this._visible||a(),fullyvisible:this._fullyvisible||a()},h=this.index(d.first||f.first)<this.index(f.first),b=function(b){var c=[],p=[];d[b].each(function(){0>f[b].index(this)&&c.push(this)});f[b].each(function(){0>d[b].index(this)&&p.push(this)});h?c=c.reverse():p=p.reverse();e._trigger(b+"in",a(c));
e._trigger(b+"out",a(p));e["_"+b]=d[b]};for(c in d)b(c);return this}})})(jQuery,window);
(function(a){a.jcarousel.fn.scrollIntoView=function(e,f,d){var c;e=a.jCarousel.parseTarget(e);var k=this.index(this._fullyvisible.first()),g=this.index(this._fullyvisible.last());if(c=e.relative?0>e.target?Math.max(0,k+e.target):g+e.target:"object"!=typeof e.target?e.target:this.index(e.target),k>c)return this.scroll(c,f,d);if(c>=k&&g>=c)return a.isFunction(d)&&d.call(this,!1),this;var h,g=this.items();e=this.clipping();for(var b=this.vertical?"bottom":this.rtl?"left":"right",k=0;h=g.eq(c),0!==h.length;){if(k+=
this.dimension(h),k>=e){h=parseFloat(h.css("margin-"+b))||0;k-h!==e&&c++;break}if(0>=c)break;c--}return this.scroll(c,f,d)}})(jQuery);
(function(a){a.jCarousel.plugin("jcarouselControl",{_options:{target:"+=1",event:"click",method:"scroll"},_active:null,_init:function(){this.onDestroy=a.proxy(function(){this._destroy();this.carousel().one("jcarousel:createend",a.proxy(this._create,this))},this);this.onReload=a.proxy(this._reload,this);this.onEvent=a.proxy(function(e){e.preventDefault();e=this.options("method");a.isFunction(e)?e.call(this):this.carousel().jcarousel(this.options("method"),this.options("target"))},this)},_create:function(){this.carousel().one("jcarousel:destroy",
this.onDestroy).on("jcarousel:reloadend jcarousel:scrollend",this.onReload);this._element.on(this.options("event")+".jcarouselcontrol",this.onEvent);this._reload()},_destroy:function(){this._element.off(".jcarouselcontrol",this.onEvent);this.carousel().off("jcarousel:destroy",this.onDestroy).off("jcarousel:reloadend jcarousel:scrollend",this.onReload)},_reload:function(){var e,f=a.jCarousel.parseTarget(this.options("target"));e=this.carousel();f.relative?e=e.jcarousel(0<f.target?"hasNext":"hasPrev"):
(f="object"!=typeof f.target?e.jcarousel("items").eq(f.target):f.target,e=0<=e.jcarousel("target").index(f));return this._active!==e&&(this._trigger(e?"active":"inactive"),this._active=e),this}})})(jQuery);
(function(a){a.jCarousel.plugin("jcarouselPagination",{_options:{perPage:null,item:function(a){return'<a href="#'+a+'">'+a+"</a>"},event:"click",method:"scroll"},_carouselItems:null,_pages:{},_items:{},_currentPage:null,_init:function(){this.onDestroy=a.proxy(function(){this._destroy();this.carousel().one("jcarousel:createend",a.proxy(this._create,this))},this);this.onReload=a.proxy(this._reload,this);this.onScroll=a.proxy(this._update,this)},_create:function(){this.carousel().one("jcarousel:destroy",
this.onDestroy).on("jcarousel:reloadend",this.onReload).on("jcarousel:scrollend",this.onScroll);this._reload()},_destroy:function(){this._clear();this.carousel().off("jcarousel:destroy",this.onDestroy).off("jcarousel:reloadend",this.onReload).off("jcarousel:scrollend",this.onScroll);this._carouselItems=null},_reload:function(){var e=this.options("perPage");if(this._pages={},this._items={},a.isFunction(e)&&(e=e.call(this)),null==e)this._pages=this._calculatePages();else for(var f,e=parseInt(e,10)||
0,d=this._getCarouselItems(),c=1,k=0;f=d.eq(k++),0!==f.length;)this._pages[c]=this._pages[c]?this._pages[c].add(f):f,0===k%e&&c++;this._clear();var g=this,h=this.carousel().data("jcarousel"),b=this._element,m=this.options("item"),n=this._getCarouselItems().length;a.each(this._pages,function(c,d){var e=g._items[c]=a(m.call(g,c,d));e.on(g.options("event")+".jcarouselpagination",a.proxy(function(){var a=d.eq(0);if(h.circular){var b=h.index(h.target()),e=h.index(a);parseFloat(c)>parseFloat(g._currentPage)?
b>e&&(a="+="+(n-b+e)):e>b&&(a="-="+(b+(n-e)))}h[this.options("method")](a)},g));b.append(e)});this._update()},_update:function(){var e,f=this.carousel().jcarousel("target");a.each(this._pages,function(a,c){return c.each(function(){return f.is(this)?(e=a,!1):void 0}),e?!1:void 0});this._currentPage!==e&&(this._trigger("inactive",this._items[this._currentPage]),this._trigger("active",this._items[e]));this._currentPage=e},items:function(){return this._items},reloadCarouselItems:function(){return this._carouselItems=
null,this},_clear:function(){this._element.empty();this._currentPage=null},_calculatePages:function(){for(var a,f=this.carousel().data("jcarousel"),d=this._getCarouselItems(),c=f.clipping(),k=0,g=0,h=1,b={};a=d.eq(g++),0!==a.length;)b[h]=b[h]?b[h].add(a):a,k+=f.dimension(a),k>=c&&(h++,k=0);return b},_getCarouselItems:function(){return this._carouselItems||(this._carouselItems=this.carousel().jcarousel("items")),this._carouselItems}})})(jQuery);
(function(a){a.jCarousel.plugin("jcarouselAutoscroll",{_options:{target:"+=1",interval:3E3,autostart:!0},_timer:null,_init:function(){this.onDestroy=a.proxy(function(){this._destroy();this.carousel().one("jcarousel:createend",a.proxy(this._create,this))},this);this.onAnimateEnd=a.proxy(this.start,this)},_create:function(){this.carousel().one("jcarousel:destroy",this.onDestroy);this.options("autostart")&&this.start()},_destroy:function(){this.stop();this.carousel().off("jcarousel:destroy",this.onDestroy)},
start:function(){return this.stop(),this.carousel().one("jcarousel:animateend",this.onAnimateEnd),this._timer=setTimeout(a.proxy(function(){this.carousel().jcarousel("scroll",this.options("target"))},this),this.options("interval")),this},stop:function(){return this._timer&&(this._timer=clearTimeout(this._timer)),this.carousel().off("jcarousel:animateend",this.onAnimateEnd),this}})})(jQuery);
(function(a){a.jGrowl=function(e,f){0==a("#jGrowl").size()&&a('<div id="jGrowl"></div>').addClass(f&&f.position?f.position:a.jGrowl.defaults.position).appendTo("body");a("#jGrowl").jGrowl(e,f)};a.fn.jGrowl=function(e,f){if(a.isFunction(this.each)){var d=arguments;return this.each(function(){void 0==a(this).data("jGrowl.instance")&&(a(this).data("jGrowl.instance",a.extend(new a.fn.jGrowl,{notifications:[],element:null,interval:null})),a(this).data("jGrowl.instance").startup(this));a.isFunction(a(this).data("jGrowl.instance")[e])?
a(this).data("jGrowl.instance")[e].apply(a(this).data("jGrowl.instance"),a.makeArray(d).slice(1)):a(this).data("jGrowl.instance").create(e,f)})}};a.extend(a.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:!1,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3E3,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:!0,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(a,f,d){},beforeOpen:function(a,
f,d){},afterOpen:function(a,f,d){},open:function(a,f,d){},beforeClose:function(a,f,d){},close:function(a,f,d){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(e,f){f=a.extend({},this.defaults,f);"undefined"!==typeof f.speed&&(f.openDuration=f.speed,f.closeDuration=f.speed);this.notifications.push({message:e,options:f});f.log.apply(this.element,[this.element,e,f])},render:function(e){var f=this,d=e.message,c=e.options;c.themeState=
""==c.themeState?"":"ui-state-"+c.themeState;e=a('<div class="jGrowl-notification '+c.themeState+" ui-corner-all"+(void 0!=c.group&&""!=c.group?" "+c.group:"")+'"><div class="jGrowl-close">'+c.closeTemplate+'</div><div class="jGrowl-header">'+c.header+'</div><div class="jGrowl-message">'+d+"</div></div>").data("jGrowl",c).addClass(c.theme).children("div.jGrowl-close").bind("click.jGrowl",function(){a(this).parent().trigger("jGrowl.close")}).parent();a(e).bind("mouseover.jGrowl",function(){a("div.jGrowl-notification",
f.element).data("jGrowl.pause",!0)}).bind("mouseout.jGrowl",function(){a("div.jGrowl-notification",f.element).data("jGrowl.pause",!1)}).bind("jGrowl.beforeOpen",function(){0!=c.beforeOpen.apply(e,[e,d,c,f.element])&&a(this).trigger("jGrowl.open")}).bind("jGrowl.open",function(){0!=c.open.apply(e,[e,d,c,f.element])&&("after"==c.glue?a("div.jGrowl-notification:last",f.element).after(e):a("div.jGrowl-notification:first",f.element).before(e),a(this).animate(c.animateOpen,c.openDuration,c.easing,function(){!a.browser.msie||
1!==parseInt(a(this).css("opacity"),10)&&0!==parseInt(a(this).css("opacity"),10)||this.style.removeAttribute("filter");null!=a(this).data("jGrowl")&&(a(this).data("jGrowl").created=new Date);a(this).trigger("jGrowl.afterOpen")}))}).bind("jGrowl.afterOpen",function(){c.afterOpen.apply(e,[e,d,c,f.element])}).bind("jGrowl.beforeClose",function(){0!=c.beforeClose.apply(e,[e,d,c,f.element])&&a(this).trigger("jGrowl.close")}).bind("jGrowl.close",function(){a(this).data("jGrowl.pause",!0);a(this).animate(c.animateClose,
c.closeDuration,c.easing,function(){a.isFunction(c.close)?!1!==c.close.apply(e,[e,d,c,f.element])&&a(this).remove():a(this).remove()})}).trigger("jGrowl.beforeOpen");""!=c.corners&&void 0!=a.fn.corner&&a(e).corner(c.corners);1<a("div.jGrowl-notification:parent",f.element).size()&&0==a("div.jGrowl-closer",f.element).size()&&0!=this.defaults.closer&&a(this.defaults.closerTemplate).addClass("jGrowl-closer "+this.defaults.themeState+" ui-corner-all").addClass(this.defaults.theme).appendTo(f.element).animate(this.defaults.animateOpen,
this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){a(this).siblings().trigger("jGrowl.beforeClose");a.isFunction(f.defaults.closer)&&f.defaults.closer.apply(a(this).parent()[0],[a(this).parent()[0]])})},update:function(){a(this.element).find("div.jGrowl-notification:parent").each(function(){void 0!=a(this).data("jGrowl")&&void 0!=a(this).data("jGrowl").created&&a(this).data("jGrowl").created.getTime()+parseInt(a(this).data("jGrowl").life)<(new Date).getTime()&&1!=a(this).data("jGrowl").sticky&&
(void 0==a(this).data("jGrowl.pause")||1!=a(this).data("jGrowl.pause"))&&a(this).trigger("jGrowl.beforeClose")});0<this.notifications.length&&(0==this.defaults.pool||a(this.element).find("div.jGrowl-notification:parent").size()<this.defaults.pool)&&this.render(this.notifications.shift());2>a(this.element).find("div.jGrowl-notification:parent").size()&&a(this.element).find("div.jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){a(this).remove()})},
startup:function(e){this.element=a(e).addClass("jGrowl").append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){a(e).data("jGrowl.instance").update()},parseInt(this.defaults.check));a.browser.msie&&7>parseInt(a.browser.version)&&!window.XMLHttpRequest&&a(this.element).addClass("ie6")},shutdown:function(){a(this.element).removeClass("jGrowl").find("div.jGrowl-notification").remove();clearInterval(this.interval)},close:function(){a(this.element).find("div.jGrowl-notification").each(function(){a(this).trigger("jGrowl.beforeClose")})}});
a.jGrowl.defaults=a.fn.jGrowl.prototype.defaults})(jQuery);
(function(a){var e=function(e,d){this.settings=d;this.checkSettings();this.entries=this.imgAnalyzerTimeout=null;this.buildingRow={entriesBuff:[],width:0,aspectRatio:0};this.lastAnalyzedIndex=-1;this.yield={every:2,flushed:0};this.border=0<=d.border?d.border:d.margins;this.maxRowHeight=this.retrieveMaxRowHeight();this.suffixRanges=this.retrieveSuffixRanges();this.offY=this.border;this.spinner={phase:0,timeSlot:150,$el:a('<div class="spinner"><span></span><span></span><span></span></div>'),intervalId:null};
this.checkWidthIntervalId=null;this.galleryWidth=e.width();this.$gallery=e};e.prototype.getSuffix=function(a,d){var c,e;c=a>d?a:d;for(e=0;e<this.suffixRanges.length;e++)if(c<=this.suffixRanges[e])return this.settings.sizeRangeSuffixes[this.suffixRanges[e]];return this.settings.sizeRangeSuffixes[this.suffixRanges[e-1]]};e.prototype.removeSuffix=function(a,d){return a.substring(0,a.length-d.length)};e.prototype.endsWith=function(a,d){return-1!==a.indexOf(d,a.length-d.length)};e.prototype.getUsedSuffix=
function(a){for(var d in this.settings.sizeRangeSuffixes)if(this.settings.sizeRangeSuffixes.hasOwnProperty(d)&&0!==this.settings.sizeRangeSuffixes[d].length&&this.endsWith(a,this.settings.sizeRangeSuffixes[d]))return this.settings.sizeRangeSuffixes[d];return""};e.prototype.newSrc=function(a,d,c){var e=a.match(this.settings.extension),e=null!==e?e[0]:"";a=a.replace(this.settings.extension,"");a=this.removeSuffix(a,this.getUsedSuffix(a));return a+=this.getSuffix(d,c)+e};e.prototype.showImg=function(a,
d){this.settings.cssAnimation?(a.addClass("entry-visible"),d&&d()):a.stop().fadeTo(this.settings.imagesAnimationDuration,1,d)};e.prototype.extractImgSrcFromImage=function(a){var d="undefined"!==typeof a.data("safe-src")?a.data("safe-src"):a.attr("src");a.data("jg.originalSrc",d);return d};e.prototype.imgFromEntry=function(a){var d=a.find("> img");0===d.length&&(d=a.find("> a > img"));return 0===d.length?null:d};e.prototype.captionFromEntry=function(a){a=a.find("> .caption");return 0===a.length?null:
a};e.prototype.displayEntry=function(e,d,c,k,g,h){e.width(k);e.height(h);e.css("top",c);e.css("left",d);var b=this.imgFromEntry(e);if(null!==b){b.css("width",k);b.css("height",g);b.css("margin-left",-k/2);b.css("margin-top",-g/2);var m=b.attr("src"),n=this.newSrc(m,k,g);b.one("error",function(){b.attr("src",b.data("jg.originalSrc"))});var p=function(){m!==n&&b.attr("src",n)};if("skipped"===e.data("jg.loaded"))this.onImageEvent(m,a.proxy(function(){this.showImg(e,p);e.data("jg.loaded",!0)},this));
else this.showImg(e,p)}else this.showImg(e);this.displayEntryCaption(e)};e.prototype.displayEntryCaption=function(e){var d=this.imgFromEntry(e);if(null!==d&&this.settings.captions){var c=this.captionFromEntry(e);null===c&&(d=d.attr("alt"),this.isValidCaption(d)||(d=e.attr("title")),this.isValidCaption(d)&&(c=a('<div class="caption">'+d+"</div>"),e.append(c),e.data("jg.createdCaption",!0)));null!==c&&(this.settings.cssAnimation||c.stop().fadeTo(0,this.settings.captionSettings.nonVisibleOpacity),this.addCaptionEventsHandlers(e))}else this.removeCaptionEventsHandlers(e)};
e.prototype.isValidCaption=function(a){return"undefined"!==typeof a&&0<a.length};e.prototype.onEntryMouseEnterForCaption=function(e){e=this.captionFromEntry(a(e.currentTarget));this.settings.cssAnimation?e.addClass("caption-visible").removeClass("caption-hidden"):e.stop().fadeTo(this.settings.captionSettings.animationDuration,this.settings.captionSettings.visibleOpacity)};e.prototype.onEntryMouseLeaveForCaption=function(e){e=this.captionFromEntry(a(e.currentTarget));this.settings.cssAnimation?e.removeClass("caption-visible").removeClass("caption-hidden"):
e.stop().fadeTo(this.settings.captionSettings.animationDuration,this.settings.captionSettings.nonVisibleOpacity)};e.prototype.addCaptionEventsHandlers=function(e){var d=e.data("jg.captionMouseEvents");"undefined"===typeof d&&(d={mouseenter:a.proxy(this.onEntryMouseEnterForCaption,this),mouseleave:a.proxy(this.onEntryMouseLeaveForCaption,this)},e.on("mouseenter",void 0,void 0,d.mouseenter),e.on("mouseleave",void 0,void 0,d.mouseleave),e.data("jg.captionMouseEvents",d))};e.prototype.removeCaptionEventsHandlers=
function(a){var d=a.data("jg.captionMouseEvents");"undefined"!==typeof d&&(a.off("mouseenter",void 0,d.mouseenter),a.off("mouseleave",void 0,d.mouseleave),a.removeData("jg.captionMouseEvents"))};e.prototype.prepareBuildingRow=function(a){var d,c,e,g=!0,h=0,b=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*this.settings.margins,m=b/this.buildingRow.aspectRatio;d=this.buildingRow.width/b>this.settings.justifyThreshold;if(a&&"hide"===this.settings.lastRow&&!d){for(a=0;a<this.buildingRow.entriesBuff.length;a++)d=
this.buildingRow.entriesBuff[a],this.settings.cssAnimation?d.removeClass("entry-visible"):d.stop().fadeTo(0,0);return-1}a&&!d&&"justify"!==this.settings.lastRow&&"hide"!==this.settings.lastRow&&(g=!1);for(a=0;a<this.buildingRow.entriesBuff.length;a++)if(d=this.buildingRow.entriesBuff[a],c=d.data("jg.width")/d.data("jg.height"),g?(c=a===this.buildingRow.entriesBuff.length-1?b:m*c,e=m):(c*=this.settings.rowHeight,e=this.settings.rowHeight),b-=Math.round(c),d.data("jg.jwidth",Math.round(c)),d.data("jg.jheight",
Math.ceil(e)),0===a||h>e)h=e;this.settings.fixedHeight&&h>this.settings.rowHeight&&(h=this.settings.rowHeight);return{minHeight:h,justify:g}};e.prototype.clearBuildingRow=function(){this.buildingRow.entriesBuff=[];this.buildingRow.aspectRatio=0;this.buildingRow.width=0};e.prototype.flushRow=function(a){var d=this.settings,c,e,g,h=this.border,b;g=this.prepareBuildingRow(a);e=g.minHeight;if(a&&"hide"===d.lastRow&&-1===e)this.clearBuildingRow();else{this.maxRowHeight.percentage?this.maxRowHeight.value*
d.rowHeight<e&&(e=this.maxRowHeight.value*d.rowHeight):0<this.maxRowHeight.value&&this.maxRowHeight.value<e&&(e=this.maxRowHeight.value);if("center"===d.lastRow||"right"===d.lastRow){var m=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*d.margins;for(b=0;b<this.buildingRow.entriesBuff.length;b++)c=this.buildingRow.entriesBuff[b],m-=c.data("jg.jwidth");"center"===d.lastRow?h+=m/2:"right"===d.lastRow&&(h+=m)}for(b=0;b<this.buildingRow.entriesBuff.length;b++)c=this.buildingRow.entriesBuff[b],
this.displayEntry(c,h,this.offY,c.data("jg.jwidth"),c.data("jg.jheight"),e),h+=c.data("jg.jwidth")+d.margins;this.$gallery.height(this.offY+e+this.border+(this.isSpinnerActive()?this.getSpinnerHeight():0));if(!a||e<=d.rowHeight&&g.justify)this.offY+=e+d.margins,this.clearBuildingRow(),this.$gallery.trigger("jg.rowflush")}};e.prototype.checkWidth=function(){this.checkWidthIntervalId=setInterval(a.proxy(function(){var a=parseFloat(this.$gallery.width());Math.abs(a-this.galleryWidth)>this.settings.refreshSensitivity&&
(this.galleryWidth=a,this.rewind(),this.startImgAnalyzer(!0))},this),this.settings.refreshTime)};e.prototype.isSpinnerActive=function(){return null!==this.spinner.intervalId};e.prototype.getSpinnerHeight=function(){return this.spinner.$el.innerHeight()};e.prototype.stopLoadingSpinnerAnimation=function(){clearInterval(this.spinner.intervalId);this.spinner.intervalId=null;this.$gallery.height(this.$gallery.height()-this.getSpinnerHeight());this.spinner.$el.detach()};e.prototype.startLoadingSpinnerAnimation=
function(){var a=this.spinner,d=a.$el.find("span");clearInterval(a.intervalId);this.$gallery.append(a.$el);this.$gallery.height(this.offY+this.getSpinnerHeight());a.intervalId=setInterval(function(){a.phase<d.length?d.eq(a.phase).fadeTo(a.timeSlot,1):d.eq(a.phase-d.length).fadeTo(a.timeSlot,0);a.phase=(a.phase+1)%(2*d.length)},a.timeSlot)};e.prototype.rewind=function(){this.lastAnalyzedIndex=-1;this.offY=this.border;this.clearBuildingRow()};e.prototype.hideBuildingRowImages=function(){for(var a=0;a<
this.buildingRow.entriesBuff.length;a++)this.settings.cssAnimation?this.buildingRow.entriesBuff[a].removeClass("entry-visible"):this.buildingRow.entriesBuff[a].stop().fadeTo(0,0)};e.prototype.updateEntries=function(e){this.entries=this.$gallery.find(this.settings.selector).toArray();if(0===this.entries.length)return!1;this.settings.filter?this.modifyEntries(this.filterArray,e):this.modifyEntries(this.resetFilters,e);a.isFunction(this.settings.sort)?this.modifyEntries(this.sortArray,e):this.settings.randomize&&
this.modifyEntries(this.shuffleArray,e);return!0};e.prototype.insertToGallery=function(e){var d=this;a.each(e,function(){a(this).appendTo(d.$gallery)})};e.prototype.shuffleArray=function(a){var d,c,e;for(d=a.length-1;0<d;d--)c=Math.floor(Math.random()*(d+1)),e=a[d],a[d]=a[c],a[c]=e;this.insertToGallery(a);return a};e.prototype.sortArray=function(a){a.sort(this.settings.sort);this.insertToGallery(a);return a};e.prototype.resetFilters=function(e){for(var d=0;d<e.length;d++)a(e[d]).removeClass("jg-filtered");
return e};e.prototype.filterArray=function(e){var d=this.settings;if("string"===a.type(d.filter))return e.filter(function(c){c=a(c);if(c.is(d.filter))return c.removeClass("jg-filtered"),!0;c.addClass("jg-filtered");return!1});if(a.isFunction(d.filter))return e.filter(d.filter)};e.prototype.modifyEntries=function(a,d){var c=d?this.entries.splice(this.lastAnalyzedIndex+1,this.entries.length-this.lastAnalyzedIndex-1):this.entries,c=a.call(this,c);this.entries=d?this.entries.concat(c):c};e.prototype.destroy=
function(){clearInterval(this.checkWidthIntervalId);a.each(this.entries,a.proxy(function(e,d){var c=a(d);c.css("width","");c.css("height","");c.css("top","");c.css("left","");c.data("jg.loaded",void 0);c.removeClass("jg-entry");var k=this.imgFromEntry(c);k.css("width","");k.css("height","");k.css("margin-left","");k.css("margin-top","");k.attr("src",k.data("jg.originalSrc"));k.data("jg.originalSrc",void 0);this.removeCaptionEventsHandlers(c);k=this.captionFromEntry(c);c.data("jg.createdCaption")?
(c.data("jg.createdCaption",void 0),null!==k&&k.remove()):null!==k&&k.fadeTo(0,1)},this));this.$gallery.css("height","");this.$gallery.removeClass("justified-gallery");this.$gallery.data("jg.controller",void 0)};e.prototype.analyzeImages=function(e){for(var d=this.lastAnalyzedIndex+1;d<this.entries.length;d++){var c=a(this.entries[d]);if(!0===c.data("jg.loaded")||"skipped"===c.data("jg.loaded")){var k=this.galleryWidth-2*this.border-(this.buildingRow.entriesBuff.length-1)*this.settings.margins,g=
c.data("jg.width")/c.data("jg.height");if(k/(this.buildingRow.aspectRatio+g)<this.settings.rowHeight&&(this.flushRow(!1),++this.yield.flushed>=this.yield.every)){this.startImgAnalyzer(e);return}this.buildingRow.entriesBuff.push(c);this.buildingRow.aspectRatio+=g;this.buildingRow.width+=g*this.settings.rowHeight;this.lastAnalyzedIndex=d}else if("error"!==c.data("jg.loaded"))return}0<this.buildingRow.entriesBuff.length&&this.flushRow(!0);this.isSpinnerActive()&&this.stopLoadingSpinnerAnimation();this.stopImgAnalyzerStarter();
this.$gallery.trigger(e?"jg.resize":"jg.complete")};e.prototype.stopImgAnalyzerStarter=function(){this.yield.flushed=0;null!==this.imgAnalyzerTimeout&&clearTimeout(this.imgAnalyzerTimeout)};e.prototype.startImgAnalyzer=function(a){var d=this;this.stopImgAnalyzerStarter();this.imgAnalyzerTimeout=setTimeout(function(){d.analyzeImages(a)},.001)};e.prototype.onImageEvent=function(e,d,c){if(d||c){var k=new Image,g=a(k);if(d)g.one("load",function(){g.off("load error");d(k)});if(c)g.one("error",function(){g.off("load error");
c(k)});k.src=e}};e.prototype.init=function(){var e=!1,d=!1,c=this;a.each(this.entries,function(k,g){var h=a(g),b=c.imgFromEntry(h);h.addClass("jg-entry");if(!0!==h.data("jg.loaded")&&"skipped"!==h.data("jg.loaded"))if(null!==c.settings.rel&&h.attr("rel",c.settings.rel),null!==c.settings.target&&h.attr("target",c.settings.target),null!==b){var m=c.extractImgSrcFromImage(b);b.attr("src",m);if(!1===c.settings.waitThumbnailsLoad){var n=parseFloat(b.attr("width")),b=parseFloat(b.attr("height"));if(!isNaN(n)&&
!isNaN(b))return h.data("jg.width",n),h.data("jg.height",b),h.data("jg.loaded","skipped"),d=!0,c.startImgAnalyzer(!1),!0}h.data("jg.loaded",!1);e=!0;c.isSpinnerActive()||c.startLoadingSpinnerAnimation();c.onImageEvent(m,function(a){h.data("jg.width",a.width);h.data("jg.height",a.height);h.data("jg.loaded",!0);c.startImgAnalyzer(!1)},function(){h.data("jg.loaded","error");c.startImgAnalyzer(!1)})}else h.data("jg.loaded",!0),h.data("jg.width",h.width()|parseFloat(h.css("width"))|1),h.data("jg.height",
h.height()|parseFloat(h.css("height"))|1)});e||d||this.startImgAnalyzer(!1);this.checkWidth()};e.prototype.checkOrConvertNumber=function(e,d){"string"===a.type(e[d])&&(e[d]=parseFloat(e[d]));if("number"===a.type(e[d])){if(isNaN(e[d]))throw"invalid number for "+d;}else throw d+" must be a number";};e.prototype.checkSizeRangesSuffixes=function(){if("object"!==a.type(this.settings.sizeRangeSuffixes))throw"sizeRangeSuffixes must be defined and must be an object";var e=[],d;for(d in this.settings.sizeRangeSuffixes)this.settings.sizeRangeSuffixes.hasOwnProperty(d)&&
e.push(d);d={0:""};for(var c=0;c<e.length;c++)if("string"===a.type(e[c]))try{var k=parseInt(e[c].replace(/^[a-z]+/,""),10);d[k]=this.settings.sizeRangeSuffixes[e[c]]}catch(g){throw"sizeRangeSuffixes keys must contains correct numbers ("+g+")";}else d[e[c]]=this.settings.sizeRangeSuffixes[e[c]];this.settings.sizeRangeSuffixes=d};e.prototype.retrieveMaxRowHeight=function(){var e={};if("string"===a.type(this.settings.maxRowHeight))this.settings.maxRowHeight.match(/^[0-9]+%$/)?(e.value=parseFloat(this.settings.maxRowHeight.match(/^([0-9])+%$/)[1])/
100,e.percentage=!1):(e.value=parseFloat(this.settings.maxRowHeight),e.percentage=!0);else if("number"===a.type(this.settings.maxRowHeight))e.value=this.settings.maxRowHeight,e.percentage=!1;else throw"maxRowHeight must be a number or a percentage";if(isNaN(e.value))throw"invalid number for maxRowHeight";e.percentage?100>e.value&&(e.value=100):0<e.value&&e.value<this.settings.rowHeight&&(e.value=this.settings.rowHeight);return e};e.prototype.checkSettings=function(){this.checkSizeRangesSuffixes();
this.checkOrConvertNumber(this.settings,"rowHeight");this.checkOrConvertNumber(this.settings,"margins");this.checkOrConvertNumber(this.settings,"border");if("justify"!==this.settings.lastRow&&"nojustify"!==this.settings.lastRow&&"left"!==this.settings.lastRow&&"center"!==this.settings.lastRow&&"right"!==this.settings.lastRow&&"hide"!==this.settings.lastRow)throw'lastRow must be "justify", "nojustify", "left", "center", "right" or "hide"';this.checkOrConvertNumber(this.settings,"justifyThreshold");
if(0>this.settings.justifyThreshold||1<this.settings.justifyThreshold)throw"justifyThreshold must be in the interval [0,1]";if("boolean"!==a.type(this.settings.cssAnimation))throw"cssAnimation must be a boolean";if("boolean"!==a.type(this.settings.captions))throw"captions must be a boolean";this.checkOrConvertNumber(this.settings.captionSettings,"animationDuration");this.checkOrConvertNumber(this.settings.captionSettings,"visibleOpacity");if(0>this.settings.captionSettings.visibleOpacity||1<this.settings.captionSettings.visibleOpacity)throw"captionSettings.visibleOpacity must be in the interval [0, 1]";
this.checkOrConvertNumber(this.settings.captionSettings,"nonVisibleOpacity");if(0>this.settings.captionSettings.nonVisibleOpacity||1<this.settings.captionSettings.nonVisibleOpacity)throw"captionSettings.nonVisibleOpacity must be in the interval [0, 1]";if("boolean"!==a.type(this.settings.fixedHeight))throw"fixedHeight must be a boolean";this.checkOrConvertNumber(this.settings,"imagesAnimationDuration");this.checkOrConvertNumber(this.settings,"refreshTime");this.checkOrConvertNumber(this.settings,
"refreshSensitivity");if("boolean"!==a.type(this.settings.randomize))throw"randomize must be a boolean";if("string"!==a.type(this.settings.selector))throw"selector must be a string";if(!1!==this.settings.sort&&!a.isFunction(this.settings.sort))throw"sort must be false or a comparison function";if(!1!==this.settings.filter&&!a.isFunction(this.settings.filter)&&"string"!==a.type(this.settings.filter))throw"filter must be false, a string or a filter function";};e.prototype.retrieveSuffixRanges=function(){var a=
[],d;for(d in this.settings.sizeRangeSuffixes)this.settings.sizeRangeSuffixes.hasOwnProperty(d)&&a.push(parseInt(d,10));a.sort(function(a,d){return a>d?1:a<d?-1:0});return a};e.prototype.updateSettings=function(e){this.settings=a.extend({},this.settings,e);this.checkSettings();this.border=0<=this.settings.border?this.settings.border:this.settings.margins;this.maxRowHeight=this.retrieveMaxRowHeight();this.suffixRanges=this.retrieveSuffixRanges()};a.fn.justifiedGallery=function(f){return this.each(function(d,
c){var k=a(c);k.addClass("justified-gallery");var g=k.data("jg.controller");if("undefined"===typeof g){if("undefined"!==typeof f&&null!==f&&"object"!==a.type(f))throw"The argument must be an object";g=new e(k,a.extend({},a.fn.justifiedGallery.defaults,f));k.data("jg.controller",g)}else if("norewind"===f)g.hideBuildingRowImages();else{if("destroy"===f){g.destroy();return}g.updateSettings(f);g.rewind()}g.updateEntries("norewind"===f)&&g.init()})};a.fn.justifiedGallery.defaults={sizeRangeSuffixes:{},
rowHeight:120,maxRowHeight:"200%",margins:1,border:-1,lastRow:"nojustify",justifyThreshold:.75,fixedHeight:!1,waitThumbnailsLoad:!0,captions:!0,cssAnimation:!1,imagesAnimationDuration:500,captionSettings:{animationDuration:500,visibleOpacity:.7,nonVisibleOpacity:0},rel:null,target:null,extension:/\.[^.\\/]+$/,refreshTime:100,refreshSensitivity:0,randomize:!1,sort:!1,filter:!1,selector:"> a, > div:not(.spinner)"}})(jQuery);
(function(a,e){$window=a(e);a.fn.lazyload=function(f){function d(){var d=0;c.each(function(){var c=a(this);if(!(k.skip_invisible&&!c.is(":visible")||a.abovethetop(this,k)||a.leftofbegin(this,k)))if(!a.belowthefold(this,k)&&!a.rightoffold(this,k))c.trigger("appear");else if(++d>k.failure_limit)return!1})}var c=this,k={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:e,data_attribute:"original",skip_invisible:!0,appear:null,load:null};return f&&(void 0!==f.failurelimit&&(f.failure_limit=
f.failurelimit,delete f.failurelimit),void 0!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(k,f)),$container=void 0===k.container||k.container===e?$window:a(k.container),0===k.event.indexOf("scroll")&&$container.bind(k.event,function(a){return d()}),this.each(function(){var d=this,e=a(d);d.loaded=!1;e.one("appear",function(){this.loaded||(k.appear&&k.appear.call(d,c.length,k),a("<img />").bind("load",function(){e.hide().attr("src",e.data(k.data_attribute))[k.effect](k.effect_speed);
d.loaded=!0;var b=a.grep(c,function(a){return!a.loaded});c=a(b);k.load&&k.load.call(d,c.length,k)}).attr("src",e.data(k.data_attribute)))});0!==k.event.indexOf("scroll")&&e.bind(k.event,function(a){d.loaded||e.trigger("appear")})}),$window.bind("resize",function(a){d()}),d(),this};a.belowthefold=function(f,d){var c;return void 0===d.container||d.container===e?c=$window.height()+$window.scrollTop():c=$container.offset().top+$container.height(),c<=a(f).offset().top-d.threshold};a.rightoffold=function(f,
d){var c;return void 0===d.container||d.container===e?c=$window.width()+$window.scrollLeft():c=$container.offset().left+$container.width(),c<=a(f).offset().left-d.threshold};a.abovethetop=function(f,d){var c;return void 0===d.container||d.container===e?c=$window.scrollTop():c=$container.offset().top,c>=a(f).offset().top+d.threshold+a(f).height()};a.leftofbegin=function(f,d){var c;return void 0===d.container||d.container===e?c=$window.scrollLeft():c=$container.offset().left,c>=a(f).offset().left+d.threshold+
a(f).width()};a.inviewport=function(e,d){return!a.rightofscreen(e,d)&&!a.leftofscreen(e,d)&&!a.belowthefold(e,d)&&!a.abovethetop(e,d)};a.extend(a.expr[":"],{"below-the-fold":function(f){return a.belowthefold(f,{threshold:0,container:e})},"above-the-top":function(f){return!a.belowthefold(f,{threshold:0,container:e})},"right-of-screen":function(f){return a.rightoffold(f,{threshold:0,container:e})},"left-of-screen":function(f){return!a.rightoffold(f,{threshold:0,container:e})},"in-viewport":function(f){return!a.inviewport(f,
{threshold:0,container:e})},"above-the-fold":function(f){return!a.belowthefold(f,{threshold:0,container:e})},"right-of-fold":function(f){return a.rightoffold(f,{threshold:0,container:e})},"left-of-fold":function(f){return!a.rightoffold(f,{threshold:0,container:e})}})})(jQuery,window);
(function(a){function e(c){var d=c||window.event,e=[].slice.call(arguments,1),f=0,b=0,m;c=a.event.fix(d);c.type="mousewheel";d.wheelDelta&&(f=d.wheelDelta/120);d.detail&&(f=-d.detail/3);m=f;void 0!==d.axis&&d.axis===d.HORIZONTAL_AXIS&&(m=0,b=-1*f);void 0!==d.wheelDeltaY&&(m=d.wheelDeltaY/120);void 0!==d.wheelDeltaX&&(b=-1*d.wheelDeltaX/120);e.unshift(c,f,b,m);return(a.event.dispatch||a.event.handle).apply(this,e)}var f=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var d=f.length;d;)a.event.fixHooks[f[--d]]=
a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=f.length;a;)this.addEventListener(f[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=f.length;a;)this.removeEventListener(f[--a],e,!1);else this.onmousewheel=null}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
(function(a,e,f){function d(a){var b={},c=/^jQuery\d+$/;f.each(a.attributes,function(a,d){d.specified&&!c.test(d.name)&&(b[d.name]=d.value)});return b}function c(a,b){var c=f(this),d;if(this.value==c.attr("placeholder")&&c.hasClass("placeholder")){d=this==e.activeElement;if(c.data("placeholder-password")){c=c.hide().next().show().attr("id",c.removeAttr("id").data("placeholder-id"));if(!0===a)return c[0].value=b;c.focus()}else this.value="",c.removeClass("placeholder");d&&this.select()}}function k(){var a,
b=f(this),e=this.id;if(""==this.value){if("password"==this.type){if(!b.data("placeholder-textinput")){try{a=b.clone().attr({type:"text"})}catch(g){a=f("<input>").attr(f.extend(d(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":e}).bind("focus.placeholder",c);b.data({"placeholder-textinput":a,"placeholder-id":e}).before(a)}b=b.removeAttr("id").hide().prev().attr("id",e).show()}b.addClass("placeholder");b[0].value=b.attr("placeholder")}else b.removeClass("placeholder")}
var g="placeholder"in e.createElement("input"),h="placeholder"in e.createElement("textarea"),b=f.fn,m=f.valHooks;g&&h?(b=b.placeholder=function(){return this},b.input=b.textarea=!0):(b=b.placeholder=function(){this.filter((g?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":c,"blur.placeholder":k}).data("placeholder-enabled",!0).trigger("blur.placeholder");return this},b.input=g,b.textarea=h,b={get:function(a){var b=f(a);return b.data("placeholder-enabled")&&b.hasClass("placeholder")?
"":a.value},set:function(a,b){var d=f(a);if(!d.data("placeholder-enabled"))return a.value=b;""==b?(a.value=b,a!=e.activeElement&&k.call(a)):d.hasClass("placeholder")?c.call(a,!0,b)||(a.value=b):a.value=b;return d}},g||(m.input=b),h||(m.textarea=b),f(function(){f(e).delegate("form","submit.placeholder",function(){var a=f(".placeholder",this).each(c);setTimeout(function(){a.each(k)},10)})}),f(a).bind("beforeunload.placeholder",function(){f(".placeholder").each(function(){this.value=""})}))})(this,document,
jQuery);
(function(a){function e(a){return"object"==typeof a?a:{top:a,left:a}}var f=a.scrollTo=function(d,c,e){a(window).scrollTo(d,c,e)};f.defaults={axis:"xy",duration:1.3<=parseFloat(a.fn.jquery)?0:1};f.window=function(d){return a(window)._scrollable()};a.fn._scrollable=function(){return this.map(function(){if(this.nodeName&&-1==a.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"]))return this;var d=(this.contentWindow||this).document||this.ownerDocument||this;return a.browser.safari||"BackCompat"==
d.compatMode?d.body:d.documentElement})};a.fn.scrollTo=function(d,c,k){"object"==typeof c&&(k=c,c=0);"function"==typeof k&&(k={onAfter:k});"max"==d&&(d=9E9);k=a.extend({},f.defaults,k);c=c||k.speed||k.duration;k.queue=k.queue&&1<k.axis.length;k.queue&&(c/=2);k.offset=e(k.offset);k.over=e(k.over);return this._scrollable().each(function(){function g(a){b.animate(p,c,k.easing,a&&function(){a.call(this,d,k)})}var h=this,b=a(h),m=d,n,p={},q=b.is("html,body");switch(typeof m){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(m)){m=
e(m);break}m=a(m,this);case "object":if(m.is||m.style)n=(m=a(m)).offset()}a.each(k.axis.split(""),function(a,c){var d="x"==c?"Left":"Top",e=d.toLowerCase(),w="scroll"+d,y=h[w],t=f.max(h,c);n?(p[w]=n[e]+(q?0:y-b.offset()[e]),k.margin&&(p[w]-=parseInt(m.css("margin"+d))||0,p[w]-=parseInt(m.css("border"+d+"Width"))||0),p[w]+=k.offset[e]||0,k.over[e]&&(p[w]+=m["x"==c?"width":"height"]()*k.over[e])):(d=m[e],p[w]=d.slice&&"%"==d.slice(-1)?parseFloat(d)/100*t:d);/^\d+$/.test(p[w])&&(p[w]=0>=p[w]?0:Math.min(p[w],
t));!a&&k.queue&&(y!=p[w]&&g(k.onAfterFirst),delete p[w])});g(k.onAfter)}).end()};f.max=function(d,c){var e="x"==c?"Width":"Height",g="scroll"+e;if(!a(d).is("html,body"))return d[g]-a(d)[e.toLowerCase()]();var e="client"+e,f=d.ownerDocument.documentElement,b=d.ownerDocument.body;return Math.max(f[g],b[g])-Math.min(f[e],b[e])}})(jQuery);
(function(a,e){"function"===typeof define&&define.amd?define("sifter",e):"object"===typeof exports?module.exports=e():a.Sifter=e()})(this,function(){var a=function(a,c){this.items=a;this.settings=c||{diacritics:!0}};a.prototype.tokenize=function(a){a=(String(a||"").toLowerCase()+"").replace(/^\s+|\s+$|/g,"");if(!a||!a.length)return[];var d,b,e,f=[],k=a.split(/ +/);a=0;for(d=k.length;a<d;a++){b=(k[a]+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");if(this.settings.diacritics)for(e in c)c.hasOwnProperty(e)&&
(b=b.replace(new RegExp(e,"g"),c[e]));f.push({string:k[a],regex:new RegExp(b,"i")})}return f};a.prototype.iterator=function(a,c){(d(a)?Array.prototype.forEach||function(a){for(var c=0,d=this.length;c<d;c++)a(this[c],c,this)}:function(a){for(var c in this)this.hasOwnProperty(c)&&a(this[c],c,this)}).apply(a,[c])};a.prototype.getScoreFunction=function(a,c){var b,d,e;a=this.prepareSearch(a,c);d=a.tokens;b=a.options.fields;e=d.length;var f=function(a,b){var c,d;if(!a)return 0;a=String(a||"");d=a.search(b.regex);
if(-1===d)return 0;c=b.string.length/a.length;0===d&&(c+=.5);return c},k=function(){var a=b.length;return a?1===a?function(a,c){return f(c[b[0]],a)}:function(c,d){for(var e=0,g=0;e<a;e++)g+=f(d[b[e]],c);return g/a}:function(){return 0}}();return e?1===e?function(a){return k(d[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,g=0;c<e;c++){b=k(d[c],a);if(0>=b)return 0;g+=b}return g/e}:function(a){for(var b=0,c=0;b<e;b++)c+=k(d[b],a);return c/e}:function(){return 0}};a.prototype.getSortFunction=
function(a,c){var b,d,f,k,q,u,x,v,r,w;f=this;a=f.prepareSearch(a,c);w=!a.query&&c.sort_empty||c.sort;r=function(a,b){return"$score"===a?b.score:f.items[b.id][a]};q=[];if(w)for(b=0,d=w.length;b<d;b++)(a.query||"$score"!==w[b].field)&&q.push(w[b]);if(a.query){w=!0;b=0;for(d=q.length;b<d;b++)if("$score"===q[b].field){w=!1;break}w&&q.unshift({field:"$score",direction:"desc"})}else for(b=0,d=q.length;b<d;b++)if("$score"===q[b].field){q.splice(b,1);break}v=[];b=0;for(d=q.length;b<d;b++)v.push("desc"===
q[b].direction?-1:1);return(u=q.length)?1===u?(k=q[0].field,x=v[0],function(a,b){return x*e(r(k,a),r(k,b))}):function(a,b){var c,d;for(c=0;c<u;c++)if(d=q[c].field,d=v[c]*e(r(d,a),r(d,b)))return d;return 0}:null};a.prototype.prepareSearch=function(a,c){if("object"===typeof a)return a;c=f({},c);var b=c.fields,e=c.sort,k=c.sort_empty;b&&!d(b)&&(c.fields=[b]);e&&!d(e)&&(c.sort=[e]);k&&!d(k)&&(c.sort_empty=[k]);return{options:c,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}};
a.prototype.search=function(a,c){var b,d,e,f;d=this.prepareSearch(a,c);c=d.options;a=d.query;f=c.score||this.getScoreFunction(d);a.length?this.iterator(this.items,function(a,e){b=f(a);(!1===c.filter||0<b)&&d.items.push({score:b,id:e})}):this.iterator(this.items,function(a,b){d.items.push({score:1,id:b})});(e=this.getSortFunction(d,c))&&d.items.sort(e);d.total=d.items.length;"number"===typeof c.limit&&(d.items=d.items.slice(0,c.limit));return d};var e=function(a,c){if("number"===typeof a&&"number"===
typeof c)return a>c?1:a<c?-1:0;a=k(String(a||""));c=k(String(c||""));return a>c?1:c>a?-1:0},f=function(a,c){var b,d,e,f;b=1;for(d=arguments.length;b<d;b++)if(f=arguments[b])for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e]);return a},d=Array.isArray||$&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},c={a:"[a]",c:"[c]",d:"[d]",e:"[e]",i:"[i]",l:"[l]",n:"[n]",o:"[o]",r:"[r]",s:"[s]",t:"[t]",
u:"[u]",y:"[y]",z:"[z]"},k=function(){var a,d,b,e,f="",k={};for(b in c)if(c.hasOwnProperty(b))for(e=c[b].substring(2,c[b].length-1),f+=e,a=0,d=e.length;a<d;a++)k[e.charAt(a)]=b;var q=new RegExp("["+f+"]","g");return function(a){return a.replace(q,function(a){return k[a]}).toLowerCase()}}();return a});
(function(a,e){"function"===typeof define&&define.amd?define("microplugin",e):"object"===typeof exports?module.exports=e():a.MicroPlugin=e()})(this,function(){var a={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return{mixin:function(e){e.plugins={};e.prototype.initializePlugins=function(e){var d,c,k=[];this.plugins={names:[],settings:{},requested:{},loaded:{}};if(a.isArray(e))for(d=0,c=e.length;d<c;d++)"string"===typeof e[d]?k.push(e[d]):(this.plugins.settings[e[d].name]=
e[d].options,k.push(e[d].name));else if(e)for(d in e)e.hasOwnProperty(d)&&(this.plugins.settings[d]=e[d],k.push(d));for(;k.length;)this.require(k.shift())};e.prototype.loadPlugin=function(a){var d=this.plugins,c=e.plugins[a];if(!e.plugins.hasOwnProperty(a))throw Error('Unable to find "'+a+'" plugin');d.requested[a]=!0;d.loaded[a]=c.fn.apply(this,[this.plugins.settings[a]||{}]);d.names.push(a)};e.prototype.require=function(a){var d=this.plugins;if(!this.plugins.loaded.hasOwnProperty(a)){if(d.requested[a])throw Error('Plugin has circular dependency ("'+
a+'")');this.loadPlugin(a)}return d.loaded[a]};e.define=function(a,d){e.plugins[a]={name:a,fn:d}}}}});
(function(a,e){"function"===typeof define&&define.amd?define(["jquery","sifter","microplugin"],e):"object"===typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):a.Selectize=e(a.jQuery,a.Sifter,a.MicroPlugin)})(this,function(a,e,f){var d=function(a,b){if("string"!==typeof b||b.length){var c="string"===typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(0<=e&&0<a.data.length){var g=a.data.match(c),b=document.createElement("span");
b.className="highlight";a=a.splitText(e);a.splitText(g[0].length);e=a.cloneNode(!0);b.appendChild(e);a.parentNode.replaceChild(b,a);b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(e=0;e<a.childNodes.length;++e)e+=d(a.childNodes[e]);return b};return a.each(function(){d(this)})}},c=function(){};c.prototype={on:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},off:function(a,b){var c=arguments.length;if(0===c)return delete this._events;
if(1===c)return delete this._events[a];this._events=this._events||{};!1!==a in this._events&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){this._events=this._events||{};if(!1!==a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}};c.mixin=function(a){for(var b=["on","off","trigger"],d=0;d<b.length;d++)a.prototype[b[d]]=c.prototype[b[d]]};var k=/Mac/.test(navigator.userAgent),g=k?91:17,h=k?18:
17,b=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,m=function(a){return"undefined"===typeof a||null===a?null:"boolean"===typeof a?a?"1":"0":a+""},n=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p={before:function(a,b,c){var d=a[b];a[b]=function(){c.apply(a,arguments);return d.apply(a,arguments)}},after:function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);c.apply(a,arguments);
return b}}},q=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},u=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c);c=window.setTimeout(function(){a.apply(d,e)},b)}},x=function(a,b,c){var d,e=a.trigger,g={};a.trigger=function(){var c=arguments[0];if(-1!==b.indexOf(c))g[c]=arguments;else return e.apply(a,arguments)};c.apply(a,[]);a.trigger=e;for(d in g)g.hasOwnProperty(d)&&e.apply(a,g[d])},v=function(a,b,c,d){a.on(b,c,function(b){for(var c=
b.target;c&&c.parentNode!==a[0];)c=c.parentNode;b.currentTarget=c;return d.apply(this,[b])})},r=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length);b.start=c.text.length-d;b.length=d}return b},w=function(b){var c=null,d=function(d,e){var g,f,h;d=d||window.event||{};e=e||{};if(!d.metaKey&&
!d.altKey&&(e.force||!1!==b.data("grow"))){g=b.val();d.type&&"keydown"===d.type.toLowerCase()&&(f=d.keyCode,h=97<=f&&122>=f||65<=f&&90>=f||48<=f&&57>=f||32===f,46===f||8===f?(h=r(b[0]),h.length?g=g.substring(0,h.start)+g.substring(h.start+h.length):8===f&&h.start?g=g.substring(0,h.start-1)+g.substring(h.start+1):46===f&&"undefined"!==typeof h.start&&(g=g.substring(0,h.start)+g.substring(h.start+1))):h&&(f=d.shiftKey,h=String.fromCharCode(d.keyCode),h=f?h.toUpperCase():h.toLowerCase(),g+=h));f=b.attr("placeholder");
!g&&f&&(g=f);if(g){g=a("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(g).appendTo("body");f=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];var k,m={};if(f)for(h=0,k=f.length;h<k;h++)m[f[h]]=b.css(f[h]);else m=b.css();g.css(m);f=g.width();g.remove();g=f}else g=0;g+=4;g!==c&&(c=g,b.width(g),b.triggerHandler("resize"))}};b.on("keydown keyup update blur",d);d()},y=function(b,c){var d,g;d=b[0];d.selectize=this;g=(g=(g=window.getComputedStyle&&
window.getComputedStyle(d,null))?g.getPropertyValue("direction"):d.currentStyle&&d.currentStyle.direction)||b.parents("[dir]:first").attr("dir")||"";a.extend(this,{order:0,settings:c,$input:b,tabIndex:b.attr("tabindex")||"",tagType:"select"===d.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++y.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:b.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,
ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===c.loadThrottle?this.onSearchChange:u(this.onSearchChange,c.loadThrottle)});this.sifter=new e(this.options,{diacritics:c.diacritics});if(this.settings.options){d=0;for(g=this.settings.options.length;d<g;d++)this.registerOption(this.settings.options[d]);
delete this.settings.options}if(this.settings.optgroups){d=0;for(g=this.settings.optgroups.length;d<g;d++)this.registerOptionGroup(this.settings.optgroups[d]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi");"boolean"!==typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode);this.initializePlugins(this.settings.plugins);this.setupCallbacks();this.setupTemplates();this.setup()};c.mixin(y);f.mixin(y);
a.extend(y.prototype,{setup:function(){var c=this,d=c.settings,e=c.eventNS,f=a(window),m=a(document),n=c.$input,q,p,r,x,l,u;l=c.settings.mode;u=n.attr("class")||"";q=a("<div>").addClass(d.wrapperClass).addClass(u).addClass(l);p=a("<div>").addClass(d.inputClass).addClass("items").appendTo(q);r=a('<input type="text" autocomplete="off" />').appendTo(p).attr("tabindex",n.is(":disabled")?"-1":c.tabIndex);x=a(d.dropdownParent||q);x=a("<div>").addClass(d.dropdownClass).addClass(l).hide().appendTo(x);l=a("<div>").addClass(d.dropdownContentClass).appendTo(x);
p.addClass(c.settings.readOnly?"input-readonly":"");r.prop("readonly",c.settings.readOnly);r.prop("disabled",c.settings.readOnly);c.settings.copyClassesToDropdown&&x.addClass(u);q.css({width:n[0].style.width});c.plugins.names.length&&(u="plugin-"+c.plugins.names.join(" plugin-"),q.addClass(u),x.addClass(u));(null===d.maxItems||1<d.maxItems)&&1===c.tagType&&n.attr("multiple","multiple");c.settings.placeholder&&r.attr("placeholder",d.placeholder);!c.settings.splitOn&&c.settings.delimiter&&(u=c.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,
"\\$&"),c.settings.splitOn=new RegExp("\\s*"+u+"+\\s*"));n.attr("autocorrect")&&r.attr("autocorrect",n.attr("autocorrect"));n.attr("autocapitalize")&&r.attr("autocapitalize",n.attr("autocapitalize"));c.$wrapper=q;c.$control=p;c.$control_input=r;c.$dropdown=x;c.$dropdown_content=l;x.on("mouseenter","[data-selectable]",function(){return c.onOptionHover.apply(c,arguments)});x.on("mousedown click","[data-selectable]",function(){return c.onOptionSelect.apply(c,arguments)});v(p,"mousedown","*:not(input)",
function(){return c.onItemSelect.apply(c,arguments)});w(r);p.on({mousedown:function(){return c.onMouseDown.apply(c,arguments)},click:function(){return c.onClick.apply(c,arguments)}});r.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return c.onKeyDown.apply(c,arguments)},keyup:function(){return c.onKeyUp.apply(c,arguments)},keypress:function(){return c.onKeyPress.apply(c,arguments)},resize:function(){c.positionDropdown.apply(c,[])},blur:function(){return c.onBlur.apply(c,arguments)},
focus:function(){c.ignoreBlur=!1;return c.onFocus.apply(c,arguments)},paste:function(){return c.onPaste.apply(c,arguments)}});m.on("keydown"+e,function(a){c.isCmdDown=a[k?"metaKey":"ctrlKey"];c.isCtrlDown=a[k?"altKey":"ctrlKey"];c.isShiftDown=a.shiftKey});m.on("keyup"+e,function(a){a.keyCode===h&&(c.isCtrlDown=!1);16===a.keyCode&&(c.isShiftDown=!1);a.keyCode===g&&(c.isCmdDown=!1)});m.on("mousedown"+e,function(a){if(c.isFocused){if(a.target===c.$dropdown[0]||a.target.parentNode===c.$dropdown[0])return!1;
c.$control.has(a.target).length||a.target===c.$control[0]||c.blur(a.target)}});f.on(["scroll"+e,"resize"+e].join(" "),function(){c.isOpen&&c.positionDropdown.apply(c,arguments)});f.on("mousemove"+e,function(){c.ignoreHover=!1});this.revertSettings={$children:n.children().detach(),tabindex:n.attr("tabindex")};n.attr("tabindex",-1).hide().after(c.$wrapper);a.isArray(d.items)&&(c.setValue(d.items),delete d.items);if(b)n.on("invalid"+e,function(a){a.preventDefault();c.isInvalid=!0;c.refreshState()});
c.updateOriginalInput();c.refreshItems();c.refreshState();c.updatePlaceholder();c.isSetup=!0;n.is(":disabled")&&c.disable();c.on("change",this.onChange);n.data("selectize",c);n.addClass("selectized");c.trigger("initialize");if(!0===d.preload)c.onSearchChange("")},setupTemplates:function(){var b=this.settings.labelField,c=this.settings.optgroupLabelField;this.settings.render=a.extend({},{optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+
b(a[c])+"</div>"},option:function(a,c){return'<div class="option">'+c(a[b])+"</div>"},item:function(a,c){return'<div class="item">'+c(a[b])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}},this.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",
optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)if(c.hasOwnProperty(a)&&(b=this.settings[c[a]]))this.on(a,b)},onClick:function(a){this.isFocused||(this.focus(),a.preventDefault())},onMouseDown:function(b){var c=this,d=b.isDefaultPrevented();a(b.target);if(c.isFocused){if(b.target!==c.$control_input[0])return"single"===
c.settings.mode?c.isOpen?c.close():c.open():d||c.setActiveItem(null),!1}else d||window.setTimeout(function(){c.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(b){var c=this;c.isFull()||c.isInputHidden||c.isLocked?b.preventDefault():c.settings.splitOn&&setTimeout(function(){for(var b=a.trim(c.$control_input.val()||"").split(c.settings.splitOn),d=0,e=b.length;d<e;d++)c.createItem(b[d])},0)},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||
a.which);if(this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter)return this.createItem(),a.preventDefault(),!1},onKeyDown:function(a){if(this.isLocked)9!==a.keyCode&&a.preventDefault();else{switch(a.keyCode){case 65:if(this.isCmdDown){this.selectAll();return}break;case 27:this.isOpen&&(a.preventDefault(),a.stopPropagation(),this.close());return;case 78:if(!a.ctrlKey||a.altKey)break;case 40:if(!this.isOpen&&this.hasOptions)this.open();else if(this.$activeOption){this.ignoreHover=
!0;var b=this.getAdjacentOption(this.$activeOption,1);b.length&&this.setActiveOption(b,!0,!0)}a.preventDefault();return;case 80:if(!a.ctrlKey||a.altKey)break;case 38:this.$activeOption&&(this.ignoreHover=!0,b=this.getAdjacentOption(this.$activeOption,-1),b.length&&this.setActiveOption(b,!0,!0));a.preventDefault();return;case 13:this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),a.preventDefault());return;case 37:this.advanceSelection(-1,a);return;case 39:this.advanceSelection(1,
a);return;case 9:this.settings.selectOnTab&&this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),this.isFull()||a.preventDefault());this.settings.create&&this.createItem()&&a.preventDefault();return;case 8:case 46:this.deleteSelection(a);return}!this.isFull()&&!this.isInputHidden||(k?a.metaKey:a.ctrlKey)||a.preventDefault()}},onKeyUp:function(a){if(this.isLocked)return a&&a.preventDefault();a=this.$control_input.val()||"";this.lastValue!==a&&(this.lastValue=a,
this.onSearchChange(a),this.refreshOptions(),this.trigger("type",a))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&!b.loadedSearches.hasOwnProperty(a)&&(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])}))},onFocus:function(a){var b=this.isFocused;if(this.isDisabled)return this.blur(),a&&a.preventDefault(),!1;if(!this.ignoreFocus){this.isFocused=!0;if("focus"===this.settings.preload)this.onSearchChange("");b||this.trigger("focus");this.$activeItems.length||(this.showInput(),
this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus));this.refreshState()}},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus))if(c.ignoreBlur||document.activeElement!==c.$dropdown_content[0]){var d=function(){c.close();c.setTextboxValue("");c.setActiveItem(null);c.setActiveOption(null);c.setCaret(c.items.length);c.refreshState();(b||document.body).focus();c.ignoreFocus=!1;c.trigger("blur")};c.ignoreFocus=!0;c.settings.create&&c.settings.createOnBlur?
c.createItem(null,!1,d):d()}else c.ignoreBlur=!0,c.onFocus(a)},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(b){var c,d=this;b.preventDefault&&(b.preventDefault(),b.stopPropagation());c=a(b.currentTarget);c.hasClass("create")?d.createItem(null,function(){d.settings.closeAfterSelect&&d.close()}):(c=c.attr("data-value"),"undefined"!==typeof c&&(d.lastQuery=null,d.setTextboxValue(""),d.addItem(c),d.settings.closeAfterSelect?d.close():!d.settings.hideSelected&&
b.type&&/mouse/.test(b.type)&&d.setActiveOption(d.getOption(c))))},onItemSelect:function(a){this.isLocked||"multi"!==this.settings.mode||(a.preventDefault(),this.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++;a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0);a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden));b.loading||c.removeClass(b.settings.loadingClass);b.trigger("load",a)}])},setTextboxValue:function(a){var b=
this.$control_input;b.val()!==a&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){x(this,b?[]:["change"],function(){this.clear(b);this.addItems(a,b)})},setActiveItem:function(b,c){var d,e,g;if("single"!==this.settings.mode)if(b=a(b),b.length){d=c&&c.type.toLowerCase();if("mousedown"===d&&this.isShiftDown&&this.$activeItems.length){d=this.$control.children(".active:last");
e=Array.prototype.indexOf.apply(this.$control[0].childNodes,[d[0]]);d=Array.prototype.indexOf.apply(this.$control[0].childNodes,[b[0]]);e>d&&(g=e,e=d,d=g);for(;e<=d;e++)g=this.$control[0].childNodes[e],-1===this.$activeItems.indexOf(g)&&(a(g).addClass("active"),this.$activeItems.push(g));c.preventDefault()}else"mousedown"===d&&this.isCtrlDown||"keydown"===d&&this.isShiftDown?b.hasClass("active")?(d=this.$activeItems.indexOf(b[0]),this.$activeItems.splice(d,1),b.removeClass("active")):this.$activeItems.push(b.addClass("active")[0]):
(a(this.$activeItems).removeClass("active"),this.$activeItems=[b.addClass("active")[0]]);this.hideInput();this.isFocused||this.focus()}else a(this.$activeItems).removeClass("active"),this.$activeItems=[],this.isFocused&&this.showInput()},setActiveOption:function(b,c,d){var e,g,f;this.$activeOption&&this.$activeOption.removeClass("active");this.$activeOption=null;b=a(b);b.length&&(this.$activeOption=b.addClass("active"),c||"undefined"===typeof c)&&(b=this.$dropdown_content.height(),e=this.$activeOption.outerHeight(!0),
c=this.$dropdown_content.scrollTop()||0,g=this.$activeOption.offset().top-this.$dropdown_content.offset().top+c,f=g-b+e,g+e>b+c?this.$dropdown_content.stop().animate({scrollTop:f},d?this.settings.scrollDuration:0):g<c&&this.$dropdown_content.stop().animate({scrollTop:g},d?this.settings.scrollDuration:0))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),
this.close()),this.focus())},hideInput:function(){this.setTextboxValue("");this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1E4:-1E4});this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0});this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1;a.onFocus()},0))},blur:function(a){this.$control_input[0].blur();this.onBlur(null,
a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;"string"===typeof b&&(b=[{field:b}]);return{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(b){var c,d;c=this.settings;var e=this.getSearchOptions();if(c.score&&(d=this.settings.score.apply(this,[b]),"function"!==typeof d))throw Error('Selectize "score" setting must be a function that returns a function');b!==this.lastQuery?
(this.lastQuery=b,this.currentResults=b=this.sifter.search(b,a.extend(e,{score:d}))):b=a.extend(!0,{},this.currentResults);if(c.hideSelected)for(c=b.items.length-1;0<=c;c--)-1!==this.items.indexOf(m(b.items[c].id))&&b.items.splice(c,1);return b},refreshOptions:function(b){var c,e,g,f,h,k,n,q,p,l,v,r;"undefined"===typeof b&&(b=!0);var w=this;v=a.trim(w.$control_input.val());var x=w.search(v),u=w.$dropdown_content,y=w.$activeOption&&m(w.$activeOption.attr("data-value"));f=x.items.length;"number"===
typeof w.settings.maxOptions&&(f=Math.min(f,w.settings.maxOptions));h={};k=[];for(c=0;c<f;c++)for(n=w.options[x.items[c].id],q=w.render("option",n),n=n[w.settings.optgroupField]||"",p=a.isArray(n)?n:[n],e=0,g=p&&p.length;e<g;e++)n=p[e],w.optgroups.hasOwnProperty(n)||(n=""),h.hasOwnProperty(n)||(h[n]=[],k.push(n)),h[n].push(q);this.settings.lockOptgroupOrder&&k.sort(function(a,b){return(w.optgroups[a].$order||0)-(w.optgroups[b].$order||0)});q=[];c=0;for(f=k.length;c<f;c++)n=k[c],w.optgroups.hasOwnProperty(n)&&
h[n].length?(e=w.render("optgroup_header",w.optgroups[n])||"",e+=h[n].join(""),q.push(w.render("optgroup",a.extend({},w.optgroups[n],{html:e})))):q.push(h[n].join(""));u.html(q.join(""));if(w.settings.highlight&&x.query.length&&x.tokens.length)for(c=0,f=x.tokens.length;c<f;c++)d(u,x.tokens[c].regex);if(!w.settings.hideSelected)for(c=0,f=w.items.length;c<f;c++)w.getOption(w.items[c]).addClass("selected");if(c=w.canCreate(v))u.prepend(w.render("option_create",{input:v})),r=a(u[0].childNodes[0]);w.hasOptions=
0<x.items.length||c;w.hasOptions?(0<x.items.length?((v=y&&w.getOption(y))&&v.length?l=v:"single"===w.settings.mode&&w.items.length&&(l=w.getOption(w.items[0])),l&&l.length||(l=r&&!w.settings.addPrecedence?w.getAdjacentOption(r,1):u.find("[data-selectable]:first"))):l=r,w.setActiveOption(l),b&&!w.isOpen&&w.open()):(w.setActiveOption(null),b&&w.isOpen&&w.close())},addOption:function(b){var c,d;if(a.isArray(b))for(c=0,d=b.length;c<d;c++)this.addOption(b[c]);else if(c=this.registerOption(b))this.userOptions[c]=
!0,this.lastQuery=null,this.trigger("option_add",c,b)},registerOption:function(a){var b=m(a[this.settings.valueField]);if(!b||this.options.hasOwnProperty(b))return!1;a.$order=a.$order||++this.order;this.options[b]=a;return b},registerOptionGroup:function(a){var b=m(a[this.settings.optgroupValueField]);if(!b)return!1;a.$order=a.$order||++this.order;this.optgroups[b]=a;return b},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a;(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",
a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={};this.renderCache={};this.trigger("optgroup_clear")},updateOption:function(b,c){var d,e,g;b=m(b);d=m(c[this.settings.valueField]);if(null!==b&&this.options.hasOwnProperty(b)){if("string"!==typeof d)throw Error("Value must be set in option data");g=this.options[b].$order;d!==b&&(delete this.options[b],e=
this.items.indexOf(b),-1!==e&&this.items.splice(e,1,d));c.$order=c.$order||g;this.options[d]=c;e=this.renderCache.item;g=this.renderCache.option;e&&(delete e[b],delete e[d]);g&&(delete g[b],delete g[d]);-1!==this.items.indexOf(d)&&(d=this.getItem(b),e=a(this.render("item",c)),d.hasClass("active")&&e.addClass("active"),d.replaceWith(e));this.lastQuery=null;this.isOpen&&this.refreshOptions(!1)}},removeOption:function(a,b){a=m(a);var c=this.renderCache.item,d=this.renderCache.option;c&&delete c[a];d&&
delete d[a];delete this.userOptions[a];delete this.options[a];this.lastQuery=null;this.trigger("option_remove",a);this.removeItem(a,b)},clearOptions:function(a){this.loadedSearches={};this.userOptions={};this.renderCache={};this.options=this.sifter.items={};this.lastQuery=null;this.trigger("option_clear");this.clear(a)},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(b,c){var d=this.$dropdown.find("[data-selectable]"),
e=d.index(b)+c;return 0<=e&&e<d.length?d.eq(e):a()},getElementWithValue:function(b,c){b=m(b);if("undefined"!==typeof b&&null!==b)for(var d=0,e=c.length;d<e;d++)if(c[d].getAttribute("data-value")===b)return a(c[d]);return a()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(b,c){for(var d=a.isArray(b)?b:[b],e=0,g=d.length;e<g;e++)this.isPending=e<g-1,this.addItem(d[e],c)},addItem:function(b,c){x(this,c?[]:["change"],function(){var d,e,g,f=this.settings.mode;
b=m(b);-1!==this.items.indexOf(b)?"single"===f&&this.close():this.options.hasOwnProperty(b)&&("single"===f&&this.clear(c),"multi"===f&&this.isFull()||(d=a(this.render("item",this.options[b])),g=this.isFull(),this.items.splice(this.caretPos,0,b),this.insertAtCaret(d),(!this.isPending||!g&&this.isFull())&&this.refreshState(),this.isSetup&&(g=this.$dropdown_content.find("[data-selectable]"),this.isPending||(e=this.getOption(b),e=this.getAdjacentOption(e,1).attr("data-value"),this.refreshOptions(this.isFocused&&
"single"!==f),e&&this.setActiveOption(this.getOption(e))),!g.length||this.isFull()?this.close():this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",b,d),this.updateOriginalInput({silent:c}))))})},removeItem:function(a,b){var c,d,e;c="object"===typeof a?a:this.getItem(a);a=m(c.attr("data-value"));d=this.items.indexOf(a);-1!==d&&(c.remove(),c.hasClass("active")&&(e=this.$activeItems.indexOf(c[0]),this.$activeItems.splice(e,1)),this.items.splice(d,1),this.lastQuery=null,!this.settings.persist&&
this.userOptions.hasOwnProperty(a)&&this.removeOption(a,b),d<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput({silent:b}),this.positionDropdown(),this.trigger("item_remove",a,c))},createItem:function(b,c){var d=this,e=d.caretPos;b=b||a.trim(d.$control_input.val()||"");var g=arguments[arguments.length-1];"function"!==typeof g&&(g=function(){});"boolean"!==typeof c&&(c=!0);if(!d.canCreate(b))return g(),!1;d.lock();var f="function"===
typeof d.settings.create?this.settings.create:function(a){var b={};b[d.settings.labelField]=a;b[d.settings.valueField]=a;return b},h=q(function(a){d.unlock();if(!a||"object"!==typeof a)return g();var b=m(a[d.settings.valueField]);if("string"!==typeof b)return g();d.setTextboxValue("");d.addOption(a);d.setCaret(e);d.addItem(b);d.refreshOptions(c&&"single"!==d.settings.mode);g(a)}),f=f.apply(this,[b,h]);"undefined"!==typeof f&&h(f);return!0},refreshItems:function(){this.lastQuery=null;this.isSetup&&
this.addItem(this.items);this.refreshState();this.updateOriginalInput()},refreshState:function(){this.isRequired&&(this.items.length&&(this.isInvalid=!1),this.$control_input.prop("required",void 0));this.refreshClasses()},refreshClasses:function(){var b=this.isFull(),c=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl);this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",
c).toggleClass("full",b).toggleClass("not-full",!b).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!a.isEmptyObject(this.options)).toggleClass("has-items",0<this.items.length);this.$control_input.data("grow",!b&&!c)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e;a=a||{};if(1===this.tagType){d=[];b=0;for(c=this.items.length;b<
c;b++)e=this.options[this.items[b]][this.settings.labelField]||"",d.push('<option value="'+n(this.items[b])+'" selected="selected">'+n(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>');this.$input.html(d.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(a.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;
this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder);a.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var a=this.isOpen;"single"===this.settings.mode&&
this.items.length&&this.hideInput();this.isOpen=!1;this.$dropdown.hide();this.setActiveOption(null);this.refreshState();a&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0);this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),
this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput({silent:a}),this.refreshState(),a||this.showInput(),this.trigger("clear"))},insertAtCaret:function(b){var c=Math.min(this.caretPos,this.items.length);0===c?this.$control.prepend(b):a(this.$control[0].childNodes[c]).before(b);this.setCaret(c+1)},deleteSelection:function(b){var c,d,e,g,f;c=b&&8===b.keyCode?-1:1;d=r(this.$control_input[0]);this.$activeOption&&!this.settings.hideSelected&&(f=this.getAdjacentOption(this.$activeOption,
-1).attr("data-value"));e=[];if(this.$activeItems.length){g=this.$control.children(".active:"+(0<c?"last":"first"));g=this.$control.children(":not(input)").index(g);0<c&&g++;c=0;for(d=this.$activeItems.length;c<d;c++)e.push(a(this.$activeItems[c]).attr("data-value"));b&&(b.preventDefault(),b.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(0>c&&0===d.start&&0===d.length?e.push(this.items[this.caretPos-1]):0<c&&d.start===this.$control_input.val().length&&
e.push(this.items[this.caretPos]));if(!e.length||"function"===typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[e]))return!1;for("undefined"!==typeof g&&this.setCaret(g);e.length;)this.removeItem(e.pop());this.showInput();this.positionDropdown();this.refreshOptions(!0);f&&(b=this.getOption(f),b.length&&this.setActiveOption(b));return!0},advanceSelection:function(a,b){var c,d;0!==a&&(this.rtl&&(a*=-1),c=0<a?"last":"first",d=r(this.$control_input[0]),this.isFocused&&!this.isInputHidden?
(c=this.$control_input.val().length,(d=0>a?0===d.start&&0===d.length:d.start===c)&&!c&&this.advanceCaret(a,b)):(d=this.$control.children(".active:"+c),d.length&&(d=this.$control.children(":not(input)").index(d),this.setActiveItem(null),this.setCaret(0<a?d+1:d))))},advanceCaret:function(a,b){var c;0!==a&&(c=0<a?"next":"prev",this.isShiftDown?(c=this.$control_input[c](),c.length&&(this.hideInput(),this.setActiveItem(c),b&&b.preventDefault())):this.setCaret(this.caretPos+a))},setCaret:function(b){b=
"single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,b));if(!this.isPending){var c,d,e,g;e=this.$control.children(":not(input)");c=0;for(d=e.length;c<d;c++)g=a(e[c]).detach(),c<b?this.$control_input.before(g):this.$control.append(g)}this.caretPos=b},lock:function(){this.close();this.isLocked=!0;this.refreshState()},unlock:function(){this.isLocked=!1;this.refreshState()},disable:function(){this.$input.prop("disabled",!0);this.$control_input.prop("disabled",!0).prop("tabindex",
-1);this.isDisabled=!0;this.lock()},enable:function(){this.$input.prop("disabled",!1);this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex);this.isDisabled=!1;this.unlock()},destroy:function(){var b=this.eventNS,c=this.revertSettings;this.trigger("destroy");this.off();this.$wrapper.remove();this.$dropdown.remove();this.$input.html("").append(c.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:c.tabindex}).show();this.$control_input.removeData("grow");this.$input.removeData("selectize");
a(window).off(b);a(document).off(b);a(document.body).off(b);delete this.$input[0].selectize},render:function(a,b){var c,d,e,g=!1,f=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;if("option"===a||"item"===a)c=m(b[this.settings.valueField]),g=!!c;if(g&&("undefined"===typeof this.renderCache[a]&&(this.renderCache[a]={}),this.renderCache[a].hasOwnProperty(c)))return this.renderCache[a][c];e=this.settings.render[a].apply(this,[b,n]);if("option"===a||"option_create"===a)e=e.replace(f,"<$1 data-selectable");
"optgroup"===a&&(d=b[this.settings.optgroupValueField]||"",e=e.replace(f,'<$1 data-group="'+(n(d)+"").replace(/\$/g,"$$$$")+'"'));if("option"===a||"item"===a)e=e.replace(f,'<$1 data-value="'+(n(c||"")+"").replace(/\$/g,"$$$$")+'"');g&&(this.renderCache[a][c]=e);return e},clearCache:function(a){"undefined"===typeof a?this.renderCache={}:delete this.renderCache[a]},canCreate:function(a){if(!this.settings.create)return!1;var b=this.settings.createFilter;return a.length&&("function"!==typeof b||b.apply(this,
[a]))&&("string"!==typeof b||(new RegExp(b)).test(a))&&(!(b instanceof RegExp)||b.test(a))}});y.count=0;y.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1E3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",
valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,readOnly:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}};a.fn.selectize=function(b){var c=a.fn.selectize.defaults,d=a.extend({},c,b),e=d.dataAttr,g=d.labelField,
f=d.valueField,h=d.optgroupField,k=d.optgroupLabelField,n=d.optgroupValueField,q=function(b,c){var q,t,p,v,r=c.options,w={},x=function(a){a=e&&a.attr(e);return"string"===typeof a&&a.length?JSON.parse(a):null},u=function(b,e){b=a(b);var k=m(b.attr("value"));if(k||d.allowEmptyOption)if(w.hasOwnProperty(k)){if(e){var n=w[k][h];n?a.isArray(n)?n.push(e):w[k][h]=[n,e]:w[k][h]=e}}else n=x(b)||{},n[g]=n[g]||b.text(),n[f]=n[f]||k,n[h]=n[h]||e,w[k]=n,r.push(n),b.is(":selected")&&c.items.push(k)},D=function(b){var d,
e,g;b=a(b);if(e=b.attr("label"))d=x(b)||{},d[k]=e,d[n]=e,c.optgroups.push(d);g=a("option",b);b=0;for(d=g.length;b<d;b++)u(g[b],e)};c.maxItems=b.attr("multiple")?null:1;v=b.children();q=0;for(t=v.length;q<t;q++)p=v[q].tagName.toLowerCase(),"optgroup"===p?D(v[q]):"option"===p&&u(v[q])};return this.each(function(){if(!this.selectize){var h=a(this),k=this.tagName.toLowerCase(),m=h.attr("placeholder")||h.attr("data-placeholder");m||d.allowEmptyOption||(m=h.children('option[value=""]').text());m={placeholder:m,
options:[],optgroups:[],items:[]};if("select"===k)q(h,m);else{var n,p,v;if(k=h.attr(e))for(m.options=JSON.parse(k),k=0,n=m.options.length;k<n;k++)m.items.push(m.options[k][f]);else if(k=a.trim(h.val()||""),d.allowEmptyOption||k.length){p=k.split(d.delimiter);k=0;for(n=p.length;k<n;k++)v={},v[g]=p[k],v[f]=p[k],m.options.push(v);m.items=p}}new y(h,a.extend(!0,{},c,m,b))}})};a.fn.selectize.defaults=y.defaults;a.fn.selectize.support={validity:b};y.define("drag_drop",function(b){if(!a.fn.sortable)throw Error('The "drag_drop" plugin requires jQuery UI "sortable".');
if("multi"===this.settings.mode){var c=this;c.lock=function(){var a=c.lock;return function(){var b=c.$control.data("sortable");b&&b.disable();return a.apply(c,arguments)}}();c.unlock=function(){var a=c.unlock;return function(){var b=c.$control.data("sortable");b&&b.enable();return a.apply(c,arguments)}}();c.setup=function(){var b=c.setup;return function(){b.apply(this,arguments);var d=c.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:c.isLocked,start:function(a,b){b.placeholder.css("width",
b.helper.css("width"));d.css({overflow:"visible"})},stop:function(){d.css({overflow:"hidden"});var b=c.$activeItems?c.$activeItems.slice():null,e=[];d.children("[data-value]").each(function(){e.push(a(this).attr("data-value"))});c.setValue(e);c.setActiveItem(b)}})}}()}});y.define("dropdown_header",function(b){var c=this;b=a.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",
html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},b);c.setup=function(){var d=c.setup;return function(){d.apply(c,arguments);c.$dropdown_header=a(b.html(b));c.$dropdown.prepend(c.$dropdown_header)}}()});y.define("optgroup_columns",function(b){var c=this;b=a.extend({equalizeWidth:!0,equalizeHeight:!0},b);this.getAdjacentOption=function(b,
c){var d=b.closest("[data-group]").find("[data-selectable]"),e=d.index(b)+c;return 0<=e&&e<d.length?d.eq(e):a()};this.onKeyDown=function(){var a=c.onKeyDown;return function(b){var d,e;if(!this.isOpen||37!==b.keyCode&&39!==b.keyCode)return a.apply(this,arguments);c.ignoreHover=!0;e=this.$activeOption.closest("[data-group]");d=e.find("[data-selectable]").index(this.$activeOption);e=37===b.keyCode?e.prev("[data-group]"):e.next("[data-group]");e=e.find("[data-selectable]");d=e.eq(Math.min(e.length-1,
d));d.length&&this.setActiveOption(d)}}();var d=function(){var a,b=d.width,c=document;"undefined"===typeof b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,c.body.appendChild(a),b=d.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a));return b},e=function(){var e,g,f,h;h=a("[data-group]",c.$dropdown_content);if((g=h.length)&&c.$dropdown_content.width()){if(b.equalizeHeight){for(e=
f=0;e<g;e++)f=Math.max(f,h.eq(e).height());h.css({height:f})}b.equalizeWidth&&(f=c.$dropdown_content.innerWidth()-d(),e=Math.round(f/g),h.css({width:e}),1<g&&(e=f-e*(g-1),h.eq(g-1).css({width:e})))}};if(b.equalizeHeight||b.equalizeWidth)p.after(this,"positionDropdown",e),p.after(this,"refreshOptions",e)});y.define("remove_button",function(b){if("single"!==this.settings.mode){b=a.extend({label:"&times;",title:"Remove",className:"remove",append:!0},b);var c=this,d='<a href="javascript:void(0)" class="'+
b.className+'" tabindex="-1" title="'+n(b.title)+'">'+b.label+"</a>";this.setup=function(){var e=c.setup;return function(){if(b.append){var g=c.settings.render.item;c.settings.render.item=function(a){var b=g.apply(this,arguments),c=b.search(/(<\/[^>]+>\s*)$/);return b.substring(0,c)+d+b.substring(c)}}e.apply(this,arguments);this.$control.on("click","."+b.className,function(b){b.preventDefault();c.isLocked||(b=a(b.currentTarget).parent(),c.setActiveItem(b),c.deleteSelection()&&c.setCaret(c.items.length))})}}()}});
y.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]};this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d;if(8===b.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,0<=d&&d<this.items.length)){d=this.options[this.items[d]];this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[d])),this.refreshOptions(!0));b.preventDefault();return}return c.apply(this,arguments)}}()});y.define("clear_selection",
function(a){var b=this;a=a||{};b.plugins.settings.dropdown_header={title:a.title||"Clear selection"};this.require("dropdown_header");b.setup=function(){var a=b.setup;return function(){a.apply(this,arguments);this.$dropdown.on("mousedown",".selectize-dropdown-header",function(){b.setValue("");b.close();b.blur();return!1})}}()});return y});
(function(a){var e=function(a,c){return a-c},f=function(c){4===c.length&&(c=a.map(/\w+/.exec(c),function(a){return a+a}).join(""));c=/(\w{2})(\w{2})(\w{2})/.exec(c);return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]},d=function(c){return"#"+a.map(c,function(a){a=a.toString(16);return a=1===a.length?"0"+a:a}).join("")},c=function(c,d){return a.map(f(c.end),function(a,e){return(a-f(c.start)[e])/d})},k=function(c,e,b){c=a.map(f(c.start),function(a,c){var d=Math.round(a+e[c]*b);255<d?d=255:
0>d&&(d=0);return d});return d(c)};a.fn.tagcloud=function(d){var f=a.extend({},a.fn.tagcloud.defaults,d);d=this.map(function(){return a(this).attr("rel")});d=a.makeArray(d).sort(e);var b=d[0];d=d.pop()-b;0===d&&(d=1);var m,n;f.size&&(m=(f.size.end-f.size.start)/d);f.color&&(n=c(f.color,d));return this.each(function(){var c=a(this).attr("rel")-b;f.size&&a(this).css({"font-size":f.size.start+c*m+f.size.unit});f.color&&a(this).css({color:k(f.color,n,c)})})};a.fn.tagcloud.defaults={size:{start:14,end:18,
unit:"pt"}}})(jQuery);(function(a){a.fn.taphold=function(e,f){a(this).bind("touchstart",function(d){var c=window.setTimeout(function(){e(d)},f);a(document).bind("touchend touchcancel",function(){window.clearTimeout(c);a(document).unbind("touchend touchcancel");return!0});return!0})}})(jQuery);
(function(a,e){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(e){var d=this.options;return this.helper||d.disabled||a(e.target).is(".ui-resizable-handle")?
!1:(this.handle=this._getHandle(e),this.handle?(d.iframeFix&&a(!0===d.iframeFix?"iframe":d.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var d=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),
a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),
this.originalPageX=e.pageX,this.originalPageY=e.pageY,d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt),d.containment&&this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,d){this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!d){var c=
this._uiHash();if(!1===this._trigger("drag",e,c))return this._mouseUp({}),!1;this.position=c.position}this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");return a.ui.ddmanager&&a.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var d=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,e));this.dropped&&(d=this.dropped,this.dropped=!1);
for(var c=this.element[0],k=!1;c&&(c=c.parentNode);)c==document&&(k=!0);if(!k&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var g=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==g._trigger("stop",e)&&g._clear()})}else!1!==this._trigger("stop",e)&&this._clear();return!1},
_mouseUp:function(e){return!0===this.options.iframeFix&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,e),a.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){var d=this.options.handle&&a(this.options.handle,this.element).length?!1:!0;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==
e.target&&(d=!0)}),d},_createHelper:function(e){var d=this.options;e=a.isFunction(d.helper)?a(d.helper.apply(this.element[0],[e])):"clone"==d.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo),e[0]!=this.element[0]&&!/(fixed|absolute)/.test(e.css("position"))&&e.css("position","absolute"),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" "));a.isArray(e)&&(e={left:+e[0],
top:+e[1]||0});"left"in e&&(this.offset.click.left=e.left+this.margins.left);"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left);"top"in e&&(this.offset.click.top=e.top+this.margins.top);"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.browser.msie)e={top:0,left:0};return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;"parent"==e.containment&&(e.containment=this.helper[0].parentNode);if("document"==e.containment||"window"==e.containment)this.containment=["document"==e.containment?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==e.containment?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==e.containment?0:a(window).scrollLeft())+a("document"==e.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==e.containment?0:a(window).scrollTop())+(a("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(/^(document|window|parent)$/.test(e.containment)||e.containment.constructor==Array)e.containment.constructor==Array&&(this.containment=e.containment);else{var e=a(e.containment),d=e[0];if(d){e.offset();var c="hidden"!=a(d).css("overflow");this.containment=
[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=e}}},_convertPositionTo:function(e,d){d||(d=this.position);var c="absolute"==e?1:-1,k="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(k[0].tagName);return{top:d.top+this.offset.relative.top*c+this.offset.parent.top*c-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():g?0:k.scrollTop())*c),left:d.left+this.offset.relative.left*c+this.offset.parent.left*c-(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():g?0:k.scrollLeft())*c)}},_generatePosition:function(e){var d=this.options,c="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,
k=/(html|body)/i.test(c[0].tagName),g=e.pageX,h=e.pageY;if(this.originalPosition){var b;this.containment&&(this.relative_container?(b=this.relative_container.offset(),b=[this.containment[0]+b.left,this.containment[1]+b.top,this.containment[2]+b.left,this.containment[3]+b.top]):b=this.containment,e.pageX-this.offset.click.left<b[0]&&(g=b[0]+this.offset.click.left),e.pageY-this.offset.click.top<b[1]&&(h=b[1]+this.offset.click.top),e.pageX-this.offset.click.left>b[2]&&(g=b[2]+this.offset.click.left),
e.pageY-this.offset.click.top>b[3]&&(h=b[3]+this.offset.click.top));d.grid&&(h=d.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,h=b?h-this.offset.click.top<b[1]||h-this.offset.click.top>b[3]?h-this.offset.click.top<b[1]?h+d.grid[1]:h-d.grid[1]:h:h,g=d.grid[0]?this.originalPageX+Math.round((g-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,g=b?g-this.offset.click.left<b[0]||g-this.offset.click.left>b[2]?g-this.offset.click.left<b[0]?
g+d.grid[0]:g-d.grid[0]:g:g)}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():k?0:c.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&526>a.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():k?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(e,d,c){return c=c||this._uiHash(),a.ui.plugin.call(this,e,[d,c]),"drag"==e&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,e,d,c)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.23"});
a.ui.plugin.add("draggable","connectToSortable",{start:function(e,d){var c=a(this).data("draggable"),k=c.options,g=a.extend({},d,{item:c.element});c.sortables=[];a(k.connectToSortable).each(function(){var d=a.data(this,"sortable");d&&!d.options.disabled&&(c.sortables.push({instance:d,shouldRevert:d.options.revert}),d.refreshPositions(),d._trigger("activate",e,g))})},stop:function(e,d){var c=a(this).data("draggable"),k=a.extend({},d,{item:c.element});a.each(c.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"==c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,k))})},drag:function(e,d){var c=a(this).data("draggable"),k=this;a.each(c.sortables,function(g){this.instance.positionAbs=
c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(k).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,
!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",e),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",e),c.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(e,d){var c=a("body"),k=a(this).data("draggable").options;
c.css("cursor")&&(k._cursor=c.css("cursor"));c.css("cursor",k.cursor)},stop:function(e,d){var c=a(this).data("draggable").options;c._cursor&&a("body").css("cursor",c._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(e,d){var c=a(d.helper),k=a(this).data("draggable").options;c.css("opacity")&&(k._opacity=c.css("opacity"));c.css("opacity",k.opacity)},stop:function(e,d){var c=a(this).data("draggable").options;c._opacity&&a(d.helper).css("opacity",c._opacity)}});a.ui.plugin.add("draggable",
"scroll",{start:function(e,d){var c=a(this).data("draggable");c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName&&(c.overflowOffset=c.scrollParent.offset())},drag:function(e,d){var c=a(this).data("draggable"),k=c.options,g=!1;c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName?(k.axis&&"x"==k.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-e.pageY<k.scrollSensitivity?c.scrollParent[0].scrollTop=g=c.scrollParent[0].scrollTop+k.scrollSpeed:e.pageY-c.overflowOffset.top<
k.scrollSensitivity&&(c.scrollParent[0].scrollTop=g=c.scrollParent[0].scrollTop-k.scrollSpeed)),k.axis&&"y"==k.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-e.pageX<k.scrollSensitivity?c.scrollParent[0].scrollLeft=g=c.scrollParent[0].scrollLeft+k.scrollSpeed:e.pageX-c.overflowOffset.left<k.scrollSensitivity&&(c.scrollParent[0].scrollLeft=g=c.scrollParent[0].scrollLeft-k.scrollSpeed))):(k.axis&&"x"==k.axis||(e.pageY-a(document).scrollTop()<k.scrollSensitivity?g=a(document).scrollTop(a(document).scrollTop()-
k.scrollSpeed):a(window).height()-(e.pageY-a(document).scrollTop())<k.scrollSensitivity&&(g=a(document).scrollTop(a(document).scrollTop()+k.scrollSpeed))),k.axis&&"y"==k.axis||(e.pageX-a(document).scrollLeft()<k.scrollSensitivity?g=a(document).scrollLeft(a(document).scrollLeft()-k.scrollSpeed):a(window).width()-(e.pageX-a(document).scrollLeft())<k.scrollSensitivity&&(g=a(document).scrollLeft(a(document).scrollLeft()+k.scrollSpeed))));!1!==g&&a.ui.ddmanager&&!k.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,
e)}});a.ui.plugin.add("draggable","snap",{start:function(e,d){var c=a(this).data("draggable"),k=c.options;c.snapElements=[];a(k.snap.constructor!=String?k.snap.items||":data(draggable)":k.snap).each(function(){var d=a(this),e=d.offset();this!=c.element[0]&&c.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),top:e.top,left:e.left})})},drag:function(e,d){for(var c=a(this).data("draggable"),k=c.options,g=k.snapTolerance,h=d.offset.left,b=h+c.helperProportions.width,m=d.offset.top,
n=m+c.helperProportions.height,p=c.snapElements.length-1;0<=p;p--){var q=c.snapElements[p].left,u=q+c.snapElements[p].width,x=c.snapElements[p].top,v=x+c.snapElements[p].height;if(q-g<h&&h<u+g&&x-g<m&&m<v+g||q-g<h&&h<u+g&&x-g<n&&n<v+g||q-g<b&&b<u+g&&x-g<m&&m<v+g||q-g<b&&b<u+g&&x-g<n&&n<v+g){if("inner"!=k.snapMode){var r=Math.abs(x-n)<=g,w=Math.abs(v-m)<=g,y=Math.abs(q-b)<=g,t=Math.abs(u-h)<=g;r&&(d.position.top=c._convertPositionTo("relative",{top:x-c.helperProportions.height,left:0}).top-c.margins.top);
w&&(d.position.top=c._convertPositionTo("relative",{top:v,left:0}).top-c.margins.top);y&&(d.position.left=c._convertPositionTo("relative",{top:0,left:q-c.helperProportions.width}).left-c.margins.left);t&&(d.position.left=c._convertPositionTo("relative",{top:0,left:u}).left-c.margins.left)}var D=r||w||y||t;"outer"!=k.snapMode&&(r=Math.abs(x-m)<=g,w=Math.abs(v-n)<=g,y=Math.abs(q-h)<=g,t=Math.abs(u-b)<=g,r&&(d.position.top=c._convertPositionTo("relative",{top:x,left:0}).top-c.margins.top),w&&(d.position.top=
c._convertPositionTo("relative",{top:v-c.helperProportions.height,left:0}).top-c.margins.top),y&&(d.position.left=c._convertPositionTo("relative",{top:0,left:q}).left-c.margins.left),t&&(d.position.left=c._convertPositionTo("relative",{top:0,left:u-c.helperProportions.width}).left-c.margins.left));!c.snapElements[p].snapping&&(r||w||y||t||D)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,e,a.extend(c._uiHash(),{snapItem:c.snapElements[p].item}));c.snapElements[p].snapping=r||w||y||t||D}else c.snapElements[p].snapping&&
c.options.snap.release&&c.options.snap.release.call(c.element,e,a.extend(c._uiHash(),{snapItem:c.snapElements[p].item})),c.snapElements[p].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(e,d){var c=a(this).data("draggable").options,c=a.makeArray(a(c.stack)).sort(function(c,d){return(parseInt(a(c).css("zIndex"),10)||0)-(parseInt(a(d).css("zIndex"),10)||0)});if(c.length){var k=parseInt(c[0].style.zIndex)||0;a(c).each(function(a){this.style.zIndex=k+a});this[0].style.zIndex=k+c.length}}});
a.ui.plugin.add("draggable","zIndex",{start:function(e,d){var c=a(d.helper),k=a(this).data("draggable").options;c.css("zIndex")&&(k._zIndex=c.css("zIndex"));c.css("zIndex",k.zIndex)},stop:function(e,d){var c=a(this).data("draggable").options;c._zIndex&&a(d.helper).css("zIndex",c._zIndex)}})})(jQuery);
(function(a,e){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var e=this.options,d=e.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(d)?d:function(a){return a.is(d)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[e.scope]=a.ui.ddmanager.droppables[e.scope]||[];a.ui.ddmanager.droppables[e.scope].push(this);
e.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var e=a.ui.ddmanager.droppables[this.options.scope],d=0;d<e.length;d++)e[d]==this&&e.splice(d,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(e,d){"accept"==e&&(this.accept=a.isFunction(d)?d:function(a){return a.is(d)});a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var d=a.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);d&&this._trigger("activate",e,this.ui(d))},_deactivate:function(e){var d=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);d&&this._trigger("deactivate",e,this.ui(d))},_over:function(e){var d=a.ui.ddmanager.current;d&&(d.currentItem||d.element)[0]!=this.element[0]&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
e,this.ui(d)))},_out:function(e){var d=a.ui.ddmanager.current;d&&(d.currentItem||d.element)[0]!=this.element[0]&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(d)))},_drop:function(e,d){var c=d||a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var k=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var d=
a.data(this,"droppable");if(d.options.greedy&&!d.options.disabled&&d.options.scope==c.options.scope&&d.accept.call(d.element[0],c.currentItem||c.element)&&a.ui.intersect(c,a.extend(d,{offset:d.element.offset()}),d.options.tolerance))return k=!0,!1}),k?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(c)),
this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.23"});a.ui.intersect=function(e,d,c){if(!d.offset)return!1;var k=(e.positionAbs||e.position.absolute).left,g=k+e.helperProportions.width,h=(e.positionAbs||e.position.absolute).top,b=h+e.helperProportions.height,m=d.offset.left,n=m+d.proportions.width,p=d.offset.top,q=p+d.proportions.height;switch(c){case "fit":return m<=k&&g<=
n&&p<=h&&b<=q;case "intersect":return m<k+e.helperProportions.width/2&&g-e.helperProportions.width/2<n&&p<h+e.helperProportions.height/2&&b-e.helperProportions.height/2<q;case "pointer":return a.ui.isOver((e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,p,m,d.proportions.height,d.proportions.width);case "touch":return(h>=p&&h<=q||b>=p&&b<=q||h<p&&b>q)&&(k>=m&&k<=n||g>=m&&g<=n||k<m&&g>n);default:return!1}};
a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,d){var c=a.ui.ddmanager.droppables[e.options.scope]||[],k=d?d.type:null,g=(e.currentItem||e.element).find(":data(droppable)").andSelf(),h=0;a:for(;h<c.length;h++)if(!(c[h].options.disabled||e&&!c[h].accept.call(c[h].element[0],e.currentItem||e.element))){for(var b=0;b<g.length;b++)if(g[b]==c[h].element[0]){c[h].proportions.height=0;continue a}c[h].visible="none"!=c[h].element.css("display");c[h].visible&&("mousedown"==
k&&c[h]._activate.call(c[h],d),c[h].offset=c[h].element.offset(),c[h].proportions={width:c[h].element[0].offsetWidth,height:c[h].element[0].offsetHeight})}},drop:function(e,d){var c=!1;return a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance)&&(c=this._drop.call(this,d)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=1,this.isover=
0,this._deactivate.call(this,d)))}),c},dragStart:function(e,d){e.element.parents(":not(body,html)").bind("scroll.droppable",function(){e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,d)})},drag:function(e,d){e.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(e,d);a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c=a.ui.intersect(e,this,this.options.tolerance);if(c=c||1!=this.isover?c&&0==this.isover?
"isover":null:"isout"){var k;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(k=a.data(g[0],"droppable"),k.greedyChild="isover"==c?1:0)}k&&"isover"==c&&(k.isover=0,k.isout=1,k._out.call(k,d));this[c]=1;this["isout"==c?"isover":"isout"]=0;this["isover"==c?"_over":"_out"].call(this,d);k&&"isout"==c&&(k.isout=0,k.isover=1,k._over.call(k,d))}}})},dragStop:function(e,d){e.element.parents(":not(body,html)").unbind("scroll.droppable");e.options.refreshPositions||a.ui.ddmanager.prepareOffsets(e,
d)}}})(jQuery);
(function(a){function e(a,c){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var d=a.originalEvent.changedTouches[0],b=document.createEvent("MouseEvents");b.initMouseEvent(c,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(b)}}a.support.touch="ontouchend"in document;if(a.support.touch){var f=a.ui.mouse.prototype,d=f._mouseInit,c;f._touchStart=function(a){!c&&this._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,this._touchMoved=!1,
e(a,"mouseover"),e(a,"mousemove"),e(a,"mousedown"))};f._touchMove=function(a){c&&(this._touchMoved=!0,e(a,"mousemove"))};f._touchEnd=function(a){c&&(e(a,"mouseup"),e(a,"mouseout"),this._touchMoved||e(a,"click"),c=!1)};f._mouseInit=function(){this.element.bind("touchstart",a.proxy(this,"_touchStart")).bind("touchmove",a.proxy(this,"_touchMove")).bind("touchend",a.proxy(this,"_touchEnd"));d.call(this)}}})(jQuery);
jQuery.fn.uniform=function(a){var e=this,f={},d=jQuery.extend(jQuery.fn.uniform.defaults,a),c=jQuery.fn.uniform.language;this.validators={get_val:function(a,b,c){b=b.split(" ");for(var d=0;d<b.length;d+=1)if(b[d]===a&&"undefined"!=b[d+1]&&"val-"===b[d+1].substr(0,4)){c=parseInt(b[d+1].substr(4),10);break}return c},required:function(a,b){var c;return a.is(":radio")?(c=a.attr("name"),$("input[name="+c+"]:checked").length?!0:g("req_radio",b)):a.is(":checkbox")?(a.attr("name"),a.is(":checked")?!0:g("req_checkbox",
b)):""===jQuery.trim(a.val())?g("required",b):!0},validateMinLength:function(a,b){var c=this.get_val("validateMinLength",a.attr("class"),0);return 0<c&&a.val().length<c?g("minlength",b,c):!0},validateMin:function(a,b){var c=this.get_val("validateMin",a.attr("class"),0);return parseInt(a.val(),10)<c?g("min",b,c):!0},validateMaxLength:function(a,b){var c=this.get_val("validateMaxLength",a.attr("class"),0);return 0<c&&a.val().length>c?g("maxlength",b,c):!0},validateMax:function(a,b){var c=this.get_val("validateMax",
a.attr("class"),0);return parseInt(a.val(),10)>c?g("max",b,c):!0},validateSameAs:function(a,b){var c=a.attr("class").split(" "),d;d="";for(var e=0;e<c.length;e+=1)if("validateSameAs"===c[e]&&"undefined"!=c[e+1]){d=c[e+1];break}return d&&(c=a.parents("form:first"),d=jQuery('input[name="'+d+'"]',c),0<d.length&&d.val()!=a.val())?(d=k(d),g("same_as",b,d)):!0},validateEmail:function(a,b){return a.val().match(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)?!0:g("email",b)},validateEmails:function(a,
b){for(var c=a.val().split(","),d=0;d<c.length;d++)if(!$.trim(c[d]).match(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/))return g("email",b);return!0},validateUrl:function(a,b){return a.val().match(/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i)?!0:g("url",b)},validateNumber:function(a,b){return a.val().match(/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/)||""===a.val()?!0:g("number",b)},validateInteger:function(a,b){return a.val().match(/(^-?\d\d*$)/)||
""===a.val()?!0:g("integer",b)},validateAlpha:function(a,b){return a.val().match(/^[a-zA-Z]+$/)?!0:g("alpha",b)},validateAlphaNum:function(a,b){return a.val().match(/\W/)?g("alphanum",b):!0},validatePhrase:function(a,b){return""===a.val()||a.val().match(/^[\w\d\.\-_\(\)\*'# :,]+$/i)?!0:g("phrase",b)},validatePhone:function(a,b){return/^\(?(\d{3})\)?[\- ]?(\d{3})[\- ]?(\d{4})$/.test(a.val())?!0:g("phone",b)},validateDate:function(a,b){return a.val().match("([0]?[1-9]|[1][0-2])/([0]?[1-9]|[1|2][0-9]|[3][0|1])/([0-9]{4}|[0-9]{2})$")?
!0:g("date",b)},validateCallback:function(a,b){for(var c=a.attr("class").split(" "),d="",e=0;e<c.length;e+=1)if("validateCallback"===c[e]&&"undefined"!=c[e+1]){d=c[e+1];break}return"undefined"!=window[d]&&"function"===typeof window[d]?window[d](a,b):g("callback",b,d)}};var k=function(a){var b=a.closest("label").text();""===b&&(b=a.closest("div."+d.holder_class).find("label").text());return b.replace("*","").replace(":","")},g=function(a){for(var b=c[a].split("%"),d=b[0],e=/^([ds])(.*)$/,g,f=1;f<b.length;f+=
1)(g=e.exec(b[f]))&&null!==arguments[f]&&("d"===g[1]?d+=parseInt(arguments[f],10):"s"===g[1]&&(d+=arguments[f]),d+=g[2]);return d};return this.each(function(){var a=jQuery(this),b=function(a,b,c){a.closest("div."+d.holder_class).andSelf().toggleClass(d.invalid_class,!b).toggleClass(d.error_class,!b).toggleClass(d.valid_class,b).find("span.help-inline").toggleClass("visuallyhidden",b);b?name in f&&delete f[name]:f[name]=c};a.find(d.field_selector).each(function(){var a=$(this),b=a.val();a.data("default-color",
a.css("color"));b!==a.data("default-value")&&b||(a.not("select").css("color",d.default_value_color),a.val(a.attr("data-default-value")))});if(d.ask_on_leave||a.hasClass("askOnLeave")){var c=a.serialize();$(window).bind("beforeunload",function(b){if(c!=a.serialize()&&(d.ask_on_leave||a.hasClass("askOnLeave")))return $.isFunction(d.on_leave_callback)?d.on_leave_callback(a):confirm(g("on_leave"))})}a.submit(function(){var b,c=!0;a.removeClass("failedSubmit");d.ask_on_leave=!1;a.removeClass("askOnLeave");
a.find(d.field_selector).each(function(){$(this).val()===$(this).data("default-value")&&$(this).val("")});if(d.prevent_submit||a.hasClass("preventSubmit")){if(a.find(d.field_selector).each(function(){$(this).blur()}),$.isFunction(d.submit_callback)&&(c=d.submit_callback(a)),a.find("."+d.invalid_class).add("."+d.error_class).length||!c)b=$.isFunction(d.prevent_submit_callback)?d.prevent_submit_callback(a,g("submit_msg"),[g("submit_help")]):jQuery.fn.uniform.showFormError(a,g("submit_msg"),[g("submit_help")])}else b=
!0;a.parents("#qunit-fixture").length&&(b=!1);!1===b&&a.addClass("failedSubmit");return b});a.delegate(d.field_selector,"focus",function(){a.find("."+d.focused_class).removeClass(d.focused_class);var b=$(this);b.parents().filter("."+d.holder_class+":first").addClass(d.focused_class);b.val()===b.data("default-value")&&b.val("");b.not("select").css("color",b.data("default-color"))});a.delegate(d.field_selector,"blur",function(){var b=$(this),c=!1,g,f=k($(this));a.find("."+d.focused_class).removeClass(d.focused_class);
if(""!==b.val()&&b.val()!==b.data("default-value")||b.hasClass("required")){for(g in e.validators)if(b.hasClass(g)){var c=!0,m=e.validators[g](b,f);if("string"===typeof m){b.trigger("error",m);return}}c&&b.trigger("success");b.css("color",b.data("default-color"))}else b.not("select").css("color",d.default_value_color),b.val(b.data("default-value"))});a.delegate(d.field_selector,"error",function(a,c){b($(this),!1,c)});a.delegate(d.field_selector,"success",function(a,c){b($(this),!0)});$("input[autofocus]:first").focus()})};
jQuery.fn.uniform.showFormError=function(a,e,f){var d;$("#errorMsg").length&&$("#errorMsg").remove();e=$("<div />").attr("id","errorMsg").html("<h3>"+e+"</h3>");if(f.length)for(d in e.append($("<ol />")),f)$("ol",e).append($("<li />").text(f[d]));a.prepend(e);$("html, body").animate({scrollTop:a.offset().top},500);$("#errorMsg").slideDown();return!1};
jQuery.fn.uniform.showFormSuccess=function(a,e){var f;$("#okMsg").length&&$("#okMsg").remove();f=$("<div />").attr("id","okMsg").html("<h3>"+e+"</h3>");a.prepend(f);$("html, body").animate({scrollTop:a.offset().top},500);$("#okMsg").slideDown();return!1};
jQuery.fn.uniform.language={required:"%s is required",req_radio:"Please make a selection",req_checkbox:"You must select this checkbox to continue",minlength:"%s should be at least %d characters long",min:"%s should be greater than or equal to %d",maxlength:"%s should not be longer than %d characters",max:"%s should be less than or equal to %d",same_as:"%s is expected to be same as %s",email:"%s is not a valid email address",url:"%s is not a valid URL",number:"%s needs to be a number",integer:"%s needs to be a whole number",
alpha:"%s should contain only letters (without special characters or numbers)",alphanum:"%s should contain only numbers and letters (without special characters)",phrase:"%s should contain only alphabetic characters, numbers, spaces, and the following: . , - _ () * # :",phone:"%s should be a phone number",date:"%s should be a date (mm/dd/yyyy)",callback:"Failed to validate %s field. Validator function (%s) is not defined!",on_leave:"Are you sure you want to leave this page without saving this form?",
submit_msg:"Sorry, this form needs corrections.",submit_help:"Please see the items marked below.",submit_success:"Thank you, this form has been sent."};jQuery.fn.uniform.defaults={submit_callback:!1,prevent_submit:!1,prevent_submit_callback:!1,ask_on_leave:!1,on_leave_callback:!1,valid_class:"valid",invalid_class:"invalid",error_class:"error",focused_class:"focused",holder_class:"ctrlHolder",field_selector:"input, textarea, select",default_value_color:"#AFAFAF"};
(function(a){function e(){if(g.jStorage)try{k=n(String(g.jStorage))}catch(a){g.jStorage="{}"}else g.jStorage="{}";b=g.jStorage?String(g.jStorage).length:0}function f(){try{g.jStorage=m(k),h&&(h.setAttribute("jStorage",g.jStorage),h.save("jStorage")),b=g.jStorage?String(g.jStorage).length:0}catch(a){}}function d(a){if(!a||"string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==a)throw new TypeError("Reserved key name");return!0}function c(){var a,
b,d,e=Infinity,g=!1;clearTimeout(q);if(k.__jstorage_meta&&"object"==typeof k.__jstorage_meta.TTL){a=+new Date;d=k.__jstorage_meta.TTL;for(b in d)d.hasOwnProperty(b)&&(d[b]<=a?(delete d[b],delete k[b],g=!0):d[b]<e&&(e=d[b]));Infinity!=e&&(q=setTimeout(c,e-a));g&&f()}}if(!a||!(a.toJSON||Object.toJSON||window.JSON))throw Error("jQuery, MooTools or Prototype needs to be loaded before jStorage!");var k={},g={jStorage:"{}"},h=null,b=0,m=a.toJSON||Object.toJSON||window.JSON&&(JSON.encode||JSON.stringify),
n=a.evalJSON||window.JSON&&(JSON.decode||JSON.parse)||function(a){return String(a).evalJSON()},p=!1,q,u={isXML:function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?"HTML"!==a.nodeName:!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");b.async=
"false";b.loadXML(a);return b};if(!b)return!1;a=b.call("DOMParser"in window&&new DOMParser||window,a,"text/xml");return this.isXML(a)?a:!1}};a.jStorage={version:"0.1.6.1",set:function(a,b){d(a);u.isXML(b)?b={_is_xml:!0,xml:u.encode(b)}:"function"==typeof b?b=null:b&&"object"==typeof b&&(b=n(m(b)));k[a]=b;f();return b},get:function(a,b){d(a);return a in k?k[a]&&"object"==typeof k[a]&&k[a]._is_xml&&k[a]._is_xml?u.decode(k[a].xml):k[a]:"undefined"==typeof b?null:b},deleteKey:function(a){d(a);return a in
k?(delete k[a],k.__jstorage_meta&&"object"==typeof k.__jstorage_meta.TTL&&a in k.__jstorage_meta.TTL&&delete k.__jstorage_meta.TTL[a],f(),!0):!1},setTTL:function(a,b){var e=+new Date;d(a);b=Number(b)||0;return a in k?(k.__jstorage_meta||(k.__jstorage_meta={}),k.__jstorage_meta.TTL||(k.__jstorage_meta.TTL={}),0<b?k.__jstorage_meta.TTL[a]=e+b:delete k.__jstorage_meta.TTL[a],f(),c(),!0):!1},flush:function(){k={};f();return!0},storageObj:function(){function a(){}a.prototype=k;return new a},index:function(){var a=
[],b;for(b in k)k.hasOwnProperty(b)&&"__jstorage_meta"!=b&&a.push(b);return a},storageSize:function(){return b},currentBackend:function(){return p},storageAvailable:function(){return!!p},reInit:function(){var a;if(h&&h.addBehavior){a=document.createElement("link");h.parentNode.replaceChild(a,h);h=a;h.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(h);h.load("jStorage");a="{}";try{a=h.getAttribute("jStorage")}catch(b){}g.jStorage=a;p="userDataBehavior"}e()}};
(function(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(g=window.localStorage,p="localStorage")}catch(b){}else if("globalStorage"in window)try{window.globalStorage&&(g=window.globalStorage[window.location.hostname],p="globalStorage")}catch(b){}else if(h=document.createElement("link"),h.addBehavior){h.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(h);
h.load("jStorage");a="{}";try{a=h.getAttribute("jStorage")}catch(b){}g.jStorage=a;p="userDataBehavior"}else{h=null;return}e();c()})()})(window.jQuery||window.$);
(function(a){"function"===typeof define&&define.amd?define(["knockout","jquery","jquery.ui.sortable"],a):a(window.ko,jQuery)})(function(a,e){var f=a.utils.unwrapObservable,d=a.utils.domData.get,c=a.utils.domData.set,k=function(b,e){a.utils.arrayForEach(b,function(a){1===a.nodeType&&(c(a,"ko_sortItem",e),c(a,"ko_parentList",d(a.parentNode,"ko_sortList")))})},g=function(b,c){var d={},e=f(b())||{},g;e.data?(d[c]=e.data,d.name=e.template):d[c]=b();a.utils.arrayForEach("afterAdd afterRender as beforeRemove includeDestroyed templateEngine templateOptions".split(" "),
function(b){d[b]=e[b]||a.bindingHandlers.sortable[b]});"foreach"===c&&(d.afterRender?(g=d.afterRender,d.afterRender=function(a,b){k.call(b,a,b);g.call(b,a,b)}):d.afterRender=k);return d},h=function(a,c){var d=f(c);if(d)for(var e=0;e<a;e++)d[e]&&f(d[e]._destroy)&&a++;return a};a.bindingHandlers.sortable={init:function(b,k,n,p,q){var u=e(b),x=f(k())||{},v=g(k,"foreach"),r={},w,y;u.contents().each(function(){this&&1!==this.nodeType&&b.removeChild(this)});e.extend(!0,r,a.bindingHandlers.sortable);x.options&&
r.options&&(a.utils.extend(r.options,x.options),delete x.options);a.utils.extend(r,x);r.connectClass&&(a.isObservable(r.allowDrop)||"function"==typeof r.allowDrop)?a.computed({read:function(){var c=f(r.allowDrop),c="function"==typeof c?c.call(this,v.foreach):c;a.utils.toggleDomNodeCssClass(b,r.connectClass,c)},disposeWhenNodeIsRemoved:b},this):a.utils.toggleDomNodeCssClass(b,r.connectClass,r.allowDrop);a.bindingHandlers.template.init(b,function(){return v},n,p,q);w=r.options.start;y=r.options.update;
var t=setTimeout(function(){var g;u.sortable(a.utils.extend(r.options,{start:function(b,d){var e=d.item[0];c(e,"ko_sourceIndex",a.utils.arrayIndexOf(d.item.parent().children(),e));d.item.find("input:focus").change();w&&w.apply(this,arguments)},receive:function(a,b){if(g=d(b.item[0],"ko_dragItem"))g.clone&&(g=g.clone()),r.dragged&&(g=r.dragged.call(this,g,a,b)||g)},update:function(b,f){var k,m,n,q,t,p=f.item[0];k=f.item.parent()[0];var l=d(p,"ko_sortItem")||g;g=null;if(l&&(this===k||e.contains(this,
k))){k=d(p,"ko_parentList");n=d(p,"ko_sourceIndex");m=d(p.parentNode,"ko_sortList");q=a.utils.arrayIndexOf(f.item.parent().children(),p);v.includeDestroyed||(n=h(n,k),q=h(q,m));if(r.beforeMove||r.afterMove)t={item:l,sourceParent:k,sourceParentNode:k&&f.sender||p.parentNode,sourceIndex:n,targetParent:m,targetIndex:q,cancelDrop:!1},r.beforeMove&&r.beforeMove.call(this,t,b,f);k?e(k===m?this:f.sender).sortable("cancel"):e(p).remove();if(t&&t.cancelDrop)return;0<=q&&(k&&(k.splice(n,1),a.processAllDeferredBindingUpdates&&
a.processAllDeferredBindingUpdates()),m.splice(q,0,l));c(p,"ko_sortItem",null);a.processAllDeferredBindingUpdates&&a.processAllDeferredBindingUpdates();r.afterMove&&r.afterMove.call(this,t,b,f)}y&&y.apply(this,arguments)},connectWith:r.connectClass?"."+r.connectClass:!1}));void 0!==r.isEnabled&&a.computed({read:function(){u.sortable(f(r.isEnabled)?"enable":"disable")},disposeWhenNodeIsRemoved:b})},0);a.utils.domNodeDisposal.addDisposeCallback(b,function(){(u.data("ui-sortable")||u.data("sortable"))&&
u.sortable("destroy");clearTimeout(t)});return{controlsDescendantBindings:!0}},update:function(b,d,e,f,h){var k=g(d,"foreach");c(b,"ko_sortList",k.foreach);a.bindingHandlers.template.update(b,function(){return k},e,f,h)},connectClass:"ko_container",allowDrop:!0,afterMove:null,beforeMove:null,options:{}};a.bindingHandlers.draggable={init:function(b,d,h,k,q){var u=f(d())||{},x=u.options||{},v=a.utils.extend({},a.bindingHandlers.draggable.options),r=g(d,"data");d=u.connectClass||a.bindingHandlers.draggable.connectClass;
var w=void 0!==u.isEnabled?u.isEnabled:a.bindingHandlers.draggable.isEnabled,u=u.data||u;c(b,"ko_dragItem",u);a.utils.extend(v,x);v.connectToSortable=d?"."+d:!1;e(b).draggable(v);void 0!==w&&a.computed({read:function(){e(b).draggable(f(w)?"enable":"disable")},disposeWhenNodeIsRemoved:b});return a.bindingHandlers.template.init(b,function(){return r},h,k,q)},update:function(b,c,d,e,f){var h=g(c,"data");return a.bindingHandlers.template.update(b,function(){return h},d,e,f)},connectClass:a.bindingHandlers.sortable.connectClass,
options:{helper:"clone"}}});
(function(a){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?a(require("knockout"),exports):"function"===typeof define&&define.amd?define(["knockout","exports"],a):a(ko,ko.validation={})})(function(a,e){function f(a){var b="max"===a;return function(d,e){if(c.utils.isEmptyVal(d))return!0;var g,f;void 0===e.typeAttr?(f="text",g=e):(f=e.typeAttr,g=e.value);isNaN(g)||g instanceof Date||(f="number");var h;switch(f.toLowerCase()){case "week":h=/^(\d{4})-W(\d{2})$/;f=d.match(h);
if(null===f)throw Error("Invalid value for "+a+" attribute for week input.  Should look like '2000-W33' http://www.w3.org/TR/html-markup/input.week.html#input.week.attrs.min");return(g=g.match(h))?b?f[1]<g[1]||f[1]===g[1]&&f[2]<=g[2]:f[1]>g[1]||f[1]===g[1]&&f[2]>=g[2]:!1;case "month":h=/^(\d{4})-(\d{2})$/;f=d.match(h);if(null===f)throw Error("Invalid value for "+a+" attribute for month input.  Should look like '2000-03' http://www.w3.org/TR/html-markup/input.month.html#input.month.attrs.min");return(g=
g.match(h))?b?f[1]<g[1]||f[1]===g[1]&&f[2]<=g[2]:f[1]>g[1]||f[1]===g[1]&&f[2]>=g[2]:!1;case "number":case "range":return b?!isNaN(d)&&parseFloat(d)<=parseFloat(g):!isNaN(d)&&parseFloat(d)>=parseFloat(g);default:return b?d<=g:d>=g}}}function d(a,b,d){a.isValidating(!0);var e=function(e){var f,h="";a.__valid__()&&(e.message?(f=e.isValid,h=e.message):f=e,f||(a.error(c.formatMessage(h||d.message||b.message,g(d.params),a)),a.__valid__(f)));a.isValidating(!1)};c.utils.async(function(){b.validator(a(),void 0===
d.params?!0:g(d.params),e)})}if("undefined"===typeof a)throw Error("Knockout is required, please ensure it is loaded before loading this validation plug-in");a.validation=e;var c=a.validation,k=a.utils,g=k.unwrapObservable,h=k.arrayForEach,b=k.extend,m={registerExtenders:!0,messagesOnModified:!0,errorsAsTitle:!0,errorsAsTitleOnModified:!1,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateInputElement:!1,decorateElementOnModified:!0,errorClass:null,errorElementClass:"validationElement",
errorMessageClass:"validationMessage",allowHtmlMessages:!1,grouping:{deep:!1,observable:!0,live:!1},validate:{}},n=b({},m);n.html5Attributes=["required","pattern","min","max","step"];n.html5InputTypes=["email","number","date"];n.reset=function(){b(n,m)};c.configuration=n;c.utils=function(){var a=(new Date).getTime(),b={};return{isArray:function(a){return a.isArray||"[object Array]"===Object.prototype.toString.call(a)},isObject:function(a){return null!==a&&"object"===typeof a},isNumber:function(a){return!isNaN(a)},
isObservableArray:function(a){return!!a&&"function"===typeof a.remove&&"function"===typeof a.removeAll&&"function"===typeof a.destroy&&"function"===typeof a.destroyAll&&"function"===typeof a.indexOf&&"function"===typeof a.replace},values:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},getValue:function(a){return"function"===typeof a?a():a},hasAttribute:function(a,b){return null!==a.getAttribute(b)},getAttribute:function(a,b){return a.getAttribute(b)},setAttribute:function(a,
b,c){return a.setAttribute(b,c)},isValidatable:function(a){return!!(a&&a.rules&&a.isValid&&a.isModified)},insertAfter:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},newId:function(){return a+=1},getConfigOptions:function(a){return c.utils.contextFor(a)||c.configuration},setDomData:function(a,d){var e=a.__ko_validation__;e||(a.__ko_validation__=e=c.utils.newId());b[e]=d},getDomData:function(a){return(a=a.__ko_validation__)?b[a]:void 0},contextFor:function(a){switch(a.nodeType){case 1:case 8:var b=
c.utils.getDomData(a);if(b)return b;if(a.parentNode)return c.utils.contextFor(a.parentNode)}},isEmptyVal:function(a){if(void 0===a||null===a||""===a)return!0},getOriginalElementTitle:function(a){var b=c.utils.getAttribute(a,"data-orig-title"),d=a.title;return c.utils.hasAttribute(a,"data-orig-title")?b:d},async:function(a){window.setImmediate?window.setImmediate(a):window.setTimeout(a,0)},forEach:function(a,b){if(c.utils.isArray(a))return h(a,b);for(var d in a)a.hasOwnProperty(d)&&b(a[d],d)}}}();
var p=function(){function d(a){h(a.subscriptions,function(a){a.dispose()});a.subscriptions=[]}function e(a){a.options.deep&&(h(a.flagged,function(a){delete a.__kv_traversed}),a.flagged.length=0);a.options.live||d(a)}function f(a,b){b.validatables=[];d(b);m(a,b);e(b)}function m(b,c,d){var e=[],g=b.peek?b.peek():b;!0!==b.__kv_traversed&&(c.options.deep&&(b.__kv_traversed=!0,c.flagged.push(b)),d=void 0!==d?d:c.options.deep?1:-1,a.isObservable(b)&&(b.errors||u.isValidatable(b)||b.extend({validatable:!0}),
c.validatables.push(b),c.options.live&&u.isObservableArray(b)&&c.subscriptions.push(b.subscribe(function(){c.graphMonitor.valueHasMutated()}))),g&&!g._destroy&&(u.isArray(g)?e=g:u.isObject(g)&&(e=u.values(g))),0!==d&&u.forEach(e,function(b){!b||b.nodeType||a.isComputed(b)&&!b.rules||m(b,c,d+1)}))}function n(a){var b=[];h(a,function(a){u.isValidatable(a)&&!a.isValid()&&b.push(a.error.peek())});return b}var q=0,p=c.configuration,u=c.utils;return{init:function(a,d){0<q&&!d||(a=a||{},a.errorElementClass=
a.errorElementClass||a.errorClass||p.errorElementClass,a.errorMessageClass=a.errorMessageClass||a.errorClass||p.errorMessageClass,b(p,a),p.registerExtenders&&c.registerExtenders(),q=1)},reset:c.configuration.reset,group:function(c,d){d=b(b({},p.grouping),d);var e={options:d,graphMonitor:a.observable(),flagged:[],subscriptions:[],validatables:[]},g=null,g=d.observable?a.computed(function(){e.graphMonitor();f(c,e);return n(e.validatables)}):function(){f(c,e);return n(e.validatables)};g.showAllMessages=
function(a){void 0===a&&(a=!0);g.forEach(function(b){u.isValidatable(b)&&b.isModified(a)})};g.isAnyMessageShown=function(){return!!g.find(function(a){return u.isValidatable(a)&&!a.isValid()&&a.isModified()})};g.filter=function(a){a=a||function(){return!0};g();return k.arrayFilter(e.validatables,a)};g.find=function(a){a=a||function(){return!0};g();return k.arrayFirst(e.validatables,a)};g.forEach=function(a){a=a||function(){};g();h(e.validatables,a)};g.map=function(a){a=a||function(a){return a};g();
return k.arrayMap(e.validatables,a)};g._updateState=function(a){if(!u.isObject(a))throw Error("An object is required.");c=a;if(d.observable)e.graphMonitor.valueHasMutated();else return f(a,e),n(e.validatables)};return g},formatMessage:function(a,b,c){u.isObject(b)&&b.typeAttr&&(b=b.value);if("function"===typeof a)return a(b,c);var d=g(b);null==d&&(d=[]);u.isArray(d)||(d=[d]);return a.replace(/{(\d+)}/gi,function(a,b){return"undefined"!==typeof d[b]?d[b]:a})},addRule:function(a,b){a.extend({validatable:!0});
k.arrayFirst(a.rules(),function(a){return a.rule&&a.rule===b.rule})||a.rules.push(b);return a},addAnonymousRule:function(a,b){void 0===b.message&&(b.message="Error");b.onlyIf&&(b.condition=b.onlyIf);c.addRule(a,b)},addExtender:function(b){a.extenders[b]=function(a,d){return d&&(d.message||d.onlyIf)?c.addRule(a,{rule:b,message:d.message,params:u.isEmptyVal(d.params)?!0:d.params,condition:d.onlyIf}):c.addRule(a,{rule:b,params:d})}},registerExtenders:function(){if(p.registerExtenders)for(var b in c.rules)c.rules.hasOwnProperty(b)&&
(a.extenders[b]||c.addExtender(b))},insertValidationMessage:function(a){var b=document.createElement("SPAN");b.className=u.getConfigOptions(a).errorMessageClass;u.insertAfter(a,b);return b},parseInputValidationAttributes:function(a,b){h(c.configuration.html5Attributes,function(d){if(u.hasAttribute(a,d)){var e=a.getAttribute(d)||!0;if("min"===d||"max"===d){var g=a.getAttribute("type");"undefined"!==typeof g&&g||(g="text");e={typeAttr:g,value:e}}c.addRule(b(),{rule:d,params:e})}});var d=a.getAttribute("type");
h(c.configuration.html5InputTypes,function(a){a===d&&c.addRule(b(),{rule:"date"===a?"dateISO":a,params:!0})})},writeInputValidationAttributes:function(b,d){var e=d();if(e&&e.rules){var g=e.rules();h(c.configuration.html5Attributes,function(c){var d=k.arrayFirst(g,function(a){return a.rule&&a.rule.toLowerCase()===c.toLowerCase()});d&&a.computed({read:function(){var e=a.unwrap(d.params);"pattern"===d.rule&&e instanceof RegExp&&(e=e.source);b.setAttribute(c,e)},disposeWhenNodeIsRemoved:b})});g=null}},
makeBindingHandlerValidatable:function(b){var c=a.bindingHandlers[b].init;a.bindingHandlers[b].init=function(b,d,e,g,f){c(b,d,e,g,f);return a.bindingHandlers.validationCore.init(b,d,e,g,f)}},setRules:function(b,d){var e=function(b,d){if(b&&d)for(var f in d)if(d.hasOwnProperty(f)){var h=d[f];if(b[f]){var k=b[f],m=g(k),n={},q={},p;for(p in h)h.hasOwnProperty(p)&&(c.rules[p]?n[p]=h[p]:q[p]=h[p]);a.isObservable(k)&&k.extend(n);if(m&&u.isArray(m))for(h=0;h<m.length;h++)e(m[h],q);else e(m,q)}}};e(b,d)}}}();
b(a.validation,p);c.rules={};c.rules.required={validator:function(a,b){var c;if(void 0===a||null===a)return!b;c=a;"string"===typeof a&&(c=String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,""));return b?0<(c+"").length:!0},message:"This field is required."};c.rules.min={validator:f("min"),message:"Please enter a value greater than or equal to {0}."};c.rules.max={validator:f("max"),message:"Please enter a value less than or equal to {0}."};c.rules.minLength={validator:function(a,b){return c.utils.isEmptyVal(a)?
!0:(c.utils.isNumber(a)?""+a:a).length>=b},message:"Please enter at least {0} characters."};c.rules.maxLength={validator:function(a,b){return c.utils.isEmptyVal(a)?!0:(c.utils.isNumber(a)?""+a:a).length<=b},message:"Please enter no more than {0} characters."};c.rules.pattern={validator:function(a,b){return c.utils.isEmptyVal(a)||null!==a.toString().match(b)},message:"Please check this value."};c.rules.step={validator:function(a,b){if(c.utils.isEmptyVal(a)||"any"===b)return!0;var d=100*a%(100*b);return 1E-5>
Math.abs(d)||1E-5>Math.abs(1-d)},message:"The value must increment by {0}."};c.rules.email={validator:function(a,b){return b?c.utils.isEmptyVal(a)||b&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a):
!0},message:"Please enter a proper email address."};c.rules.date={validator:function(a,b){return b?c.utils.isEmptyVal(a)||b&&!/Invalid|NaN/.test(new Date(a)):!0},message:"Please enter a proper date."};c.rules.dateISO={validator:function(a,b){return b?c.utils.isEmptyVal(a)||b&&/^\d{4}[-/](?:0?[1-9]|1[012])[-/](?:0?[1-9]|[12][0-9]|3[01])$/.test(a):!0},message:"Please enter a proper date."};c.rules.number={validator:function(a,b){return b?c.utils.isEmptyVal(a)||b&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a):
!0},message:"Please enter a number."};c.rules.digit={validator:function(a,b){return b?c.utils.isEmptyVal(a)||b&&/^\d+$/.test(a):!0},message:"Please enter a digit."};c.rules.phoneUS={validator:function(a,b){if(!b||c.utils.isEmptyVal(a))return!0;if("string"!==typeof a)return!1;a=a.replace(/\s+/g,"");return b&&9<a.length&&a.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},message:"Please specify a valid phone number."};c.rules.equal={validator:function(a,b){return a===c.utils.getValue(b)},
message:"Values must equal."};c.rules.notEqual={validator:function(a,b){return a!==c.utils.getValue(b)},message:"Please choose another value."};c.rules.unique={validator:function(a,b){var d=c.utils.getValue(b.collection),e=c.utils.getValue(b.externalValue),g=0;if(!a||!d)return!0;k.arrayFilter(d,function(c){a===(b.valueAccessor?b.valueAccessor(c):c)&&g++});return g<(e?1:2)},message:"Please make sure the value is unique."};c.registerExtenders();a.bindingHandlers.validationCore=function(){return{init:function(b,
d,e,g,f){e=c.utils.getConfigOptions(b);g=d();e.parseInputAttributes&&c.utils.async(function(){c.parseInputValidationAttributes(b,d)});e.insertMessages&&c.utils.isValidatable(g)&&(f=c.insertValidationMessage(b),e.messageTemplate?a.renderTemplate(e.messageTemplate,{field:g},null,f,"replaceNode"):a.applyBindingsToNode(f,{validationMessage:g}));e.writeInputAttributes&&c.utils.isValidatable(g)&&c.writeInputValidationAttributes(b,d);e.decorateInputElement&&c.utils.isValidatable(g)&&a.applyBindingsToNode(b,
{validationElement:g})}}}();c.makeBindingHandlerValidatable("value");c.makeBindingHandlerValidatable("checked");a.bindingHandlers.textInput&&c.makeBindingHandlerValidatable("textInput");c.makeBindingHandlerValidatable("selectedOptions");a.bindingHandlers.validationMessage={update:function(b,d){var e=d(),f=c.utils.getConfigOptions(b);g(e);var h=!1,m=!1;if(null===e||"undefined"===typeof e)throw Error("Cannot bind validationMessage to undefined value. data-bind expression: "+b.getAttribute("data-bind"));
var h=e.isModified&&e.isModified(),m=e.isValid&&e.isValid(),n=null;if(!f.messagesOnModified||h)n=m?null:e.error;e=!f.messagesOnModified||h?!m:!1;h="none"!==b.style.display;f.allowHtmlMessages?k.setHtml(b,n):a.bindingHandlers.text.update(b,function(){return n});h&&!e?b.style.display="none":!h&&e&&(b.style.display="")}};a.bindingHandlers.validationElement={update:function(b,d,e){var f=d(),h=c.utils.getConfigOptions(b);g(f);var k=!1,m=!1;if(null===f||"undefined"===typeof f)throw Error("Cannot bind validationElement to undefined value. data-bind expression: "+
b.getAttribute("data-bind"));k=f.isModified&&f.isModified();m=f.isValid&&f.isValid();a.bindingHandlers.css.update(b,function(){var a={};a[h.errorElementClass]=!h.decorateElementOnModified||k?!m:!1;return a},e);h.errorsAsTitle&&a.bindingHandlers.attr.update(b,function(){var a=!h.errorsAsTitleOnModified||k,d=c.utils.getOriginalElementTitle(b);if(a&&!m)return{title:f.error,"data-orig-title":d};if(!a||m)return{title:d,"data-orig-title":null}})}};a.bindingHandlers.validationOptions=function(){return{init:function(a,
d,e,f,h){if(d=g(d()))e=b({},c.configuration),b(e,d),c.utils.setDomData(a,e)}}}();a.extenders.validation=function(a,b){h(c.utils.isArray(b)?b:[b],function(b){c.addAnonymousRule(a,b)});return a};a.extenders.validatable=function(d,e){c.utils.isObject(e)||(e={enable:e});"enable"in e||(e.enable=!0);if(e.enable&&!c.utils.isValidatable(d)){var g=c.configuration.validate||{},g={throttleEvaluation:e.throttle||g.throttle};d.error=a.observable(null);d.rules=a.observableArray();d.isValidating=a.observable(!1);
d.__valid__=a.observable(!0);d.isModified=a.observable(!1);d.isValid=a.computed(d.__valid__);d.setError=function(a){var b=d.error.peek(),c=d.__valid__.peek();d.error(a);d.__valid__(!1);b===a||c||d.isValid.notifySubscribers()};d.clearError=function(){d.error(null);d.__valid__(!0);return d};var f=d.subscribe(function(){d.isModified(!0)}),h=a.computed(b({read:function(){d();d.rules();c.validateObservable(d);return!0}},g));b(h,g);d._disposeValidation=function(){d.isValid.dispose();d.rules.removeAll();
f.dispose();h.dispose();delete d.rules;delete d.error;delete d.isValid;delete d.isValidating;delete d.__valid__;delete d.isModified;delete d.setError;delete d.clearError;delete d._disposeValidation}}else!1===e.enable&&d._disposeValidation&&d._disposeValidation();return d};c.validateObservable=function(a){for(var b=0,e,f,h=a.rules(),k=h.length;b<k;b++)if(f=h[b],!f.condition||f.condition())if(e=f.rule?c.rules[f.rule]:f,e.async||f.async)d(a,e,f);else{var m;m=a;e.validator(m(),void 0===f.params?!0:g(f.params))?
m=!0:(m.setError(c.formatMessage(f.message||e.message,g(f.params),m)),m=!1);if(!m)return!1}a.clearError();return!0};var q={},u;c.defineLocale=function(a,b){return a&&b?q[a.toLowerCase()]=b:null};c.locale=function(a){if(a)if(a=a.toLowerCase(),q.hasOwnProperty(a))c.localize(q[a]),u=a;else throw Error("Localization "+a+" has not been loaded.");return u};c.localize=function(a){var b=c.rules,d;for(d in a)b.hasOwnProperty(d)&&(b[d].message=a[d])};(function(){var a={},b=c.rules,d;for(d in b)b.hasOwnProperty(d)&&
(a[d]=b[d].message);c.defineLocale("en-us",a)})();u="en-us";a.applyBindingsWithValidation=function(d,e,g){var f=document.body;e&&e.nodeType&&(f=e,e=g);c.init();e&&(e=b(b({},c.configuration),e),c.utils.setDomData(f,e));a.applyBindings(d,f)};var x=a.applyBindings;a.applyBindings=function(a,b){c.init();x(a,b)};a.validatedObservable=function(b,d){if(!d&&!c.utils.isObject(b))return a.observable(b).extend({validatable:!0});var e=a.observable(b);e.errors=c.group(c.utils.isObject(b)?b:{},d);e.isValid=a.observable(0===
e.errors().length);a.isObservable(e.errors)?e.errors.subscribe(function(a){e.isValid(0===a.length)}):a.computed(e.errors).subscribe(function(a){e.isValid(0===a.length)});e.subscribe(function(a){c.utils.isObject(a)||(a={});e.errors._updateState(a);e.isValid(0===e.errors().length)});return e}});
(function(a){var e;try{e=!!localStorage.getItem}catch(d){e=!1}var f;try{f=!!sessionStorage.getItem}catch(d){f=!1}return a.storage={sessionStorageAvailable:f,localStorageAvailable:e,get:function(a,c){if(window.JSON){if(c&&e)return JSON.parse(localStorage.getItem(a));if(f)return JSON.parse(sessionStorage.getItem(a))}else return null},set:function(a,c,k){window.JSON&&(k&&e?localStorage.setItem(a,JSON.stringify(c)):f&&sessionStorage.setItem(a,JSON.stringify(c)))},remove:function(a,c){c&&e?localStorage.removeItem(a):
f&&sessionStorage.removeItem(a)},clear:function(a){a&&e?localStorage.clear():f&&sessionStorage.clear()}}})(jQuery);
!function(a){function e(){}function f(a){function f(b){b.prototype.option||(b.prototype.option=function(b){a.isPlainObject(b)&&(this.options=a.extend(!0,this.options,b))})}function g(b,e){a.fn[b]=function(g){if("string"==typeof g){for(var f=d.call(arguments,1),k=0,u=this.length;u>k;k++){var x=a.data(this[k],b);if(x)if(a.isFunction(x[g])&&"_"!==g.charAt(0)){if(x=x[g].apply(x,f),void 0!==x)return x}else h("no such method '"+g+"' for "+b+" instance");else h("cannot call methods on "+b+" prior to initialization; attempted to call '"+
g+"'")}return this}return this.each(function(){var d=a.data(this,b);d?(d.option(g),d._init()):(d=new e(this,g),a.data(this,b,d))})}}if(a){var h="undefined"==typeof console?e:function(a){console.error(a)};return a.bridget=function(a,c){f(c);g(a,c)},a.bridget}}var d=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],f):f("object"==typeof exports?require("jquery"):a.jQuery)}(window);
(function(a){function e(c){var d=a.event;return d.target=d.target||d.srcElement||c,d}var f=document.documentElement,d=function(){};f.addEventListener?d=function(a,c,d){a.addEventListener(c,d,!1)}:f.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var b=e(a);d.handleEvent.call(d,b)}:function(){var b=e(a);d.call(a,b)};a.attachEvent("on"+c,a[c+d])});var c=function(){};f.removeEventListener?c=function(a,c,d){a.removeEventListener(c,d,!1)}:f.detachEvent&&(c=function(a,c,d){a.detachEvent("on"+
c,a[c+d]);try{delete a[c+d]}catch(b){a[c+d]=void 0}});f={bind:d,unbind:c};"function"==typeof define&&define.amd?define("eventie/eventie",f):"object"==typeof exports?module.exports=f:a.eventie=f})(window);
(function(){function a(){}function e(a,c){for(var b=a.length;b--;)if(a[b].listener===c)return b;return-1}function f(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,c=this,k=c.EventEmitter;d.getListeners=function(a){var c,b,d=this._getEvents();if(a instanceof RegExp)for(b in c={},d)d.hasOwnProperty(b)&&a.test(b)&&(c[b]=d[b]);else c=d[a]||(d[a]=[]);return c};d.flattenListeners=function(a){var c,b=[];for(c=0;c<a.length;c+=1)b.push(a[c].listener);return b};d.getListenersAsObject=
function(a){var c,b=this.getListeners(a);return b instanceof Array&&(c={},c[a]=b),c||b};d.addListener=function(a,c){var b,d=this.getListenersAsObject(a),f="object"==typeof c;for(b in d)d.hasOwnProperty(b)&&-1===e(d[b],c)&&d[b].push(f?c:{listener:c,once:!1});return this};d.on=f("addListener");d.addOnceListener=function(a,c){return this.addListener(a,{listener:c,once:!0})};d.once=f("addOnceListener");d.defineEvent=function(a){return this.getListeners(a),this};d.defineEvents=function(a){for(var c=0;c<
a.length;c+=1)this.defineEvent(a[c]);return this};d.removeListener=function(a,c){var b,d,f=this.getListenersAsObject(a);for(d in f)f.hasOwnProperty(d)&&(b=e(f[d],c),-1!==b&&f[d].splice(b,1));return this};d.off=f("removeListener");d.addListeners=function(a,c){return this.manipulateListeners(!1,a,c)};d.removeListeners=function(a,c){return this.manipulateListeners(!0,a,c)};d.manipulateListeners=function(a,c,b){var d,e,f=a?this.removeListener:this.addListener;a=a?this.removeListeners:this.addListeners;
if("object"!=typeof c||c instanceof RegExp)for(d=b.length;d--;)f.call(this,c,b[d]);else for(d in c)c.hasOwnProperty(d)&&(e=c[d])&&("function"==typeof e?f.call(this,d,e):a.call(this,d,e));return this};d.removeEvent=function(a){var c,b=typeof a,d=this._getEvents();if("string"===b)delete d[a];else if(a instanceof RegExp)for(c in d)d.hasOwnProperty(c)&&a.test(c)&&delete d[c];else delete this._events;return this};d.removeAllListeners=f("removeEvent");d.emitEvent=function(a,c){var b,d,e,f,k=this.getListenersAsObject(a);
for(e in k)if(k.hasOwnProperty(e))for(d=k[e].length;d--;)b=k[e][d],!0===b.once&&this.removeListener(a,b.listener),f=b.listener.apply(this,c||[]),f===this._getOnceReturnValue()&&this.removeListener(a,b.listener);return this};d.trigger=f("emitEvent");d.emit=function(a){var c=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,c)};d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this};d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:
!0};d._getEvents=function(){return this._events||(this._events={})};a.noConflict=function(){return c.EventEmitter=k,a};"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:c.EventEmitter=a}).call(this);
(function(a){function e(a){if(a){if("string"==typeof d[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var e,g=0,h=f.length;h>g;g++)if(e=f[g]+a,"string"==typeof d[e])return e}}var f=["Webkit","Moz","ms","Ms","O"],d=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:a.getStyleProperty=e})(window);
(function(a){function e(a){var c=parseFloat(a);return-1===a.indexOf("%")&&!isNaN(c)&&c}function f(){}function d(d){function f(){if(!p){p=!0;var h=a.getComputedStyle;if(b=function(){var a=h?function(a){return h(a,null)}:function(a){return a.currentStyle};return function(b){b=a(b);return b||c("Style returned "+b+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),b}}(),m=d("boxSizing")){var k=document.createElement("div");k.style.width="200px";k.style.padding=
"1px 2px 3px 4px";k.style.borderStyle="solid";k.style.borderWidth="1px 2px 3px 4px";k.style[m]="border-box";var x=document.body||document.documentElement;x.appendChild(k);var v=b(k);n=200===e(v.width);x.removeChild(k)}}}var b,m,n,p=!1;return function(c){if(f(),"string"==typeof c&&(c=document.querySelector(c)),c&&"object"==typeof c&&c.nodeType){var d=b(c);if("none"===d.display){for(var g={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},d=0,p=k.length;p>d;d++)g[k[d]]=0;return g}g=
{};g.width=c.offsetWidth;g.height=c.offsetHeight;for(var p=g.isBorderBox=!(!m||!d[m]||"border-box"!==d[m]),r=0,w=k.length;w>r;r++){var y=k[r],t=d[y];var D=c,B=t;if(a.getComputedStyle||-1===B.indexOf("%"))t=B;else var t=D.style,E=t.left,z=D.runtimeStyle,G=z&&z.left,t=(G&&(z.left=D.currentStyle.left),t.left=B,B=t.pixelLeft,t.left=E,G&&(z.left=G),B);D=parseFloat(t);g[y]=isNaN(D)?0:D}c=g.paddingLeft+g.paddingRight;r=g.paddingTop+g.paddingBottom;w=g.marginLeft+g.marginRight;y=g.marginTop+g.marginBottom;
D=g.borderLeftWidth+g.borderRightWidth;B=g.borderTopWidth+g.borderBottomWidth;p=p&&n;t=e(d.width);!1!==t&&(g.width=t+(p?0:c+D));d=e(d.height);return!1!==d&&(g.height=d+(p?0:r+B)),g.innerWidth=g.width-(c+D),g.innerHeight=g.height-(r+B),g.outerWidth=g.width+w,g.outerHeight=g.height+y,g}}}var c="undefined"==typeof console?f:function(a){console.error(a)},k="paddingLeft paddingRight paddingTop paddingBottom marginLeft marginRight marginTop marginBottom borderLeftWidth borderRightWidth borderTopWidth borderBottomWidth".split(" ");
"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],d):"object"==typeof exports?module.exports=d(require("desandro-get-style-property")):a.getSize=d(a.getStyleProperty)})(window);
(function(a){function e(a){"function"==typeof a&&(e.isReady?a():g.push(a))}function f(a){a="readystatechange"===a.type&&"complete"!==k.readyState;e.isReady||a||d()}function d(){e.isReady=!0;for(var a=0,b=g.length;b>a;a++)(0,g[a])()}function c(c){return"complete"===k.readyState?d():(c.bind(k,"DOMContentLoaded",f),c.bind(k,"readystatechange",f),c.bind(a,"load",f)),e}var k=a.document,g=[];e.isReady=!1;"function"==typeof define&&define.amd?define("doc-ready/doc-ready",["eventie/eventie"],c):"object"==
typeof exports?module.exports=c(require("eventie")):a.docReady=c(a.eventie)})(window);
(function(a){function e(a,b){return a[k](b)}function f(a,b){a.parentNode||document.createDocumentFragment().appendChild(a);for(var c=a.parentNode.querySelectorAll(b),d=0,e=c.length;e>d;d++)if(c[d]===a)return!0;return!1}function d(a,b){a.parentNode||document.createDocumentFragment().appendChild(a);return e(a,b)}var c,k=function(){if(a.matches)return"matches";if(a.matchesSelector)return"matchesSelector";for(var c=["webkit","moz","ms","o"],b=0,d=c.length;d>b;b++){var e=c[b]+"MatchesSelector";if(a[e])return e}}();
if(k){var g=document.createElement("div");c=e(g,"div")?e:d}else c=f;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return c}):"object"==typeof exports?module.exports=c:window.matchesSelector=c})(Element.prototype);
(function(a,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["doc-ready/doc-ready","matches-selector/matches-selector"],function(f,d){return e(a,f,d)}):"object"==typeof exports?module.exports=e(a,require("doc-ready"),require("desandro-matches-selector")):a.fizzyUIUtils=e(a,a.docReady,a.matchesSelector)})(window,function(a,e,f){var d={extend:function(a,c){for(var b in c)a[b]=c[b];return a},modulo:function(a,c){return(a%c+c)%c}},c=Object.prototype.toString;d.isArray=function(a){return"[object Array]"==
c.call(a)};d.makeArray=function(a){var c=[];if(d.isArray(a))c=a;else if(a&&"number"==typeof a.length)for(var b=0,e=a.length;e>b;b++)c.push(a[b]);else c.push(a);return c};d.indexOf=Array.prototype.indexOf?function(a,c){return a.indexOf(c)}:function(a,c){for(var b=0,d=a.length;d>b;b++)if(a[b]===c)return b;return-1};d.removeFrom=function(a,c){var b=d.indexOf(a,c);-1!=b&&a.splice(b,1)};d.isElement="function"==typeof HTMLElement||"object"==typeof HTMLElement?function(a){return a instanceof HTMLElement}:
function(a){return a&&"object"==typeof a&&1==a.nodeType&&"string"==typeof a.nodeName};d.setText=function(){var a;return function(c,b){a=a||(void 0!==document.documentElement.textContent?"textContent":"innerText");c[a]=b}}();d.getParent=function(a,c){for(;a!=document.body;)if(a=a.parentNode,f(a,c))return a};d.getQueryElement=function(a){return"string"==typeof a?document.querySelector(a):a};d.handleEvent=function(a){var c="on"+a.type;this[c]&&this[c](a)};d.filterFindElements=function(a,c){a=d.makeArray(a);
for(var b=[],e=0,k=a.length;k>e;e++){var p=a[e];if(d.isElement(p))if(c){f(p,c)&&b.push(p);for(var p=p.querySelectorAll(c),q=0,u=p.length;u>q;q++)b.push(p[q])}else b.push(p)}return b};d.debounceMethod=function(a,c,b){var d=a.prototype[c],e=c+"Timeout";a.prototype[c]=function(){var a=this[e];a&&clearTimeout(a);var c=arguments,g=this;this[e]=setTimeout(function(){d.apply(g,c);delete g[e]},b||100)}};d.toDashed=function(a){return a.replace(/(.)([A-Z])/g,function(a,b,c){return b+"-"+c}).toLowerCase()};
var k=a.console;return d.htmlInit=function(c,f){e(function(){for(var b=d.toDashed(f),e=document.querySelectorAll(".js-"+b),b="data-"+b+"-options",n=0,p=e.length;p>n;n++){var q,u=e[n],x=u.getAttribute(b);try{q=x&&JSON.parse(x)}catch(r){k&&k.error("Error parsing "+b+" on "+u.nodeName.toLowerCase()+(u.id?"#"+u.id:"")+": "+r);continue}var x=new c(u,q),v=a.jQuery;v&&v.data(u,f,x)}})},d});
(function(a,e){"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property","fizzy-ui-utils/utils"],function(f,d,c,k){return e(a,f,d,c,k)}):"object"==typeof exports?module.exports=e(a,require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property"),require("fizzy-ui-utils")):(a.Outlayer={},a.Outlayer.Item=e(a,a.EventEmitter,a.getSize,a.getStyleProperty,a.fizzyUIUtils))})(window,function(a,
e,f,d,c){function k(a,b){a&&(this.element=a,this.layout=b,this.position={x:0,y:0},this._create())}var g=a.getComputedStyle,h=g?function(a){return g(a,null)}:function(a){return a.currentStyle},b=d("transition");a=d("transform");a=b&&a;var m=!!d("perspective"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[b],p=["transform","transition","transitionDuration","transitionProperty"],q=function(){for(var a={},b=0,c=p.length;c>
b;b++){var e=p[b],g=d(e);g&&g!==e&&(a[e]=g)}return a}();c.extend(k.prototype,e.prototype);k.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};this.css({position:"absolute"})};k.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)};k.prototype.getSize=function(){this.size=f(this.element)};k.prototype.css=function(a){var b=this.element.style,c;for(c in a)b[q[c]||c]=a[c]};k.prototype.getPosition=function(){var a=h(this.element),b=this.layout.options,c=
b.isOriginLeft,b=b.isOriginTop,d=a[c?"left":"right"],e=a[b?"top":"bottom"],a=this.layout.size,d=-1!=d.indexOf("%")?parseFloat(d)/100*a.width:parseInt(d,10),e=-1!=e.indexOf("%")?parseFloat(e)/100*a.height:parseInt(e,10),d=isNaN(d)?0:d,e=isNaN(e)?0:e,d=d-(c?a.paddingLeft:a.paddingRight),e=e-(b?a.paddingTop:a.paddingBottom);this.position.x=d;this.position.y=e};k.prototype.layoutPosition=function(){var a=this.layout.size,b=this.layout.options,c={},d=b.isOriginLeft?"right":"left";c[b.isOriginLeft?"left":
"right"]=this.getXValue(this.position.x+a[b.isOriginLeft?"paddingLeft":"paddingRight"]);c[d]="";d=b.isOriginTop?"bottom":"top";c[b.isOriginTop?"top":"bottom"]=this.getYValue(this.position.y+a[b.isOriginTop?"paddingTop":"paddingBottom"]);c[d]="";this.css(c);this.emitEvent("layout",[this])};k.prototype.getXValue=function(a){var b=this.layout.options;return b.percentPosition&&!b.isHorizontal?a/this.layout.size.width*100+"%":a+"px"};k.prototype.getYValue=function(a){var b=this.layout.options;return b.percentPosition&&
b.isHorizontal?a/this.layout.size.height*100+"%":a+"px"};k.prototype._transitionTo=function(a,b){this.getPosition();var c=this.position.x,d=this.position.y,e=parseInt(a,10),g=parseInt(b,10),e=e===this.position.x&&g===this.position.y;if(this.setPosition(a,b),e&&!this.isTransitioning)return void this.layoutPosition();e={};e.transform=this.getTranslate(a-c,b-d);this.transition({to:e,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})};k.prototype.getTranslate=function(a,b){var c=this.layout.options;
return a=c.isOriginLeft?a:-a,b=c.isOriginTop?b:-b,m?"translate3d("+a+"px, "+b+"px, 0)":"translate("+a+"px, "+b+"px)"};k.prototype.goTo=function(a,b){this.setPosition(a,b);this.layoutPosition()};k.prototype.moveTo=a?k.prototype._transitionTo:k.prototype.goTo;k.prototype.setPosition=function(a,b){this.position.x=parseInt(a,10);this.position.y=parseInt(b,10)};k.prototype._nonTransition=function(a){this.css(a.to);a.isCleaning&&this._removeStyles(a.to);for(var b in a.onTransitionEnd)a.onTransitionEnd[b].call(this)};
k.prototype._transition=function(a){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(a);var b=this._transn,c;for(c in a.onTransitionEnd)b.onEnd[c]=a.onTransitionEnd[c];for(c in a.to)b.ingProperties[c]=!0,a.isCleaning&&(b.clean[c]=!0);a.from&&this.css(a.from);this.enableTransition(a.to);this.css(a.to);this.isTransitioning=!0};var u="opacity,"+function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}(q.transform||"transform");k.prototype.enableTransition=
function(){this.isTransitioning||(this.css({transitionProperty:u,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(n,this,!1))};k.prototype.transition=k.prototype[b?"_transition":"_nonTransition"];k.prototype.onwebkitTransitionEnd=function(a){this.ontransitionend(a)};k.prototype.onotransitionend=function(a){this.ontransitionend(a)};var x={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};k.prototype.ontransitionend=function(a){if(a.target===
this.element){var b=this._transn,c=x[a.propertyName]||a.propertyName;delete b.ingProperties[c];var d;a:{d=b.ingProperties;for(var e in d){d=!1;break a}d=!0}if(d&&this.disableTransition(),c in b.clean&&(this.element.style[a.propertyName]="",delete b.clean[c]),c in b.onEnd)b.onEnd[c].call(this),delete b.onEnd[c];this.emitEvent("transitionEnd",[this])}};k.prototype.disableTransition=function(){this.removeTransitionStyles();this.element.removeEventListener(n,this,!1);this.isTransitioning=!1};k.prototype._removeStyles=
function(a){var b={},c;for(c in a)b[c]="";this.css(b)};var v={transitionProperty:"",transitionDuration:""};return k.prototype.removeTransitionStyles=function(){this.css(v)},k.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);this.css({display:""});this.emitEvent("remove",[this])},k.prototype.remove=function(){if(!b||!parseFloat(this.layout.options.transitionDuration))return void this.removeElem();var a=this;this.once("transitionEnd",function(){a.removeElem()});this.hide()},
k.prototype.reveal=function(){delete this.isHidden;this.css({display:""});var a=this.layout.options,b={},c=this.getHideRevealTransitionEndProperty("visibleStyle");b[c]=this.onRevealTransitionEnd;this.transition({from:a.hiddenStyle,to:a.visibleStyle,isCleaning:!0,onTransitionEnd:b})},k.prototype.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},k.prototype.getHideRevealTransitionEndProperty=function(a){a=this.layout.options[a];if(a.opacity)return"opacity";for(var b in a)return b},
k.prototype.hide=function(){this.isHidden=!0;this.css({display:""});var a=this.layout.options,b={},c=this.getHideRevealTransitionEndProperty("hiddenStyle");b[c]=this.onHideTransitionEnd;this.transition({from:a.visibleStyle,to:a.hiddenStyle,isCleaning:!0,onTransitionEnd:b})},k.prototype.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},k.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},
k});
(function(a,e){"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","eventEmitter/EventEmitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(f,d,c,k,g){return e(a,f,d,c,k,g)}):"object"==typeof exports?module.exports=e(a,require("eventie"),require("wolfy87-eventemitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):a.Outlayer=e(a,a.eventie,a.EventEmitter,a.getSize,a.fizzyUIUtils,a.Outlayer.Item)})(window,function(a,e,f,d,c,k){function g(a,d){var e=
c.getQueryElement(a);if(!e)return void(h&&h.error("Bad element for "+this.constructor.namespace+": "+(e||a)));this.element=e;b&&(this.$element=b(this.element));this.options=c.extend({},this.constructor.defaults);this.option(d);e=++n;this.element.outlayerGUID=e;p[e]=this;this._create();this.options.isInitLayout&&this.layout()}var h=a.console,b=a.jQuery,m=function(){},n=0,p={};return g.namespace="outlayer",g.Item=k,g.defaults={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,
isResizeBound:!0,isResizingContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},c.extend(g.prototype,f.prototype),g.prototype.option=function(a){c.extend(this.options,a)},g.prototype._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);c.extend(this.element.style,this.options.containerStyle);this.options.isResizeBound&&this.bindResize()},g.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},
g.prototype._itemize=function(a){a=this._filterFindItemElements(a);for(var b=this.constructor.Item,c=[],d=0,e=a.length;e>d;d++){var g=new b(a[d],this);c.push(g)}return c},g.prototype._filterFindItemElements=function(a){return c.filterFindElements(a,this.options.itemSelector)},g.prototype.getItemElements=function(){for(var a=[],b=0,c=this.items.length;c>b;b++)a.push(this.items[b].element);return a},g.prototype.layout=function(){this._resetLayout();this._manageStamps();this.layoutItems(this.items,void 0!==
this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited);this._isLayoutInited=!0},g.prototype._init=g.prototype.layout,g.prototype._resetLayout=function(){this.getSize()},g.prototype.getSize=function(){this.size=d(this.element)},g.prototype._getMeasurement=function(a,b){var e,g=this.options[a];g?("string"==typeof g?e=this.element.querySelector(g):c.isElement(g)&&(e=g),this[a]=e?d(e)[b]:g):this[a]=0},g.prototype.layoutItems=function(a,b){a=this._getItemsForLayout(a);this._layoutItems(a,
b);this._postLayout()},g.prototype._getItemsForLayout=function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];e.isIgnored||b.push(e)}return b},g.prototype._layoutItems=function(a,b){if(this._emitCompleteOnItems("layout",a),a&&a.length){for(var c=[],d=0,e=a.length;e>d;d++){var g=a[d],f=this._getItemLayoutPosition(g);f.item=g;f.isInstant=b||g.isLayoutInstant;c.push(f)}this._processLayoutQueue(c)}},g.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},g.prototype._processLayoutQueue=function(a){for(var b=
0,c=a.length;c>b;b++){var d=a[b];this._positionItem(d.item,d.x,d.y,d.isInstant)}},g.prototype._positionItem=function(a,b,c,d){d?a.goTo(b,c):a.moveTo(b,c)},g.prototype._postLayout=function(){this.resizeContainer()},g.prototype.resizeContainer=function(){if(this.options.isResizingContainer){var a=this._getContainerSize();a&&(this._setContainerMeasure(a.width,!0),this._setContainerMeasure(a.height,!1))}},g.prototype._getContainerSize=m,g.prototype._setContainerMeasure=function(a,b){if(void 0!==a){var c=
this.size;c.isBorderBox&&(a+=b?c.paddingLeft+c.paddingRight+c.borderLeftWidth+c.borderRightWidth:c.paddingBottom+c.paddingTop+c.borderTopWidth+c.borderBottomWidth);a=Math.max(a,0);this.element.style[b?"width":"height"]=a+"px"}},g.prototype._emitCompleteOnItems=function(a,b){function c(){e.dispatchEvent(a+"Complete",null,[b])}function d(){f++;f===g&&c()}var e=this,g=b.length;if(!b||!g)return void c();for(var f=0,h=0,k=b.length;k>h;h++)b[h].once(a,d)},g.prototype.dispatchEvent=function(a,c,d){var e=
c?[c].concat(d):d;if(this.emitEvent(a,e),b)(this.$element=this.$element||b(this.element),c)?(c=b.Event(c),c.type=a,this.$element.trigger(c,d)):this.$element.trigger(a,d)},g.prototype.ignore=function(a){(a=this.getItem(a))&&(a.isIgnored=!0)},g.prototype.unignore=function(a){(a=this.getItem(a))&&delete a.isIgnored},g.prototype.stamp=function(a){if(a=this._find(a)){this.stamps=this.stamps.concat(a);for(var b=0,c=a.length;c>b;b++)this.ignore(a[b])}},g.prototype.unstamp=function(a){if(a=this._find(a))for(var b=
0,d=a.length;d>b;b++){var e=a[b];c.removeFrom(this.stamps,e);this.unignore(e)}},g.prototype._find=function(a){return a?("string"==typeof a&&(a=this.element.querySelectorAll(a)),c.makeArray(a)):void 0},g.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var a=0,b=this.stamps.length;b>a;a++)this._manageStamp(this.stamps[a])}},g.prototype._getBoundingRect=function(){var a=this.element.getBoundingClientRect(),b=this.size;this._boundingRect={left:a.left+
b.paddingLeft+b.borderLeftWidth,top:a.top+b.paddingTop+b.borderTopWidth,right:a.right-(b.paddingRight+b.borderRightWidth),bottom:a.bottom-(b.paddingBottom+b.borderBottomWidth)}},g.prototype._manageStamp=m,g.prototype._getElementOffset=function(a){var b=a.getBoundingClientRect(),c=this._boundingRect;a=d(a);return{left:b.left-c.left-a.marginLeft,top:b.top-c.top-a.marginTop,right:c.right-b.right-a.marginRight,bottom:c.bottom-b.bottom-a.marginBottom}},g.prototype.handleEvent=function(a){var b="on"+a.type;
this[b]&&this[b](a)},g.prototype.bindResize=function(){this.isResizeBound||(e.bind(a,"resize",this),this.isResizeBound=!0)},g.prototype.unbindResize=function(){this.isResizeBound&&e.unbind(a,"resize",this);this.isResizeBound=!1},g.prototype.onresize=function(){this.resizeTimeout&&clearTimeout(this.resizeTimeout);var a=this;this.resizeTimeout=setTimeout(function(){a.resize();delete a.resizeTimeout},100)},g.prototype.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},g.prototype.needsResizeLayout=
function(){var a=d(this.element);return this.size&&a&&a.innerWidth!==this.size.innerWidth},g.prototype.addItems=function(a){a=this._itemize(a);return a.length&&(this.items=this.items.concat(a)),a},g.prototype.appended=function(a){a=this.addItems(a);a.length&&(this.layoutItems(a,!0),this.reveal(a))},g.prototype.prepended=function(a){a=this._itemize(a);if(a.length){var b=this.items.slice(0);this.items=a.concat(b);this._resetLayout();this._manageStamps();this.layoutItems(a,!0);this.reveal(a);this.layoutItems(b)}},
g.prototype.reveal=function(a){this._emitCompleteOnItems("reveal",a);for(var b=a&&a.length,c=0;b&&b>c;c++)a[c].reveal()},g.prototype.hide=function(a){this._emitCompleteOnItems("hide",a);for(var b=a&&a.length,c=0;b&&b>c;c++)a[c].hide()},g.prototype.revealItemElements=function(a){a=this.getItems(a);this.reveal(a)},g.prototype.hideItemElements=function(a){a=this.getItems(a);this.hide(a)},g.prototype.getItem=function(a){for(var b=0,c=this.items.length;c>b;b++){var d=this.items[b];if(d.element===a)return d}},
g.prototype.getItems=function(a){a=c.makeArray(a);for(var b=[],d=0,e=a.length;e>d;d++){var g=this.getItem(a[d]);g&&b.push(g)}return b},g.prototype.remove=function(a){a=this.getItems(a);if(this._emitCompleteOnItems("remove",a),a&&a.length)for(var b=0,d=a.length;d>b;b++){var e=a[b];e.remove();c.removeFrom(this.items,e)}},g.prototype.destroy=function(){var a=this.element.style;a.height="";a.position="";a.width="";for(var a=0,c=this.items.length;c>a;a++)this.items[a].destroy();this.unbindResize();delete p[this.element.outlayerGUID];
delete this.element.outlayerGUID;b&&b.removeData(this.element,this.constructor.namespace)},g.data=function(a){return(a=(a=c.getQueryElement(a))&&a.outlayerGUID)&&p[a]},g.create=function(a,d){function e(){g.apply(this,arguments)}return Object.create?e.prototype=Object.create(g.prototype):c.extend(e.prototype,g.prototype),e.prototype.constructor=e,e.defaults=c.extend({},g.defaults),c.extend(e.defaults,d),e.prototype.settings={},e.namespace=a,e.data=g.data,e.Item=function(){k.apply(this,arguments)},
e.Item.prototype=new k,c.htmlInit(e,a),b&&b.bridget&&b.bridget(a,e),e},g.Item=k,g});
(function(a,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size","fizzy-ui-utils/utils"],e):"object"==typeof exports?module.exports=e(require("outlayer"),require("get-size"),require("fizzy-ui-utils")):a.Masonry=e(a.Outlayer,a.getSize,a.fizzyUIUtils)})(window,function(a,e,f){a=a.create("masonry");return a.prototype._resetLayout=function(){this.getSize();this._getMeasurement("columnWidth","outerWidth");this._getMeasurement("gutter","outerWidth");this.measureColumns();
var a=this.cols;for(this.colYs=[];a--;)this.colYs.push(0);this.maxY=0},a.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var a=this.items[0];this.columnWidth=(a=a&&a.element)&&e(a).outerWidth||this.containerWidth}var a=this.columnWidth+=this.gutter,c=this.containerWidth+this.gutter,f=a-c%a,a=Math[f&&1>f?"round":"floor"](c/a);this.cols=Math.max(a,1)},a.prototype.getContainerWidth=function(){var a=e(this.options.isFitWidth?this.element.parentNode:this.element);this.containerWidth=
a&&a.innerWidth},a.prototype._getItemLayoutPosition=function(a){a.getSize();var c=a.size.outerWidth%this.columnWidth,c=Math[c&&1>c?"round":"ceil"](a.size.outerWidth/this.columnWidth),c=Math.min(c,this.cols),e=this._getColGroup(c),g=Math.min.apply(Math,e),c=f.indexOf(e,g),h={x:this.columnWidth*c,y:g};a=g+a.size.outerHeight;e=this.cols+1-e.length;for(g=0;e>g;g++)this.colYs[c+g]=a;return h},a.prototype._getColGroup=function(a){if(2>a)return this.colYs;for(var c=[],e=this.cols+1-a,g=0;e>g;g++){var f=
this.colYs.slice(g,g+a);c[g]=Math.max.apply(Math,f)}return c},a.prototype._manageStamp=function(a){var c=e(a),f=this._getElementOffset(a);a=this.options.isOriginLeft?f.left:f.right;var g=a+c.outerWidth,h=Math.floor(a/this.columnWidth),h=Math.max(0,h);a=Math.floor(g/this.columnWidth);a-=g%this.columnWidth?0:1;a=Math.min(this.cols-1,a);c=(this.options.isOriginTop?f.top:f.bottom)+c.outerHeight;for(f=h;a>=f;f++)this.colYs[f]=Math.max(c,this.colYs[f])},a.prototype._getContainerSize=function(){this.maxY=
Math.max.apply(Math,this.colYs);var a={height:this.maxY};return this.options.isFitWidth&&(a.width=this._getContainerFitWidth()),a},a.prototype._getContainerFitWidth=function(){for(var a=0,c=this.cols;--c&&0===this.colYs[c];)a++;return(this.cols-a)*this.columnWidth-this.gutter},a.prototype.needsResizeLayout=function(){var a=this.containerWidth;return this.getContainerWidth(),a!==this.containerWidth},a});
MediaElementPlayer&&(MediaElementPlayer.prototype.enterFullScreenOrg=MediaElementPlayer.prototype.enterFullScreen,MediaElementPlayer.prototype.enterFullScreen=function(){$(document).trigger("mejs-enter-fullscreen");this.enterFullScreenOrg()},MediaElementPlayer.prototype.exitFullScreenOrg=MediaElementPlayer.prototype.exitFullScreen,MediaElementPlayer.prototype.exitFullScreen=function(){$(document).trigger("mejs-exit-fullscreen");this.exitFullScreenOrg()});
Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(void 0===this||null===this)throw new TypeError;var e=Object(this),f=e.length>>>0;if(0===f)return-1;var d=0;0<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&Infinity!==d&&-Infinity!==d&&(d=(0<d||-1)*Math.floor(Math.abs(d))));if(d>=f)return-1;for(d=0<=d?d:Math.max(f-Math.abs(d),0);d<f;d++)if(d in e&&e[d]===a)return d;return-1});
Array.prototype.remove||(Array.prototype.remove=function(a){var e;if(-1<(a=this.indexOf(a)))return[].splice.apply(this,[a,a-a+1].concat(e=[])),e});
var smoke={smoketimeout:[],init:!1,zindex:2E3,i:0,bodyload:function(a){var e=document.createElement("div");e.setAttribute("id","smoke-out-"+a);e.className="smoke-base";e.style.zIndex=smoke.zindex;smoke.zindex++;document.body.appendChild(e)},newdialog:function(){var a=(new Date).getTime(),a=Math.random(1,99)+a;smoke.init?smoke.bodyload(a):smoke.listen(window,"load",function(){smoke.bodyload(a)});return a},forceload:function(){},build:function(a,e){smoke.i++;e.stack=smoke.i;a=a.replace(/\n/g,"<br />");
a=a.replace(/\r/g,"<br />");var f="",d=EB.i18n.string("mycontent.remove-collection.are-you-sure.ok"),c=EB.i18n.string("mycontent.remove-collection.are-you-sure.cancel"),k="",g="",h;"prompt"===e.type&&(f='<div class="dialog-prompt"><input id="dialog-input-'+e.newid+'" type="text" '+(e.params.value?'value="'+e.params.value+'"':"")+" /></div>");e.params.ok&&(d=e.params.ok);e.params.cancel&&(c=e.params.cancel);e.params.classname&&(k=e.params.classname);if("signal"!==e.type){g='<div class="dialog-buttons">';
if("alert"===e.type)g+='<button id="alert-ok-'+e.newid+'">'+d+"</button>";else if("prompt"===e.type||"confirm"===e.type)g=e.params.reverseButtons?g+('<button id="'+e.type+"-ok-"+e.newid+'">'+d+'</button><button id="'+e.type+"-cancel-"+e.newid+'" class="cancel">'+c+"</button>"):g+('<button id="'+e.type+"-cancel-"+e.newid+'" class="cancel">'+c+'</button><button id="'+e.type+"-ok-"+e.newid+'">'+d+"</button>");g+="</div>"}h='<div id="smoke-bg-'+e.newid+'" class="smokebg"></div><div class="dialog smoke '+
k+'"><div class="dialog-inner">'+a+f+g+"</div></div>";smoke.init?smoke.finishbuild(a,e,h):smoke.listen(window,"load",function(){smoke.finishbuild(a,e,h)})},finishbuild:function(a,e,f){var d=document.getElementById("smoke-out-"+e.newid);d.className="smoke-base smoke-visible  smoke-"+e.type;for(d.innerHTML=f;""===d.innerHTML;)d.innerHTML=f;smoke.smoketimeout[e.newid]&&clearTimeout(smoke.smoketimeout[e.newid]);smoke.listen(document.getElementById("smoke-bg-"+e.newid),"click",function(){smoke.destroy(e.type,
e.newid);"prompt"===e.type||"confirm"===e.type?e.callback(!1):"alert"===e.type&&"undefined"!==typeof e.callback&&e.callback()});switch(e.type){case "alert":smoke.finishbuildAlert(a,e,f);break;case "confirm":smoke.finishbuildConfirm(a,e,f);break;case "prompt":smoke.finishbuildPrompt(a,e,f);break;case "signal":smoke.finishbuildSignal(a,e,f);break;default:throw"Unknown type: "+e.type;}},finishbuildAlert:function(a,e,f){smoke.listen(document.getElementById("alert-ok-"+e.newid),"click",function(){smoke.destroy(e.type,
e.newid);"undefined"!==typeof e.callback&&e.callback()});document.onkeyup=function(a){a||(a=window.event);if(13===a.keyCode||32===a.keyCode||27===a.keyCode)smoke.destroy(e.type,e.newid),"undefined"!==typeof e.callback&&e.callback()}},finishbuildConfirm:function(a,e,f){smoke.listen(document.getElementById("confirm-cancel-"+e.newid),"click",function(){smoke.destroy(e.type,e.newid);e.callback(!1)});smoke.listen(document.getElementById("confirm-ok-"+e.newid),"click",function(){smoke.destroy(e.type,e.newid);
e.callback(!0)});document.onkeyup=function(a){a||(a=window.event);13===a.keyCode||32===a.keyCode?(smoke.destroy(e.type,e.newid),e.callback(!0)):27===a.keyCode&&(smoke.destroy(e.type,e.newid),e.callback(!1))}},finishbuildPrompt:function(a,e,f){var d=document.getElementById("dialog-input-"+e.newid);setTimeout(function(){d.focus();d.select()},100);smoke.listen(document.getElementById("prompt-cancel-"+e.newid),"click",function(){smoke.destroy(e.type,e.newid);e.callback(!1)});smoke.listen(document.getElementById("prompt-ok-"+
e.newid),"click",function(){smoke.destroy(e.type,e.newid);e.callback(d.value)});document.onkeyup=function(a){a||(a=window.event);13===a.keyCode?(smoke.destroy(e.type,e.newid),e.callback(d.value)):27===a.keyCode&&(smoke.destroy(e.type,e.newid),e.callback(!1))}},finishbuildSignal:function(a,e,f){smoke.smoketimeout[e.newid]=setTimeout(function(){smoke.destroy(e.type,e.newid)},e.timeout)},destroy:function(a,e){var f=document.getElementById("smoke-out-"+e),d=document.getElementById(a+"-ok-"+e),c=document.getElementById(a+
"-cancel-"+e);f.className="smoke-base";d&&(smoke.stoplistening(d,"click",function(){}),document.onkeyup=null);c&&smoke.stoplistening(c,"click",function(){});smoke.i=0;f.innerHTML=""},alert:function(a,e,f){"object"!==typeof e&&(e=!1);var d=smoke.newdialog();smoke.build(a,{type:"alert",callback:f,params:e,newid:d})},signal:function(a,e){"undefined"===typeof e&&(e=5E3);var f=smoke.newdialog();smoke.build(a,{type:"signal",timeout:e,params:!1,newid:f})},confirm:function(a,e,f){"object"!==typeof f&&(f=
!1);var d=smoke.newdialog();smoke.build(a,{type:"confirm",callback:e,params:f,newid:d})},prompt:function(a,e,f){"object"!==typeof f&&(f=!1);var d=smoke.newdialog();return smoke.build(a,{type:"prompt",callback:e,params:f,newid:d})},listen:function(a,e,f){return a.addEventListener?a.addEventListener(e,f,!1):a.attachEvent?a.attachEvent("on"+e,f):!1},stoplistening:function(a,e,f){return a.removeEventListener?a.removeEventListener("click",f,!1):a.detachEvent?a.detachEvent("on"+e,f):!1}};
smoke.init||smoke.listen(window,"load",function(){smoke.init=!0});EB=window.EB||{};
EB.Strings=function(){var a={"en-US":{"article.action.email.address":"E-mail","article.action.email.name":"Name","lessons.planning.builder.details.grade.label":"Grade Levels*","lessons.planning.details.title":"Title*","lessons.planning.details.subjects":"Does this lesson plan work for any additional subjects?","lessons.planning.details.objective":"Objective","lessons.planning.details.assessment":"Assessment","lessons.planning.details.duration":"Duration","lessons.planning.add-another":"Add","lessons.planning.details.pack.category":"Enter Pack Category",
"lessons.planning.details.procedures":"Procedures","lessons.planning.details.procedures.intro":"Enter your procedure for how to conduct the lesson. Click the add button if you need more steps.","lessons.planning.details.objective.intro":"By the end of this lesson, students should be able to:","lessons.planning.details.intro":"Add details about conducting this lesson - intended grade levels, time, and subjects","lessons.planning.keywords":"Enter keywords","lessons.planning.description":"Enter a description",
"lessons.planning.procedures.placeholder":"Example: Read the provided article and take notes.","lessons.planning.materials.placeholder":'Example: Map, Colored Pencils"',"lessons.planning.publish.confirm.message":"Publishing your lesson plan means it will be made available for other educators to view on Britannica School. <br> Click OK to proceed with publishing, or Cancel to return to the Lesson Plan Builder.","lessons.planning.delete.item.warning":"Are you sure you wish to remove this item from this lesson plan?",
"lessons.planning.alerts.content.can.not.be.added":"Sorry, there was an error adding content to lesson plan!","lessons.planning.title.required":"Title is required","lessons.planning.grade.required":"Please select a Grade","lessons.planning.subject.required":"Please select a Subject","lessons.quick.search.select.content.type":"Select a content type:","lessons.quick.search.select.reading.level":"Select a reading level:","lessons.planning.convert.header":"Convert {packLabel} to a Lesson Plan by adding additional information below*:",
"lessons.planning.convert.intro":"If you need to revise info that you added in the last step, just open the <strong>Details</strong> or <strong>Subject(s) and Duration</strong> panels.","lessons.planning.convert.note":"<em>*Please note that the original pack version of this content will remain in your Favorites and Packs tab.</em>","login.submit.button.text":"Log in","lessons.search.type.images-and-videos":"Images and Videos","lessons.search.type.article":"Articles","lessons.search.type.image":"Images",
"lessons.search.type.video":"Videos","lessons.search.type.studyguides":"Study Guides","lessons.search.type.visuallearning":"Visual Learning","lessons.search.type.manipulatives":"Manipulatives","lessons.search.type.interactivelessons":"Interactive Lessons","lessons.search.type.games":"Games","lessons.search.type.primarysources":"Primary Sources","lessons.search.type.magazines":"Magazines","lessons.search.levels.high":"Level 3","lessons.search.levels.middle":"Level 2","lessons.search.levels.elementary":"Level 1",
"elementary.feed.news.bbcl.title":"News by BBC News","elementary.feed.news.mi.title":"News by Muy Interesante","middle.feed.news.bbcl.title":"News by BBC News","middle.feed.news.mi.title":"News by Muy Interesante","my.content.content-type.image":"Image","my.content.content-type.video":"Video","school.level1.name.lower":"elementary","school.level1.name.capital":"Elementary","school.level2.name.lower":"middle","school.level2.name.capital":"Middle","school.level3.name.lower":"high","school.level3.name.capital":"High",
"library.level1.name.lower":"children","library.level1.name.capital":"Children","library.level2.name.lower":"youngadults","library.level2.name.capital":"Young Adults","library.level3.name.lower":"referencecenter","library.level3.name.capital":"Reference Center","academic.level3.name.lower":"collegiate","academic.level3.name.capital":"Academic","spell.favorite.lower":"favorite","spell.favorite.capital":"Favorite","institution.dictionary.feature.description.text":"This is the double-click dictionary. Double-click any word to see its definition and Spanish translation.",
"institution.dictionary.tap.feature.description.text":"Tap and hold any word for 1 second to see its definition and Spanish translation.","institution.dictionary.feature.word.not.found":"The word you've entered isn't in the dictionary.","institution.favorites.login.prompt":"Please log in to add to favorites.","institution.toc.expand.label":"Expand All","institution.toc.collapse.label":"Collapse All","learning-material.all-subjects":"All Subjects","learning-material.mathematics":"Mathematics","learning-material.social-studies":"Social Studies",
"learning-material.science":"Science","learning-material.language-arts":"Language Arts","home.primary.sources.additional.recommendations":"Additional recommendations:","home.primary.sources.show.more":"show more","home.primary.sources.show.less":"show less","home.nara.see.all":"See all","home.nara.new":"NEW","home.feature.read.more.link":"Read more","home.feature.more.like.this":"MORE LIKE THIS","home.middle.feature.article.link":"READ THE ARTICLE","home.middle.feature.video.link":"PLAY VIDEO","home.middle.feature.can.you.guess.title":"Can You Guess?",
"home.middle.feature.did.you.know.title":"Did You Know?","home.middle.feature.at.a.glance.title":"At a Glance","home.middle.primary.sources":"Recommended U.S. Primary Sources","home.middle.primary.sources.text":"Find letters, speeches and other U.S. primary source materials, including documents specified in state standards.","home.middle.compare.countries":"Compare Countries","home.middle.explore.biographies":"Explore Biographies","home.middle.explore.biographies.biography.of.the.day":"Biography of the day:",
"home.middle.explore.biographies.learn.more":"Learn more","home.middle.explore.biographies.browse.other":"Browse Other Biographies by choosing criteria:","home.middle.compare.countries.see.what.else":"Use the Compare Countries tool to find out more about both of these countries.","home.middle.nara.heading":"New & Revised Articles","home.nz.encyclopedia.title":"Te Ara  The Encyclopedia of New Zealand","home.nz.encyclopedia.description":"A guide to its peoples, natural environment, history, culture, economy, institutions and society.",
"home.nz.encyclopedia.launch.site":"Launch Site","home.middle.feed.news.nyt.title":"News by New York Times","home.middle.feed.news.abc.title":"News from ABC","home.middle.feed.news.cbbc.title":"News by CBBC","home.middle.feed.news.btn.title":"News by Behind the News","home.middle.feed.news.bbc.title":"News by BBC News","home.middle.feed.news.nzh.title":"News by The New Zealand Herald","home.middle.buzzword.title":"Daily Buzzword","home.middle.buzzword.definition":"What does it mean?","home.middle.buzzword.usage":"How do you use it?",
"home.high.this.day.title":"on this day","home.high.behind.the.news":"behind the news","home.high.quotation.another":"give me another quote","video.appears.in.articles":"This video appears in the following articles:","image.appears.in.articles":"This image appears in the following articles:","mycontent.all-my-favorites":"All Favorites","mycontent.item":"item","mycontent.items":"items","mycontent.delete-favorite-warning":'Removing content from "All My Favorites" will also remove it from within resource packs. Are you sure... ?',
"mycontent.content-type-ddl.all":"Filter by content type","mycontent.content-type-ddl.articles":"Articles","mycontent.content-type-ddl.images-and-videos":"Images and Videos","mycontent.content-type-ddl.lesson-plans":"Lesson Plans","mycontent.content-type-ddl.magazines":"Magazines","mycontent.content-type-ddl.primary-sources":"Primary Sources","mycontent.content-type-ddl.websites":"Websites","mycontent.add-content-type.magazine":"Magazine","mycontent.add-content-type.primary-source":"Primary Source",
"mycontent.add-content-type.website":"Website","mycontent.remove-collection.are-you-sure":"Are you sure you want to remove the resource pack?","mycontent.remove-item.from-collection.are-you-sure":"Item will be removed from the resource pack. Are you sure?","mycontent.remove-collection.are-you-sure.ok":"OK","mycontent.remove-collection.are-you-sure.cancel":"Cancel","mycontent.remove-lesson-plan.are-you-sure":"Are you sure you want to remove this lesson plan?","mycontent.help-overlay.header":"Get started with the new My Content",
"mycontent.help-overlay.text1":"Favorite content by clicking the star:","mycontent.help-overlay.text2":"Create resource packs to hold your content:","mycontent.help-overlay.text3":"Organize your favorites into resource packs by dragging and dropping:","mycontent.help-overlay.text4":"If you would like to include more information around your resource pack, select it in the sidebar, and convert it to a lesson plan:","mycontent.help-overlay.got-it":"Got it!","mycontent.label-already-exists":"Such label already exists",
"browse.subjects.title":"Articles","browse.canada.title":"Canada in Focus","browse.australia.title":"Australia in Focus","browse.nz.title":"New Zealand in Focus","browse.india.title":"India in Focus","article.reading.level":"Article Reading Level","xsl.article.introduction":"Introduction","xsl.article.additional.reading":"Additional Reading","xsl.article.researcher.note":"Researcher's Note","xsl.article.see.table":"See table:","xsl.article.representative.work":"Representative Works","xsl.article.major.work":"Major Works",
"xsl.profile":"profile","xsl.expand":"[+] Expand","xsl.collapse":"[-] Collapse","xsl.article.elementary.single.toc.intro":"Article","xsl.article.birth.date.respectively.text":"respectively,","xsl.article.birth.type.born.text":"born","xsl.article.birth.type.flourish.text":"flourished","xsl.article.birth.type.baptize.text":"baptized","xsl.article.death.type.kill.text":"killed in action","xsl.article.death.type.bury.text":"burried","xsl.article.death.type.found.text":"found dead","xsl.article.death.type.disappear.text":"disappeared",
"xsl.article.death.type.normal.text":"died","xsl.animal.breadcrumb.home.text":"Home","xsl.animal.breadcrumb.animal.kingdom.text":"Animal Kingdom","xsl.animal.featured.video.title":"Featured Video","xsl.animal.related.links.title":"Related Links","xsl.animal.did.you.know.title":"Did You Know?","xsl.animal.browse.az.title":"Animals A-Z","xsl.assembly.related.articles.title":"Related Articles:","xsl.melingo.button.english.label":"English","xsl.melingo.button.spanish.label":"Espaol","xsl.melingo.button.arabic.label":"",
"xsl.melingo.see-full-definition":"See full definition","xsl.melingo.definitions-provided-by":"Definitions provided by","header.tools.print":"Print","header.tools.cite":"Cite","header.tools.email":"Email","header.tools.font-up":"Font Up","header.tools.font-down":"Font Down","handlebar.cite.intro":"While every effort has been made to follow citation style rules, there may be some discrepancies. Please refer to the appropriate style manual or other sources if you have any questions.","handlebar.cite.select.label":"Select citation style",
"handlebar.media.download.text":"Download","handlebar.media.counter.text":"Media","handlebar.media.view.large.text":"View larger image","action.email":"E-mail","action.email.recipient.label":"Recipients","action.email.cancel":"Cancel","action.email.failure":"The e-mail request failed.","action.email.hint":"To share with more than one person, separate addresses with a comma","action.email.sender.name.label":"Sender Name","action.email.sender.email.label":"Sender Email","action.email.recipients.invalid":"Please check the format of the email addresses.",
"action.email.sender.name.invalid":"Please enter your name.","action.email.sender.email.invalid":"Please check the format of the email address.","action.email.submit":"Send","action.email.to":"To","action.email.from":"From","handlebar.cite.date.year.format":"{yyyy}","handlebar.cite.date.month.format":"{Month}","handlebar.cite.date.mon.format":"{Mon}","handlebar.cite.date.day.format":"{d}","handlebar.cite.article.mla.format":'"{title}." <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}. <a href="{url}">{urlWithoutProtocol}</a>. Accessed {day} {mon}. {year}.',
"handlebar.cite.article.apa.format":'{title}. ({year}). In <em>Encyclopdia Britannica</em>. Retrieved from <a href="{url}">{url}</a>',"handlebar.cite.article.harvard.format":'{title} {year}. <em>{siteTitle}</em>. Retrieved {day} {month} {year}, from <a href="{url}">{url}</a>',"handlebar.cite.article.chicago.format":'<em>{siteTitle}</em>, s.v. "{title}," accessed {month} {day}, {year}, <a href="{url}">{url}</a>.',"handlebar.cite.article.mla.print.format":'"{title}." <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}.</br>{urlWithoutProtocol}. Accessed {day} {mon}. {year}.',
"handlebar.cite.article.apa.print.format":"{title}. ({year}). In <em>Encyclopdia Britannica</em>. Retrieved from</br>{url}","handlebar.cite.article.harvard.print.format":"{title} {year}. <em>{siteTitle}</em>. Retrieved {day} {month} {year}, from </br>{url}","handlebar.cite.article.chicago.print.format":'<em>{siteTitle}</em>, s.v. "{title}," accessed {month} {day}, {year}, </br>{url}.',"handlebar.cite.assembly.mla.format":'<em>{assemblyTitle}.</em> {assemblyType}. <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}. <a href="{url}">{urlWithoutProtocol}</a>. Accessed {day} {mon}. {year}.',
"handlebar.cite.assembly.apa.format":'<em>{assemblyTitle}.</em> [{assemblyType}]. In <em>Encyclopdia Britannica.</em> Retrieved from <a href="{url}">{url}</a>',"handlebar.cite.assembly.harvard.format":'{assemblyTitle} [{assemblyType}]. <em>Encyclopdia Britannica.</em> Retrieved {day} {month} {year}, from <a href="{url}">{url}</a>',"handlebar.cite.assembly.chicago.format":'<em>{assemblyTitle}</em>, {assemblyType}, from <em>Encyclopdia Britannica,</em> accessed {month} {day}, {year}, <a href="{url}">{url}</a>.',
"handlebar.media.transcript.header":"Transcript","handlebar.media.show.transcript.text":"Show video transcript","handlebar.media.hide.transcript.text":"Hide video transcript","handlebar.userprofile.biography.text":"Biographical Information","handlebar.userprofile.publications.text":"Publications","media.video.no.transcript.text":"This video does not have narration.","homepage.dyk.learnmore":"Learn More","browse.a-z.biography.quick.tip":"Search for a specific word within an article by pressing the <strong>CTRL + F</strong> on your keyboard (or <strong>&#8984; + F</strong> on a Mac).",
"pagination.range.label":"Displaying {range} of {total} results.","browse.breadcrumb.home.text":"Home","resource.packs.quick.search.pagination.more":"More Results","resource.packs.quick.search.pagination.previous":"Previous","mycontent.content-type-ddl.images":"Images","mycontent.content-type-ddl.videos":"Videos","mycontent.content-type-ddl.html5":"Interactives","my.content.alerts.item.can.not.be.removed":"Item cannot be removed!","my.content.alerts.item.can.not.be.renamed":"Item cannot be renamed!",
"my.content.alerts.content.can.not.be.added":"Sorry, there was an error adding content to resource pack!","my.content.alerts.content.already.exists":"This content already exists in this resource pack","my.content.alerts.resource.pack.updated":"Resource pack updated!","my.content.alerts.resource.pack.update.error":"Error! Resource pack could not be updated.","my.content.alerts.no.resource.pack.selected":"No pack was selected!","my.content.alerts.resource.pack.publish.error":"Sorry, could not publish pack!",
"my.content.alerts.resource.pack.unpublish.error":"Sorry, could not unpublish pack!","my.content.alerts.resource.pack.cannot.save.twice":"Resource pack cannot be saved twice.","resource.pack.content.type.count.article.singular":"Article","resource.pack.content.type.count.article.plural":"Articles","resource.pack.content.type.count.image.singular":"Image","resource.pack.content.type.count.image.plural":"Images","resource.pack.content.type.count.video.singular":"Video","resource.pack.content.type.count.video.plural":"Videos",
"resource.pack.content.type.count.lessonplan.singular":"Lesson Plan","resource.pack.content.type.count.lessonplan.plural":"Lesson Plans","resource.pack.content.type.count.ebook.singular":"Primary Source","resource.pack.content.type.count.ebook.plural":"Primary Sources","resource.pack.content.type.count.magazine.singular":"Magazine","resource.pack.content.type.count.magazine.plural":"Magazines","resource.pack.content.type.count.interactive.singular":"Interactive","resource.pack.content.type.count.interactive.plural":"Interactives",
"resource.pack.content.type.count.html5.singular":"Interactive","resource.pack.content.type.count.html5.plural":"Interactives","resource.pack.content.type.count.website.singular":"Website","resource.pack.content.type.count.website.plural":"Websites","resource.pack.content.type.count.document.singular":"Document","resource.pack.content.type.count.document.plural":"Documents","resource.pack.content.type.count.link.singular":"Link","resource.pack.content.type.count.link.plural":"Links","resource.pack.content.type.count.label":"In this pack:",
"my.content.favorites.count.singular":"You have 1 item in your Favorites:","my.content.favorites.count.plural":"You have {count} items in your Favorites:","lesson.plan.content.type.count.label":"In this lesson plan:","my.content.alerts.please.add.content":"Please add at least one resource, either from your favorites, or by browsing Britannica content.","packs.type.":"All","packs.type.article":"Article","packs.type.image":"Image","packs.type.video":"Video","packs.type.magazine":"Magazine","packs.type.ebook":"Primary Source",
"packs.type.interactive":"Interactive","packs.type.website":"Website","packs.type.external_link":"External Link","packs.type.uploaded_document":"Document","packs.type.s":"All","packs.type.articles":"Articles","packs.type.images":"Images","packs.type.videos":"Videos","packs.type.magazines":"Magazines","packs.type.ebooks":"Primary Sources","packs.type.interactives":"Interactives","packs.type.websites":"Websites","packs.type.external_links":"External Links","packs.type.uploaded_documents":"Documents",
"packs.view.switch.pinboard":"Switch to <strong>TAB</strong> view","packs.view.switch.tab":"Switch to <strong>PINBOARD</strong> view","packs.browse.content.title.for.each.pack":"This pack contains:","packs.browse.subject.title.4":"Resource packs for Social Studies","packs.browse.subject.title.3":"Resource packs for Science","packs.browse.no.content.found.message":"<p><b>We're sorry, we couldn't find any Packs to match &ldquo;{searchTerm}&rdquo;.</b></p><p>Suggestions:</p><ul><li>Check your spelling or enter a different keyword/phrase;</li><li>Browse the options related to your search filters below;</li><li>If you still can't find what you're looking for, <a href=\"#pack-feedback-modal\" data-toggle=\"modal\"><b>let us know what topic you would like added!</b></a></li></ul>",
"packs.browse.no.content.found.for.search.in.selected.filters":'<p>Your exact search returned <b>0 results</b>.</p> <p>Showing results for &ldquo;<b>{searchTerm}</b>&rdquo; from <span class="orange">other grade ranges and categories</span>.</p>',"packs.browse.welcome.header":"Start Smart with Resource Packs!","packs.browse.welcome.message.3":"Jump-start learning in Science with expertly compiled images, articles, and videos centered around concepts within branches of scientific study, biological classifications, and famous scientists. Select a grade range below to get started!",
"packs.browse.welcome.message.4":"Jump-start learning in Social Studies with expertly compiled articles, images, videos, and primary sources centered around pivotal events, movements, people, and concepts. Select a grade range below to get started!","packs.browse.customer.feedback.link":"Do you have an idea for a pack topic? <a><b>Let us know!</b></a>","packs.note":"Britannica Note:","packs.grades":"Grades","packs.email.this.pack":"Email This Pack","packs.share.link":"Share","packs.customize":"Customize",
"packs.header.differentiated.crosslinks":"See this pack for","packs.header.differentiated.crosslinks.or":"or","alert.ok.close":"OK","packs.custom.pack.created.by":"Custom Pack created by","my.packs.header":"My Resource Packs","my.packs.custom.pack":"Custom Pack","my.packs.show.custom.pack":"Only Custom Packs","my.packs.sort.label":"Sort packs by:","my.packs.remove.label":"Remove this Resource Pack?","my.packs.remove.cancel":"Cancel","my.packs.remove.confirm":"Remove","packs.search.results.query":"Your search for &ldquo;<b>{searchTerm}</b>&rdquo; returned <b>0 results</b>.",
"packs.search.results.suggest.query":"Showing results for &ldquo;<b>{suggestedTerm}</b>&rdquo;.","packs.search.results.suggest.query.with.suggest.list":"Your search for &ldquo;<b>{searchTerm}</b>&rdquo; returned <b>0 results</b>. Showing results for &ldquo;<b>{suggestedTerm}</b>&rdquo;.","mycontent.favorites.from-packs.warning.back.to.packs.link":"Return to <span>Resource Packs</span>","selectize.clear.title":"Clear selection","assembly.image.related.articles.info":"This image also in:","assembly.video.related.articles.info":"This video also in:",
"resource.pack.uploaded.label":"You have uploaded the following documents:","mycontent.remove-uploaded-document.are-you-sure":"Are you sure you want to remove the uploaded document?","mycontent.load-uploaded-document.legal-disclaimer":"By checking this box and uploading material, you certify that: (i) you have read and agree to our <a href='http://corporate.britannica.com/termsofuse.html' target=\"_blank\">terms of use</a> ; (ii) that the material you upload does not infringe any third party copyrights, trademarks or any other rights; and (iii) that you own or have permission to use the uploaded materials.",
"mycontent.load-uploaded-document.error.file-too-large":"The file <b>{name}</b> is too large to be uploaded to your pack.<br/> Please choose a file smaller than 10MB to upload","mycontent.load-uploaded-document.error.file-type-not-supported":"The file <b>{name}</b> is not in a format that can be uploaded to your pack. <br/> <br/> Try choosing a file with one of these formats:","mycontent.upload.document.total-usage-exceeds-limit.error.header":"Upload Document: Storage Almost Full","mycontent.load-uploaded-document.error.total-usage-exceeds-limit":"<p>Uh-oh! Uploading <b>{name}</b> will put your account over its {maxSize} storage limit.</p><p>Here are your currently stored documents. You can free up some room by deleting any you are no longer using.</p>",
"mycontent.upload.document.total-usage-exceeds-limit.error.th.filename":"File Name","mycontent.upload.document.total-usage-exceeds-limit.error.th.file-to-be-uploaded":"File to be Uploaded","mycontent.upload.document.total-usage-exceeds-limit.error.th.uploaded-date":"Uploaded Date","mycontent.upload.document.total-usage-exceeds-limit.error.th.in-pack":"In Pack","mycontent.upload.document.total-usage-exceeds-limit.error.th.size":"Size","mycontent.upload.document.total-usage-exceeds-limit.error.th.delete":"Delete",
"mycontent.upload.document.total-usage-exceeds-limit.error.th.current-total-size":"Current Total Size:","mycontent.upload.document.total-usage-exceeds-limit.error.th.total-after-upload":"Total After Upload:","mycontent.upload.document.total-usage-exceeds-limit.error.delete.question":"Delete file {name}?","mycontent.upload.document.total-usage-exceeds-limit.error.delete.yes":"Yes, Delete","mycontent.upload.document.total-usage-exceeds-limit.error.delete.no":"No, Cancel","mycontent.upload.document.selected.file":"Selected File:",
"mycontent.upload.document.header":"Upload Document","mycontent.upload.document.button.upload":"Upload","mycontent.upload.document.type.error.header":"Upload Document: File Type Not Allowed","mycontent.upload.document.file.too.large.error.header":"Upload Document: File Too Large","mycontent.upload.document.button.ok":"OK","mycontent.upload.document.button.cancel":"Cancel","mycontent.upload.document.remove.document.header":"Remove Document","media.grid.view.title":"Grid View","media.strip.view.title":"Strip View",
"my.content.packs.user.welcome.overlay.heading":"Welcome!","my.content.packs.user.welcome.overlay.sub.heading":"This is where you can customize your copy of this resource pack.","my.content.packs.user.welcome.overlay.body.text.1":"<strong>Add notes or instructions</strong> to a resource","my.content.packs.user.welcome.overlay.body.text.2":"<strong>Upload</strong> your own documents","my.content.packs.user.welcome.overlay.body.text.3":"<strong>Modify</strong> pack content or details","my.content.packs.user.welcome.overlay.get.started.button":"Get Started",
"my.content.return.to.packs":"Back to Britannica Resource Packs","my.content.your.pack.lives.here.title":"Your Packs","my.content.your.pack.lives.here.para.1":"Your copy of this pack is saved here.","my.content.your.pack.lives.here.para.2":'Start building new packs of your own by clicking "Create a new resource pack!"',"search.thumbnail.size.control.large":"Larger Thumbnails","search.thumbnail.size.control.small":"Smaller Thumbnails","search.thumbnail.size.control.slider.title":"Thumbnail size","content.type.interactive":"Interactive",
"media.gallery.click.to.view.interactive":"Click to view interactive","packs.help.images.search_results":"/resources/img/help/packs_search_results.png","packs.help.images.content":"/resources/img/help/packs_content.png","packs.help.images.explore":"/resources/img/help/packs_explore.png","packs.help.images.share":"/resources/img/help/packs_share.png","packs.help.images.download":"/resources/img/help/packs_download.png","packs.help.images.citation":"/resources/img/help/packs_citation.png","high.feed.news.bbcl.title":"News by BBC News",
"high.feed.news.mi.title":"News by Muy Interesante","school.name":"Britannica School","library.name":"Britannica Library","academic.name":"Britannica Academic","packs.name":"Britannica Resource Packs","packs.view.on.britannica":"View on Britannica School","packs.no.saved.packs":'You have no favorite or custom packs. <a href="/">Get started by browsing Britannica packs!</a>',"packs.user.note.label":"{name}'s note:","packs.custom.save.changes":"Save Changes","packs.custom.saving.changes":"Saving...",
"packs.custom.mode.popover":"With Edit Mode you can customize the pack title, add or remove resources, and create notes for users.","packs.custom.content.added.popover":"Your custom content appears on its own card. When finished editing, don't forget to save your changes!","packs.custom.generic.error.title":"Error","packs.custom.generic.error.message":"Something went wrong. Please try again later.","packs.custom.discard.changes.modal.title":"Discard Changes","packs.custom.discard.changes.modal.body":"Are you sure? Unsaved changes will be lost.",
"packs.custom.discard.changes.confirm":"Discard Changes","packs.custom.discard.changes.cancel":"Cancel","packs.custom.link.validation.message":"This website address does not seem to be valid.","packs.custom.card.title.validation.message":"Please enter a card title.","packs.custom.upload.no.file.message":"No file selected.","packs.custom.upload.format.supported.message":"{filename} is not a file format that can be uploaded.","packs.custom.upload.file.too.large.message":"{filename} exceeds the 20MB limit for each pack.",
"packs.custom.pack.saved.popover":"You created a custom pack! Access all custom and favorite packs from the My Resource Packs link.","packs.custom.pack.favorited.popover":"You favorited a pack! Access all favorite and custom packs from the My Resource Packs link.","packs.custom.add.note":"Add a note","packs.custom.upload.exceeds.limit.yes.delete":"Yes, Delete","packs.custom.upload.exceeds.limit.no.cancel":"No, Cancel","packs.custom.upload.exceeds.limit.delete.file":"Delete file {filename}?","packs.share.copied":"Copied!",
"packs.share.could.not.copy.safari":"Press &#8984;-C to copy","packs.share.could.not.copy":"Press Ctrl+C to copy"},"en-AU":{"lessons.planning.builder.details.grade.label":"Year Levels","lessons.planning.convert.note":"<em>*Please note that the original pack version of this content will remain in your Favourites and Packs tab.</em>","school.level1.name.lower":"primary","school.level1.name.capital":"Primary","library.level1.name.lower":"kids","library.level1.name.capital":"Kids","library.level2.name.lower":"teens",
"library.level2.name.capital":"Teens","library.level3.name.lower":"adults","library.level3.name.capital":"Adults","spell.favorite.lower":"favourite","spell.favorite.capital":"Favourite","institution.dictionary.feature.description.text":"This is the double-click dictionary. Double-click any word to see its definition.","institution.dictionary.tap.feature.description.text":"Tap and hold any word for 1 second to see its definition.","institution.favorites.login.prompt":"Please log in to add to favourites.",
"learning-material.social-studies":"History","learning-material.language-arts":"English","home.middle.primary.sources":"Recommended Primary Sources","home.middle.primary.sources.text":"Find letters, speeches, and other primary source material.","mycontent.all-my-favorites":"All Favourites","mycontent.delete-favorite-warning":'Removing content from "All My Favourites" will also remove it from within resource packs. Are you sure... ?',"mycontent.help-overlay.text1":"Favourite content by clicking the star:",
"mycontent.help-overlay.text3":"Organise your favourites into resource packs by dragging and dropping:","my.content.favorites.count.singular":"You have 1 item in your Favourites:","my.content.favorites.count.plural":"You have {count} items in your Favourites:","my.content.alerts.please.add.content":"Please add at least one resource, either from your favourites, or by browsing Britannica content.","packs.no.saved.packs":'You have no favourite or custom packs. <a href="/">Get started by browsing Britannica packs!</a>',
"packs.custom.pack.saved.popover":"You created a custom pack! Access all custom and favourite packs from the My Resource Packs link.","packs.custom.pack.favorited.popover":"You favourited a pack! Access all favourite and custom packs from the My Resource Packs link."},"en-CA":{"home.middle.primary.sources":"Recommended Primary Sources","home.middle.primary.sources.text":"Find letters, speeches, and other primary source material."},"en-IN":{"lessons.planning.builder.details.grade.label":"Year Levels",
"lessons.planning.convert.note":"<em>*Please note that the original pack version of this content will remain in your Favourites and Packs tab.</em>","home.middle.primary.sources":"Recommended Primary Sources","mycontent.all-my-favorites":"All Favourites","mycontent.delete-favorite-warning":'Removing content from "All My Favourites" will also remove it from within resource packs. Are you sure... ?',"mycontent.help-overlay.text1":"Favourite content by clicking the star:","mycontent.help-overlay.text3":"Organise your favourites into resource packs by dragging and dropping:",
"my.content.favorites.count.singular":"You have 1 item in your Favourites:","my.content.favorites.count.plural":"You have {count} items in your Favourites:","my.content.alerts.please.add.content":"Please add at least one resource, either from your favourites, or by browsing Britannica content.","packs.no.saved.packs":'You have no favourite or custom packs. <a href="/">Get started by browsing Britannica packs!</a>',"packs.custom.pack.saved.popover":"You created a custom pack! Access all custom and favourite packs from the My Resource Packs link.",
"packs.custom.pack.favorited.popover":"You favourited a pack! Access all favourite and custom packs from the My Resource Packs link."},"en-NZ":{"lessons.planning.builder.details.grade.label":"Year Levels","lessons.planning.convert.note":"<em>*Please note that the original pack version of this content will remain in your Favourites and Packs tab.</em>","school.level1.name.lower":"primary","school.level1.name.capital":"Primary","school.level3.name.lower":"secondary","school.level3.name.capital":"Secondary",
"library.level1.name.lower":"kids","library.level1.name.capital":"Kids","library.level2.name.lower":"teens","library.level2.name.capital":"Teens","library.level3.name.lower":"adults","library.level3.name.capital":"Adults","spell.favorite.lower":"favourite","spell.favorite.capital":"Favourite","institution.dictionary.feature.description.text":"This is the double-click dictionary. Double-click any word to see its definition.","institution.dictionary.tap.feature.description.text":"Tap and hold any word for 1 second to see its definition.",
"institution.favorites.login.prompt":"Please log in to add to favourites.","learning-material.social-studies":"Social Sciences","learning-material.language-arts":"The Arts","home.middle.primary.sources":"Recommended Primary Sources","home.middle.primary.sources.text":"Find letters, speeches, and other primary source material.","mycontent.all-my-favorites":"All Favourites","mycontent.delete-favorite-warning":'Removing content from "All My Favourites" will also remove it from within resource packs. Are you sure... ?',
"mycontent.help-overlay.text1":"Favourite content by clicking the star:","mycontent.help-overlay.text3":"Organise your favourites into resource packs by dragging and dropping:","my.content.favorites.count.singular":"You have 1 item in your Favourites:","my.content.favorites.count.plural":"You have {count} items in your Favourites:","my.content.alerts.please.add.content":"Please add at least one resource, either from your favourites, or by browsing Britannica content.","packs.no.saved.packs":'You have no favourite or custom packs. <a href="/">Get started by browsing Britannica packs!</a>',
"packs.custom.pack.saved.popover":"You created a custom pack! Access all custom and favourite packs from the My Resource Packs link.","packs.custom.pack.favorited.popover":"You favourited a pack! Access all favourite and custom packs from the My Resource Packs link."},"en-UK":{"lessons.planning.builder.details.grade.label":"Ages","lessons.planning.convert.note":"<em>*Please note that the original pack version of this content will remain in your Favourites and Packs tab.</em>","school.level1.name.lower":"foundation",
"school.level1.name.capital":"Foundation","school.level2.name.lower":"intermediate","school.level2.name.capital":"Intermediate","school.level3.name.lower":"advanced","school.level3.name.capital":"Advanced","library.level1.name.lower":"junior","library.level1.name.capital":"Junior","library.level2.name.lower":"student","library.level2.name.capital":"Student","library.level3.name.lower":"adult","library.level3.name.capital":"Adult","spell.favorite.lower":"favourite","spell.favorite.capital":"Favourite",
"institution.dictionary.feature.description.text":"This is the double-click dictionary. Double-click any word to see its definition.","institution.dictionary.tap.feature.description.text":"Tap and hold any word for 1 second to see its definition.","institution.favorites.login.prompt":"Please log in to add to favourites.","learning-material.social-studies":"Social Sciences","learning-material.language-arts":"English","home.middle.primary.sources":"Recommended Primary Sources","home.middle.primary.sources.text":"Find letters, speeches, and other primary source material.",
"mycontent.all-my-favorites":"All Favourites","mycontent.delete-favorite-warning":'Removing content from "All My Favourites" will also remove it from within resource packs. Are you sure... ?',"mycontent.help-overlay.text1":"Favourite content by clicking the star:","mycontent.help-overlay.text3":"Organise your favourites into resource packs by dragging and dropping:","my.content.favorites.count.singular":"You have 1 item in your Favourites:","my.content.favorites.count.plural":"You have {count} items in your Favourites:",
"my.content.alerts.please.add.content":"Please add at least one resource, either from your favourites, or by browsing Britannica content.","packs.no.saved.packs":'You have no favourite or custom packs. <a href="/">Get started by browsing Britannica packs!</a>',"packs.custom.pack.saved.popover":"You created a custom pack! Access all custom and favourite packs from the My Resource Packs link.","packs.custom.pack.favorited.popover":"You favourited a pack! Access all favourite and custom packs from the My Resource Packs link."},
es:{"article.action.email.address":"Correo electrnico","article.action.email.name":"Nombre","login.submit.button.text":"Iniciar sesin","lessons.search.levels.high":"Academica","lessons.search.levels.middle":"Secundaria","lessons.search.levels.elementary":"Primaria","elementary.feed.news.bbcl.title":"Noticias por <i>BBC Mundo</i>","elementary.feed.news.mi.title":"Noticias por <i>Muy Interesante</i>","middle.feed.news.bbcl.title":"Noticias por <i>BBC Mundo</i>","middle.feed.news.mi.title":"Noticias por <i>Muy Interesante</i>",
"my.content.content-type.image":"imagen","school.level1.name.lower":"primaria","school.level1.name.capital":"Primaria","school.level2.name.lower":"secundaria","school.level2.name.capital":"Secundaria","spell.favorite.lower":"favorito","spell.favorite.capital":"Favorito","institution.dictionary.feature.description.text":"Este es el diccionario. Haz doble clic en una palabra para ver su significado o su traduccin al ingls.","institution.dictionary.tap.feature.description.text":"Mantn el dedo pulsado sobre cualquier palabra por un segundo para ver su significado o su traduccin al ingls.",
"institution.dictionary.feature.word.not.found":"Esta palabra no est en el diccionario.","institution.favorites.login.prompt":"Por favor, inicia sesin para indicar tu contenido favorito.","institution.toc.expand.label":"Expandir todo","institution.toc.collapse.label":"Contraer todo","home.nara.see.all":"Ver ms","home.nara.new":"NUEVO","home.middle.nara.heading":"Artculos nuevos y actualizados","video.appears.in.articles":"Este video aparece en los siguientes artculos:","image.appears.in.articles":"Esta imagen aparece en los siguientes artculos:",
"mycontent.all-my-favorites":"Todos favoritos","mycontent.item":"recurso","mycontent.items":"recursos","mycontent.delete-favorite-warning":'Eliminacin del contenido de "Todos Mis favoritos" tambin lo borrar de las colecciones. Ests seguro?',"mycontent.content-type-ddl.all":"Todo","mycontent.content-type-ddl.articles":"Artculos","mycontent.content-type-ddl.images-and-videos":"Imgenes y videos","mycontent.remove-collection.are-you-sure":"Ests seguro de que quieres eliminar esta coleccin?",
"mycontent.remove-item.from-collection.are-you-sure":"El recurso ser eliminado de la coleccin. Ests seguro?","mycontent.remove-collection.are-you-sure.ok":"Eliminar","mycontent.remove-collection.are-you-sure.cancel":"Cancelar","mycontent.help-overlay.header":"Organiza tu trabajo con Mi contenido","mycontent.help-overlay.text1":"Indica contenidos favoritos haciendo clic sobre la estrella:","mycontent.help-overlay.text2":"Crea colecciones para guardar tus contenidos:","mycontent.help-overlay.text3":"Organiza tus contenidos favoritos en colecciones con la funcin arrastrar y soltar:",
"mycontent.help-overlay.got-it":"Me queda claro!","mycontent.label-already-exists":"Esta coleccin ya existe.","browse.subjects.title":"Artculos","xsl.article.introduction":"Introduccin","xsl.expand":"[+] Expandir","xsl.collapse":"[-] Contraer","xsl.article.elementary.single.toc.intro":"Artculo","xsl.animal.breadcrumb.home.text":"Pgina principal","xsl.animal.breadcrumb.animal.kingdom.text":"Reino animal","xsl.melingo.button.english.label":"Ingls","xsl.melingo.see-full-definition":"Ver definicin completa",
"xsl.melingo.definitions-provided-by":"Definiciones proporcionada por","xsl.rae.definitions-provided-by":"Definicin proporcionada por","xsl.mw.translations-provided-by":"Traduccin proporcionada por","header.tools.print":"Imprimir","header.tools.cite":"Citar","header.tools.email":"Enviar","header.tools.font-up":"Letra ms grande","header.tools.font-down":"Letra ms pequea","handlebar.cite.intro":"A pesar de que se ha hecho todo lo posible para seguir las reglas de estilo de citacin, puede haber algunas discrepancias. En caso de alguna duda, favor de consultar el manual de estilo apropiado u otras fuentes.",
"handlebar.cite.select.label":"Seleccionar estilo de citacin","handlebar.media.download.text":"Descargar","handlebar.media.counter.text":"Recursos multimedia","handlebar.media.view.large.text":"Ver imagen ampliada","action.email":"Enviar","action.email.recipient.label":"Destinatarios","action.email.cancel":"Cancelar","action.email.failure":"No se ha podido enviar el recurso.","action.email.hint":"Para compartir con ms de una persona, separa las direcciones usando la coma.","action.email.sender.name.label":"Nombre del remitente",
"action.email.sender.email.label":"Correo electrnico del remitente","action.email.recipients.invalid":"Verifica el formato de las direcciones de correo electrnico que has ingresado.","action.email.sender.name.invalid":"Nombre es obligatorio","action.email.sender.email.invalid":"Correo electrnico es obligatorio.","action.email.submit":"Enviar","action.email.to":"Destinatario","action.email.from":"Remitente","handlebar.cite.date.month.format":"{month}","handlebar.cite.date.mon.format":"{mon}","handlebar.cite.article.mla.format":'"{title}." <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}. <a href="{url}">{urlWithoutProtocol}</a>. Consultado el {day} {mon}. {year}.',
"handlebar.cite.article.apa.format":'<strong>{title}</strong>. ({year}). En <em>{siteTitle}</em>. Recuperado el {day} de {month} de {year}, de Encyclopdia Britannica: <a href="{url}">{url}</a>',"handlebar.cite.article.harvard.format":'{title} {year}. <em>{siteTitle}</em>. Consultado el {day} de {month} de {year}, desde <a href="{url}">{url}</a>',"handlebar.cite.article.chicago.format":'<em>{siteTitle}</em>, s.v. "{title}", consultado el {day} de {month}, {year}, <a href="{url}">{url}</a>.',"handlebar.cite.article.mla.print.format":'"{title}." <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}.</br>{urlWithoutProtocol}. Consultado el {day} {mon}. {year}.',
"handlebar.cite.article.apa.print.format":"<strong>{title}</strong>. ({year}). En <em>{siteTitle}</em>. Recuperado el {day} de {month} de {year}, de Encyclopdia Britannica: </br>{url}","handlebar.cite.article.harvard.print.format":"{title} {year}. <em>{siteTitle}</em>. Consultado el {day} de {month} de {year}, desde </br>{url}","handlebar.cite.article.chicago.print.format":'<em>{siteTitle}</em>, s.v. "{title}", consultado el {day} de {month}, {year}, </br>{url}.',"handlebar.cite.assembly.mla.format":'<em>{assemblyTitle}.</em> {assemblyType}. <em>{siteTitle}</em>, Encyclopdia Britannica, {pubDay} {pubMon}. {pubYear}. <a href="{url}">{urlWithoutProtocol}</a>. Consultada el {day} {mon}. {year}.',
"handlebar.cite.assembly.apa.format":'<strong>{assemblyTitle}.</strong> ({year}). En <em>{siteTitle}.</em> Recuperado el {day} de {month} de {year}, de Encyclopdia Britannica: <a href="{url}">{url}</a>',"handlebar.cite.assembly.harvard.format":'{assemblyTitle} {year}. <em>{siteTitle}.</em> Consultado el {day} de {month} de {year}, desde <a href="{url}">{url}</a>',"handlebar.cite.assembly.chicago.format":'<em>{siteTitle}</em>, s.v. "{assemblyTitle}", consultado el {day} de {month}, {year}, <a href="{url}">{url}</a>.',
"handlebar.media.transcript.header":"Transcripcin","handlebar.media.show.transcript.text":"Mostrar transcripcin del video","handlebar.media.hide.transcript.text":"Ocultar transcripcin del video","media.video.no.transcript.text":"Este video no tiene narracin.","shared.see.more":"Ver ms","shared.a.of.b":"{a} de {b}","elementary.homepage.animal-of-the-day.title":"Animal del da","elementary.homepage.video-of-the-day.title":"Sabas que?","browse.a-z.article.header":"Ver artculos por orden alfabtico.",
"browse.a-z.biography.header":"Ver biografas por orden alfabtico.","homepage.dyk.learnmore":"Aprenda ms","browse.a-z.biography.quick.tip":"Busca palabras especficas dentro de un artculo pulsando las teclas <strong>Ctrl + F<strong> (o <strong>&#8984; +F</strong> en Mac).","pagination.range.label":"Mostrando {range} de {total} resultados.","browse.games.header":"<p>Nuestras actividades de aprendizaje te ayudarn con tus estudios, tanto en clase como en casa. Y te vas a divertir tambin!</p><p>Selecciona una de las asignaturas de abajo para comenzar y luego escoge el tema que ms te interese.</p>",
"browse.breadcrumb.home.text":"Inicio","resource.packs.quick.search.pagination.more":"Ms resultados","resource.packs.quick.search.pagination.previous":"Resultados anteriores","mycontent.content-type-ddl.images":"Imgenes","my.content.alerts.item.can.not.be.removed":"No se puede eliminar este recurso!","my.content.alerts.item.can.not.be.renamed":"No se puede cambiar el nombre de este recurso!","my.content.alerts.content.can.not.be.added":"Lo sentimos, hubo un error al agregar contenido a esta coleccin!",
"my.content.alerts.content.already.exists":"Este contenido ya existe en esta coleccin.","my.content.alerts.resource.pack.updated":"Esta coleccin ha sido actualizada!","my.content.alerts.resource.pack.update.error":"Hubo un error! No se pudo actualizar esta coleccin.","my.content.alerts.no.resource.pack.selected":"No seleccionaste ninguna coleccin!","my.content.alerts.resource.pack.publish.error":"Lo sentimos, no se pudo publicar esta coleccin.","my.content.alerts.resource.pack.unpublish.error":"Lo sentimos, no se pudo anular la publicacin de esta coleccin.",
"my.content.alerts.resource.pack.cannot.save.twice":"No se puede guardar la coleccin dos veces.","resource.pack.content.type.count.article.singular":"Artculo","resource.pack.content.type.count.article.plural":"Artculos","resource.pack.content.type.count.image.singular":"Imagen","resource.pack.content.type.count.image.plural":"Imgenes","resource.pack.content.type.count.label":"En esta coleccin:","my.content.favorites.count.singular":"Tienes 1 recurso en tus Favoritos:","my.content.favorites.count.plural":"Tienes {count} recursos en tus Favoritos:",
"my.content.alerts.please.add.content":"Por favor, agrega al menos un recurso de tus Favoritos o busca los recursos en Britannica Escolar.","alert.ok.close":"Cerrar","assembly.image.related.articles.info":"Esta imagen tambin aparece en:","assembly.video.related.articles.info":"Este video tambin aparece en:","resource.pack.uploaded.label":"Has subido los siguientes archivos:","mycontent.remove-uploaded-document.are-you-sure":"Ests seguro de que quieres eliminar el archivo subido?","mycontent.load-uploaded-document.legal-disclaimer":"Al marcar esta casilla y al subir los materiales, certificas que: (i) has ledo y ests de acuerdo con nuestros <a href='http://corporate.britannica.com/termsofuse.html'>trminos de uso</a>; (ii) el material subido no infringe los derechos de autor, marcas registradas o cualquier otro derecho de terceros; y (iii) eres propietario de los materiales subidos o tienes permiso para utilizarlos.",
"mycontent.load-uploaded-document.error.file-too-large":"El archivo es demasiado grande para subir a esta coleccin. Por favor, escoge un archivo que no supere los 10MB.","mycontent.load-uploaded-document.error.file-type-not-supported":"El tipo del archivo no es admitido. Escoge un archivo en uno de los formatos siguientes:","mycontent.upload.document.selected.file":"Archivo Seleccionado:","mycontent.upload.document.header":"Archivo Subido","mycontent.upload.document.button.upload":"Subir","mycontent.upload.document.type.error.header":"Archivo Subido: Tipo de Archivo No Admitido",
"mycontent.upload.document.file.too.large.error.header":"Archivo Subido: Archivo Demasiado Grande","mycontent.upload.document.button.ok":"Aceptar","mycontent.upload.document.button.cancel":"Cancelar","mycontent.upload.document.remove.document.header":"Eliminar Archivo","nara.date.separator":"de","high.feed.news.bbcl.title":"Noticias por <i>BBC Mundo</i>","high.feed.news.mi.title":"Noticias por <i>Muy Interesante</i>","school.name":"Britannica Escolar","academic.name":"Britannica Moderna"},pt:{"article.action.email.name":"Nome",
"login.submit.button.text":"Fazer login","lessons.search.levels.elementary":"Ensino Fundamental","elementary.feed.news.folha.title":"Notcias","my.content.content-type.image":"Imagem","my.content.content-type.video":"Vdeo","school.level1.name.lower":"fundamental","school.level1.name.capital":"Ensino Fundamental","spell.favorite.lower":"favorito","spell.favorite.capital":"Favorito","institution.favorites.login.prompt":"Por favor, faa login para adicionar contedo aos seus favoritos.","institution.toc.expand.label":"Ver mais",
"institution.toc.collapse.label":"Ver menos","home.nara.see.all":"Ver mais","home.nara.new":"NOVIDADE","video.appears.in.articles":"Este vdeo aparece nos seguintes artigos:","image.appears.in.articles":"Esta imagem aparece nos seguintes artigos:","mycontent.all-my-favorites":"Todos os favoritos","mycontent.item":"recurso","mycontent.items":"recursos","mycontent.delete-favorite-warning":'Ao deletar contedo da lista "Todos os favoritos", voc tambm ir remov-lo das colees. Deseja continuar?',
"mycontent.content-type-ddl.all":"Todos","mycontent.content-type-ddl.articles":"Artigos","mycontent.content-type-ddl.images-and-videos":"Imagens e vdeos","mycontent.remove-collection.are-you-sure":"Tem certeza de que deseja deletar esta coleo?","mycontent.remove-item.from-collection.are-you-sure":"Tem certeza de que deseja remover o recurso desta coleo?","mycontent.remove-collection.are-you-sure.ok":"Sim","mycontent.remove-collection.are-you-sure.cancel":"Cancelar","mycontent.help-overlay.header":"Organize seu trabalho com a seo Meu contedo",
"mycontent.help-overlay.text1":"Clique na estrela para marcar o contedo como favorito.","mycontent.help-overlay.text2":"Crie colees para salvar contedo.","mycontent.help-overlay.text3":"Organize seus contedos favoritos arrastando os recursos para dentro de uma coleo.","mycontent.help-overlay.got-it":"Entendi!","mycontent.label-already-exists":"Esta coleo j existe.","browse.subjects.title":"Artigos","xsl.article.introduction":"Introduo","xsl.expand":"[+] Expandir","xsl.collapse":"[-] Contrair",
"xsl.article.elementary.single.toc.intro":"Artigo","xsl.animal.breadcrumb.home.text":"Pgina principal","xsl.animal.breadcrumb.animal.kingdom.text":"Reino Animal","xsl.animal.browse.az.title":"Animais de A a Z","header.tools.print":"Imprimir","header.tools.cite":"Citar","header.tools.email":"Enviar","header.tools.font-up":"Aumentar fonte","header.tools.font-down":"Diminuir fonte","handlebar.cite.intro":"Estilo ABNT","handlebar.cite.article.abnt.format":'<em>{title}</em>. In {siteTitle}. <em>Enciclopdia Escolar Britannica</em>, {year}. Web, {year}. Disponvel em: &lt;<a href="{url}">{url}</a>&gt;. Acesso em: {day} de {month} de {year}.',
"handlebar.cite.article.abnt.print.format":"<em>{title}</em>. In {siteTitle}. <em>Enciclopdia Escolar Britannica</em>, {year}. Web, {year}. Disponvel em: &lt;{url}&gt;. Acesso em: {day} de {month} de {year}.","handlebar.cite.assembly.abnt.format":'<em>{assemblyTitle}</em>. {assemblyType}. In <em>{siteTitle}</em>. Web, {year}. Disponvel em: &lt;<a href="{url}">{url}</a>&gt;. Acesso em: {day} de {month} de {year}.',"handlebar.media.download.text":"Fazer download","handlebar.media.counter.text":"Recursos multimdia",
"handlebar.media.view.large.text":"Ver imagem ampliada","action.email":"Enviar","action.email.recipient.label":"Destinatrios","action.email.cancel":"Cancelar","action.email.failure":"No foi possvel enviar o recurso.","action.email.hint":"Para enviar o recurso a mais de um destinatrio, separe os e-mails com uma vrgula.","action.email.sender.name.label":"Nome do remetente","action.email.sender.email.label":"E-mail do remetente","action.email.recipients.invalid":"Confira se o e-mail foi digitado corretamente",
"action.email.sender.name.invalid":"O nome  obrigatrio","action.email.sender.email.invalid":"O e-mail  obrigatrio","action.email.submit":"Enviar","action.email.to":"Destinatrio","action.email.from":"Remetente","handlebar.media.transcript.header":"Transcrio","handlebar.media.show.transcript.text":"Mostrar transcrio do vdeo","handlebar.media.hide.transcript.text":"Ocultar transcrio do vdeo","media.video.no.transcript.text":"Este vdeo no tem narrao.","shared.see.more":"Ver mais","shared.a.of.b":"{a} de {b}",
"elementary.homepage.video-of-the-day.title":"Voc sabia?","elementary.homepage.article-of-the-day.title":"Artigos de interesse","elementary.homepage.learningzone.title":"Para os alunos mais jovens","elementary.homepage.lz.description":"Estamos construindo este espao para voc.","elementary.homepage.lz.link":"Aguarde.","browse.a-z.article.header":"Veja os artigos em ordem alfabtica","browse.a-z.biography.header":"Veja as biografias em ordem alfabtica","homepage.dyk.learnmore":"Veja mais","browse.a-z.biography.quick.tip":"Encontre palavras especficas dentro de um artigo pressionando as teclas <strong>Ctrl + F<strong> (ou <strong>&#8984; +F</strong> no Mac).",
"pagination.range.label":"Mostrando {range} de {total} resultados.","browse.games.header":"<p>As atividades de aprendizado iro ajud-lo tanto na sala de aula quanto em casa. E alm de tudo voc vai se divertir!</p><p>Escolha uma das opes abaixo, depois clique no tema que mais lhe interessa.</p>","browse.breadcrumb.home.text":"Incio","resource.packs.quick.search.pagination.more":"Mais resultados","resource.packs.quick.search.pagination.previous":"Resultados anteriores","mycontent.content-type-ddl.images":"Imagens",
"mycontent.content-type-ddl.videos":"Vdeos","my.content.alerts.item.can.not.be.removed":"Este recurso no pode ser deletado!","my.content.alerts.item.can.not.be.renamed":"O nome deste recurso no pode ser modificado!","my.content.alerts.content.can.not.be.added":"Desculpe, no foi possvel acrescentar este contedo  coleo.","my.content.alerts.content.already.exists":"Este contedo j faz parte desta coleo.","my.content.alerts.resource.pack.updated":"A coleo foi atualizada!","my.content.alerts.resource.pack.update.error":"Houve um erro. No foi possvel atualizar a coleo.",
"my.content.alerts.no.resource.pack.selected":"Voc no selecionou nenhuma coleo.","my.content.alerts.resource.pack.publish.error":"Desculpe, no foi possvel publicar esta coleo.","my.content.alerts.resource.pack.unpublish.error":"Desculpe, no foi possvel anular a publicao desta coleo.","my.content.alerts.resource.pack.cannot.save.twice":"No  possvel salvar a coleo duas vezes.","resource.pack.content.type.count.article.singular":"Artigo","resource.pack.content.type.count.article.plural":"Artigos",
"resource.pack.content.type.count.image.singular":"Imagem","resource.pack.content.type.count.image.plural":"Imagens","resource.pack.content.type.count.video.singular":"Vdeo","resource.pack.content.type.count.video.plural":"Vdeos","resource.pack.content.type.count.label":"Nesta coleo:","my.content.favorites.count.singular":"H 1 recurso na sua seo Favoritos","my.content.favorites.count.plural":"H {count} recursos na sua seo Favoritos:","my.content.alerts.please.add.content":"Por favor, acrescente pelo menos um item da sua lista de favoritos, ou encontre recursos pesquisando no Britannica Escola.",
"alert.ok.close":"Fechar","assembly.image.related.articles.info":"Esta imagem tambm aparece em:","assembly.video.related.articles.info":"Este vdeo tambm aparece em:","resource.pack.uploaded.label":"Voc fez o upload destes arquivos:","mycontent.remove-uploaded-document.are-you-sure":"Tem certeza de que quer deletar o arquivo acrescentado?","mycontent.load-uploaded-document.legal-disclaimer":"Ao marcar este box e fazer o upload dos materiais, voc garante que: (i) leu e est de acordo com os nossos <a href='http://corporate.britannica.com/termsofuse.html'>termos de uso</a>; (ii) o material acrescentado no infringe direitos autorais, marcas registradas nem qualquer outro direito de terceiros; (iii)  o proprietrio dos materiais acrescentados ou tem permisso para utiliz-los.",
"mycontent.load-uploaded-document.error.file-too-large":"O arquivo  grande demais. Por favor, escolha um arquivo menor que 10MB.","mycontent.load-uploaded-document.error.file-type-not-supported":"Esse tipo de arquivo no  permitido. Por favor, escolha arquivos que estejam em um dos seguintes formatos:","mycontent.upload.document.selected.file":"Arquivo selecionado:","mycontent.upload.document.header":"Fazer upload do arquivo","mycontent.upload.document.button.upload":"Fazer upload","mycontent.upload.document.type.error.header":"Fazer upload do arquivo: tipo de arquivo no permitido",
"mycontent.upload.document.file.too.large.error.header":"Fazer upload do arquivo: arquivo grande demais","mycontent.upload.document.button.ok":"Confirmar","mycontent.upload.document.button.cancel":"Cancelar","mycontent.upload.document.remove.document.header":"Deletar arquivo","nara.date.separator":"de","school.name":"Britannica Escola"}};a.en=a["en-US"];return a}();EB=window.EB||{};
EB.Resources=function(){var a={"en-US":{"home.middle.feed.news":[],"home.middle.nara.count":8,"home.high.nara.count":10,"home.primary.sources.path":"/resources/files/home/shared/us-primary-sources.json","academic.home.primary.sources.path":"/resources/files/home/shared/int-primary-sources.json","packs.help.images.search_results":"/resources/img/help/packs_search_results.png","packs.help.images.content":"/resources/img/help/packs_content.png","packs.help.images.explore":"/resources/img/help/packs_explore.png",
"packs.help.images.share":"/resources/img/help/packs_share.png","packs.help.images.download":"/resources/img/help/packs_download.png","packs.help.images.citation":"/resources/img/help/packs_citation.png","packs.help.article.tools":"/resources/img/help/article_tools.png","packs.images.additional.tools":"/resources/img/help/article_addtnl_tools.png","packs.images.media.tools":"/resources/img/help/media_tools.png","help.images.search_results":"/resources/img/help/search_results{us}{levelRestriction}.png",
"help.images.level_indicators":"/resources/img/help/level_indicators{levelRestriction}.png","help.images.related_elem":"/resources/img/help/related_Elem.png","help.images.related_mid_high":"/resources/img/help/related_Mid_High.png","help.images.favorites":"/resources/img/help/favorites.png","help.images.print":"/resources/img/help/print.png","help.images.email":"/resources/img/help/email.png","help.images.font_size":"/resources/img/help/font_size.png","help.images.cite":"/resources/img/help/cite.png",
"help.images.translate":"/resources/img/help/translate.png","help.images.listen":"/resources/img/help/listen.png","help.images.dictionary":"/resources/img/help/dictionary.png","help.images.teacher_tab_ms":"/resources/img/help/teacher_tab_MS.png","user.content.features.intro.favorite.popup.1":"/resources/img/features-intro/favorite-popup-1.png","user.content.features.intro.favorite.popup.2":"/resources/img/features-intro/favorite-popup-2.png","user.content.features.intro.favorite.popup.3":"/resources/img/features-intro/favorite-popup-3.png",
"user.content.features.intro.favorite.popup.4":"/resources/img/features-intro/favorite-popup-4.png","filedlogin.video.poster":"/resources/img/failedlogin/video-poster-{siteType}.jpg","my.content.grade.ranges":[{label:"Pre-K - 2nd",shortLabel:"Pre-K-2",fullLabel:"Grades Pre-K-2",value:1},{label:"3rd - 5th",shortLabel:"3-5",fullLabel:"Grades 3-5",value:2},{label:"6th - 8th",shortLabel:"6-8",fullLabel:"Grades 6-8",value:3},{label:"9th - 12th",shortLabel:"9-12",fullLabel:"Grades 9-12",value:4}],"my.content.grades.all":{US:[{label:"Pre-K - 2nd",
value:1,sequence:1},{label:"3rd - 5th",value:2,sequence:2},{label:"6th - 8th",value:3,sequence:3},{label:"9th - 12th",value:4,sequence:4}],UK:[{label:"5-7",value:10,sequence:1},{label:"7-11",value:8,sequence:2},{label:"11-14",value:9,sequence:3},{label:"14-16",value:11,sequence:4}],AU:[{label:"K",value:17,sequence:1},{label:"1st - 2nd",value:15,sequence:2},{label:"3rd - 4th",value:16,sequence:3},{label:"5th - 6th",value:18,sequence:4},{label:"7th - 8th",value:19,sequence:5},{label:"9th - 10th",value:20,
sequence:6},{label:"11th - 12th",value:21,sequence:7}],NZ:[{label:"K",value:22,sequence:1},{label:"1st - 2nd",value:23,sequence:2},{label:"3rd - 4th",value:24,sequence:3},{label:"5th - 6th",value:25,sequence:4},{label:"7th - 8th",value:26,sequence:5},{label:"9th - 10th",value:27,sequence:6},{label:"11th - 12th",value:28,sequence:7}],AS:[{label:"Pre-K - K",value:29,sequence:1},{label:"1st - 2nd",value:30,sequence:2},{label:"3rd - 4th",value:31,sequence:3},{label:"5th - 6th",value:32,sequence:4},{label:"7th - 8th",
value:33,sequence:5},{label:"9th - 10th",value:34,sequence:6},{label:"11th - 12th",value:35,sequence:7}]},"resource.packs.levels.to.grades":{1:[1,2],2:[3],3:[4]},"my.packs.sort.filter":[{name:"Most Recent",value:"date"},{name:"Alphabetical A-Z",value:"alpha"}]},"en-CA":{"home.primary.sources.path":"/resources/files/home/shared/int-primary-sources.json"},"en-AS":{"my.content.grade.ranges":[{label:"Pre-K - K",shortLabel:"Pre-K - K",fullLabel:"Grades Pre-K - K",value:29},{label:"1st - 2nd",shortLabel:"1st - 2nd",
fullLabel:"Grades 1st - 2nd",value:30},{label:"3rd - 4th",shortLabel:"3rd - 4th",fullLabel:"Grades 3rd - 4th",value:31},{label:"5th - 6th",shortLabel:"5th - 6th",fullLabel:"Grades 5th - 6th",value:32},{label:"7th - 8th",shortLabel:"7th - 8th",fullLabel:"Grades 7th - 8th",value:33},{label:"9th - 10th",shortLabel:"9th - 10th",fullLabel:"Grades 9th - 10th",value:34},{label:"11th - 12th",shortLabel:"11th - 12th",fullLabel:"Grades 11th - 12th",value:35}]},"en-UK":{"home.middle.feed.news":[{name:"bbc",
count:5}],"home.primary.sources.path":"/resources/files/home/shared/int-primary-sources.json","my.content.grade.ranges":[{label:"5-7",shortLabel:"5-7",fullLabel:"Grades 5-7",value:10},{label:"7-11",shortLabel:"7-11",fullLabel:"Grades 7-11",value:8},{label:"11-14",shortLabel:"11-14",fullLabel:"Grades 11-14",value:9},{label:"14-16",shortLabel:"14-16",fullLabel:"Grades 14-16",value:11}]},"en-AU":{"my.content.grade.ranges":[{label:"K",shortLabel:"K",fullLabel:"Grade K",value:17},{label:"1st - 2nd",shortLabel:"1st - 2nd",
fullLabel:"Grades 1st - 2nd",value:15},{label:"3rd - 4th",shortLabel:"3rd - 4th",fullLabel:"Grades 3rd - 4th",value:16},{label:"5th - 6th",shortLabel:"5th - 6th",fullLabel:"Grades 5th - 6th",value:18},{label:"7th - 8th",shortLabel:"7th - 8th",fullLabel:"Grades 7th - 8th",value:19},{label:"9th - 10th",shortLabel:"9th - 10th",fullLabel:"Grades 9th - 10th",value:20},{label:"11th - 12th",shortLabel:"11th - 12th",fullLabel:"Grades 11th - 12th",value:21}],"home.middle.feed.news":[{name:"cbbc",count:5},
{name:"btn",count:5}],"home.middle.nara.count":16,"home.primary.sources.path":"/resources/files/home/shared/int-primary-sources.json"},"en-NZ":{"my.content.grade.ranges":[{label:"K",shortLabel:"K",fullLabel:"Grade K",value:22},{label:"1st - 2nd",shortLabel:"1st - 2nd",fullLabel:"Grades 1st - 2nd",value:23},{label:"3rd - 4th",shortLabel:"3rd - 4th",fullLabel:"Grades 3rd - 4th",value:24},{label:"5th - 6th",shortLabel:"5th - 6th",fullLabel:"Grades 5th - 6th",value:25},{label:"7th - 8th",shortLabel:"7th - 8th",
fullLabel:"Grades 7th - 8th",value:26},{label:"9th - 10th",shortLabel:"9th - 10th",fullLabel:"Grades 9th - 10th",value:27},{label:"11th - 12th",shortLabel:"11th - 12th",fullLabel:"Grades 11th - 12th",value:28}],"home.middle.feed.news":[{name:"cbbc",count:5},{name:"btn",count:5}],"home.middle.nara.count":16,"home.primary.sources.path":"/resources/files/home/shared/int-primary-sources.json"},"es-ES":{"home.middle.feed.news":[{name:"mi",count:12,url:"http://www.muyinteresante.com.mx/rss.xml",order:1},
{name:"bbcl",count:12,url:"http://www.bbc.co.uk/mundo/temas/america_latina/index.xml",order:2}],"home.high.feed.news":[{name:"bbcl",count:12,url:"http://www.bbc.co.uk/mundo/temas/america_latina/index.xml",order:2}],"home.middle.nara.count":32,"home.high.nara.count":32,"help.images.search_results":"/resources/img/help/es/search_results{us}{levelRestriction}.png","help.images.level_indicators":"/resources/img/help/es/level_indicators{levelRestriction}.png","help.images.related_elem":"/resources/img/help/related_Elem.png",
"help.images.related_mid_high":"/resources/img/help/related_Mid_High.png","help.images.favorites":"/resources/img/help/es/favorites.png","help.images.print":"/resources/img/help/es/print.png","help.images.email":"/resources/img/help/es/email.png","help.images.font_size":"/resources/img/help/es/font_size.png","help.images.cite":"/resources/img/help/es/cite.png","help.images.translate":"/resources/img/help/translate.png","help.images.listen":"/resources/img/help/listen.png","help.images.dictionary":"/resources/img/help/es/dictionary.png",
"help.images.dictionary.moderna.1":"/resources/img/help/es/dictionary-moderna-1.png","help.images.dictionary.moderna.2":"/resources/img/help/es/dictionary-moderna-2.png","help.images.teacher_tab_ms":"/resources/img/help/teacher_tab_MS.png","user.content.features.intro.favorite.popup.1":"/resources/img/features-intro/es/favorite-popup-1.png","user.content.features.intro.favorite.popup.2":"/resources/img/features-intro/es/favorite-popup-2.png","user.content.features.intro.favorite.popup.3":"/resources/img/features-intro/es/favorite-popup-3.png",
"filedlogin.video.poster":"/resources/img/failedlogin/es/escolar-video-screenshot.png"},"pt-BR":{"home.elementary.feed.news":[{name:"folha",count:5,url:"http://feeds.folha.uol.com.br/folhinha/rss091.xml",order:1}]}};a.en=a["en-US"];return a}();EB=window.EB||{};
EB.i18n=function(a,e,f){function d(a){return h=a?a:h}function c(a){return g=a?a:g}function k(){var b=a("html").attr("lang")||"";d(b||"en-US");c(b.split("-")[0]||"en")}var g,h;k();return{string:function(a,c){if(!a)return"";var d=void 0!=e[h]&&void 0!=e[h][a]?e[h][a]:void 0!=e[g]&&void 0!=e[g][a]?e[g][a]:void 0!=e["en-US"]&&void 0!=e["en-US"][a]?e["en-US"][a]:"";return c?c.length?String.prototype.assign.apply(d,c):d.assign(c):d},resource:function(a,c){if(!a)return"";var d=void 0!=f[h]&&void 0!=f[h][a]?
f[h][a]:void 0!=f[g]&&void 0!=f[g][a]?f[g][a]:void 0!=f["en-US"]&&void 0!=f["en-US"][a]?f["en-US"][a]:null;return c&&"string"==typeof d?c.length?String.prototype.assign.apply(d,c):d.assign(c):d},locale:d,defaultLocale:c,setLocaleToHtmlLang:k}}(jQuery,EB.Strings,EB.Resources);EB=window.EB||{};
EB.Template=function(a){return a({constructor:function(a,f,d){this.template=this.template?this.template:d;this.templateClass=this.templateClass?this.templateClass:a?a:this.template+"-template";this.afterRender=this.afterRender?this.afterRender:f}})}(Class);EB=window.EB||{};
EB.Nav=function(a,e,f){var d=e({constructor:function(a,c,d,b,e,f){this.id=a;this.name=c;this.nav=d;this.itemClass=b;this.iconClass=e;this.onClick=f},click:function(){this.nav.activeItemId(this.id);if(Object.isFunction(this.onClick))this.onClick();return!1}}),c=e(a,{$statics:{template:"component/nav"},constructor:function(a,e,h,b,m){this.items=[];a.each(function(a){this.items.push(new d(a.id,a.name,this,a.itemClass,a.iconClass,a.onClick))}.bind(this));this.activeItemId=f.observable(e?e:this.items[0].id);
this.listClass=h;c.$super.call(this,b,m)}});return c}(EB.Template,Class,ko);EB=window.EB||{};
EB.NavView=function(a,e,f,d){var c=f(e,{constructor:function(a,e,b,f,k,p,q){this.id=a;this.name=e;this.nav=b;this.data=f;this.visible=d.computed(function(){if(this.id==this.nav.activeItemId()){if(Object.isFunction(f.onShow))f.onShow();return!0}if(Object.isFunction(f.onHide))f.onHide();return!1}.bind(this));c.$super.call(this,k,p,q)}}),k=f(e,{$statics:{template:"component/nav-view"},constructor:function(d,e,b,f,n,p,q,u){this.nav=new a(d,e,b,f,n);this.viewTemplateClass=p;this.views=[];d.each(function(a){this.views.push(new c(a.id,
a.name,this.nav,a.data,a.templateClass,a.afterRender,a.template))}.bind(this));k.$super.call(this,q,u)}});return k}(EB.Nav,EB.Template,Class,ko);EB=window.EB||{};
EB.Toolbar=function(a,e,f,d){var c=f({constructor:function(a){this.activeItem=ko.observable("");this.level=EB.shared.getLevelFromPath();this.eventLabel=a}}),k=f(e,{$statics:{itemName:"",iconClass:"",itemClass:"item"},constructor:function(a){this.itemState=a;this.open=this.open||function(){this.itemState.activeItem(this.itemName)};this.close=this.close||function(){this.itemState.activeItem("")};k.$super.call(this)},open:null,close:null}),g=f(k,{$statics:{itemName:"",template:"toolbar/favorite",templateClass:"toolbar-favorite-template"},
constructor:function(b,c){this.context=c;this.itemName=a.string("spell.favorite.capital");this.loggedIn=d("#logout-link").length;this.loginPrompt=a.string("institution.favorites.login.prompt");this.login=function(){"school"===d("body").data("site-type")?individual.showB2LoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox(),null,EB.shared.getLanguage()):"library"===d("body").data("site-type")&&individual.showLibraryLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox())};this.controlPanel=
ko.observable("");this.isFavorite=ko.observable(!1);this.iconClass=ko.computed(function(){return this.isFavorite()?"fontello-icon-star":"fontello-icon-star-empty"}.bind(this));this.assemblyId=ko.observable("");g.$super.call(this,b)},open:function(){this.loggedIn&&(this.refresh(!0),this.favoriteUrl="/levels/{1}/favorites/assembly/{2}".assign(this.itemState.level,this.assemblyId()),this.add());this.itemState.activeItem(this.itemName);this.context.afterStarClicked&&this.context.afterStarClicked()},add:function(){d.ajax({url:this.favoriteUrl,
type:"PUT",dataType:"html",success:function(a){EB.shared.writeInternalStats({url:this.favoriteUrl});this.controlPanel(a);this.isFavorite(!0);d(this.context.isFavorite.selector.assign(this.assemblyId()))[this.context.isFavorite.method](this.context.isFavorite.params,!0);setTimeout(function(){var a=d("#favorites-panel-label-select");this.labelUrl="/levels/{1}/favorites/assembly/{2}/label/".assign(this.itemState.level,a.data("content-id"));a.chosen().change(function(a,b){b&&b.deselected?this.removeLabel(b.deselected):
b&&b.selected&&(this.addLabel(b.selected),d(".favorites-panel-labels .review-packs").addClass("show"))}.bind(this));d("#remove-favorite-button").click(this.remove.bind(this));d("#add-favorite-label-button").click(this.addNewLabel.bind(this))}.bind(this),0)}.bind(this)})},remove:function(){d.ajax({url:this.favoriteUrl,type:"DELETE",success:function(){EB.shared.writeInternalStats({url:this.favoriteUrl});this.isFavorite(!1);d(this.context.isFavorite.selector.assign(this.assemblyId()))[this.context.isFavorite.method](this.context.isFavorite.params,
"");this.close()}.bind(this)})},addLabel:function(a){this.modifyLabel(a,!0)},removeLabel:function(a){this.modifyLabel(a,!1)},modifyLabel:function(a,b){var c=this.labelUrl+a;d.ajax(c,{type:b?"PUT":"DELETE",complete:function(){EB.shared.writeInternalStats({url:c})}})},refresh:function(a){if(this.itemState.activeItem()==this.itemName||!0===a)this.close(),this.controlPanel("");this.assemblyId(d(this.context.assemblyId.selector)[this.context.assemblyId.method](this.context.assemblyId.params));this.isFavorite(d(this.context.isFavorite.selector.assign(this.assemblyId()))[this.context.isFavorite.method](this.context.isFavorite.params))},
addNewLabel:function(){var a=d("#add-label-textarea").val().toLowerCase().compact();if(!/[A-Z0-9 ]+/i.test(a))smoke.alert("Label can only contain letters and digits");else if(a.length){var b=this.labelUrl+a;d.ajax({url:b,type:"POST",success:function(c){EB.shared.writeInternalStats({url:b});if(0<c){var e=d("#favorites-panel-label-select");e.prepend('<option value="'+c+'" selected="selected">'+a+"</option>");e.trigger("liszt:updated");d("#add-label-textarea").val("");d(".favorites-panel-labels .review-packs").addClass("show")}else 0==
c?smoke.alert("Such label already exists."):smoke.alert("Error occurred!")}})}}}),h=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-mail-alt",template:"toolbar/email",templateClass:"toolbar-email-template",method:"post"},constructor:function(b,c){this.itemState=b;this.context=c;this.itemName=a.string("header.tools.email");this.placeholderName=a.string("article.action.email.name");this.placeholderRecipient=a.string("article.action.email.address");this.emailToolEventName="Email - "+b.level;h.$super.call(this,
b)},afterRender:function(){d("."+r.templateClass).uniform();d("."+r.templateClass+" #recipients").placeholder();d("."+r.templateClass+" #senderName").placeholder();d("."+r.templateClass+" #senderEmail").placeholder()},open:function(){this.refresh(!0);this.itemState.activeItem(this.itemName)},submit:function(a){d(a).hasClass("failedSubmit")?EB.shared.trackEvent({eventName:this.emailToolEventName,eventType:"Incorrect completion of email article form",eventLabel:this.itemState.eventLabel}):(this.close(),
EB.shared.trackEvent({eventName:this.emailToolEventName,eventType:"Click on submit button in Email popover",eventLabel:this.itemState.eventLabel}),a=d(a).serialize(),d.ajax({url:this.action,type:this.method,data:a,dataType:"json",complete:function(a){EB.shared.writeInternalStats({url:this.action});var b;try{b=a.responseText?JSON.parse(a.responseText):null}catch(c){console.error(c.message)}d.jGrowl((b?b.message:"")||"Error sending Email.",{life:3E3,position:"bottom-right"})}.bind(this)}))},refresh:function(a){var b=
d(this.context.assemblyId.selector)[this.context.assemblyId.method](this.context.assemblyId.params);this.itemState.activeItem()!=this.itemName&&!0!==a||"media"!=this.context.type||(a=d(this.context.assemblyType.selector)[this.context.assemblyType.method](this.context.assemblyType.params),this.action=d(this.context.articleUrl.selector)[this.context.articleUrl.method](this.context.articleUrl.params)+"/assembly/"+b+"/email?assemblyType="+a);"undefined"===typeof b?d(".fontello-icon-mail-alt").hide():
d(".fontello-icon-mail-alt").show()}}),b=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-check",cookieName:"citationFormat",citationStyles:[{name:"MLA",value:"mla"},{name:"APA",value:"apa"},{name:"Harvard",value:"harvard"},{name:"Chicago Manual of Style",value:"chicago"}]},constructor:function(c,e){this.context=e;this.itemName=a.string("header.tools.cite");this.context&&"media"==this.context.type&&(this.template="toolbar/cite-media",this.templateClass="toolbar-cite-media-template",this.assemblyTitle=
ko.observable(""),this.assemblyLink=ko.observable(""),this.assemblyType=ko.observable(""));var g=d.cookie(b.cookieName),f;if(EB.shared.isEscola())f="abnt";else if(g){if(f=b.citationStyles.find(function(a){return a.value==g}))f=f.value}else f=b.citationStyles[0].value;this.citationStyle=ko.observable(f);this.citeEventName="Cite - "+c.level;Date.setLocale(EB.shared.getLanguage());f=Date.create().format(a.string("handlebar.cite.date.year.format"));var h=Date.create().format(a.string("handlebar.cite.date.month.format")),
k=Date.create().format(a.string("handlebar.cite.date.mon.format")),m=Date.create().format(a.string("handlebar.cite.date.day.format"));this.date={year:f,month:h,mon:k,day:m};k=EB.shared.getPublishDate();f=k.format(a.string("handlebar.cite.date.year.format"));h=k.format(a.string("handlebar.cite.date.mon.format"));k=k.format(a.string("handlebar.cite.date.day.format"));this.pubDate={year:f,mon:h,day:k};b.$super.call(this,c)},refresh:function(a){this.itemState.activeItem()!=this.itemName&&!0!==a||"media"!=
this.context.type||(this.assemblyTitle(d(this.context.assemblyTitle.selector)[this.context.assemblyTitle.method]()),this.assemblyLink(d(this.context.assemblyLink.image.selector)[this.context.assemblyLink.image.method](this.context.assemblyLink.image.params)||d(this.context.assemblyLink.video.selector)[this.context.assemblyLink.video.method](this.context.assemblyLink.video.params)),this.assemblyType(d(this.context.assemblyType.selector)[this.context.assemblyType.method](this.context.assemblyType.params)))},
open:function(){this.refresh(!0);EB.shared.trackEvent({eventName:this.citeEventName,eventType:"Open Cite popover",eventLabel:this.itemState.eventLabel});this.itemState.activeItem(this.itemName)},change:function(){EB.shared.trackEvent({eventName:this.citeEventName,eventType:"Citation style selected from Cite popover",eventLabel:this.itemState.eventLabel+" - Selected citation style - "+this.citationStyle()});d.cookie(b.cookieName,this.citationStyle(),{expires:3650,path:"/"})}}),m=f(k,{$statics:{itemName:"",
iconClass:"fontello-icon-print",cookieName:"citationFormat",citationStyles:[{name:"MLA",value:"mla"},{name:"APA",value:"apa"},{name:"Harvard",value:"harvard"},{name:"Chicago Manual of Style",value:"chicago"}]},constructor:function(b,c){this.context=c;this.itemState=b;this.itemName=a.string("header.tools.print");this.context&&"media"==this.context.type&&(this.template="toolbar/cite-media-print",this.templateClass="toolbar-cite-print-media-template",this.assemblyTitle=ko.observable(""),this.assemblyLink=
ko.observable(""),this.assemblyLinkWithoutProtocol=ko.observable(""),this.assemblyType=ko.observable(""));var e=d.cookie(m.cookieName),g;if(e){if(g=m.citationStyles.find(function(a){return a.value==e}))g=g.value}else g=EB.shared.isEscola()?"abnt":m.citationStyles[0].value;this.citationStyle=ko.observable(g);Date.setLocale(EB.shared.getLanguage());g=Date.create().format(a.string("handlebar.cite.date.year.format"));var f=Date.create().format(a.string("handlebar.cite.date.month.format")),h=Date.create().format(a.string("handlebar.cite.date.mon.format")),
k=Date.create().format(a.string("handlebar.cite.date.day.format"));this.date={year:g,month:f,mon:h,day:k};m.$super.call(this,b)},refresh:function(a){this.itemState.activeItem()!=this.itemName&&!0!==a||"media"!=this.context.type||(this.assemblyTitle(d(this.context.assemblyTitle.selector)[this.context.assemblyTitle.method]()),this.assemblyLink(d(this.context.assemblyLink.image.selector)[this.context.assemblyLink.image.method](this.context.assemblyLink.image.params)||d(this.context.assemblyLink.video.selector)[this.context.assemblyLink.video.method](this.context.assemblyLink.video.params)),
this.assemblyLinkWithoutProtocol(this.assemblyLink().replace(/.*?:\/\//g,"")),this.assemblyType(d(this.context.assemblyType.selector)[this.context.assemblyType.method](this.context.assemblyType.params)))},open:function(){this.itemState.activeItem(this.itemName);this.refresh(!0);setTimeout("window.print()",500)}}),n=f(k,{$statics:{percentages:[71.4285714,78.5714286,85.7142857,92.8571429,100,107.1428571,114.2857143,121.4285714,128.5714286],initialFontIndex:4,ancestorSelectors:".content, .gallery-media-metadata, .compare-content",
descendantSelectors:"p:visible, a, span, li, label, figcaption, h1, h2, h3, h4, h5, td"},constructor:function(b,c,d){this.itemName=b?a.string("header.tools.font-up"):a.string("header.tools.font-down");this.iconClass=b?"fontello-icon-plus":"fontello-icon-minus";this.increment=b?1:-1;this.context=d;c.fontSizeIndex=n.initialFontIndex;c.fontSizeIndexMin="elementary"==c.level?n.initialFontIndex-2:0;c.fontSizeIndexMax="elementary"==c.level?n.initialFontIndex+2:n.percentages.length-1;n.$super.call(this,
c)},resizeFont:function(a,b){var c=b.fontSizeIndex+a;c>=b.fontSizeIndexMin&&c<=b.fontSizeIndexMax&&(b.fontSizeIndex=c,d(this.context.containerId).find(".resizable-content").length?d(this.context.containerId).find(".resizable-content").css("font-size",this.percentages[b.fontSizeIndex]+"%"):d(this.ancestorSelectors).find(this.descendantSelectors).css("font-size",function(b,c){return parseInt(c,10)+a}))},open:function(){this.resizeFont(this.increment,this.itemState)}}),p=f(n,{constructor:function(a,
b){p.$super.call(this,!0,a,b)}}),q=f(n,{constructor:function(a,b){q.$super.call(this,!1,a,b)}}),u={Favorite:g,Print:m,Email:h,Cite:b,FontUp:p,FontDown:q},x={},v;for(v in u)u.hasOwnProperty(v)&&(x[v]=v);var r=f(e,{$statics:{itemNames:x,template:"toolbar/toolbar",templateClass:"toolbar"},constructor:function(a,b,d,e){this.itemState=new c(b);this.items=[];this.hide=ko.observable(!1);this.showOnCondition=e;this.refresh();d&&d.each(function(a){var b=this.refresh.bind(this);a.delegateElement.on(a.event,
a.elementSelector||"",b)}.bind(this));a.each(function(a){var b;u[a.name]&&(b=new u[a.name](this.itemState,a.context),this.items.push(b));d&&d.each(function(a){if(b.refresh){var c=b.refresh.bind(b);a.delegateElement.on(a.event,a.elementSelector||"",c)}}.bind(this))}.bind(this));r.$super.call(this)},refresh:function(){this.hide(!d(this.showOnCondition).length)}});return r}(EB.i18n,EB.Template,Class,jQuery);EB=window.EB||{};
EB.MediaGalleryToolbar=function(a,e,f,d){var c=f({constructor:function(a,b,c){this.activeItem=ko.observable("");this.activeItem.subscribe(function(a){a&&a.compact()&&EB.shared.trackGaEvent(["Media Overlay","Open Tool",a])}.bind(this));this.activeItem.subscribe(function(a){a&&a.compact()&&EB.shared.trackGaEvent(["Media Overlay","Close Tool",a])},null,"beforeChange");this.level=EB.shared.getLevelFromPath();this.eventLabel=a;this.data=b;this.showTranscriptFunction=c}}),k=f(e,{$statics:{itemName:"",iconClass:"",
itemClass:"item"},constructor:function(a){this.itemState=a;this.open=this.open||function(){this.itemState.activeItem(this.itemName)};this.close=this.close||function(){this.itemState.activeItem("")};this.href=this.href;k.$super.call(this)},open:null,close:null,href:null}),g=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-download",template:"",templateClass:"",itemClass:"item download"},constructor:function(b){this.itemName=a.string("handlebar.media.download.text");this.href=ko.observable(b.data().downloadPath);
g.$super.call(this,b)},open:function(){this.itemState.activeItem(this.itemName);return!0}}),h=f(k,{$statics:{itemName:"",template:"toolbar/favorite",templateClass:"toolbar-favorite-template",itemClass:"item favorite"},constructor:function(b){this.itemName=a.string("spell.favorite.capital");this.loggedIn=d("#logout-link").length;this.loginPrompt=a.string("institution.favorites.login.prompt");this.login=function(){"school"===d("body").data("site-type")?individual.showB2LoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox(),
null,EB.shared.getLanguage()):"library"===d("body").data("site-type")?individual.showLibraryLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox()):"academic"===d("body").data("site-type")&&individual.showAcademicLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox())};this.controlPanel=ko.observable("");this.isFavorite=ko.observable(b.data().isFavorite);this.iconClass=ko.computed(function(){return this.isFavorite()?"fontello-icon-star":"fontello-icon-star-empty"}.bind(this));this.assemblyId=
ko.observable(b.data().assemblyId);h.$super.call(this,b)},open:function(){this.loggedIn&&(this.refresh(!0),this.favoriteUrl="/levels/{1}/favorites/assembly/{2}".assign(this.itemState.level,this.assemblyId()),this.add());this.itemState.activeItem(this.itemName)},add:function(){d.ajax({url:this.favoriteUrl,type:"PUT",dataType:"html",success:function(a){EB.shared.writeInternalStats({url:this.favoriteUrl});this.controlPanel(a);this.isFavorite(!0);this.itemState.data().isFavorite=!0;setTimeout(function(){var a=
d("#favorites-panel-label-select");this.labelUrl="/levels/{1}/favorites/assembly/{2}/label/".assign(this.itemState.level,a.data("content-id"));a.chosen().change(function(a,b){b&&b.deselected?this.removeLabel(b.deselected):b&&b.selected&&(this.addLabel(b.selected),d(".favorites-panel-labels .review-packs").addClass("show"))}.bind(this));d("#remove-favorite-button").click(this.remove.bind(this));d("#add-favorite-label-button").click(this.addNewLabel.bind(this))}.bind(this),50)}.bind(this)})},remove:function(){d.ajax({url:this.favoriteUrl,
type:"DELETE",success:function(){EB.shared.writeInternalStats({url:this.favoriteUrl});this.isFavorite(!1);this.itemState.data().isFavorite=!1;this.close()}.bind(this)})},addLabel:function(a){this.modifyLabel(a,!0)},removeLabel:function(a){this.modifyLabel(a,!1)},modifyLabel:function(a,b){var c=this.labelUrl+a;d.ajax(c,{type:b?"PUT":"DELETE",complete:function(){EB.shared.writeInternalStats({url:c})}})},refresh:function(a){if(this.itemState.activeItem()==this.itemName||!0===a)this.close(),this.controlPanel("");
this.assemblyId(this.itemState.data().assemblyId);this.isFavorite(this.itemState.data().isFavorite)},addNewLabel:function(){var b=d("#add-label-textarea").val().toLowerCase().compact();d(".toolbar-favorite-template .favorite-error-msg").addClass("hidden");if(b.length){var c=this.labelUrl+b;d.ajax({url:c,type:"POST",success:function(e){EB.shared.writeInternalStats({url:c});if(0<e){var g=d("#favorites-panel-label-select");g.prepend('<option value="'+e+'" selected="selected">'+b+"</option>");g.trigger("liszt:updated");
d("#add-label-textarea").val("");d(".favorites-panel-labels .review-packs").addClass("show")}else 0==e?d(".toolbar-favorite-template .favorite-error-msg").removeClass("hidden").find(".favorite-error-msg-text").text(a.string("mycontent.label-already-exists")):d(".toolbar-favorite-template .favorite-error-msg").removeClass("hidden").find(".favorite-error-msg-text").text("Error occurred!")}})}}}),b=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-mail",template:"toolbar/email",templateClass:"toolbar-email-template",
method:"post",itemClass:"item email"},constructor:function(c){this.itemState=c;this.itemName=a.string("header.tools.email");this.placeholderName=a.string("article.action.email.name");this.placeholderRecipient=a.string("article.action.email.address");this.emailToolEventName="Email - "+c.level;b.$super.call(this,c)},afterRender:function(){d("."+x.templateClass).uniform();d("."+x.templateClass+" #recipients").placeholder();d("."+x.templateClass+" #senderName").placeholder();d("."+x.templateClass+" #senderEmail").placeholder()},
open:function(){this.refresh(!0);this.itemState.activeItem(this.itemName)},submit:function(a){d(a).hasClass("failedSubmit")?EB.shared.trackEvent({eventName:this.emailToolEventName,eventType:"Incorrect completion of email article form",eventLabel:this.itemState.eventLabel}):(this.close(),EB.shared.trackEvent({eventName:this.emailToolEventName,eventType:"Click on submit button in Email popover",eventLabel:this.itemState.eventLabel}),a=d(a).serialize(),d.ajax({url:this.action,type:this.method,data:a,
dataType:"json",complete:function(a){EB.shared.writeInternalStats({url:this.action});var b;try{b=a.responseText?JSON.parse(a.responseText):null}catch(c){console.error(c.message)}d.jGrowl((b?b.message:"")||"Error sending Email.",{life:3E3,position:"bottom-right"})}.bind(this)}))},refresh:function(a){var b=this.itemState.data().assemblyId;if(this.itemState.activeItem()==this.itemName||!0===a)if(a=this.itemState.data().mediaType,EB.shared.getLevelFromPath()){var c=this.itemState.data().firstArticleUrl;
this.action=c?c+"/assembly/"+b+"/email?assemblyType="+a:"/levels/"+EB.shared.getLevelFromPath()+"/assembly/view/"+b+"/email"}else this.action="/resourcepacks/"+window.location.pathname.split("/").remove("").last()+"/assembly/"+b+"/email?assemblyType="+a;"undefined"===typeof b?d(".fontello-icon-mail").hide():d(".fontello-icon-mail").show()}}),m=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-check",cookieName:"citationFormat",citationStyles:[{name:"MLA",value:"mla"},{name:"APA",value:"apa"},{name:"Harvard",
value:"harvard"},{name:"Chicago Manual of Style",value:"chicago"},{name:"ABNT",value:"abnt"}]},constructor:function(b){this.itemName=a.string("header.tools.cite");this.template="toolbar/cite-media";this.templateClass="toolbar-cite-media-template";var c=b.data().title,c=c&&c[0].toUpperCase()+c.slice(1);"es"!=EB.shared.getLanguage()&&(c=c&&c[0].toUpperCase()+c.slice(1));this.assemblyTitle=ko.observable(c);this.assemblyLink=ko.observable(b.data().assemblyViewUrl);this.assemblyLinkWithoutProtocol=ko.observable(b.data().assemblyViewUrl.replace(/.*?:\/\//g,
""));c=(c=b.data().mediaType.toLowerCase())&&c[0].toUpperCase()+c.slice(1);EB.shared.isEscola()&&("Image"==c?c="1 fot., color.":"Video"==c&&(c="Vdeo"));this.assemblyType=ko.observable(c);var e=d.cookie(m.cookieName);if(EB.shared.isEscola())c="abnt";else if(e){if(c=m.citationStyles.find(function(a){return a.value==e}))c=c.value}else c=m.citationStyles[0].value;this.citationStyle=ko.observable(c);this.citeEventName="Cite - "+b.level;Date.setLocale(EB.shared.getLanguage());var c=Date.create().format(a.string("handlebar.cite.date.year.format")),
g=Date.create().format(a.string("handlebar.cite.date.month.format")),f=Date.create().format(a.string("handlebar.cite.date.mon.format")),h=Date.create().format(a.string("handlebar.cite.date.day.format"));this.date={year:c,month:g,mon:f,day:h};f=EB.shared.getPublishDate();c=f.format(a.string("handlebar.cite.date.year.format"));g=f.format(a.string("handlebar.cite.date.mon.format"));f=f.format(a.string("handlebar.cite.date.day.format"));this.pubDate={year:c,mon:g,day:f};m.$super.call(this,b)},refresh:function(a){if(this.itemState.activeItem()==
this.itemName||!0===a)a=(a=this.itemState.data().title)&&a[0].toUpperCase()+a.slice(1),this.assemblyTitle(a),"es"==EB.shared.getLanguage()&&this.assemblyTitle(this.itemState.data().title),this.assemblyLink(this.itemState.data().assemblyViewUrl),this.assemblyLinkWithoutProtocol(this.itemState.data().assemblyViewUrl.replace(/.*?:\/\//g,"")),a=(a=this.itemState.data().mediaType.toLowerCase())&&a[0].toUpperCase()+a.slice(1),EB.shared.isEscola()&&("Image"==a?a="1 fot., color.":"Video"==a&&(a="Vdeo")),
this.assemblyType(a)},open:function(){this.refresh(!0);EB.shared.trackEvent({eventName:this.citeEventName,eventType:"Open Cite popover",eventLabel:this.itemState.eventLabel});this.itemState.activeItem(this.itemName)},change:function(){EB.shared.trackEvent({eventName:this.citeEventName,eventType:"Citation style selected from Cite popover",eventLabel:this.itemState.eventLabel+" - Selected citation style - "+this.citationStyle()});d.cookie(m.cookieName,this.citationStyle(),{expires:3650,path:"/"})}}),
n=f(k,{$statics:{itemName:"",iconClass:"fontello-icon-print",cookieName:"citationFormat",citationStyles:[{name:"MLA",value:"mla"},{name:"APA",value:"apa"},{name:"Harvard",value:"harvard"},{name:"Chicago Manual of Style",value:"chicago"}]},constructor:function(b){this.itemState=b;this.itemName=a.string("header.tools.print");this.template="toolbar/cite-media-print";this.templateClass="toolbar-cite-print-media-template";var c=b.data().title,c=c&&c[0].toUpperCase()+c.slice(1);this.assemblyTitle=ko.observable(c);
"es"==EB.shared.getLanguage()&&(this.assemblyTitle=ko.observable(b.data().title));this.assemblyLink=ko.observable(b.data().assemblyViewUrl);this.assemblyLinkWithoutProtocol=ko.observable(b.data().assemblyViewUrl.replace(/.*?:\/\//g,""));c=(c=b.data().mediaType.toLowerCase())&&c[0].toUpperCase()+c.slice(1);this.assemblyType=ko.observable(c);var e=d.cookie(n.cookieName);if(EB.shared.isEscola())c="abnt";else if(e){if(c=n.citationStyles.find(function(a){return a.value==e}))c=c.value}else c=n.citationStyles[0].value;
this.citationStyle=ko.observable(c);Date.setLocale(EB.shared.getLanguage());var c=Date.create().format(a.string("handlebar.cite.date.year.format")),g=Date.create().format(a.string("handlebar.cite.date.month.format")),f=Date.create().format(a.string("handlebar.cite.date.mon.format")),h=Date.create().format(a.string("handlebar.cite.date.day.format"));this.date={year:c,month:g,mon:f,day:h};f=EB.shared.getPublishDate();c=f.format(a.string("handlebar.cite.date.year.format"));g=f.format(a.string("handlebar.cite.date.mon.format"));
f=f.format(a.string("handlebar.cite.date.day.format"));this.pubDate={year:c,mon:g,day:f};n.$super.call(this,b)},refresh:function(a){if(this.itemState.activeItem()==this.itemName||!0===a){a=(a=this.itemState.data().title)&&a[0].toUpperCase()+a.slice(1);this.assemblyTitle(a);"es"==EB.shared.getLanguage()&&this.assemblyTitle(this.itemState.data().title);this.assemblyLink(this.itemState.data().assemblyViewUrl);this.assemblyLinkWithoutProtocol(this.itemState.data().assemblyViewUrl.replace(/.*?:\/\//g,
""));a=(a=this.itemState.data().mediaType.toLowerCase())&&a[0].toUpperCase()+a.slice(1);this.assemblyType(a);var b=d.cookie(n.cookieName);if(EB.shared.isEscola())a="abnt";else if(b){if(a=n.citationStyles.find(function(a){return a.value==b}))a=a.value}else a=n.citationStyles[0].value;this.citationStyle=ko.observable(a)}},open:function(){this.itemState.activeItem(this.itemName);this.refresh(!0);setTimeout("window.print()",500)}}),p={Favorite:h,Print:n,Email:b,Cite:m,VideoDownload:g},q={},u;for(u in p)p.hasOwnProperty(u)&&
(q[u]=u);var x=f(e,{$statics:{itemNames:q,template:"media-gallery/toolbar",templateClass:"mg-toolbar"},constructor:function(a,b,d,e){this.itemState=new c(e,b,d);this.items=[];this.hide=ko.observable(!1);a.each(function(a){var b;p[a]&&(b=new p[a](this.itemState),this.items.push(b));b.refresh&&b.refresh()}.bind(this));x.$super.call(this)}});return x}(EB.i18n,EB.Template,Class,jQuery);EB=window.EB||{};
EB.MediaGallery=function(a){function e(b){p(!1);"INTERACTIVE"==b.mediaType&&function(){(b.height>a(".mg-media-container").height()||b.width>a(".mg-media-container").width())&&p(!0)}.delay(100)}function f(){n()+1<m().length?n(n()+1):n(0)}function d(){0<n()?n(n()-1):n(m().length-1)}function c(a){if(null!==n())switch(a=a||window.event,a.which||a.keyCode){case 37:d();EB.shared.trackGaEvent(["Media Overlay","Go To Previous Item - Using Keyboard"]);break;case 39:f();EB.shared.trackGaEvent(["Media Overlay",
"Go To Next Item - Using Keyboard"]);break;case 27:n(null),EB.shared.trackGaEvent(["Media Overlay","Close Overlay - Using Keyboard"])}}function k(b){var c=b.attr("href")||"",d=b.data("full-path"),e=b.data("large-path"),g=b.data("assembly-id"),f=b.data("media-type")||"IMAGE";"Animated GIF"==(b.data("media-type-name")||"")&&(f="IMAGE");var k=b.find("img");"IMAGE"==f&&(d=e||d||c.endsWith(/(\.jpg|\.png|\.gif)/i)&&c||k.attr("src")||k.data("original"));var c=b.data("thumb")||k&&k.attr("src")||k&&k.data("original")||
d,m=d&&d.split("/"),m=m&&6==m.length?h?"/download/video?path=/"+m[4]+"/"+m[5]:"/resourcepacks/download/video?path=/"+m[4]+"/"+m[5]:"",n=b.data("height"),p=b.data("width");return{title:b.attr("title")||k&&k.attr("title"),caption:b.data("caption")||k&&k.attr("alt"),assemblyId:g,credit:b.data("credit"),licenseId:b.data("license-id"),licenseTitle:b.data("license-title"),thumb:c,fullPath:d,downloadPath:m,largePath:e,mediaType:f,autoplay:b.data("autoplay"),height:n,width:p,level:b.data("level"),transcript:b.data("transcript"),
duration:b.data("duration"),relatedArticleHtml:a("#media-metadata-"+b.data("assembly-id")+" > .media-metadata").html(),firstArticleUrl:a("#media-metadata-"+g+" > .media-metadata").find("li a:first-child").attr("href")||(b.data("article-id")?"/levels/"+h+"/article/"+b.data("article-url-title")+"/"+b.data("article-id"):null),assemblyViewUrl:document.location.protocol+"//"+document.location.hostname+"/levels/"+h+"/assembly/view/"+g,isFavorite:b.data("is-favorite")}}function g(c){m([]);b=a(c);b.each(function(c,
d){var e=a(d);e.hasClass("text-link")||m.push(k(e));e.click(function(){var d=-1;b.each(function(b,e){c>=b&&(a(e).hasClass("text-link")||d++)});n(d);return!1})})}var h,b,m=ko.observableArray([]),n=ko.observable(null),p=ko.observable(!1),q="Media Overlay",u=!0,x=ko.observable(!0);x.subscribe(function(a){EB.shared.trackGaEvent(["Media Overlay",(a?"Open":"Close")+" Tool","Transcript"])});var v=ko.observable(null),r=["Favorite","Print","Email","Cite"],w=["Favorite","Email","Cite","VideoDownload"],y={ONE:"elementary",
TWO:"middle",THREE:"high"},t={items:m,currentIndex:n,tooBigToShow:p,template:"media-gallery/media-gallery",next:f,prev:d,getAssemblyUrl:function(a,b){var c=y[b];return(h?"":window.location.protocol+"//"+document.domain.replace("packs.","school."))+"/levels/"+(c||h)+"/assembly/view/"+a},showTranscript:x,toolbar:v},D,B=!1;n.subscribe(function(b){if(b=m()&&m()[b]){if(B||(B=!0,a("body").addClass("no-scroll")),e(b),u&&v(new EB.MediaGalleryToolbar("VIDEO"==b.mediaType?w:r,ko.observable(b),x,q)),EB.shared.trackGaEvent(["Media Overlay",
"Display Item",[b.assemblyId,b.mediaType,b.title,b.fullPath].join(" - ")]),b=b.fullPath){var c={eventType:"media"};""!==EB.shared.getIndividualId()&&(c.individualId=EB.shared.getIndividualId());writeStat(null,{accountId:EBStat.accountId,hostnameOverride:EBStat.host,domain:EBStat.domain,requestUrl:b+"/"+EB.shared.getLevelFromPath(),hitCount:2,json:JSON.stringify(c)})}}else B=!1,a("body").removeClass("no-scroll")});var E=function(){null!==n()&&m()[n()]&&e(m()[n()])}.throttle(300);return{init:function(b,
d,e){h=EB.shared.getLevelFromPath();q=d;u=!e;D||(D=document.createElement("div"),D.innerHTML='<div data-bind="template: { name: $data.template, data: $data }" id="media-gallery" class="media-gallery"></div>',document.body.appendChild(D));g(b);ko.applyBindings(t,D);a(document).unbind("keydown",c);a(document).keydown(c);a(window).unbind("resize",E);a(window).resize(E)},goToIndex:function(a){a<m().length&&0<=a&&n(a)}}}(jQuery);EB=window.EB||{};
EB.Dom=function(){var a=null,e=null,f=null,d=-1<window.navigator.userAgent.indexOf("Windows NT 10.0"),c={clickLink:function(a,c){setTimeout(function(){var c=document.createElement("a");c.href=a;document.body.appendChild(c);c.click()},0<c?c:0)},selectAllText:function(a){var c;if(document.body.createTextRange)c=document.body.createTextRange(),c.moveToElementText(a),c.select();else if(window.getSelection){var d=window.getSelection();c=document.createRange();c.selectNodeContents(a);d.removeAllRanges();
d.addRange(c)}},handleSwipe:function(a,d){if(c.isTouchDevice){var e,b,f,n,p,q,u,x=d||function(a){};a.addEventListener("touchstart",function(a){var b=a.changedTouches[0];e="none";n=b.pageX;p=b.pageY;u=(new Date).getTime();a.preventDefault()},!1);a.addEventListener("touchmove",function(a){a.preventDefault()},!1);a.addEventListener("touchend",function(a){var c=a.changedTouches[0];b=c.pageX-n;f=c.pageY-p;q=(new Date).getTime()-u;500>=q&&(101<=Math.abs(b)&&100>=Math.abs(f)?e=0>b?"left":"right":101<=Math.abs(f)&&
100>=Math.abs(b)&&(e=0>f?"up":"down"));x(e);a.preventDefault()},!1)}},isTouchDevice:"ontouchstart"in document.documentElement&&!d,isWin10:d,viewPort:{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)},isIE:function(){null===a&&(a=-1<navigator.userAgent.indexOf("MSIE"));return a},isIE8AndBelow:function(){null===e&&(e=document.all&&!document.addEventListener);return e},isIE9AndBelow:function(){null===
f&&(f=document.all&&!window.atob);return f},getAnimationEndEvent:function(){var a,c=document.createElement("fakeelement"),d={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(a in d)if(void 0!==c.style[a])return d[a]},toggleClass:function(a,c){var d=new RegExp("(?:^|\\s)"+a+"(?!\\S)");c.className.match(d)?c.className=c.className.replace(d,""):c.className+=" "+a},addClass:function(a,c){c.className.match(new RegExp("(?:^|\\s)"+
a+"(?!\\S)"))||(c.className+=" "+a)},removeClass:function(a,c){c.className=c.className.replace(new RegExp("(?:^|\\s)"+a+"(?!\\S)"),"")},hasClass:function(a,c){return!!c.className.match(new RegExp("(?:^|\\s)"+a+"(?!\\S)"))},offset:function(a){a=a.getBoundingClientRect();return{top:a.top+document.body.scrollTop,left:a.left+document.body.scrollLeft}}};c.inputValueUpdate=c.isIE9AndBelow()?"afterkeydown":"input";return c}();EB=window.EB||{};
EB.CSSUtil=function(a){function e(b,c){return a.CSS&&a.CSS.supports?a.CSS.supports(b,c):a.supportsCSS?a.supportsCSS(b,c):!1}function f(a){return a.replace(g,function(a,b){return(b+"").toUpperCase()})}function d(a,b,d){var e=b in c.style;if("inherit"===d)return e;c.style.cssText=a+":"+d;return e&&""!==c.style[b]}var c=a.document.createElement("div"),k=["Webkit","Moz","O","ms"],g=/-([a-z]|[0-9])/ig,h,b,m,n,p,q;return{isStyleSupported:function(a,c,g){c=c||"inherit";if(b=e(a,c))return!0;m=f(a);n=m.charAt(0).toUpperCase()+
m.slice(1);b=d(a,m,c);for(h=k.length;!b&&h--;)p="-"+k[h].toLowerCase()+"-"+c,q="-"+k[h].toLowerCase()+"-"+a,b=g?e(a,p):e(q,c),b||(m=k[h]+n,b=d(q,m,c));return b}}}(window);EB=window.EB||{};
EB.Sticky=function(a,e){function f(){return!$("body").hasClass("elementary")&&979<$(window).width()&&$(".cobrand-top").outerHeight(!0)}function d(){var a=$(g);k=!1;$("body").removeClass("pinned");a.css("margin-top","");a=$("#pinned-outer");a.length&&a.children()&&a.children().unwrap()}function c(){d();p&&(p.off("scroll",u),$(window).off("resize",d))}var k=!1,g,h,b,m,n,p,q,u=function(){if(!(q&&Object.isFunction(q)&&q())){var a=$(g),c=Object.isFunction(b)?b():b;if(h.scrollTop()>c){if(!k){$("#pinned-outer").length||
(a.wrap('<div id="pinned-outer"></div>'),c=$("#pinned-outer"),$(c).height(a.height()),m&&Object.isFunction(m)&&m(a));k=!0;a.css("margin-top","");$("body").addClass("pinned");if(f()){var c=parseFloat(a.css("margin-top")),d=$(".cobrand-top").outerHeight(!0);a.css("margin-top",c+d)}n&&Object.isFunction(n)&&n(a)}}else k=!1,$("body").removeClass("pinned"),f()&&a.css("margin-top","")}}.throttle(20);return{init:function(f,k,r,w,y,t,D){D&&e.isStyleSupported("position","sticky",!0)?(f=document.querySelector(f),
k=979<window.innerWidth?document.querySelector(".navbar.navbar-fixed-top").offsetHeight:0,f.style.top=k+"px",f&&a.addClass("sticky",f)):(c(),g=f,h=y?$(y):$(document),p=y?$(y):$(window),b=k,m=r,n=w,q=t,p.on("scroll",u),$(window).on("resize",d))},clear:d,destroy:c,setOffset:function(a){b=a}}}(EB.Dom,EB.CSSUtil);EB=window.EB||{};
EB.Overlay=function(a,e,f){function d(){var a=document.createElement("div");a.className="modal-backdrop fade in overlay-backdrop";document.body.appendChild(a)}var c,k,g={label:f.string("mycontent.remove-collection.are-you-sure.ok"),onClick:function(){},css:""},h={title:"",content:"",close:function(b,c){a(c.target).parents("[role=overlay]").addClass("hide");var d=document.querySelector(".overlay-backdrop");d&&d.parentNode.removeChild(d);k.afterClose&&Object.isFunction(k.afterClose)&&k.afterClose()},
show:function(){a("div[data-overlay]").find("[role=overlay]").removeClass("hide")},afterClose:function(){}};return function(a,f,n,p,q){c||(c=document.createElement("div"),c.innerHTML='<div data-bind="template: { name: \'widget/overlay\', data: $data, afterRender: $data.show }" data-overlay="true"></div>',document.body.appendChild(c));q&&d();k={title:a,content:f,afterClose:n,buttons:p};k=Object.merge(k,h,!0,!1);k.buttons=k.buttons?k.buttons.map(function(a){return Object.merge(a,g,!0,!1)}):[g];e.applyBindings(k,
c)}}(jQuery,ko,EB.i18n);EB=window.EB||{};
EB.Cite=function(a,e,f){var d=e({$statics:{itemName:"",iconClass:"fontello-icon-check",cookieName:"citationFormat",citationStyles:[{name:"MLA",value:"mla"},{name:"APA",value:"apa"},{name:"Harvard",value:"harvard"},{name:"Chicago Manual of Style",value:"chicago"}]},constructor:function(c){this.itemState=c;this.itemName=a.string("header.tools.cite");this.template="toolbar/cite-media";this.templateClass="toolbar-cite-media-template";var e=c.title,e=e&&e[0].toUpperCase()+e.slice(1);this.assemblyTitle=
ko.observable(e);"es"==EB.shared.getLanguage()&&(this.assemblyTitle=ko.observable(c.title));this.assemblyLink=ko.observable(c.fullPath);this.assemblyLinkWithoutProtocol=ko.observable(c.fullPath.replace(/.*?:\/\//g,""));e=(e=c.mediaType.toLowerCase())&&e[0].toUpperCase()+e.slice(1);this.assemblyType=ko.observable(e);var g=f.cookie(d.cookieName);if(EB.shared.isEscola())e="abnt";else if(g){if(e=d.citationStyles.find(function(a){return a.value==g}))e=e.value}else e=d.citationStyles[0].value;this.citationStyle=
ko.observable(e);this.citeEventName="Cite - "+c.level;Date.setLocale(EB.shared.getLanguage());var h=EB.shared.getPublishDate();c=h.format(a.string("handlebar.cite.date.year.format"));e=h.format(a.string("handlebar.cite.date.mon.format"));h=h.format(a.string("handlebar.cite.date.day.format"));this.pubDate={year:c,mon:e,day:h};c=Date.create().format(a.string("handlebar.cite.date.year.format"));var e=Date.create().format(a.string("handlebar.cite.date.month.format")),h=Date.create().format(a.string("handlebar.cite.date.mon.format")),
b=Date.create().format(a.string("handlebar.cite.date.day.format"));this.date={year:c,month:e,mon:h,day:b}},change:function(){EB.shared.trackEvent({eventName:this.citeEventName,eventType:"Citation style selected from Cite popover",eventLabel:this.itemState.eventLabel+" - Selected citation style - "+this.citationStyle()});f.cookie(d.cookieName,this.citationStyle(),{expires:3650,path:"/"})}});return d}(EB.i18n,Class,jQuery);EB=window.EB||{};
EB.Alert=function(a){function e(){a.addClass("hide",f.querySelector(".alert-popover"))}var f,d=!1;return function(c,k,g,h,b){d||(window.addEventListener("click",e),d=!0);h=h||"";g=g||300;var m,n,p,q;c='<div style="width:'+g+'px" data-alert="true" class="alert-popover '+h+" "+(b||"")+'">'+('<div class="alert-popover-content">'+c+"</div></div>");f||(f=document.createElement("div"),document.body.appendChild(f));f.innerHTML=c;if(q=f.querySelector(".alert-popover")){var u=q.offsetHeight;k&&k.tagName?(c=
a.offset(k).top,b=a.offset(k).left,p=k.offsetHeight,k=k.offsetWidth,"bottom"==h?(m=c-u-18,n=b+(k-g)/2):"top"==h?(m=c+p+18,n=b+(k-g)/2):"left"==h?(m=c+(p-u),n=b+(k+18)):"right"==h&&(m=c+(p-u),n=b-(g+18))):k&&(m=k.top,n=k.left);q.style.top=m?m+"px":"";q.style.left=n?n+"px":""}}}(EB.Dom);
(function(a){"function"===typeof define&&define.amd?define(["Knockout","jQuery","i18n"],a):a(window.ko,jQuery,EB.i18n)})(function(a,e,f){a.bindingHandlers.jCarousel={init:function(c,d){var g=a.utils.unwrapObservable(d()),f=e(c),b=f.parent(),m=g.options||{},n=g.delay||200,p=EB.Dom.viewPort.width,q=g.step?g.step:979<p?"3":"2",u=0,x=g.onScroll||function(){};g&&function(){f.on("jcarousel:scroll",function(a,b,c){"string"==typeof c&&(a=c.substring(0,1),c=parseInt(c.substring(2),10),b=e("ul",f).children("li").length,
u="-"==a?u-c:u+c,u=0>u?0:u>=b?b-1:u,x(u))});f.on("jcarousel:reload jcarousel:create",function(){var a=f.innerWidth();600<=a?a/=3:350<=a&&(a/=2);f.jcarousel("items").css("width",a+"px")}).jcarousel(m);g.autoScroll&&g.autoScroll.interval&&(f.jcarouselAutoscroll({interval:g.autoScroll.interval}),f.hover(function(){e(this).jcarouselAutoscroll("stop")},function(){e(this).jcarouselAutoscroll("start")}));g.nav&&(e(".jcarousel-control-prev",b).on("jcarouselcontrol:inactive",function(){e(this).addClass("inactive")}).on("jcarouselcontrol:active",
function(){e(this).removeClass("inactive")}).jcarouselControl({carousel:f,target:"-="+q}),e(".jcarousel-control-next",b).on("jcarouselcontrol:inactive",function(){e(this).addClass("inactive")}).on("jcarouselcontrol:active",function(){e(this).removeClass("inactive")}).jcarouselControl({carousel:f,target:"+="+q}));if(g.handleSwipe){var a=function(a){"left"==a?f.jcarousel("scroll","+=1"):"right"==a&&f.jcarousel("scroll","-=1")};(function(){e(c).find(".swipeable").each(function(){EB.Dom.handleSwipe(this,
a)})}).delay(500)}}.delay(n)}};a.bindingHandlers.jCarousel.update=a.bindingHandlers.jCarousel.init;a.bindingHandlers.jCarouselPagination={init:function(c,d){var g=a.utils.unwrapObservable(d()),f=e(c);if(g){g.perPage=g.perPage||1;g.showTitle&&g.pageCount&&(g.item=function(a,b){var c=e(b).attr("title");return'<a href="#'+a+'" style="width: '+100/g.pageCount+'%">'+c+"</a>"});var b=g.delay||400,m=function(){f.on("jcarouselpagination:active","a",function(){e(this).addClass("active")}).on("jcarouselpagination:inactive",
"a",function(){e(this).removeClass("active")}).on("click",function(a){a.preventDefault()}).jcarouselPagination(g)}.debounce(100);(function(){m()}).delay(b)}}};a.bindingHandlers.jCarouselPagination.update=a.bindingHandlers.jCarouselPagination.init;a.bindingHandlers.string={init:function(c,d,g){d=a.utils.unwrapObservable(d());g=g();var h=f.string(d,g.tokens);(d=g.filters||null)&&d.split(",").each(function(a){(a=a.trim())&&Object.isFunction(h[a])&&(h=h[a]())});if(g.truncate){d=g.truncate.charLimit;var b=
g.truncate.from||"right",m=g.truncate.ellipsis||"...",h=g.truncate.onWord?h.truncateOnWord(d,b,m):h.truncate(d,b,m)}e(c).html(h)}};a.bindingHandlers.string.update=a.bindingHandlers.string.init;a.bindingHandlers.localizableImage={init:function(c,d,g){d=a.utils.unwrapObservable(d());g=g();g=f.resource(d,g.tokens);e(c).attr("src",g)}};a.bindingHandlers.localizableImage.update=a.bindingHandlers.localizableImage.init;a.bindingHandlers.draggable={init:function(c,d){var g=a.utils.unwrapObservable(d());g?
e(c).draggable(g):e(c).draggable("destroy")}};a.bindingHandlers.draggable.update=a.bindingHandlers.draggable.init;a.bindingHandlers.sortable={init:function(c,d){var g=a.utils.unwrapObservable(d());g?e(c).sortable(g):e(c).sortable("destroy")}};a.bindingHandlers.sortable.update=a.bindingHandlers.sortable.init;a.bindingHandlers.verticalAlign={init:function(c,d){var g=a.utils.unwrapObservable(d());g&&g.parentHeight&&imagesLoaded(c,function(){e(c).css("top",.2*-(e(c).outerHeight()-g.parentHeight)).css("position",
"absolute")})}};a.bindingHandlers.verticalAlign.update=a.bindingHandlers.verticalAlign.init;var d=0;a.bindingHandlers.scroll={init:function(c,f){var g=a.utils.unwrapObservable(f());if(g&&Array.isArray(g)){var h=g[0],b=g[1],m=e(c);m.scroll(function(a){a=m.scrollTop();a>d?b&&b():h&&h();d=a})}}};a.bindingHandlers.audioElement={init:function(c,d){var g=a.utils.unwrapObservable(d()),f=e(c),b=f.find("audio"),m=f.find("iframe"),f=f.find(".control"),n=g.src,p=g.isMW||!1,q=g.level||"middle";if(n){var u=function(){EB.shared.trackEvent({eventName:"Playback buzzword - "+
q,eventType:"Play buzzword audio"})};if(EB.shared.isIE8())f.click(function(){u();var a=EB.shared.getMWWavFilename(n);m.attr("src","/levels/"+q+"/audio/specialCase?src="+encodeURIComponent(a));return!1});else{if(n){g=n.endsWith(".wav")?n:p&&n.endsWith(".mp3")?EB.shared.getMWWavFilename(n):null;p=n.endsWith(".mp3")?n:p&&n.endsWith(".wav")?EB.shared.getMWMP3Filename(n):null;if(g){var x=document.createElement("source");x.type="audio/wav";x.src=g;b.get(0).appendChild(x)}p&&(g=document.createElement("source"),
g.type="audio/mpeg",g.src=p,b.get(0).appendChild(g))}var v=new MediaElementPlayer(b);f.click(function(){u();v.play();return!1})}}}};a.bindingHandlers.mediaElement={init:function(c,d){var g=a.utils.unwrapObservable(d());(function(){e(c).mediaelementplayer(g)}).delay(200)}};a.bindingHandlers.mediaElement.update=a.bindingHandlers.mediaElement.init;a.bindingHandlers.moreLess={init:function(c,d){var g=a.utils.unwrapObservable(d()),f=e(c);(function(){var a=g.list?e(g.list,f):e("ul",f),c=g.more?e(g.more,
f):e("a.show-more",f),d=g.less?e(g.less,f):e("a.show-less",f),k=a.children("li").length,q=g.count?g.count:10;d.hide();q>=k?c.hide():(e("li:gt( "+(q-1)+" )",a).hide(),c.show(),a.addClass("collapsed").removeClass("expanded"));d.click(function(){e("li:gt( "+(q-1)+" )",a).hide();c.show();d.hide();a.addClass("collapsed").removeClass("expanded");return!1});c.click(function(){e("li",a).show();c.hide();d.show();a.removeClass("collapsed").addClass("expanded");return!1})}).delay(200)}};a.bindingHandlers.expandable=
{init:function(c,d){var f=a.utils.unwrapObservable(d()),h=e(c);(function(){var a=h.parent(),c=f.more?e(f.more,a):e("a.show-more",a),d=f.less?e(f.less,a):e("a.show-less",a),k=h.height(),q=f.height||200;d.hide();q>=k?c.hide():(c.show(),h.height(q),h.addClass("collapsed").removeClass("expanded"));d.click(function(){h.height(q);c.show();d.hide();h.addClass("collapsed").removeClass("expanded");return!1});c.click(function(){h.height(k);c.hide();d.show();h.removeClass("collapsed").addClass("expanded");return!1})}).delay(200)}};
a.bindingHandlers.slideVisible={init:function(c,d){var f=a.utils.unwrapObservable(d());e(c).toggle(f)},update:function(c,d,f){var h=a.utils.unwrapObservable(d()),b=f().duration||350;e(c).slideUp(b);(function(){h?e(c).slideDown(b):e(c).slideUp(b)}).delay(100)}};a.bindingHandlers.scrollable={init:function(c,d){function f(){return b(!0)}function h(){return b(!1)}function b(a){p.animate({scrollTop:(a?"-=":"+=")+x},{duration:v,specialEasing:{width:"linear",height:"easeInOutQuad"}});return!1}function m(){var a=
p.outerHeight(),b=p[0].scrollHeight,c=p.scrollTop();c>=b-a-1?(u.addClass("disabled"),h.cancel()):u.removeClass("disabled");c?q.removeClass("disabled"):(q.addClass("disabled"),f.cancel())}var n=a.utils.unwrapObservable(d()),p=e(c),q,u,x,v;n&&(n.parentContainer&&(p.scroll(m),n.up&&(q=e(n.parentContainer).find(n.up).on("touchstart mousedown",function(){f();f.every(v);return!1}).on("touchend mouseup",function(){f.cancel();return!1}).click(function(){return!1})),n.down&&(u=e(n.parentContainer).find(n.down).on("touchstart mousedown",
function(){h();h.every(v);return!1}).on("touchend mouseup",function(){h.cancel();return!1}).click(function(){return!1}))),x=n.scrollStep||200,v=n.scrollDuration||1500,n=function(){m()}.debounce(50),p.bind("DOMSubtreeModified",n))}};a.bindingHandlers.scrollTop={init:function(c,d){a.utils.unwrapObservable(d())&&(c.scrollTop=0)}};a.bindingHandlers.scrollTop.update=a.bindingHandlers.scrollTop.init;a.bindingHandlers.handlebarsMedia={init:function(c,d){var f=a.utils.unwrapObservable(d()),h=e(c);if(f){var b=
f.fullPath,m=b.substr(b.lastIndexOf(".")+1);switch(m){case "mp3":h.html(Handlebars.templates["media/audio-with-icon"]({src:b,type:m,autoplay:/webkit/.test(navigator.userAgent.toLowerCase())?"":' autoplay="true"'})).find("audio").mediaelementplayer();break;case "mp4":h.html(Handlebars.templates["media/video"]({src:b+"?t="+(new Date).getTime(),type:m,width:f.width,height:f.height,poster:f.thumb})).find("video").mediaelementplayer();break;case "mov":h.html(Handlebars.templates["media/embed"]({src:b,
width:f.width,height:f.height+20,quicktime:!0}));break;case "wmv":h.html(Handlebars.templates["media/video"]({src:b,type:m,width:f.width,height:f.height,poster:f.thumb,autoplay:EB.shared.isIE8()?"":' autoplay="true"'})).find("video").mediaelementplayer();break;case "flv":h.html(Handlebars.templates["media/flash"]({src:b,width:f.width,height:f.height+20}));break;case "swf":h.html(Handlebars.templates["media/embed"]({src:b,width:600<f.width?600:f.width,height:f.height,type:"application/x-shockwave-flash"}));
break;case "dcr":h.html(Handlebars.templates["media/embed"]({src:b,width:f.width,height:f.height,type:"application/x-director"}));break;case "html":h.html(Handlebars.templates["media/iframe"]({src:b,width:f.width,height:f.height,backlink:encodeURIComponent("http://"+document.location.hostname+"/levels/{0}/article/".format(EB.shared.getLevelFromPath()))}))}}}};a.bindingHandlers.handlebarsMedia.update=a.bindingHandlers.handlebarsMedia.init;a.bindingHandlers.galleryVisibleItem={init:function(c,d,f){c=
a.utils.unwrapObservable(d());f=f();var h=e(f.galleryVisibleItemOptions.selector),b=f.galleryVisibleItemOptions.index;c&&setTimeout(function(){h.jcarousel("scroll",b)},100)}};a.bindingHandlers.galleryVisibleItem.update=a.bindingHandlers.galleryVisibleItem.init;a.bindingHandlers.justifiedGallery={init:function(c,d){var f=a.utils.unwrapObservable(d());f&&(e(c).justifiedGallery(f),f.callback&&function(){f.callback()}.delay(200));(function(){e(".justified-gallery li > a > .thumb-container > img").css("position",
"absolute");e(c).css("opacity",1)}).delay(100)}.debounce(100)};a.bindingHandlers.justifiedGallery.update=a.bindingHandlers.justifiedGallery.init;a.bindingHandlers.slider={init:function(c,d,f){var h=a.utils.unwrapObservable(d());f=f();var b=function(a,b){d()(b.value)},m={min:f.sliderOptions.min,max:f.sliderOptions.max,range:f.sliderOptions.range};f.sliderOptions.continuous?m.slide=b:m.change=b;!0===f.sliderOptions.range?m.values=h:m.value=h;f.sliderOptions.step&&(m.step=f.sliderOptions.step);e(c).slider(m)},
update:function(c,d,f){d=a.utils.unwrapObservable(d());!0===f().sliderOptions.range?e(c).slider("values",d):e(c).slider("value",d)}};a.bindingHandlers.autoHeightTextarea={init:function(c,d){function e(){c.style.height=b.initialHeight||"0";c.style.height=c.scrollHeight+"px"}function f(){setTimeout(e,0)}var b=a.utils.unwrapObservable(d());c.addEventListener("change",f,!1);c.addEventListener("cut",f,!1);c.addEventListener("paste",f,!1);c.addEventListener("drop",f,!1);c.addEventListener("keydown",f,!1);
e()}}});EB=window.EB||{};
EB.academicHomepage=function(a,e,f){function d(){e("a.adv-search-link").click(function(){e("#advanced-search-box").show()});e("#advanced-search-box button.close-popup-button").click(function(){e("#advanced-search-box").hide()});e("#advanced-search-btn").click(function(){var a=e("#advanced-search-all"),b=e("#advanced-search-exact"),c=e("#advanced-search-any"),d=e("#advanced-search-without"),f=e("#advanced-search-near"),g=[];0<a.val().trim().length&&g.push(a.val().split(" ").join(" and "));0<b.val().trim().length&&
g.push('"{0}"'.format(b.val().trim()));0<c.val().trim().length&&g.push(c.val().split(" ").join(" or "));0<d.val().trim().length&&g.push("not "+d.val().split(" ").join(" not "));0<f.val().trim().length&&g.push(f.val().trim());0<g.length&&(a=g.join(" and "),a=encodeURIComponent(a),window.location="/levels/{0}/search/articles?query={1}".format(EB.shared.getLevelFromPath(),a))})}function c(){e("#biographies-form").submit(function(a){a.preventDefault();window.location=e(this).attr("action")+"#"+e(this).serialize().replace("genders=MALE",
"genders1=checked").replace("genders=FEMALE","genders2=checked")})}function k(){e.getJSON("/resources/files/home/shared/britannica-contributors/britannica-contributors.json").then(function(a){q.contributors(a)})}function g(){1==e("#other-products-menu ul li").length?(e("#other-products-menu").show(),e("#other-products-singlelink-header").css("display","block"),e("#other-products-menu ul").addClass("singlelink")):1<e("#other-products-menu ul li").length&&(e("#other-products-menu").show(),e("#other-products-menu-header").css("display",
"block"),e("#other-products-menu-header").click(function(){2<e("#other-products-menu ul li").length&&e("#other-products-menu ul").css("right",e(window).width()-e("#other-products-menu").offset().left-e("#other-products-menu").outerWidth());e("#other-products-menu ul").toggle();return!1}),e("#other-products-menu ul").addClass("multiplelink"))}function h(){var a=f.resource("academic.home.primary.sources.path"),b={},c=[];e.getJSON(a).then(function(a){a&&a.links&&Object.isArray(a.links)&&a.links.each(function(a){a=
{text:a.text,url:a.id&&a.path?"/levels/{level}/additionalcontent/primarysources?id={id}&path={path}".assign({id:a.id,path:a.path,level:q.level}):""};c.push(a)});b.links=c;b.keywords=a.keywords;q.primarySources(b)})}function b(){e.getJSON("/levels/{level}/new-and-revised-articles/ajax?count={count}".assign({level:q.level,count:f.resource("home."+q.internalLevel+".nara.count")})).done(function(a){var b=[];a.groupBy(function(a){return Date.create(a.lastUpdate).format("{Month} {d}, {yyyy}:")},function(a,
c){b.push({date:a,articles:c})});q.nara(b.first(2))})}function m(){var a;a=p()?e._Deferred().resolve():e.getJSON("/levels/{level}/components/ajax?overrideDate={overrideDate}".assign({level:q.level,overrideDate:n()}));a.then(function(a){if(Object.isArray(a)){a=a.each(function(a){a.heroSpace=a.assetList.find(function(a){return"HEROSPACE_ONLINE"==a.assetSize});a.heroSpaceThumb=a.assetList.find(function(a){return"HEROSPACE_THUMB"==a.assetSize});a.fullSize=a.assetList.find(function(a){return"FULLSIZE"==
a.assetSize});a.firstFrame=a.assetList.find(function(a){return"FIRSTFRAME"==a.assetSize});a.formattedDate=Date.create(a.date).format("{Month} {d}")});p(a.groupBy(function(a){return a.componentType}));var b=[];Object.keys(p(),function(a,c){Object.isArray(c)&&c.length&&b.push(c[0].featureId)})}})}var n=a.observable(""),p=a.observable(),q={level:null,internalLevel:null,primarySources:a.observableArray(),nara:a.observableArray(),components:p,contributors:a.observableArray(),isLoggedIn:!1},u=function(a){var b=
e("#news-container");if(b.length){var c=b.data("feeds"),b=b.data("count");e("#news-container-content").load("/levels/"+a+"/feed/"+c+"/"+b+"?fromPage=homepage")}};return{init:function(f){q.level=EB.shared.getLevelFromPath();q.internalLevel=f;q.country=EB.shared.getCountry();q.isLoggedIn=EB.shared.isLoggedIn();var p=Object.fromQueryString(window.location.href);n(p&&p.overrideDate?p.overrideDate:"");e("#searchCriteria").submit(function(){e(".searchbox-selector input").each(function(){if(e(this).prop("checked")){var a=
e("#searchCriteria").attr("action").replace(/\/(\w+)$/,"/"+e(this).val());e("#searchCriteria").attr("action",a)}})});d();c();m();h();b();k();g();u(f);a.applyBindings(q)}}}(ko,jQuery,EB.i18n);EB=window.EB||{};EB.accountSelector=function(a){return{init:function(){a("#account-selector select").change(function(){document.location="/account-selector?ei="+a(this).val()})}}}(jQuery);EB=window.EB||{};
EB.admin=function(a){function e(){var e=this;e.term=ko.observable("");e.submit=function(){4>e.term().length?alert("Term cannot be less than 4 characters in length."):a.post("/admin/banPopularTerm",{term:e.term()},function(a){a&&1==a?alert("Term was wiped out. Wait for indexer to refresh (2-4 hours)."):alert("Term does not exist in DB.")})}}return{init:function(){var a=new e;ko.applyBindings(a)}}}(jQuery);EB=window.EB||{};
EB.animals=function(a,e){a("#browse-content").data("level");return{init:function(){e.applyBindings(new function(){});EB.Tools.init();a(".browse-animals-type").first().show();var f=a(".browse-animals-home-browse-categories > li");f.length&&f.height(f.first().width());a(".lt-ie9 .browse-category").each(function(){var c=a(this),d=c.data("featuredImage");c.css({"background-image":"none",filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+d+'", sizingMethod="scale")',"-ms-filter":'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+
d+'", sizingMethod="scale")'})});a(".browse-animals-featured-media, .animalkingdom-home-dyk").each(function(){var c=a(this).find(".thumb");c.find("img").imagesLoaded(function(){c.height(a(this).height())})});a("a.video-title").click(function(){a(this).parent().hasClass("browse-animals-featured-media")?EB.MediaGallery.goToIndex(0):EB.MediaGallery.goToIndex(1);return!1});EB.MediaGallery.init(".thumb a.video-gallery-link","Animal Kingdom Overlay",!1);var d=a(".browse-animals-type");a(".browse-animals-tabs li").click(function(){var c=
a(this);c.siblings().removeClass("active").end().addClass("active");d.hide().eq(c.index()).show()});(f=a(".browse-node-articles-content"))&&f.find("p").each(function(){var c=a(this),d=a.trim(c.text());""===d||d.match(/\.$/)||c.text(d+" ...")});f=a(".browse-node-articles-content.alpha, .browse-node-articles-content.habitat");f.length&&EB.Tools.updateScrollControlBindings(f.find("> .results"),".content","li");f=a(".browse-node");if(f.length){var f=f.find("a"),c=a(f.first().addClass("selected").attr("href")).show();
EB.Tools.updateScrollControlBindings(c,".content","li");f.click(function(){var c=a(this);if(c.hasClass("selected"))return!1;var d=a(c.addClass("selected").siblings(".selected").removeClass("selected").attr("href")).hide();EB.Tools.disableScrollButtons(d.nextAll(".accordion-footing"),{buttonScrollUp:!0,buttonScrollDown:!0});c=a(c.attr("href")).show();EB.Tools.updateScrollControlBindings(c,".content","li");return!1})}}}}(jQuery,ko);EB=window.EB||{};
EB.articlePrint=function(a,e,f){return{init:function(){f.applyBindings(new function(){});EB.handlebars.init(Handlebars);var d=a("#article-citation");Date.setLocale(EB.shared.getLanguage());var c=Date.create().format(e.string("handlebar.cite.date.year.format")),k=Date.create().format(e.string("handlebar.cite.date.month.format")),g=Date.create().format(e.string("handlebar.cite.date.mon.format")),h=Date.create().format(e.string("handlebar.cite.date.day.format")),b=a.trim(a("h1.article-title").text()),
m,n=a("#print-content-data").data("publishTimestamp");m=0===n.length?EB.shared.getPublishDate():new Date(parseInt(n));var n=m.format(e.string("handlebar.cite.date.year.format")),p=m.format(e.string("handlebar.cite.date.mon.format"));m=m.format(e.string("handlebar.cite.date.day.format"));var q=document.location.toString().replace("/print",""),c={heading:e.string("header.tools.cite"),intro:e.string("handlebar.cite.intro"),mlaFormat:e.string("handlebar.cite.article.mla.print.format").assign({title:b,
year:c,day:h,mon:g,month:k,pubYear:n,pubDay:m,pubMon:p,siteTitle:EB.shared.getSiteName(),url:q,urlWithoutProtocol:q.replace(/.*?:\/\//g,"")}),apaFormat:e.string("handlebar.cite.article.apa.print.format").assign({title:b,year:c,day:h,mon:g,month:k,siteTitle:EB.shared.getSiteName(),url:q}),harvardFormat:e.string("handlebar.cite.article.harvard.print.format").assign({title:b,year:c,day:h,mon:g,month:k,siteTitle:EB.shared.getSiteName(),url:q}),chicagoFormat:e.string("handlebar.cite.article.chicago.print.format").assign({title:b,
year:c,day:h,mon:g,month:k,siteTitle:EB.shared.getSiteName(),url:q}),abntFormat:e.string("handlebar.cite.article.abnt.print.format").assign({title:b,year:c,day:h,month:k,siteTitle:EB.shared.getSiteName(),url:q})};d.html(Handlebars.templates["tools/citePrint"](c));EB.shared.isEscola()?(a("#article-citation .cite-text").hide(),a("#abnt-citation").show()):(d=EB.Tools.getCitationCookie(),void 0!==d&&null!==d?(a("#article-citation .cite-text").hide(),a("#"+d+"-citation").show()):(a("#article-citation .cite-text").hide(),
a("#mla-citation").show()));window.print()}}}(jQuery,EB.i18n,ko);EB=window.EB||{};
EB.article=function(a,e,f,d){var c=a("#article-content, #history-content, #magazine-content").data("level"),k=a("#article-content, #history-content, #magazine-content").data("articleId"),g=null,h=a("#toolbar-content"),b=function(b){var c=a("#temp-carousel .es-carousel ul li a").index(a('#temp-carousel .es-carousel ul li a[data-assembly-id="{0}"]'.format(b)));setTimeout(function(){c=-1==c?0:c;EB.MediaGallery.goToIndex(c)},500);(b=a('#temp-carousel es-carousel ul li a[data-assembly-id="{0}"]'.format(b)))&&
m("Featured Media - "+EB.shared.getLevelFromPath()+" - image","Select",b.data("caption"));return!1},m=function(a,b,c){EB.shared.trackEvent({eventName:a,eventType:b,eventLabel:c,trackedEvent:null})},n=function(){a.cookie("firstArticleLoaded")||(a("html").hasClass("realtouch")?a.jGrowl(e.string("institution.dictionary.tap.feature.description.text"),{sticky:!0}):a.jGrowl(e.string("institution.dictionary.feature.description.text"),{sticky:!0}),a.cookie("firstArticleLoaded","true",3650),window.setTimeout(function(){var b=
a(".jGrowl-close");0<b.length&&b.parent().trigger("jGrowl.close")},6E3))};return{init:function(){d.applyBindings({});a("article table").addClass("table table-bordered");var p=a("#toc"),q=a("li",p),u=a("ul",p);a(p).on("click","a",function(){var b=a(this);q.removeClass("selected").find("i").remove();b.parent().addClass("selected").find("ul").show().length?b.find("i").remove().end().prepend('<i class="fontello-icon-down-dir"></i>'):b.find("i").remove().end().prepend('<i class="fontello-icon-right-dir"></i>')});
var x=a("#toc-toggle");x.click(function(){x.children("#collapse").is(":visible")?(x.children("#expand").show(),x.children("#collapse").hide(),u.hide()):(x.children("#collapse").show(),x.children("#expand").hide(),u.show())});var v="";0<x.children("#expand").length&&(v='<a href="#" class="toc-expand">Expand All</a>');var r=a(".toc-invoker").popover({placement:"right",title:"Table of Contents "+v+'<i class="icon-remove-sign pull-right"></i>',content:p.clone().attr("id","").find("li").removeClass("selected").find("i").remove().end().end()}),
w=a("#article-profile li.more-stats"),y=a("#article-profile-toggle");y.click(function(){y.children("#collapse").is(":visible")?(y.children("#expand").show(),y.children("#collapse").hide(),w.hide()):(y.children("#collapse").show(),y.children("#expand").hide(),w.show())});a(".user-profile-link").click(function(){var b=a(this).data("profileId");a.getJSON("/levels/{level}/userprofile/{profileId}".inject({level:c,profileId:b}),function(a){a={level:c,profileId:b,biographyLabel:e.string("handlebar.userprofile.biography.text"),
publicationsLabel:e.string("handlebar.userprofile.publications.text"),profile:a};a=Handlebars.templates["shared/userProfile"](a);f(null,a,null,[],!0)});return!1});p=a("body");a("#shared-wrapper").click(function(){});p.on("click",function(a){0==r.parent().find(a.target).length&&r.popover("hide")});p.on("click",".popover-title .toc-expand",function(){var b=a(this),c=e.string("institution.toc.expand.label"),d=e.string("institution.toc.collapse.label");b.text(b.text()===c?d:c).parent().next().find("ul ul").toggle();
return!1});EB.shared.isEscola()||n();var t=function(a){a&&EB.shared.trackEvent({eventName:"Read aloud - "+c,eventType:a})};EB.Tools.init();if("elementary"!==c){var D="From A to Z - "+c,p=a("#previous-article, #next-article");p.hover(function(){EB.shared.trackEvent({eventName:D,eventType:"Hover over From A to Z component (open)"});a(this).next().slideDown().removeClass("hidden")});p.on("click","a",function(a){EB.shared.trackEvent({eventName:D,eventType:"Click on article title link in From A to Z component",
trackedEvent:a})});p=function(){if(h.hasClass("sticky-toolbar")){var b=a("article").offset().top-a(".navbar").height()-a(".levels-ctn").outerHeight();a(window).scrollTop()>b&&!h.hasClass("stuck")?(h.css("position","fixed"),h.css("right",a(window).outerWidth()-(a("#article-content").offset().left+a("#article-content").outerWidth())),h.addClass("stuck")):a(window).scrollTop()<=b&&h.hasClass("stuck")&&(h.css("position","absolute"),h.removeClass("stuck"),EB.Tools.setToolbarContentPosition())}};a("#tool-tts").click(function(){t("Click on Listen button");
h.html('<button id="toolbar-content-close"/><button id="tts-reverse"><i class="fontello-icon-fast-bw"/></button><button id="tts-play-pause"><i class="fontello-icon-play"/></button><button id="tts-fastforward"><i class="fontello-icon-fast-fw"/></button>');EB.Tools.setToolbarContentPosition();h.addClass("sticky-toolbar toolbar-content-tts");h.show();var b=a("article h1, article h2, article h3, article h4, article h5, article > p, article section > p, article ol li");EB.tts.load(b);EB.tts.play();a("#tts-reverse").click(function(){t("Click on TTS rewind button");
EB.tts.rewind();EB.tts.play()});a("#tts-play-pause").click(function(){a("#tts-play-pause i").hasClass("fontello-icon-play")?(t("Click on TTS play button"),EB.tts.play()):(t("Click on TTS stop button"),EB.tts.stop())});a("#tts-fastforward").click(function(){t("Click on TTS fast forward button");EB.tts.fastForward();EB.tts.play()});a("#toolbar-content-close").click(function(){t("Close TTS popover");EB.tts.stop();h.hide();h.removeClass("sticky-toolbar");h.removeClass("stuck");h.html("")})});if(a("body").find(".cobrand-top")){var v=
a(".cobrand-top").find("img").height(),B=parseInt(a(".toc-anchor").css("padding-top"));a(".toc-anchor").css("padding-top",B+v+"px").css("margin-top",-B-v+"px")}a(window).scroll(p);a(window).resize(p);EB.shared.fetchAssemblyMetadata("figure > a",function(){EB.MediaGallery.init("figure > a","Article Page Overlay")})}if("elementary"===c){p=a(".inline-media");p.length&&(a(".tts-nav").remove(),p.prependTo(".accordion-group .accordion-inner"));var E=function(b){var c=b.find("p img").first().clone(),d=a(".inline-media"),
e=b.find(".content-type-interactive").first().clone(),f=b.find(".audio-link").first().clone();c.length||(c=f);c.length||(c=a("div#temp-carousel img").first().clone());f=a("div#carousel ul li a img");f.length&&(c=f.first().clone());if(c.length&&(!a(".featured-media img").length||a(".featured-media img").data("assembly-id")!=c.data("assembly-id")||d.length&&b.find(".featured-media img").data("assembly-id")!=c.data("assembly-id"))){var f=c.data("caption"),h=c.data("generated-alt");void 0===f&&(f=h?"":
c.attr("alt"));var h=c.data("credit")||"",k=d.length?b.find(".featured-media"):a(".featured-media"),n=d.length?b.find(".featured-media-caption"):a(".featured-media-caption");c.removeClass("hidden").appendTo(k.empty());void 0!==c.data("video-height")&&a('<i class="fontello-icon-play"></i>').appendTo(k);void 0!==c.data("interactive-height")&&e.removeClass("hidden").appendTo(k);n.html("<p>"+f+'</p><i class="featured-media-credit">'+h+"</i>")}d.length&&!b.find("#temp-carousel").length&&(g=a("#carousel"),
a(".es-carousel-wrapper").show(),g.clone().find(".es-nav").remove().end().attr("id","temp-carousel").appendTo(b.find("#temp-carousel-wrapper")).elastislide({minItems:2,onClick:function(a){a=a.find("img");m("Carousel - "+EB.shared.getLevelFromPath()+" - image","Select",a.data("assembly-title"));return!1}}))};a("#media-gallery").length&&(a(".featured-media").on("click","img, i, .content-type-interactive",function(c){c=a(c.target);var d=c.data("assemblyId");void 0==d&&(d=c.prev().data("assemblyId"));
b(d);m("Featured Media - "+EB.shared.getLevelFromPath()+" - image","Select",c.attr("alt"));return!1}),a(".featured-media").on("click",".audio-container",function(c){if(c=a(c.target).closest(".audio-container")){var d=c.data("assemblyId");b(d);m("Featured Media - "+EB.shared.getLevelFromPath()+" - audio","Select",c.data("caption"))}return!1}),g=a("#carousel"),1<g.find("ul > li").length&&a(".es-carousel-wrapper").show(),g.find("ul > li > a").each(function(b,c){a(c).attr("data-article-id",k)}),g.clone().find(".es-nav").remove().end().attr("id",
"temp-carousel").appendTo(a("#temp-carousel-wrapper")).elastislide({minItems:2}),a("#temp-carousel").find("li").removeClass("selected"),E(a(".accordion-body")));a("a.profilelink").click(function(){a("#profile-gallery").modal("show");a("#profile-gallery .modal-body").height()>a(window).height()&&a("#profile-gallery .modal-body").height(a(window).height()-50);h.hide().html("");return!1});p=a(".accordion-inner");1===p.length&&p.height(2*p.height());EB.Tools.updateScrollControlBindings(p,".accordion-body",
"p, ul, table");p=a(".magazine-article");p.length&&EB.Tools.updateScrollControlBindings(p,".content","p, ul");a(".accordion-body").on({show:function(){var b=a(this);E(b);var c=b.prev();c.children(".accordion-toggle").addClass("open");c.children(".tts-nav, .accordion-heading-open-indicator").removeClass("hidden");m("Article Accordion","Open",null);(EB.shared.isEscolar()||EB.shared.isEscola())&&EB.MediaGallery.init("#"+b.attr("id")+" #temp-carousel .es-carousel ul li a","Article Page Overlay")},hide:function(){var b=
a(this).prev();b.children(".accordion-toggle").removeClass("open");b.children(".tts-nav, .accordion-heading-open-indicator").addClass("hidden");m("Article Accordion","Close",null);EB.tts.stop()}});a(".tts-reverse").on("click",function(){a(this).parent().next().children("a").data("playing")&&(t("Click on TTS rewind button"),EB.tts.rewind(),EB.tts.play())});a(".tts-toggle").on("click",function(){var b=a(this);b.data("loaded")||(EB.tts.load(b.parents(".accordion-group").find(".accordion-heading h2.accordion-toggle, .accordion-body .accordion-inner p, .accordion-body .accordion-inner h3")),
a(".tts-toggle").data("loaded",!1),b.data("loaded",!0));b.data("playing")?(t("Click on TTS stop button"),EB.tts.stop(),b.data("playing",!1),b.removeClass("fontello-icon-stop").addClass("fontello-icon-play")):(t("Click on TTS play button"),EB.tts.play(),a(".tts-toggle").data("playing",!1),b.data("playing",!0),b.removeClass("fontello-icon-play").addClass("fontello-icon-stop"))});a(".tts-forward").on("click",function(){a(this).parent().prev().children("a").data("playing")&&(t("Click on TTS fast forward button"),
EB.tts.fastForward(),EB.tts.play())});EB.MediaGallery.init("#temp-carousel .es-carousel ul li a","Article Page Overlay");p=EB.shared.getUrlParameter("assemblyId");null!=p&&b(p);0<a(location.hash).length&&(p=a("#intro").prev(),p.children(".accordion-toggle").removeClass("open"),p.children(".tts-nav, .accordion-heading-open-indicator").addClass("hidden"),a("#intro").removeClass("in"),p=a(location.hash).prev(),p.children(".accordion-toggle").addClass("open"),p.children(".tts-nav, .accordion-heading-open-indicator").removeClass("hidden"),
a(location.hash).addClass("in"))}}}}(jQuery,EB.i18n,EB.Overlay,ko);EB=window.EB||{};
EB.assembly=function(a){var e=a("#article-media-content").data("articleId"),f=function(b){a("#carousel li").bind("carousel:item:click",function(e){var f=c(a(e.target));k(b,f);g(b,f);h(f);EB.favorites.toggleFavoriteIcon(f.isFavorite);var p=a(".rg-image embed");if(0<p.length)a("#email-modal").on({shown:function(){p.hide()},hidden:function(){p.show()}});d(e);return!1})},d=function(b){if(b=a(b.target).find("a > img"))b={eventName:"Overlay - "+EB.shared.getLevelFromPath()+" - image",eventType:"Select",
eventLabel:b.data("assembly-title"),trackedEvent:null},EB.shared.trackEvent(b)},c=function(a){a=a.find("a");return{assemblyId:a.find("img").data("assemblyId"),assemblyType:a.data("mediaType"),assemblyTypeName:a.find("img").data("mediaTypeName"),isFavorite:a.find("img").data("isFavorite")}},k=function(b,c){var d="";if(1<arguments.length)var d="/assembly/{0}".format(c.assemblyId),e=void 0!=c.assemblyType?c.assemblyType:"IMAGE";d="/levels/{0}/article/email/{1}{2}/email".format(EB.shared.getLevelFromPath(),
b,d);1<arguments.length&&(d+="?assemblyType={0}".format(e));a("#emailCriteria").attr("action",d)},g=function(b,c){var d;a(".tool-cite").attr("citeType","article");d=a("body").hasClass("elementary")?"http://"+document.location.hostname+"/levels/{0}/article/{1}".format(EB.shared.getLevelFromPath(),b):"http://"+document.location.hostname+"/levels/{0}/article/{1}/media".format(EB.shared.getLevelFromPath(),b);1<arguments.length&&(d+="?assemblyId={0}".format(c.assemblyId),a(".tool-cite").attr("citeType",
c.assemblyTypeName));a(".tool-cite").attr("citeLink",d)},h=function(b){"VIDEO"==b.assemblyType?a("i.icon-print").parent().addClass("disabled"):a("i.icon-print").parent().removeClass("disabled")};return{init:function(){a(".related-media-container ul li > a[rel=media-group]").each(function(b,c){a(c).attr("data-article-id",e)});EB.Tools.init();EB.MediaGallery.init(".related-media-container ul li > a[rel=media-group]");f(e);var b=c(a("#carousel li.selected"));k(e,b);g(e,b);h(b);b=EB.shared.getUrlParameter("assemblyId");
if(null!==b){var b=parseInt(b,10),d=a(".related-media-container ul li > a[rel=media-group]").index(a('.related-media-container ul li > a[rel=media-group][data-assembly-id="{0}"]'.format(b)));setTimeout(function(){EB.MediaGallery.goToIndex(d)},500);return!1}},extractAssemblyData:c,bindCarouselItemClick:f,updateEmailFormAction:k,updateCiteLink:g,updatePrintLink:h}}(jQuery);EB=window.EB||{};EB.assemblyView=function(a){return{init:function(){EB.Tools.init()}}}(jQuery);EB=window.EB||{};
EB.atlas=function(a){var e=a("#places-list"),f=a(".place-li"),d=a("#place-search"),c=a("#place-content"),k=a("#location-details"),g=a("#place-summary"),h=a("#place-profile"),b=a("#place-related-articles"),m=a("#summary-icon"),n=a("#profile-icon"),p=a("#related-articles-icon"),q="fontello-icon-right-dir",u=!1,x=!e.data("show-place-on-load"),v=a("#menu-container").hasClass("standard-atlas-menu");v||(q="fontello-icon-up-dir");var r=[],w=function(a){return 2==a?"country":3==a?"administrative_area_level_1":
""},y=function(b){this.id=b.data("place-id");this.typeId=b.data("place-type-id");this.name=b.data("place-name");this.parent=D(b.data("place-parent-place-id"),b.data("place-type-id")-1);this.articleId=b.data("place-article-id");this.profileArticleId=b.data("place-profile-article-id");this.flagUrl=a("p",b).text();this.hasChildren=function(){var c=!1;f.each(function(d){if(a(this).data("place-parent-place-id")==b.data("place-id"))return c=!0,!1});return c}},t=function(a,b,c){if(""!=a){var d=B(a,"place-iso2-code",
b,c);null==d&&(d=B(a,"place-name",b,c));return d}return null},D=function(a,b){return B(a,"place-id",null,b)},B=function(b,c,d,e){var g=null;f.each(function(f){f=a(this);if(f.data(c)==b&&f.data("place-type-id")==e&&(null===d||d.id==f.data("place-parent-place-id")))return g=new y(f),!1});return g},E=function(a){var b=a.getNorthEast();a=a.getSouthWest();var c=new google.maps.LatLng(b.lat(),a.lng()),d=new google.maps.LatLng(a.lat(),b.lng()),e=new google.maps.MVCArray;e.push(b);e.push(d);e.push(a);e.push(c);
e.push(b);return google.maps.geometry.spherical.computeArea(e)},z=e.data("place-starting-zoom-level"),G=function(a,b,c,d){return null!==b&&(c=E(EB.atlas.map.getBounds()),a=E(a),a=c/a,b.hasChildren()&&0<c&&(.8>a||u)&&(d=C(b,d+1),null!=d))?d:b},C=function(b,c){var d=null;a.each(r,function(e,f){if(f.address_components&&f.types&&!u){var g="";a.each(f.types,function(a,b){b===w(c)&&(g=b)});g&&a.each(f.address_components,function(e,g){g.short_name&&a.each(g.types,function(a,e){if(e===w(c)){var h=t(g.short_name,
b,c);d=G(f.geometry.viewport,h,b,c)}})})}else f.address_components&&u&&a.each(f.address_components,function(e,g){g.short_name&&a.each(g.types,function(a,e){if(e===w(c)){var h=t(g.short_name,b,c);d=G(f.geometry.viewport,h,b,c)}})})});return d},I=function(b){null!==b&&(a("#location-breadcrumb li:eq(0)").before('<li data-place-id="'+b.id+'" class="current-parent"></li>'),a("#location-breadcrumb li:eq(0)").text(b.name+" > "),I(b.parent))},R=function(b){k.animate({opacity:0},"fast");EB.shared.isIE8()&&
c.addClass("hidden");var d=a("#current-place"),e=a("#menu-bar"),f=a("#expanded-menu");null===b||x?(b=a("#toggle-caret"),b.hasClass("fontello-icon-down-dir")&&swapClass(b,"fontello-icon-down-dir","fontello-icon-up-dir"),v?(e.slideUp("fast"),f.slideDown("fast"),f.addClass("bottom-rounded-corners"),f.removeClass("top-border")):(a("li.current-parent").remove(),d.addClass("hidden"),f.slideUp("fast"),e.addClass("bottom-rounded-corners")),x=!1):(a("li.current-parent").remove(),I(b.parent),null!==b?(d.removeClass("hidden").text(b.name),
P(b),v&&(l(b),L(b))):(d.addClass("hidden"),g.addClass("hidden")),v?(e.slideDown("fast"),e.removeClass("bottom-rounded-corners"),f.addClass("bottom-rounded-corners"),f.addClass("top-border")):(f.slideDown("fast"),e.removeClass("bottom-rounded-corners")))},P=function(b){var d=a("#summary-flag");g.animate({opacity:0},"fast");if(b.articleId){g.removeClass("hidden");var e=a("#summary-article"),f="/levels/{level}/browse/atlas/article/{articleId}/summary/{characterCount}".inject({level:EB.shared.getLevelFromPath(),
articleId:b.articleId,characterCount:250});e.load(f,function(){A(c,k,g)});a("#summary-article > p").css("float","right")}null==b.flagUrl||""==b.flagUrl?d.addClass("hidden"):(d.attr("src",b.flagUrl),d.attr("alt",b.name),d.removeClass("hidden"),d.css("padding","10px"))},l=function(b){h.animate({opacity:0},"fast");h.show();if(null!==b.profileArticleId&&""!==b.profileArticleId){h.removeClass("hidden");var d=a("#profile-article");b="/levels/{level}/browse/atlas/country/profile/{profileArticleId}".inject({level:EB.shared.getLevelFromPath(),
profileArticleId:b.profileArticleId});d.load(b,function(){A(c,k,h)})}else h.hide()},L=function(d){b.animate({opacity:0},"fast");if(null!==d.articleId){b.removeClass("hidden");var e=a("#atlas-related-articles");d="/levels/{level}/article/{articleId}/related/links".inject({level:EB.shared.getLevelFromPath(),articleId:d.articleId});e.load(d,function(){A(c,k,b)})}},A=function(a,b,c){EB.shared.isIE8()&&a.removeClass("hidden");b.animate({opacity:1},"fast");c.animate({opacity:1},"fast")},U=function(){(new google.maps.Geocoder).geocode({latLng:EB.atlas.map.getCenter()},
function(a,b){b===google.maps.GeocoderStatus.OK?(r=a,R(C(null,2))):b===google.maps.GeocoderStatus.ZERO_RESULTS&&H(EB.atlas.map.getCenter())?(r=[],O()):(r=[],R(null))})},H=function(a){return Q(a)||F(a)||J(a)},Q=function(a){return 33.42>a.lat()&&32.678<a.lat()&&35.93>a.lng()&&35.586<a.lng()},F=function(a){return 32.552>a.lat()&&31.2<a.lat()&&35.591>a.lng()&&34.8486<a.lng()},J=function(a){return 43.27>a.lat()&&41.85<a.lat()&&21.9>a.lng()&&20.01<a.lng()},O=function(){Q(EB.atlas.map.getCenter())||F(EB.atlas.map.getCenter())?
R(t("Israel",null,2)):J(EB.atlas.map.getCenter())&&R(t("Kosovo",null,2))};return{init:function(){EB.shared.placeholder("#place-search");var f=new google.maps.LatLng(e.data("place-starting-latitude"),e.data("place-starting-longitude"));EB.atlas.map=new google.maps.Map(document.getElementById("map"),{center:f,zoom:z,disableDoubleClickZoom:!0,mapTypeId:google.maps.MapTypeId.TERRAIN,panControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.DEFAULT,position:google.maps.ControlPosition.LEFT_CENTER},
mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DEFAULT,position:google.maps.ControlPosition.BOTTOM_LEFT}});var k=EB.atlas.map.getStreetView();google.maps.event.addListener(k,"visible_changed",function(){k.getVisible()?a("#menu-container").hide():a("#menu-container").show()});a("#menu-bar-toggle").click(function(b){b=a("#toggle-caret");var c=a("#menu-bar"),d=a("#expanded-menu");b.hasClass("fontello-icon-up-dir")?(b.removeClass("fontello-icon-up-dir"),b.addClass("fontello-icon-down-dir"),
d.slideUp("fast"),c.addClass("bottom-rounded-corners")):b.hasClass("fontello-icon-down-dir")&&(b.removeClass("fontello-icon-down-dir"),b.addClass("fontello-icon-up-dir"),d.slideDown("fast"),d.addClass("bottom-rounded-corners"),d.addClass("top-border"),c.removeClass("bottom-rounded-corners"))});google.maps.event.addListener(EB.atlas.map,"idle",function(){c.find(".dropdown").removeClass("open");c.find(".atlas-detail-icon").removeClass("fontello-icon-down-dir").addClass(q);u?u=!1:(d.val(""),U());l()});
google.maps.event.addListener(EB.atlas.map,"click",function(a){EB.atlas.map.setCenter(a.latLng);18>EB.atlas.map.getZoom()&&EB.atlas.map.setZoom(EB.atlas.map.getZoom()+1);l()});var l=function(){var a=["Atlas","Map Action"];window.ga&&window.ga&&window.ga.apply(null,["send","event"].union(a))},f=function(a,b){a.click(function(c){b.hasClass("fontello-icon-right-dir")||b.hasClass("fontello-icon-up-dir")?(b.removeClass(q),b.addClass("fontello-icon-down-dir")):(c=q,b.removeClass("fontello-icon-down-dir"),
b.addClass(c));a.parent().siblings().find("i.atlas-detail-icon").removeClass("fontello-icon-down-dir").addClass(q)})};f(a("#summary-toggle"),m);f(a("#profile-toggle"),n);f(a("#related-articles-toggle"),p);f=function(a,b,c){a.on("click",function(a){a=q;c.removeClass("fontello-icon-down-dir");c.addClass(a);b.removeClass("open")})};f(a("#summary-dropdown"),g,m);f(a("#profile-dropdown"),h,n);f(a("#related-articles-dropdown"),b,p);a("html").off("click.dropdown.data-api touchstart.dropdown.data-api");EB.atlas.infowindow=
new google.maps.InfoWindow({maxWidth:300});var t=new google.maps.places.Autocomplete(document.getElementById("place-search"),{types:["(regions)"]});t.bindTo("bounds",EB.atlas.map);(function(b){function c(e,f){if("keydown"==e){var g=f;f=function(c){var d=a(".pac-item-selected").length;13!=c.which||d||(d=a.Event("keydown",{keyCode:40,which:40}),g.apply(b,[d]));g.apply(b,[c])}}d.apply(b,[e,f])}var d=b.addEventListener?b.addEventListener:b.attachEvent;b.addEventListener=c;b.attachEvent=c})(document.getElementById("place-search"));
google.maps.event.addListener(t,"place_changed",function(){EB.atlas.infowindow.close();var a=t.getPlace();a.geometry&&(a.geometry.viewport?EB.atlas.map.fitBounds(a.geometry.viewport):(EB.atlas.map.setCenter(a.geometry.location),EB.atlas.map.setZoom(18)),a.address_components&&[a.address_components[0]&&a.address_components[0].short_name||"",a.address_components[1]&&a.address_components[1].short_name||"",a.address_components[2]&&a.address_components[2].short_name||""].join(" "),r=[a],u=!0,H(EB.atlas.map.getCenter())?
O():R(C(null,2)))});$preloadMessage=a("#tour-preload-message").html();""!=$preloadMessage&&smoke.alert($preloadMessage,{ok:"OK"})}}}(jQuery);EB=window.EB||{};
EB.biography=function(a){var e=null,f=null,d=function(c,b){var d={page:1},e=c.attr("id");b?(d[e]=b,a.bbq.pushState(d)):a.bbq.removeState(e)},c=function(c){a("#biography-filters select").each(function(){var b=c[this.id],d=a("#"+this.id);d.val(b||[]);d.trigger("liszt:updated")});a("#biography-filters :checkbox").each(function(){this.checked=c[this.id]?!0:!1})},k=function(c){var b=f.serialize();a.ajax({url:f[0].action,type:"POST",data:b+("&page="+(void 0==c?"1":c)),localCache:!0,beforeSend:function(){a("#filter-help-message").hide();
e.find(".browse-node-articles-content").css({display:"block",textAlign:"center",padding:"150px 0"}).html('<img src="/resources/img/thistle-spinner.gif">')},success:function(a){g(a)}})},g=function(c){var b=e.find(".browse-node-articles-content");b.css({display:"none",textAlign:"",padding:""}).empty();a(".message").hide();0!==a.trim(c).length?b.append(c).fadeIn(1E3):(c=a.bbq.getState(),delete c.page,a.isEmptyObject(c)?a("#filter-help-message").show():a("#filter-empty-message").show())};return{init:function(){EB.Tools.init();
e=a("#biography-articles");f=a("#biography-filters");var h=/\?page=(\d+)/;a("#biography-filters select").change(function(){var b=a(this);d(b,b.val())});a("#biography-filters input[type=checkbox]").change(function(){var b=a(this);d(b,b.attr("checked"))});e.find(".browse-node-articles-content").on({click:function(b){var c=a(b.target);"A"!==b.target.nodeName&&(c=c.parent());c.parent().is(".disabled, .active")||(b=h.exec(c.attr("href")),a.bbq.pushState({page:b?b[1]:1}));return!1}},"nav.pagination a, nav.pagination i");
a("a.reset").on({click:function(){EB.shared.clearForm(f);a.bbq.removeState();return!1}});a(window).bind("hashchange",function(){var b=a.bbq.getState();c(b);a.isEmptyObject(b)?g():k(b.page)});a(window).trigger("hashchange")}}}(jQuery);EB=window.EB||{};
EB.browseGames=function(a,e,f,d){function c(a){f.each(b,function(b,c){c.browseId==a?m.selectedParentNode(c):void 0!==c.browseChildren&&c.browseChildren.length&&f.each(c.browseChildren,function(b,d){d.browseId==a&&m.selectedParentNode(c)})})}function k(a,b){f.each(b,function(b,c){c.browseId==a?m.selectedNode(c):void 0!==c.browseChildren&&c.browseChildren.length&&k(a,c.browseChildren)})}function g(){f.getJSON(window.location.pathname+"/ajax",function(c){b=c.browseChildren;f.each(b,function(a,b){m.categories.push(b)});
router=(new a(n)).configure({strict:!1,notfound:h,recurse:"forward"});router.init();e.applyBindings(m)})}function h(){window.location.hash="/"}var b=null,m={tileColors:["tile-orange","tile-medium-blue","tile-green","tile-purple","tile-red"],categories:e.observableArray([]),entries:e.observableArray([]),selectedParentNode:e.observable(null),childNodes:e.observableArray([]),selectedNode:e.observable(null),selectedChildNode:e.observable(null)},n={"/:browseNodeId/:childNodeId":function(a,b){f.each(m.childNodes(),
function(a,c){c.browseId==b&&(m.selectedChildNode(c),f.each(c.gameChildren,function(a,b){m.entries.push(b)}))})},"/:browseNodeId":function(a){k(a,b);null==m.selectedNode()?h():(c(m.selectedNode().browseId),f.each(m.selectedParentNode().browseChildren,function(a,b){m.childNodes.push(b)}),f.each(m.selectedParentNode().gameChildren,function(a,b){m.entries.push(b)}),f(".banner .tools-ctn").show(),EB.Tools.resetFontIndex())},"/":function(){m.selectedNode(null);m.selectedParentNode(null);m.selectedChildNode(null);
m.childNodes([]);m.entries([]);f(".banner .tools-ctn").hide();EB.shared.writeAjaxStats()}};return{init:function(){EB.shared.initShared();EB.Tools.init();window.location.hash||h();var a=document.createElement("link");a.rel="stylesheet";a.href="/resources/css/krismarGames.css";document.head.appendChild(a);g()}}}(Router,ko,jQuery,EB.i18n);EB=window.EB||{};
EB.browseIndex=function(a,e,f){function d(){var a={};k.each(function(b){b.indices.each(function(c){a[c]=b.name})});var b={};Object.keys(h.parentNodes).each(function(c,d){b[c]=a[d]});h.letterTiles=h.internalLevel&&"high"==h.internalLevel?"":b}function c(){if(h.internalLevel&&"elementary"==h.internalLevel)window.location.hash="/";else{h.page(1);var a=Object.keys(h.parentNodes)[0];window.location.hash="/"+h.parentNodes[a][0].parentNode+"/"+h.parentNodes[a][0].start+"/1"}}var k=[{name:"tile-orange",indices:[0,
14,20]},{name:"tile-medium-blue",indices:[1,11,23]},{name:"tile-green",indices:[2,13,21]},{name:"tile-turquoise",indices:[3,15,18]},{name:"tile-red",indices:[4,9,25]},{name:"tile-dark-blue",indices:[5,16,22]},{name:"tile-yellow",indices:[6,17,19]},{name:"tile-magenta",indices:[7,10,26]},{name:"tile-purple",indices:[8,12,24]}],g=function(){EB.MediaGallery.init("a[rel=media-gallery-img]","Videoteca Overlay");f("a[rel=media-gallery-text]").click(function(){var a=f("a[rel=media-gallery-text]").index(f(this));
EB.MediaGallery.goToIndex(a);return!1})}.debounce(50),h={pageSize:10,page:e.observable(0),total:e.observable(0),entries:e.observableArray([]),selectedParentNode:e.observable(null),selectedNode:e.observable(null)};h.currentRange=e.computed(function(){var a=h.page()*h.pageSize,a=a>h.total()?h.total():a;return(h.page()-1)*h.pageSize+1+" - "+a});h.selectedNode.subscribe(function(a){if(a){var b=h.pageSize;h.internalLevel&&"elementary"==h.internalLevel&&(b=a.size);f.getJSON(window.location.pathname+"/entries?start="+
a.start+"&end="+a.end+"&page="+h.page()+"&pageSize="+b+"&total="+a.size).done(function(a){h.page(a.page);h.total(a.total);h.entries(a.results);a.results.length&&g()})}});var b=!0,m={"/:parentNode/:start/:page":function(a,d,e){h.page(e);h.parentNodes[a]&&h.parentNodes[a].find(function(a){return a.start==d})?(h.selectedParentNode({name:a,nodes:h.parentNodes[a]}),h.selectedNode(h.selectedParentNode().nodes.find(function(a){return a.start==d})),f(".banner .tools-ctn").show(),EB.Tools.resetFontIndex(),
b?b=!1:EB.shared.writeAjaxStats()):c()}};return{init:function(b){EB.shared.initShared();EB.Tools.init();h.level=EB.shared.getLevelFromPath();h.internalLevel=b;h.parentNodes=window.EB.browseIndexContent.indexEntryList.groupBy("parentNode");h.nodeStatus={};Object.values(h.parentNodes).each(function(a){h.nodeStatus[a[0].parentNode]=1<=a.length&&0!==a[0].size});h.browseType=window.EB.browseIndexContent.type.toLowerCase();d();window.location.hash||c();h.internalLevel&&"elementary"==h.internalLevel&&(m["/"]=
function(){h.selectedNode(null);h.selectedParentNode(null);f(".banner .tools-ctn").hide()});(new a(m)).configure({strict:!1,notfound:c}).init();e.applyBindings(h)}}}(Router,ko,jQuery);EB=window.EB||{};
EB.browseList=function(a,e,f,d){function c(a){f.getJSON(window.location.pathname+"/ajax?page="+a+"&pageSize="+b.pageSize).done(function(c){b.total(c.totalCount);c=c.assemblyList;c.map(function(a){a.transcript=a.transcript||""});b.entries(c);b.page(a);EB.Tools.resetFontIndex();c.length&&h()})}function k(){window.location.hash="/1"}var g="",h=function(){EB.MediaGallery.init("a[rel=media-gallery-img]","Videoteca Overlay");f("a[rel=media-gallery-text]").click(function(){var a=f("a[rel=media-gallery-text]").index(f(this));
EB.MediaGallery.goToIndex(a);return!1})}.debounce(50),b={pageSize:10,page:e.observable(0),total:e.observable(0),entries:e.observableArray([]),getVideoHtml:function(a){var b=(a.credit?'<span class="italic">'+a.credit+"</span>":"")+(a.title?'<br/><span id="media-title" class="italic">'+a.title+(a.content?" "+a.content:"")+"</span>":"");a.transcript?(b=b+'<div id="transcriptToggle">'+('<a id="show"><i class="fontello-icon-plus-squared"></i>'+d.string("handlebar.media.show.transcript.text")+"</a>"),b+=
'<a id="hide"><i class="fontello-icon-minus-squared"></i>'+d.string("handlebar.media.hide.transcript.text")+"</a>",b=b+"</div>"+('<p id="transcript">'+a.transcript+"</p>")):b+="<div>"+d.string("media.video.no.transcript.text")+"</div>";b+='<div id="media-metadata" class="media-metadata" data-assembly-id="'+a.assemblyId+'" data-assembly-type="'+a.assemblyType+'"data-is-favorite="'+(void 0!=a.isFavorite?a.isFavorite:!1)+'">';if(a.articleList&&Object.isArray(a.articleList)&&a.articleList.length){for(var b=
b+("<p>"+d.string("video.appears.in.articles")+"</p>"),b=b+"<ul>",c=0;c<a.articleList.length;c++)b+="<li>",b+='<a class="media-metadata-level '+g+'" href="/levels/'+EB.shared.getLevelFromPath()+"/article/"+a.articleList[c].articleId+'" data-article-id="'+a.articleList[c].articleId+'">'+a.articleList[c].title+"</a>",b+="</li>";b+="</ul>"}return b+"</div>"},durations:e.observable({}),toolbar:e.observable(null)},m={"/:page":function(a){c(a);EB.shared.writeAjaxStats()}};return{init:function(c){g=c;EB.shared.initShared();
EB.Tools.init();b.level=EB.shared.getLevelFromPath();window.location.hash||k();(new a(m)).configure({strict:!1,notfound:k}).init();(function(){e.applyBindings(b)}).delay(100)}}}(Router,ko,jQuery,EB.i18n);EB=window.EB||{};
EB.browse=function(a,e){var f=null,d=0<a("#browse-node-articles").length?"#browse-node-articles":"#browse-node-media",c=null,k=0<a(".browse-node-articles-content").length?".browse-node-articles-content":".browse-node-media-content",g=null,h=null,b=0<a("#browse-node-articles-container").length?"#browse-node-articles-container":"#browse-node-media-container",m=null,n=a("#browse-content").data("browseType"),p=a("#browse-content").data("focusType"),q=/(subjects|infocus|media|dyk)\/(main|\d+)\/(\d+)/,
u=/&page=(\d+)/,x=null,v=a("#browse-content").data("level"),r,w=function(b,c){var d=a("#browse-node-"+b),e;e=a(".browse-container[role=main] .current-node");var f=!0;if(0<e.length){var g=e.attr("id"),f=/browse-node-(.*)/.exec(g)[1];if(f=b!==f)e.removeClass("current-node"),L("#"+g)}e=f;"main"===b?(a(k).hide(),h.removeClass("span4").addClass("span12"),1<arguments.length?c&&(h.css("display","none"),m.removeClass("span8").addClass("full-width")):(h.css("display","block"),m.removeClass("span12").addClass("span8"))):
h.removeClass("span12").addClass("span4");d.find("nav a").removeClass("selected");e&&(l(d[0]),P(d.addClass("current-node").find("nav a")));a(window).trigger("toggleToolbarDispay")},y=function(b,c){var d=a(".media-filter-content").data("mediaType"),d={page:1,leaf:c||"",mediaType:d},e=D();e.push(b);d.tree=e;a.bbq.pushState(d)},t=function(b,c,d,e){var g=a(".media-filter-content").data("mediaType"),h="#browse-node-"+c;b=("/levels/{0}/browse/{1}/{2}/{3}"+(a.trim(p).length?"?focusType={4}":"")+(a.trim(g).length?
"?mediaType={5}":"")).format(EB.shared.getLevelFromPath(),n,b,c,p,g);a.ajax({url:b,localCache:!0,async:d,success:function(b){0===a(h).length&&f.append(b);"function"===typeof e&&e(c)}})},D=function(){var b=[],c=a(".browse ul.breadcrumb .root-crumb").nextAll().andSelf();c.each(function(c,d){b.push(a(d).data("nodeId"))});c.last().data("leafNode")&&b.pop();return b},B=function(a){var b=[];z(b,a);return b},E={subjects:e.string("browse.subjects.title"),canada:e.string("browse.canada.title"),australia:e.string("browse.australia.title"),
nz:e.string("browse.nz.title"),india:e.string("browse.india.title")},z=function(b,c){var d=0===b.length;if("main"!==c){var e=a("#browse-link-"+c),f=e.data("leafNode"),f={nodeId:c,isLeafNode:f},g=e.text().compact();f.title=E[g]?E[g]:g;f["class"]=d?"active":"";b.splice(0,0,f);d=q.exec(e.attr("href"))[2];z(b,d)}else e={title:E[p]?E[p]:E[n]?E[n]:n.capitalize(!0),nodeId:"main",isLeafNode:!1},e["class"]="root-crumb"+(d?" active":""),b.splice(0,0,e)},G=function(b){b["class"]=b["class"]||"";b.href=b.href||
"#";return a(Handlebars.templates["browse/breadcrumb"](b))},C=function(b,d,e){var f,g;"media"==n||"dyk"==n?(f="/assemblies?",g=a.trim(e).length?b.split("?")[0]:b):(f="/articles?",g=a.trim(p).length?b.split("?")[0]:b);var h="engus";EB.shared.isEscolar()||EB.shared.isModerna()?h="spa":EB.shared.isEscola()&&(h="por");b=d?g+f+(a.trim(e).length?"mediaType="+e+"&":"")+(a.trim(p).length?"focusType="+p+"&":"")+"languageId="+h+"&page="+d:b;a.ajax({url:b,beforeSend:function(){c.find(k).css({display:"block",
textAlign:"center",padding:"150px 0"}).html('<img src="/resources/img/thistle-spinner.gif">')},success:function(d){if(0!==a.trim(d).length){var f=c.find(k);f.css({display:"none",textAlign:"",padding:""}).empty().append(d).show();"elementary"===v&&A(f,b);a.trim(e).length&&(c.find(".media-filter-content a").removeClass("selected-media"),c.find("."+e).addClass("selected-media"),"videos"==e||"dyk"==n?a("#b2IqLink").hide():a("#b2IqLink").show())}},complete:function(a,b){0<c.find("ul>li.thumb").length&&
setTimeout(function(){EB.MediaGallery.init("#browse-node-media ul.results > li.thumb > a","Images and Videos Overlay")},500)}})},I=function(b){var c=b.find("img").data("assemblyId");x.find("img").each(function(b){if(a(this).data("assemblyId")===c)return EB.Gallery.navigateToIndex(b),!1});R()},R=function(){a("#carousel li").bind("carousel:item:click",function(b){b=EB.assembly.extractAssemblyData(a("#carousel li.selected"));EB.assembly.updatePrintLink(b)})},P=function(b){b.each(function(){var b=a(this),
c=b.data("imgSrc");c&&b.css("background-image","url("+c+")")})},l=function(b){a(b).removeClass("visuallyhidden").animate({opacity:1,left:0},{duration:400,queue:!1})},L=function(b){a(b).animate({opacity:0,left:"-100%"},{duration:400,queue:!1,complete:function(){a(this).addClass("visuallyhidden")}})},A=function(b,c){var d=1,e=a("> .results",b),f=e.innerHeight(),g=b.find("ul").data("pages");EB.Tools.updateScrollControlBindings(e,".content","li",{buttonScrollUp:!0,buttonScrollDown:!1,pages:g});a(".accordion-footing",
b).on("click","a.dn",function(){var b=e.scrollTop();d<g&&(0===b||e.get(0).scrollHeight-b===f||e.get(0).scrollHeight-b-1===f)?(b=c.replace(/page=(\d+)/,""),a.ajax({url:b,localCache:!0,data:{ajax:!0,page:++d},success:function(b){e.append(b);setTimeout(function(){EB.MediaGallery.init("#browse-node-media ul.results > li.thumb > a","Images and Videos Overlay")},500);a.each(["p","a"],function(a,b){var c=e.find(b);c.css("font-size",c.first().css("font-size"))});EB.Tools.animateScrollDown(e,a(".accordion-footing"),
d<g)}})):EB.Tools.animateScrollDown(e,a(".accordion-footing"),d<g);return!1})};return{init:function(){r={title:e.string("browse.breadcrumb.home.text"),nodeId:"-1",isLeafNode:!0,href:"/levels/{level}".inject({level:EB.shared.getLevelFromPath()}),"class":"inactive"};EB.Tools.init();f=a(".browse-container[role=main]");c=a(d);g=a(".browse ul.breadcrumb");h=a("#alternating-span");m=a(b);x=c.find("#carousel");var l=EB.shared.isEscolar();("elementary"===v||l)&&G(r).appendTo(g);c.on("click",".media-filter-content a",
function(b){b=a(this).data("mediaFilterType");a.bbq.pushState({page:1,mediaType:b})});x.elastislide({minItems:1,onClick:function(a){a=a.find("img");I(a);a&&(a={eventName:"Images and Videos - "+EB.shared.getLevelFromPath()+" - image",eventType:"Select",eventLabel:a.data("assembly-title"),trackedEvent:null},EB.shared.trackEvent(a));return!1}});a(window).bind("hashchange",function(){var b=a.bbq.getState();a.isEmptyObject(b)&&(b={tree:["main"],leaf:""});var c=b.tree,d=c[c.length-1],e=b.leaf,f=a("#browse-link-"+
d);if(1<c.length&&(e?0===f.length:0===a("#browse-node-"+d).length)){for(var f=e?c.length-2:c.length-1,h=0;h<f;h++)t(c[h],c[h+1],!1);a(".browse-container[role=main] .browse-node").addClass("visuallyhidden");f=a("#browse-link-"+d)}h=f.attr("href");"main"===d?w(d):(f.data("leafNode")?w(c[c.length-2],e):(c=q.exec(h),t(c[1],d,!0,w)),e&&f.addClass("selected").siblings().removeClass("selected"),C(h,b.page||1,b.mediaType||a(".media-filter-content").data("mediaType")));a(".browse ul.breadcrumb .root-crumb").nextAll().andSelf().remove();
a.each(B(d),function(a,b){G(b).appendTo(g)});a.scrollTo(0);EB.shared.setEscolarPageLengthStatus(500);a("#b2IqLink").length&&(b="elementary"===EB.shared.getLevelFromPath(),d=a("ul.breadcrumb li").length,!b&&1<d||b&&2<d?(a("#b2IqLink").show(),a("#b2IqLink").attr("href",a("#b2IqLink").attr("href").replace(/^(.*\/search).*?$/,"$1?keyword="+encodeURIComponent(a("ul.breadcrumb li.active a").text())))):a("#b2IqLink").hide())});a(window).bind("toggleToolbarDispay",function(){a("#alternating-span").hasClass("span12")?
(a(".tools-ctn").hide(),a("#header-tools-container").hide()):(a(".tools-ctn").show(),a("#header-tools-container").show())});f.on({dblclick:function(){return!1},"click.noFollow":function(){return!1},click:_.debounce(function(){var b=q.exec(this.href)[3];y(b,a(this).data("leafNode"))},500,!0)},"nav a");g.on("click","a",function(){var b=a(this).parent(),c=b.data("nodeId");if(-1===c)return!0;if(EB.shared.isIE8()&&0===b.next().length)return!1;b.nextAll().andSelf().remove();y(c,b.data("leafNode"));return!1});
c.find(k).on({click:function(b){var c=a(b.target);"A"!==b.target.nodeName&&(c=c.parent());c.parent().is(".disabled, .active")||(b=u.exec(c.attr("href")),c=a(".media-filter-content").data("mediaType"),a.bbq.pushState({page:b[1],mediaType:c}));return!1}},"nav.pagination a");a("#b2IqLink").on("click",function(a){a={};""!==EB.shared.getIndividualId()&&(a.individualId=EB.shared.getIndividualId());a.eventType="click";a.eventName="iqLink";writeStat(null,{accountId:EBStat.accountId,hostnameOverride:EBStat.host,
domain:EBStat.domain,requestUrl:window.location.href,hitCount:1,json:JSON.stringify(a)})});a(window).trigger("hashchange")},swapIn:l}}(jQuery,EB.i18n);EB=window.EB||{};EB.cardLogin=function(){return{init:function(){$("#id").placeholder();$("#pattern").placeholder();$("#id").focus()}}}();EB=window.EB||{};
EB.collection=function(a,e){function f(b){var c={pageSize:100,page:1};null!=b&&(c.labelId=b);var d="/levels/{level}/user/content/ajax/uploads".inject({level:k});a.getJSON(d,c,function(a){EB.shared.writeInternalStats({url:d});a&&Array.isArray(a)&&h(a)})}function d(){var b=this;b.level=k;b.isThistleLoading=ko.observable(!1);b.favorites=g;b.availableFavoriteTypes=ko.observableArray();b.selectedFavoriteType=ko.observable();b.isShowAllActive=ko.observable(!1);b.loginBoxVisible=ko.observable(!1);b.noTranscriptMsg=
"";b.uploadedDocuments=h;if("es"===EB.shared.getLanguage()||"pt"===EB.shared.getLanguage())b.noTranscriptMsg=e.string("media.video.no.transcript.text");b.init=function(){b.collectionId=a(".collection-details").data("collectionId");var c=[new m("all",e.string("mycontent.content-type-ddl.all")),new m("article",e.string("mycontent.content-type-ddl.articles")),new m("image",e.string("mycontent.content-type-ddl.images")),new m("video",e.string("mycontent.content-type-ddl.videos"))];b.isTeacher&&c.push(new m("lessonplan",
e.string("mycontent.content-type-ddl.lesson-plans")));if("en"===EB.shared.getLanguage()){var d=EB.userContent.fetchSuitableAdditionalContentTypes();a.each(d,function(a,b){c.push(new m(b.type,e.string(b.label)))})}b.availableFavoriteTypes().add(c);b.selectedFavoriteType(_.find(b.availableFavoriteTypes(),function(a){return"all"==a.id}));b.loadFavorites()};b.onFavoriteTypeChange=function(){b.loadFavorites()};b.loadFavorites=function(){b.isThistleLoading(!0);var c=b.selectedFavoriteType().id;if("image"==
c||"video"==c)c="assembly/"+c;var d="/levels/{level}/user/content/favorites/ajax/{contentType}".inject({level:k,contentType:c});a.getJSON(d,{page:1,pageSize:1E4,labelId:b.collectionId},function(c){EB.shared.writeInternalStats({url:d});b.favorites.removeAll();c=a.map(c,function(a){return new n(a)});a.each(c,function(a,c){b.favorites.push(c)});b.isThistleLoading(!1)})};b.afterFavoritesForeach=function(){};b.contentDoesntExist=function(a){return EB.userContent.favoriteDoesntExistAnymore(a)};b.targetUrl=
function(a){return EB.userContent.generateFavoriteUrl(a)};b.saveCollection=function(){EB.shared.isLoggedIn()?a.post("/levels/"+k+"/collection/copyCollection/"+b.collectionId,{},function(a){a?window.location.href="/levels/"+k+"/user/content/favorites#/collection/"+a:alert(e.string("my.content.alerts.resource.pack.cannot.save.twice"))}):b.loginBoxVisible(!0)};b.closeLoginDialog=function(){b.loginBoxVisible(!1)};b.showLoginWebapp=function(){var c=a("body").data("site-type");"school"===c||"academic"===
c?individual.showB2LoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox(),null,EB.shared.getLanguage()):"library"===c&&individual.showLibraryLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox());b.loginBoxVisible(!1)};b.generateRelatedArticleLink=function(a,b,c){return EB.userContent.generateRelatedArticleLink(a,b,c)}}var c,k,g=ko.observableArray([]),h=ko.observableArray([]),b=function(b){b.length&&(EB.MediaGallery.init("a[rel=media-gallery-img]","Lesson Plan View Overlay"),a("a[rel=media-gallery-text]").click(function(){var b=
a("a[rel=media-gallery-text]").index(a(this));EB.MediaGallery.goToIndex(b);return!1}))}.debounce(50);g.subscribe(function(a){b(a)});var m=function(a,b){this.id=a;this.label=b},n=function(a){this.favoriteType=a.favoriteType;this.id=a.savedContentId;this.title=a.title?EB.userContent.removeTags(a.title):"This content is temporarily unavailable. Please try again later.";this.dateCreatedTimestamp=a.dateCreated;this.description=EB.userContent.removeTags(a.description);this.imageCredits=EB.userContent.removeTags(a.imageCredits);
this.imagePath=a.imagePath;this.contentId=a.contentId;this.isFavoriteAssembly=!0;this.relatedArticles=a.relatedArticles;this.level=a.level;this.articleIdForAssembly=a.articleId;this.articleUrlTitle=a.urlTitle;this.assetType=a.assetType;this.fullImagePath=a.fullImagePath;this.transcript=a.transcript;this.subjects=a.subjects;this.grades=a.grades;this.duration=a.duration;this.author=a.author;this.fullLessonPlan=a.fullLessonPlan;this.additionalContentType=a.additionalContentType;this.additionalContentIdentifier=
a.additionalContentIdentifier;this.labelNote=ko.observable(a.labelNote);this.addContentTypeReadable=function(){return EB.userContent.getReadableContentType(this.additionalContentType)};this.getAddcontentIcon=function(){return EB.userContent.getAddcontentIcon(this.additionalContentType)};this.templateToUse=function(){return"ARTICLE"==this.favoriteType?"article-template":"ASSEMBLY"==this.favoriteType?"assembly-template":"LESSONPLAN"==this.favoriteType?"lessonplan-template":"addcontent-template"};this.dateCreated=
function(){return EB.userContent.getNiceDate(this.dateCreatedTimestamp)};this.isVideo=function(){return"VIDEO"==this.assetType};this.isAudio=function(){return"AUDIO"==this.assetType}};return{initView:function(){var b=a("#toolbar-content"),e=a(".content");b.css({top:e.offset().top+60,right:a(window).width()-(e.offset().left+e.outerWidth()),width:"400px"});k=EB.shared.getLevelFromPath();c=new d;c.init();f(c.collectionId);ko.applyBindings(c)}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.compare=function(a){return{init:function(){EB.Tools.init();var e=a("#compare.compare-more"),f=a("#compare.compare-profile"),d=a("#country1"),c=a("#country2"),k=a(".country-li"),g=a("#compare-flag-and-title"),h=a("#compare-help-message"),b=a("#compare-more"),m=a("#compare-country-profile"),n=EB.shared.getLevelFromPath(),p=function(a,b){q(d,a,"#country1_chzn > a > span");q(c,b,"#country2_chzn > a > span")},q=function(b,c,d){c?b.find("option").filter(function(){var e=a(this);return e.attr("value")==
c?(a(d).text(e.text()),b.val(c),!0):!1}):a(d).text(b.data("placeholder"))},u=function(b,c,d){p(b,c);var e=parseInt(b,10),f=parseInt(c,10),m="",n="",q="",u="";k.each(function(b){b=a(this);var c=b.data(d);c===e&&(m=a("p",b).text(),q=v(b.data("country-name")));c===f&&(n=a("p",b).text(),u=v(b.data("country-name")))});q||u?(x(a("#country1-flag-and-name"),m,q),x(a("#country2-flag-and-name"),n,u),h.addClass("hidden"),g.fadeIn(1E3),g.removeClass("hidden")):g.addClass("hidden")},x=function(a,b,c){var d=a.find(".compare-countries-flag").first();
b?(d.attr("src",b),d.attr("alt",c),d.removeClass("hidden"),d.css("padding","0 10px 0 0")):d.addClass("hidden");a=a.find(".compare-countries-name").first();c?a.text(c):a.text("No name")},v=function(b){-1<b.indexOf(",")&&(b=b.split(","),b=a.trim(b[1])+" "+a.trim(b[0]));return b},r=function(b,e){b.find("select").change(function(){var b=d.val(),f=c.val();a("#"+this.id).trigger("liszt:updated");0<b&&0<f&&e()})};r(e,function(){var b={};b.article1Id=d.val();b.article2Id=c.val();a.bbq.pushState(b)});r(f,
function(){var b={};b.profile1Id=d.val();b.profile2Id=c.val();a.bbq.pushState(b)});var w=function(b,c,d,e,f,g,h,m,n,q){var l=parseInt(f,10),p=parseInt(g,10),u,r,H={};H[d]=l;H[e]=p;a(b).each(function(){var b=a(this),c=b.attr("href");b.attr("href",a.param.fragment(c,H))});k.each(function(b){b=a(this);var d=b.data(c);d===l&&(u=b.data(q));d==p&&(r=b.data(q))});if(u&&r){var v={};v[m]=u;v[n]=r;a(h).each(function(){var b=a(this),c=b.attr("href");b.attr("href",a.param.fragment(c,v))})}};a(window).bind("hashchange",
function(c){c=a.deparam.fragment();if(f.length){var d=c.profile1Id,k=c.profile2Id;if(d&&k){w(".nav-compare-profiles","country-place-id","profile1Id","profile2Id",d,k,".nav-compare-other","article1Id","article2Id","country-article-id");var q="/levels/{level}/compare/profile/{profile1Id}/{profile2Id}".inject({level:n,profile1Id:d,profile2Id:k});a.ajax({url:q,type:"GET",beforeSend:function(){h.addClass("hidden");g.addClass("hidden");m.css({display:"block",textAlign:"center",padding:"150px 0"}).html('<img src="/resources/img/thistle-spinner.gif">')},
success:function(b){u(d,k,"country-place-id");m.empty().css({display:"none",padding:"",textAlign:"left"}).append(b).fadeIn(1E3);a(".chzn-container-single a").removeClass("chzn-default")}})}else y(m)}if(e.length){var p=c.article1Id,r=c.article2Id;p&&r?(w(".nav-compare-other","country-article-id","article1Id","article2Id",p,r,".nav-compare-profiles","profile1Id","profile2Id","country-place-id"),q="/levels/{level}/compare/more/show/{article1Id}/{article2Id}".inject({level:n,article1Id:p,article2Id:r}),
a.ajax({url:q,type:"GET",beforeSend:function(){h.addClass("hidden");g.addClass("hidden");b.css({display:"block",textAlign:"center",padding:"150px 0"}).html('<img src="/resources/img/thistle-spinner.gif">')},success:function(c){u(p,r,"country-article-id");b.empty().css({display:"none",padding:"",textAlign:"left"}).append(c).fadeIn(1E3);a(".chzn-container-single a").removeClass("chzn-default");EB.MediaGallery.init(".results.media .thumb > a","Compare Countries Overlay")}})):y(b)}});var y=function(a){a.empty();
g.addClass("hidden");h.removeClass("hidden");p()};a(window).trigger("hashchange")}}}(jQuery);EB=window.EB||{};
EB.curriculumStandards=function(a){function e(b,e){var f=b.parent().children("ul").first();if(!f.data("loading")){var g=b.attr("id").split("-").pop();b.children("i").toggleClass("fontello-icon-plus-circled").toggleClass("fontello-icon-minus-circled");f.children("li").size()||(f.data("loading",!0),g="/levels/{level}/curriculum-standards/{content}/{standardId}".assign({level:m,standardId:g,content:e}),a.ajax({url:g,type:"GET",beforeSend:function(){l(d);l(c);b.parent().children("ul").first().hide();
a('<div class="spinner-holder"><img class="ajax-spinner" src="/resources/img/thistle-spinner.gif" /></div>').insertAfter(b)},success:function(e){L(d);L(c);f.append(e);0==f.children("li").size()&&(p=a("#curriculum-standards").data("no-articles-message"),f.html("<li>"+p+"</li>"));b.parent().children(".spinner-holder").first().fadeOut(250,function(){f.fadeIn(250)});f.data("loading",!1)}}));b.parent().children("ul").toggle()}}var f,d,c,k,g,h,b,m,n,p,q,u=!1,x=function(){var b=a.deparam.fragment();return b.regionId||
b.subject||b.grade},v=function(){if(x()){var b=a.deparam.fragment();if(a("body").hasClass("educators")){var c="/levels/{level}/curriculum-standards".inject({level:m});window.location.href=a.param.fragment(c,b)}else{c="/levels/{level}/curriculum-standards/results".inject({level:m});n&&(b.articleId=n);var c=a.param.querystring(c,b),d=a("#curriculum-standards-results");a.ajax({url:c,type:"GET",beforeSend:function(){k.attr("disabled","disabled");var b=a(".spinner-hider").find(".standards-spinner-holder").first();
d.empty().append(b.clone())},success:function(c){k.removeAttr("disabled");w(b);d.empty().append(c).fadeIn(1E3);c=a(".results-curriculum-standards-toggle");var f=a(".result-curriculum-standards-articles-toggle"),g=a(".result-curriculum-standards-external-contents-toggle"),h=a(".result-curriculum-standards-learning-materials-toggle");c.length&&r(c.first());h.length&&e(h.first(),"learning-materials");f.length&&e(f.first(),"articles");c.click(function(){var b=a(this);r(b);return!1});f.click(function(){e(a(this),
"articles");return!1});h.click(function(){e(a(this),"learning-materials");return!1});g.click(function(){e(a(this),"external-contents");return!1});a("#optionalInfo").val(window.location.href)}});Q(a('input[name="curriculum-standards-region-chooser"]').filter("[value="+b.groupingId+"]"));return!1}}else u?window.history.back():parent.location.href=q},r=function(a){var b=a.children("i"),c=b.attr("class");b.removeClass("fontello-icon-plus-circled"===c?"fontello-icon-plus-circled":"fontello-icon-minus-circled").addClass("fontello-icon-plus-circled"===
c?"fontello-icon-minus-circled":"fontello-icon-plus-circled");a.parent().children("ul").toggle()},w=function(b){var c=b.regionId,d=b.subject,e=b.grade;if(c){var f={regionId:c};B(c,function(){U(f,function(){d&&a('select[name="subjects"] option').each(function(b){b=a(this);if(b.val()===d)return b.attr("selected","selected"),!1})});n&&(f.subject=d);A(f,function(){e&&a('select[name="grades"] option').each(function(b){b=a(this);if(b.val()===e)return b.attr("selected","selected"),!1})})})}},y=function(b){1==
a("#region-choices").data("number-of-regions")&&b&&b()},t=function(e){var f={regionId:e},m=null,l=null;u?(k.attr("disabled","disabled"),P(),f.articleId=n,l=function(){k.removeAttr("disabled");L(a('select[name="standards"]'));L(d);L(c);var b={};b.groupingId=a('input[name="grouping-id"]').val();b.regionId=e;a.bbq.pushState(b);return!1},m=function(){g.fadeOut(500).empty().append(b.clone()).fadeIn(500);A(f,l)},g.hide().empty().append(h.clone()).fadeIn(500)):m=function(){A(f,l)};U(f,m)},D=function(b,c){var d=
"/levels/{level}/curriculum-standards/regions/grouping/{groupingId}".inject({level:m,groupingId:b});H("#standard-chooser");H("#subject-chooser");H("#grade-chooser");E();P();a("#standard-chooser").load(d,function(){a('select[name="standards"]').removeAttr("disabled");y(function(){E();var b=a('select[name="standards"]').val();t(b)});z();c&&c()})},B=function(b,c){var d="/levels/{level}/curriculum-standards/regions".inject({level:m});b&&(d=a.param.querystring(d,{regionId:b}));a("#standard-chooser").load(d,
function(){var b=a('input[name="grouping-id"]').val();b&&a('input[name="curriculum-standards-region-chooser"]').each(function(c){c=a(this);if(c.val()===b)return a('input[name="curriculum-standards-region-chooser"]').removeAttr("checked"),c.attr("checked","checked"),!1});y();z();c&&c()})},E=function(){var b=a(".curriculum-submit");d.val()&&c.val()?b.removeAttr("disabled"):b.attr("disabled","disabled")},z=function(){a(".curriculum-standards-region").change(function(){var b=a(this).val(),c={};c.regionId=
b;n?H("#grade-chooser"):A(c);U(c);E()})},G=function(){a(".curriculum-subjects").change(function(){if(n){var b=a(".curriculum-standards-region").first().val(),c=a(this).val(),d={};d.regionId=b;n&&(d.subject=c);A(d)}E()})},C=function(){a(".curriculum-grades").change(function(){E()})},I=function(){a('input[name="curriculum-standards-region-chooser"]').click(function(){var b=a(this);a('input[name="curriculum-standards-region-chooser"]').removeAttr("checked");b.attr("checked","checked");var c=a(this).val(),
d=a('input[name="grouping-id"]').val();c!==d&&D(c);Q(b)})},R=function(){a(".curriculum-submit").click(function(b){b.preventDefault();b=a.deparam.fragment();var e=a('input[name="grouping-id"]').val(),f=a('select[name="standards"]').val(),g=d.val(),h=c.val();b.groupingId=e;b.regionId=f;b.subject=g;b.grade=h;a.bbq.pushState(b);return!1})},P=function(){l(a('select[name="standards"]'));l(d);l(c)},l=function(a){a.attr("disabled","disabled")},L=function(a){a.removeAttr("disabled")},A=function(b,d){H("#grade-chooser");
l(c);var e;e=n?"/levels/{level}/curriculum-standards/grades/{articleId}".inject({level:m,articleId:n}):"/levels/{level}/curriculum-standards/grades".inject({level:m});e=b.subject?a.param.querystring(e,{regionId:b.regionId,subjectId:b.subject}):a.param.querystring(e,{regionId:b.regionId});c.load(e,function(){L(c);d&&d()})},U=function(b,c){H("#subject-chooser");l(d);var e;e=n?"/levels/{level}/curriculum-standards/subjects/{articleId}".inject({level:m,articleId:n}):"/levels/{level}/curriculum-standards/subjects".inject({level:m});
e=a.param.querystring(e,{regionId:b.regionId});d.load(e,function(){d.find("option").last().val()?L(d):a("#curriculum-standards-results").empty().append(a("#no-match-message").clone());c&&c()})},H=function(b){b=a(b);var c=b.find(".option-holder").first().find("option").first();b.find("select").first().empty().append(c.clone()).attr("disabled","disabled")},Q=function(b){var c=a("#standard-chooser, #subject-chooser, #grade-chooser");b=b.parents(".curriculum-standard-chooser-grouping");b.append(c);a("div.curriculum-standard-chooser-grouping").removeClass("active");
b.addClass("active");c.show()};return{init:function(){EB.Tools.init();m=EB.shared.getLevelFromPath();a("#curriculum-browse-content");f=a("#teacher-content");k=a("#region-chooser").find('input[ type="radio"]');d=a(".curriculum-subjects");c=a(".curriculum-grades");g=a("#progress-update");var e=a("#message-holder");h=e.find("#checking-subjects-message").first();b=e.find("#checking-grades-message").first();(u=f&&0<f.length)?(n=f.data("article-id"),q="/levels/{level}/article/{articleId}".inject({level:m,
articleId:n}),B(null,function(){var b=a(".curriculum-standards-region").first().val();t(b)})):q="/levels/{level}/curriculum-standards".inject({level:m});x()&&v();G();C();I();R();a(window).bind("hashchange",function(a){v()});E();a("#lexile-help").fancybox({autoScale:!1,autoDimensions:!1,hideOnOverlayClick:!0,overlayOpacity:0,center:!1,height:108,width:400,padding:5,speedIn:100,speedOut:100,onComplete:function(){var b=a("#lexile-help").offset();a("#fancybox-wrap").animate({left:b.left,right:"auto"});
a("#fancybox-outer").css("border","1px solid rgba(0, 0, 0, 0.4)")}})}}}(jQuery);EB=window.EB||{};
EB.ebPacksToClone=function(a){function e(){this.isMaster=EB.userContentConfig.isMaster;this.pageSize=ko.observable(10);this.pageNumber=ko.observable(1);this.ebPacks=ko.observableArray();this.isLoadingResults=d;this.loadMore=ko.observable(!1);this.getPreviousPagePacks=g;this.getNextPagePacks=h}function f(){d(!0);c.loadMore(!1);var a={pageNum:c.pageNumber(),pageSize:c.pageSize()};return $.getJSON("/clone/getEBPacks",a).done(function(a){if(a)if(a.packs){var b=$.map(a.packs,function(a){return new k(a)});
c.ebPacks(b);a.totalCount>c.pageNumber()*c.pageSize()&&c.loadMore(!0);d(!1)}else d(!1),c.loadMore(!1)})}var d=ko.observable(!1),c,k=function(a){var c=ko.observableArray([]),d=ko.observableArray([]);a.grades&&Array.isArray(a.grades)&&a.grades.length&&c(a.grades);a.subjects&&Array.isArray(a.subjects)&&a.subjects.length&&d(a.subjects);this.labelId=a.labelId;this.text=a.text;this.note=a.note;this.subjectName=d;this.gradeRange=c;this.tag=a.tags;this.territory=a.territoryInfo;this.dateCreatedTimestamp=
a.createDateMills;this.dateCreated=function(){return EB.userContent.getNiceDate(this.dateCreatedTimestamp)}},g=function(){c.pageNumber(c.pageNumber()-1);return f()}.debounce(100),h=function(){c.pageNumber(c.pageNumber()+1);return f()}.debounce(100);return{init:function(){c=new e;ko.applyBindings(c);f()}}}(EB.i18n);EB=window.EB||{};
EB.failedLoginPage=function(){return{init:function(){$("#username").placeholder();$("#password").placeholder();!Modernizr.touch&&Modernizr.input.placeholder&&$("#username").focus();var a=Object.fromQueryString(window.location.href);a&&a.showErrorMessage&&$(".failedlogin-error-message").show();$("#login-submit").click(function(){return $("#username").val().length&&$("#password").val().length?!0:($(".failedlogin-error-message").show(),!1)});ko.applyBindings({})}}}();EB=window.EB||{};
EB.favorites=function(a,e){var f=this,d,c,k=function(){f.contentType="article"},g=function(){f.contentType="assembly"},h=function(b){if(m())return c;var d=f.contentType;"undefined"!==typeof b&&(d=b);b=a("#article-favoritize-icon");a("body").hasClass("elementary")&&("article"===d?b=a("#favoritize-icon-elementary-article"):"assembly"===d&&(b=a("#favoritize-icon-elementary-media")));return b},b=function(b){b.preventDefault();var c=a("#toolbar-content");B()?(h().attr("class","fontello-icon-star active"),
q()):c.html('<button id="toolbar-content-close" /><div class="favorites-login-panel">'+e.string("institution.favorites.login.prompt")+'<br/><button id="favorites-login" class="btn btn-primary">'+e.string("login.submit.button.text")+"</button></div>");EB.Tools.setToolbarContentPosition();c.css({width:"550px","z-index":"1000"}).show();setTimeout(function(){c.find("#add-label-textarea").focus()},600);a("#toolbar-content-close").click(p)},m=function(){return-1<EB.uriUtils.parse(window.location).path.indexOf("/search/")?
!0:!1},n=function(b,c){var e=0===f.contentType.indexOf("additionalcontent")?"additionalcontent":f.contentType,g="{0}/favorites/{1}/{2}/label/{3}".format(d,e,f.favoriteId,b);a.ajax(g,{type:c?"PUT":"DELETE",complete:function(){EB.shared.writeInternalStats({url:g})}})},p=function(){a("#toolbar-content").hide().html("")},q=function(){a("#toolbar-content").html('<button id="toolbar-content-close" /><div id="favorites-popup" class="favorites-panel"><div class="favorites-panel-spinner"><img src="/resources/img/thistle-spinner.gif"/></div></div>');
var b;"article"===f.contentType?b=y():"assembly"===f.contentType?b=w():"lessonplan"===f.contentType?b=t():"additionalcontent"===f.contentType&&(b=D());var c="{0}/favorites/{1}/{2}".format(d,f.contentType,b);"additionalcontent"===f.contentType&&(c=a("#magazine-content").data("additionalContentType"),c="{0}/favorites/{1}/{2}/{3}".format(d,f.contentType,c,b));x(c)},u=function(){a("#toolbar-content").html('<button id="toolbar-content-close" /><div id="favorites-popup" class="favorites-panel"><div class="favorites-panel-spinner"><img src="/resources/img/thistle-spinner.gif"/></div></div>');
var b="{0}/favorites/{1}/{2}".format(d,f.contentType,f.contentId);f.additionalContentType&&(b="{0}/favorites/{1}/{2}/{3}".format(d,f.contentType,f.additionalContentType,f.contentId));x(b)},x=function(b){a.ajax({type:"PUT",url:b,dataType:"html",success:function(c){EB.shared.writeInternalStats({url:b});a("#favorites-popup").html(c);c=a("#favorites-popup select");f.favoriteId=c.data("content-id");c.chosen().change(function(b,c){if(c&&c.deselected)n(c.deselected,!1);else if(c&&c.selected){var d=c.selected;
EB.shared.trackEvent({eventName:"Favorite - "+EB.shared.getLevelFromPath(),eventType:"Add an existing tag from Favorites popover (selection of existing tag)"});n(d,!0);a(".favorites-panel-labels .review-packs").addClass("show")}});EB.Gallery&&EB.Gallery.toggleThumbIsFavorite(!0)}})},v=function(){var b;!0===m()?b=f.contentId:"article"===f.contentType?b=y():"assembly"===f.contentType?b=w():"lessonplan"===f.contentType?b=t():"additionalcontent"===f.contentType&&(b=D());var c="{0}/favorites/{1}/{2}".format(d,
f.contentType,b);if("additionalcontent"===f.contentType)var e=a("#magazine-content").data("additionalContentType"),c="{0}/favorites/{1}/{2}/{3}".format(d,f.contentType,e,b);a.ajax(c,{type:"DELETE",complete:function(){EB.shared.writeInternalStats({url:c})}})},r=function(b){var c="{0}/favorites/{1}/{2}/label/{3}".format(d,f.contentType,f.favoriteId,b);a.ajax({type:"POST",url:c,success:function(d){EB.shared.writeInternalStats({url:c});if(0<d){var f=a("#favorites-panel-label-select");f.prepend('<option value="'+
d+'" selected="selected">'+b+"</option>");f.trigger("liszt:updated");a("#add-label-textarea").val("");a(".favorites-panel-labels .review-packs").addClass("show")}else 0==d?smoke.alert(e.string("mycontent.label-already-exists")):smoke.alert("Error occurred!")}})},w=function(){var b=a("#carousel").find(".selected").find("img");return 0<b.length?b.data("assemblyId"):a("#assembly-content").data("assemblyId")},y=function(){return a("#article-content").data("articleId")},t=function(){return a(".lessonplan-details").data("lessonplanId")},
D=function(){return a("#magazine-content").data("id")},B=function(){return""===a("body").data("individualId")?!1:!0};return{init:function(){var m=EB.shared.getLevelFromPath();d="/levels/{0}".format(m);var n=a("#toolbar-content");a("#tool-favoritize").click(function(a){b.apply(this,[a])});a("#tool-favoritize-elementary-article").click(function(a){k();b.apply(this,[a]);n.css({"z-index":"1500"}).show()});a("#tool-favoritize-elementary-media").click(function(a){g();b.apply(this,[a]);n.css({"z-index":"1500"}).show()});
a("body").on("click",".show-favorite-pane",function(b){c=a(this);var d=a("#toolbar-content");B()?(h().toggleClass("fontello-icon-star",!0),h().toggleClass("fontello-icon-star-empty",!1),f.contentType=a(this).data("contentType"),f.additionalContentType=a(this).data("additionalContentType")?a(this).data("additionalContentType"):"",f.contentId=a(this).data("contentId"),u()):d.html('<button id="toolbar-content-close" /><div class="favorites-login-panel">'+e.string("institution.favorites.login.prompt")+
'<br/><button id="favorites-login" class="btn btn-primary">'+e.string("login.submit.button.text")+"</button></div>");d.css({width:"550px"}).show();EB.Tools.setDynamicToolbarContentPosition(b.pageX,b.pageY);a("#toolbar-content-close").click(function(){p();a("#header-tools-container").append(n)})});n.on("click","#favorites-login",function(){"school"===a("body").data("site-type")?(individual.showB2LoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox(),null,EB.shared.getLanguage()),null,getLanguage()):
"library"===a("body").data("site-type")?individual.showLibraryLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox()):"academic"===a("body").data("site-type")&&individual.showAcademicLoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox())});n.on("click","#add-favorite-label-button",function(){var b=a("#add-label-textarea").val(),b=jQuery.trim(b);/[A-Z0-9 ]+/i.test(b)?0<b.length&&r(b):smoke.alert("Label can only contain letters and digits")});n.on("click","#remove-favorite-button",
function(){v();h().toggleClass("fontello-icon-star",!1);h().toggleClass("fontello-icon-star-empty",!0);p()})},hideToolbarContent:p,toggleFavoriteIcon:function(a,b){var c=f.contentType;"undefined"!==typeof b&&(c=b);"assembly"==c&&(a&&!0===a?h(c).removeClass("fontello-icon-star-empty").addClass("fontello-icon-star").addClass("active"):h(c).removeClass("fontello-icon-star").removeClass("active").addClass("fontello-icon-star-empty"))},setTypeArticle:k,setTypeAssembly:g,setTypeLessonplan:function(){f.contentType=
"lessonplan"},setTypeAdditionalContent:function(){f.contentType="additionalcontent"}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.features=function(a){return{init:function(){a(".features-content").append(a("#dl").html());a(".features-content").children("div").show();a(".features-content").find(".hidden").show().css("visibility","visible");a("html, body").animate({scrollTop:a(".features-content").offset().top-45-50},"slow");a(".link").click(function(d){d.preventDefault();a("html, body").animate({scrollTop:a(".features-content").offset().top-45-50},"slow");d=a(d.target);d=a("#"+d.attr("title")).html();a(".features-content").empty().append(d);
a(".features-content").children("div").show("slow");a(".features-content").find(".hidden").show("slow").css("visibility","visible")});var e=a(".allow-empty").filter(function(){return""===a.trim(a(this).text())&&0==a(this).children().length});if(e.length){var f=e.parent().filter(function(){return 1==a(this).children().length});f.length?f.remove():e.remove()}".k8"==a("#all-features-content").data("levelRestriction")&&EB.shared.removeWordsForK8();EB.shared.replaceLevelNames()}}}(jQuery);
EB=window.EB||{};
EB.groupManager=function(a,e){function f(){var a=this;a.isTeacher=EB.userContentConfig.isTeacher;a.isMaster=EB.userContentConfig.isMaster;a.packId=ko.observable();a.packIsInGroup=ko.observable(!1);a.packTitle=ko.observable();a.packGradeRange=ko.observable();a.pack=ko.observable();a.groups=ko.observableArray([]);a.selectedGroup=ko.observable();a.filterInput=ko.observable("");a.filterKeyword=ko.observable("");a.newGroupName=ko.observable("");a.searchGroupInput=ko.observable("");a.applyFilter=function(){a.filterKeyword(a.filterInput())};
a.clearFilter=function(){a.filterKeyword("");a.filterInput("")};a.addNewGroupClicked=function(){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/create".inject({level:c}),data:{title:a.newGroupName()},dataType:"json",success:function(a){a?(e(null,"Group successfully added",null,[],!0),d.groups.push(new k(a)),d.newGroupName("")):e(null,"Group name already exists",null,[],!0)}})};a.searchGroupClicked=function(){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/search".inject({level:c}),
data:{query:a.searchGroupInput()},dataType:"json",success:function(a){a.length?(d.groups.removeAll(),a.forEach(function(a){d.groups.push(new k(a))})):e(null,"No groups found",null,[],!0)}})};a.addPackToGroup=function(a){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/addPack".inject({level:c}),data:{groupId:a,packId:d.packId()},dataType:"json",success:function(){ko.utils.arrayForEach(d.groups(),function(c){c.groupId==a&&(c.packs.push(d.pack()),d.packIsInGroup(!0))})}})};a.removePackFromGroup=
function(a){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/removePack".inject({level:c}),data:{groupId:a,packId:d.packId()},dataType:"json",success:function(){ko.utils.arrayForEach(d.groups(),function(c){c.groupId==a&&ko.utils.arrayForEach(c.packs(),function(a){a.labelId==d.packId()&&(c.packs.remove(a),d.packIsInGroup(!1))})})}})};a.deleteGroup=function(a){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/delete".inject({level:c}),data:{groupId:a},dataType:"json",success:function(){ko.utils.arrayForEach(d.groups(),
function(c){c.groupId==a&&(ko.utils.arrayForEach(c.packs(),function(a){a.labelId==d.packId()&&d.packIsInGroup(!1)}),d.groups.remove(c))})}})};a.initPackTitleAndGradeRange=function(b){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/loadPack".inject({level:c}),data:{id:a.packId()},dataType:"json",success:function(a){a=new EB.packs.ResourcePack(a);d.packTitle(a.text);d.packGradeRange(a.gradeRange().fullLabel);d.pack(a)}})};a.initGroup=function(b){$.ajax({type:"POST",url:"/levels/{level}/user/content/group/load".inject({level:c}),
data:{packId:a.packId()},dataType:"json",success:function(a){d.groups.removeAll();d.groups.push(new k(a));d.packIsInGroup(!0)}})}}var d,c;EB.i18n.resource("my.content.grade.ranges");var k=function(a){var b=this;b.groupId=a.groupId;b.title=a.title;b.packs=ko.observableArray([]);a.packs.forEach(function(a){b.packs.push(new EB.packs.ResourcePack(a))});b.editing=ko.observable(!1);b.hasSubstring=function(a){return 0<=b.name().toLowerCase().indexOf(a.toLowerCase())};b.containsPack=function(){var a=!1;ko.utils.arrayForEach(b.packs(),
function(b){if(b.labelId==d.packId())return a=!0});return a}},g={"/:packId":function(a){d.packId(a);d.initPackTitleAndGradeRange(a);d.initGroup()}};return{init:function(){c=EB.shared.getLevelFromPath();$("body").data("country");d=new f;router=(new Router(g)).configure({strict:!1});router.init("/");ko.applyBindings(d)}}}(EB.i18n,EB.Overlay);EB=window.EB||{};
EB.handlebars=function(){var a,e;return{init:function(f){a=f.template;e=f.templates=f.templates||{};e["shared/userProfile"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b,m=this.escapeExpression;a=""+('<div id="user-profile-modal">\n<h3>'+m((b=(b=c&&c.profile,null==b||!1===b?b:b.displayName),"function"===typeof b?b.apply(c):b))+"</h3>\n");if((b=e["if"].call(c,(b=c&&c.profile,null==b||!1===b?b:b.picture),{hash:{},inverse:this.noop,fn:this.program(1,function(a,
b){var c,d;c='<img src="/levels/';(d=e.level)?d=d.call(a,{hash:{},data:b}):(d=a&&a.level,d="function"===typeof d?d.call(a,{hash:{},data:b}):d);c+=m(d)+"/userprofile/";(d=e.profileId)?d=d.call(a,{hash:{},data:b}):(d=a&&a.profileId,d="function"===typeof d?d.call(a,{hash:{},data:b}):d);return c+=m(d)+'/picture"/><div class="profile-data">'},h),data:h}))||0===b)a+=b;a+="\n";if((b=e["if"].call(c,(b=c&&c.profile,null==b||!1===b?b:b.biography),{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){var c,
d;c="<h4>";(d=e.biographyLabel)?d=d.call(a,{hash:{},data:b}):(d=a&&a.biographyLabel,d="function"===typeof d?d.call(a,{hash:{},data:b}):d);c+=m(d)+"</h4>";if((d=(d=(d=a&&a.profile,null==d||!1===d?d:d.biography),"function"===typeof d?d.apply(a):d))||0===d)c+=d;return c},h),data:h}))||0===b)a+=b;a+="\n";if((b=e["if"].call(c,(b=c&&c.profile,null==b||!1===b?b:b.publications),{hash:{},inverse:this.noop,fn:this.program(5,function(a,b){var c,d;c="<h4>";(d=e.publicationsLabel)?d=d.call(a,{hash:{},data:b}):
(d=a&&a.publicationsLabel,d="function"===typeof d?d.call(a,{hash:{},data:b}):d);c+=m(d)+"</h4>";if((d=(d=(d=a&&a.profile,null==d||!1===d?d:d.publications),"function"===typeof d?d.apply(a):d))||0===d)c+=d;return c},h),data:h}))||0===b)a+=b;a+="\n";if((b=e["if"].call(c,(b=c&&c.profile,null==b||!1===b?b:b.picture),{hash:{},inverse:this.noop,fn:this.program(7,function(a,b){return"</div>"},h),data:h}))||0===b)a+=b;return a+"\n</div>\n"});e["shared/melingo/data"]=a(function(a,c,e,f,h){this.compilerInfo=
[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a="<mfx>\n    <ElID>ElID</ElID>\n    <idLang>";(b=e.langCode)?b=b.call(c,{hash:{},data:h}):(b=c&&c.langCode,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"</idLang>\n    <word><![CDATA[";(b=e.query)?b=b.call(c,{hash:{},data:h}):(b=c&&c.query,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+"]]\x3e</word>\n    <line><![CDATA[]]\x3e</line>\n</mfx>"});e["shared/melingo/popup"]=a(function(a,
c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<div id="growlbox-dictionary-switcher">\n    <button id="growlbox-dictionary-switcher-english" class="btn bound-function">English</button>\n    ';if((b=e["if"].call(c,c&&c.showSpanishButton,{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return'<button id="growlbox-dictionary-switcher-spanish" class="btn active">Espaol</button>'},h),data:h}))||0===b)a+=b;a+="\n    ";if((b=e["if"].call(c,
c&&c.showArabicButton,{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){return'<button id="growlbox-dictionary-switcher-arabic" class="btn active"></button>'},h),data:h}))||0===b)a+=b;a+="\n</div>\n<h4>";(b=e.query)?b=b.call(c,{hash:{},data:h}):(b=c&&c.query,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'</h4><span class="';(b=e.langCode)?b=b.call(c,{hash:{},data:h}):(b=c&&c.langCode,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'">';(b=e.words)?b=b.call(c,
{hash:{},data:h}):(b=c&&c.words,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+"</span>\n"});e["media/video"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b=this.escapeExpression;a='<video width="';(f=e.width)?f=f.call(c,{hash:{},data:h}):(f=c&&c.width,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'" height="';(f=e.height)?f=f.call(c,{hash:{},data:h}):(f=c&&c.height,f="function"===typeof f?f.call(c,{hash:{},data:h}):
f);a+=b(f)+'" id="video-player"';if((f=e["if"].call(c,c&&c.poster,{hash:{},inverse:this.noop,fn:this.program(1,function(a,c){var d,f;d=' poster="';(f=e.poster)?f=f.call(a,{hash:{},data:c}):(f=a&&a.poster,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+'"'},h),data:h}))||0===f)a+=f;a+=' controls="controls" preload="none"';(f=e.autoplay)?f=f.call(c,{hash:{},data:h}):(f=c&&c.autoplay,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);if(f||0===f)a+=f;a+='>\r\n    <source type="video/';
(f=e.type)?f=f.call(c,{hash:{},data:h}):(f=c&&c.type,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'" src="';(f=e.src)?f=f.call(c,{hash:{},data:h}):(f=c&&c.src,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);return a+=b(f)+'" />\r\n</video>'});e["media/metadata"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};a="";var b=this.escapeExpression;if((f=e["if"].call(c,c&&c.showCounter,{hash:{},inverse:this.noop,fn:this.program(1,function(a,
c){var d,f;d='\r\n<span class="gallery-media-counter">';(f=e.mediaCounterText)?f=f.call(a,{hash:{},data:c}):(f=a&&a.mediaCounterText,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+" ";(f=e.index)?f=f.call(a,{hash:{},data:c}):(f=a&&a.index,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+"</span>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n<h3>";(f=e.assemblyTitle)?f=f.call(c,{hash:{},data:h}):(f=c&&c.assemblyTitle,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);
if(f||0===f)a+=f;a+="</h3>\r\n<p>";(f=e.assemblyCaption)?f=f.call(c,{hash:{},data:h}):(f=c&&c.assemblyCaption,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);if(f||0===f)a+=f;a+='</p>\r\n<i class="rg-credit">';(f=e.credit)?f=f.call(c,{hash:{},data:h}):(f=c&&c.credit,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);if(f||0===f)a+=f;a+="</i>\r\n";if((f=e["if"].call(c,c&&c.licenseId,{hash:{},inverse:this.noop,fn:this.program(3,function(a,c){var d,f;d='\r\n    <a target="_blank" class="rg-license" href="/license/';
(f=e.licenseId)?f=f.call(a,{hash:{},data:c}):(f=a&&a.licenseId,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+'">';(f=e.licenseTitle)?f=f.call(a,{hash:{},data:c}):(f=a&&a.licenseTitle,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+"</a>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n";if((f=e["if"].call(c,c&&c.relativePath,{hash:{},inverse:this.noop,fn:this.program(5,function(a,c){var d,f;d='\r\n<a href="/download/video?path=';(f=e.relativePath)?f=f.call(a,{hash:{},data:c}):
(f=a&&a.relativePath,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+'" target="_blank"><i class="fontello-icon-download"></i>';(f=e.downloadtext)?f=f.call(a,{hash:{},data:c}):(f=a&&a.downloadtext,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+"</a>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n";if((f=e["if"].call(c,c&&c.transcript,{hash:{},inverse:this.noop,fn:this.program(7,function(a,c){var d,f;d='\r\n<div id="transcriptToggle">\r\n    <a id="show"><i class="fontello-icon-plus-squared"></i>';
(f=e.showTranscriptText)?f=f.call(a,{hash:{},data:c}):(f=a&&a.showTranscriptText,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+'</a>\r\n    <a id="hide"><i class="fontello-icon-minus-squared"></i>';(f=e.hideTranscriptText)?f=f.call(a,{hash:{},data:c}):(f=a&&a.hideTranscriptText,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+'</a>\r\n</div>\r\n<p id="transcript">';(f=e.transcript)?f=f.call(a,{hash:{},data:c}):(f=a&&a.transcript,f="function"===typeof f?f.call(a,{hash:{},
data:c}):f);if(f||0===f)d+=f;return d+"</p>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n";if((f=e["if"].call(c,c&&c.noTranscriptMsg,{hash:{},inverse:this.noop,fn:this.program(9,function(a,c){var d,f;d="\r\n<div>";(f=e.noTranscriptMsg)?f=f.call(a,{hash:{},data:c}):(f=a&&a.noTranscriptMsg,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+"</div>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n";if((f=e["if"].call(c,c&&c.largePath,{hash:{},inverse:this.noop,fn:this.program(11,function(a,c){var d,
f;d='\r\n<a href="';(f=e.largePath)?f=f.call(a,{hash:{},data:c}):(f=a&&a.largePath,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);d+=b(f)+'" target="_blank">';(f=e.largeImageLinkText)?f=f.call(a,{hash:{},data:c}):(f=a&&a.largeImageLinkText,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+"</a>\r\n"},h),data:h}))||0===f)a+=f;a+="\r\n";if((f=e["if"].call(c,c&&c.relatedArticles,{hash:{},inverse:this.noop,fn:this.program(13,function(a,b){var c,d;c="\r\n    ";(d=e.relatedArticles)?
d=d.call(a,{hash:{},data:b}):(d=a&&a.relatedArticles,d="function"===typeof d?d.call(a,{hash:{},data:b}):d);if(d||0===d)c+=d;return c+"\r\n"},h),data:h}))||0===f)a+=f;return a+"\r\n"});e["media/flash"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<embed width="';(b=e.width)?b=b.call(c,{hash:{},data:h}):(b=c&&c.width,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'"\r\n       height="';(b=e.height)?b=b.call(c,
{hash:{},data:h}):(b=c&&c.height,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'"\r\n       type="application/x-shockwave-flash" src="/resources/swf/player.swf" allowfullscreen="true" allowscriptaccess="always" wmode="transparent" quality="high" bgcolor="white"\r\n       flashvars="width=';(b=e.width)?b=b.call(c,{hash:{},data:h}):(b=c&&c.width,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"&height=";(b=e.height)?b=b.call(c,{hash:{},data:h}):(b=c&&c.height,b="function"===
typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"repeat=false&file=";(b=e.src)?b=b.call(c,{hash:{},data:h}):(b=c&&c.src,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+'&autostart=true">\r\n</embed>'});e["media/audio-with-icon"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<div class="audio-with-icon">\n<span class="fontello-icon-volume-up"></span>\n<audio preload="none" src="';(b=e.src)?b=b.call(c,{hash:{},
data:h}):(b=c&&c.src,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" type="audio/';(b=e.type)?b=b.call(c,{hash:{},data:h}):(b=c&&c.type,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" ';(b=e.autoplay)?b=b.call(c,{hash:{},data:h}):(b=c&&c.autoplay,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+"></audio>\n</div>"});e["media/iframe"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;
a='<iframe src="';(b=e.src)?b=b.call(c,{hash:{},data:h}):(b=c&&c.src,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"?backlink=";(b=e.backlink)?b=b.call(c,{hash:{},data:h}):(b=c&&c.backlink,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" style="border: none; width: ';(b=e.width)?b=b.call(c,{hash:{},data:h}):(b=c&&c.width,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"px; height: ";(b=e.height)?b=b.call(c,{hash:{},data:h}):(b=c&&c.height,b="function"===
typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+'px;" scrolling="no"></iframe>\n'});e["media/audio"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<audio preload="none" src="';(b=e.src)?b=b.call(c,{hash:{},data:h}):(b=c&&c.src,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" type="audio/';(b=e.type)?b=b.call(c,{hash:{},data:h}):(b=c&&c.type,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+
'"';(b=e.autoplay)?b=b.call(c,{hash:{},data:h}):(b=c&&c.autoplay,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+"></audio>"});e["media/embed"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b=this.escapeExpression;a='<embed width="';(f=e.width)?f=f.call(c,{hash:{},data:h}):(f=c&&c.width,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'"\r\n       height="';(f=e.height)?f=f.call(c,{hash:{},data:h}):(f=c&&c.height,f="function"===
typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'"\r\n       ';if((f=e["if"].call(c,c&&c.type,{hash:{},inverse:this.noop,fn:this.program(1,function(a,c){var d,f;d='\r\n       type="';(f=e.type)?f=f.call(a,{hash:{},data:c}):(f=a&&a.type,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+'"\r\n       '},h),data:h}))||0===f)a+=f;a+='\r\n       src="';(f=e.src)?f=f.call(c,{hash:{},data:h}):(f=c&&c.src,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'"\r\n       ';if((f=
e["if"].call(c,c&&c.quicktime,{hash:{},inverse:this.noop,fn:this.program(3,function(a,c){var d,f;d='\r\n       controller="true" loop="false" autoplay="true" pluginspage="http://www.apple.com/quicktime/download/" qtsrc="';(f=e.src)?f=f.call(a,{hash:{},data:c}):(f=a&&a.src,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+'"\r\n       '},h),data:h}))||0===f)a+=f;return a+"\r\n></embed>"});e["tools/citeMediaPrint"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,
a.helpers);h=h||{};var b;f=this.escapeExpression;a='<div class="citations-header">\n    <h3>';(b=e.heading)?b=b.call(c,{hash:{},data:h}):(b=c&&c.heading,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"</h3>\n    <span>";(b=e.intro)?b=b.call(c,{hash:{},data:h}):(b=c&&c.intro,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'</span>\n</div>\n\n<ul class="listed-citations">\n    <li id="mla-citation">\n        ';(b=e.mlaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.mlaFormat,
b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="apa-citation">\n        ';(b=e.apaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.apaFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="harvard-citation">\n        ';(b=e.harvardFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.harvardFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="chicago-citation">\n        ';
(b=e.chicagoFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.chicagoFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;return a+"\n    </li>\n</ul>\n"});e["tools/citePrint"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<div class="citations-header">\r\n\t<h3>';(b=e.heading)?b=b.call(c,{hash:{},data:h}):(b=c&&c.heading,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"</h3>\r\n    <span>";
(b=e.intro)?b=b.call(c,{hash:{},data:h}):(b=c&&c.intro,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'</span>\r\n</div><br/>\r\n    \r\n    <div id="mla-citation" class="cite-text">\r\n        ';(b=e.mlaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.mlaFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\r\n    </div>\r\n    <div id="apa-citation" class="cite-text">\r\n        ';(b=e.apaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.apaFormat,b="function"===
typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\r\n    </div>\r\n    <div id="harvard-citation" class="cite-text">\r\n        ';(b=e.harvardFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.harvardFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\r\n    </div>\r\n    <div id="chicago-citation" class="cite-text">\r\n        ';(b=e.chicagoFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.chicagoFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===
b)a+=b;a+='\r\n    </div>\r\n    <div id="abnt-citation" class="cite-text">\r\n        ';(b=e.abntFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.abntFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;return a+"\r\n    </div>\r\n"});e["tools/cite"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<button id="toolbar-content-close"></button>\n<div class="citations-header">\n\t<h3>';(b=e.heading)?b=b.call(c,
{hash:{},data:h}):(b=c&&c.heading,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+"</h3>\n    <span>";(b=e.intro)?b=b.call(c,{hash:{},data:h}):(b=c&&c.intro,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'</span>\n    <label for="citation-select">';(b=e.label)?b=b.call(c,{hash:{},data:h}):(b=c&&c.label,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'</label>\n    <select id="citation-select">\n        <option value="mla">MLA</option>\n        <option value="apa">APA</option>\n        <option value="harvard">Harvard</option>\n        <option value="chicago">Chicago Manual of Style</option>\n    </select>\n</div>\n<ul class="listed-citations">\n    <li id="mla-citation">\n        ';
(b=e.mlaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.mlaFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="apa-citation">\n        ';(b=e.apaFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.apaFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="harvard-citation">\n        ';(b=e.harvardFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.harvardFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):
b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="chicago-citation">\n        ';(b=e.chicagoFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.chicagoFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;a+='\n    </li>\n    <li id="abnt-citation">\n        ';(b=e.abntFormat)?b=b.call(c,{hash:{},data:h}):(b=c&&c.abntFormat,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);if(b||0===b)a+=b;return a+"\n    </li>\n</ul>\n"});e["browse/breadcrumb"]=a(function(a,c,e,f,h){this.compilerInfo=
[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<li class="';(b=e["class"])?b=b.call(c,{hash:{},data:h}):(b=c&&c["class"],b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" data-node-id="';(b=e.nodeId)?b=b.call(c,{hash:{},data:h}):(b=c&&c.nodeId,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" data-leaf-node="';(b=e.isLeafNode)?b=b.call(c,{hash:{},data:h}):(b=c&&c.isLeafNode,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+
'">\n    <a href="';(b=e.href)?b=b.call(c,{hash:{},data:h}):(b=c&&c.href,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'" data-ga="Breadcrumbs|Click on a breadcrumb|';(b=e.title)?b=b.call(c,{hash:{},data:h}):(b=c&&c.title,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+" (";(b=e.href)?b=b.call(c,{hash:{},data:h}):(b=c&&c.href,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+')">';(b=e.title)?b=b.call(c,{hash:{},data:h}):(b=c&&c.title,b="function"===typeof b?
b.call(c,{hash:{},data:h}):b);return a+=f(b)+'</a>\n    <span class="divider"></span>\n</li>'});e["usercontent/label"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b=this.escapeExpression;a='<li>\n    <a href="#" class="label-toggle" data-label-id="';(f=e.id)?f=f.call(c,{hash:{},data:h}):(f=c&&c.id,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+'">\n        <div class="label-div">\n            <div class="label-text">';(f=e.text)?f=f.call(c,
{hash:{},data:h}):(f=c&&c.text,f="function"===typeof f?f.call(c,{hash:{},data:h}):f);a+=b(f)+"</div>\n            ";if((f=e.unless.call(c,c&&c.readOnly,{hash:{},inverse:this.noop,fn:this.program(1,function(a,c){var d,f;d='<div class="icon-remove delete-label" data-label-id="';(f=e.id)?f=f.call(a,{hash:{},data:c}):(f=a&&a.id,f="function"===typeof f?f.call(a,{hash:{},data:c}):f);return d+=b(f)+'"></div>'},h),data:h}))||0===f)a+=f;return a+"\n        </div>\n    </a>\n</li>\n"});e["usercontent/ddl_tag"]=
a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,a.helpers);h=h||{};var b;f=this.escapeExpression;a='<li class="dropdown-item" data-id="';(b=e.id)?b=b.call(c,{hash:{},data:h}):(b=c&&c.id,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'">\n    ';(b=e.text)?b=b.call(c,{hash:{},data:h}):(b=c&&c.text,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);return a+=f(b)+"\n</li>"});e["usercontent/tag"]=a(function(a,c,e,f,h){this.compilerInfo=[4,">= 1.0.0"];e=this.merge(e,
a.helpers);h=h||{};var b;f=this.escapeExpression;a='<span class="label label-info" data-id="';(b=e.id)?b=b.call(c,{hash:{},data:h}):(b=c&&c.id,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+'">\n    ';(b=e.text)?b=b.call(c,{hash:{},data:h}):(b=c&&c.text,b="function"===typeof b?b.call(c,{hash:{},data:h}):b);a+=f(b)+" ";if((b=e.unless.call(c,c&&c.readOnly,{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return'<span class="icon-remove remove-label"></span>'},h),data:h}))||0===
b)a+=b;return a+"\n</span>\n"})}}}();EB=window.EB||{};
EB.help=function(a,e){a("#help-content").data("level");var f=function(){if(750<a(window).width()){var d=a("#help-toc .help-site-features .help-box-content").height();a("#help-toc .help-contact .help-box-content").height(d);a("#help-toc .help-accessibility .help-box-content").height(d)}else a("#help-toc .help-contact .help-box-content").css("height","auto"),a("#help-toc .help-accessibility .help-box-content").css("height","auto")};return{init:function(){f();a(window).resize(function(){f()});a("#help-content").data("showContact")?
a(".help-content").append(a("#cntct-contact-info").html()):a(".help-content").append(a("#sf-searching").html());a(".help-content").children("div").show();a(".help-content").find(".hidden").show().css("visibility","visible");EB.Tools.init();a("body").on("click",".link",function(d){d.preventDefault();a("html[lang=es-ES]").removeClass("tall");a("html, body").animate({scrollTop:a(".help-content").offset().top-50},"slow",function(){EB.shared.setEscolarPageLengthStatus(50)});d=a(d.target);var c=a("#"+d.attr("title")).html();
a(".help-content").empty().append(c);a(".help-content").children("div").show("slow");a(".help-content").find(".hidden").show("slow").css("visibility","visible");window.location.hash="#"+d.attr("title")});a(".sublink").click(function(d){d.preventDefault();a("html[lang=es-ES]").removeClass("tall");a("html, body").animate({scrollTop:a(".help-content").offset().top-50},"slow",function(){EB.shared.setEscolarPageLengthStatus(50)});d=a(d.target);var c=a("#"+d.data("parent")).html();a(".help-content").empty().append(c);
a(".help-content").children("div").show("slow").css("visibility","visible");a(".help-content").find("#"+d.attr("title")).show("slow").css("visibility","visible");window.location.hash="#"+d.attr("title")});".k8"==a("#help-content").data("levelRestriction")&&EB.shared.removeWordsForK8();EB.shared.replaceLevelNames();window.location.hash&&a(".link, .sublink").each(function(){a(this).attr("title")==window.location.hash.slice(1)&&a(this).click()});e.applyBindings({})}}}(jQuery,ko);EB=window.EB||{};
EB.homepage=function(a,e,f){function d(){var a=location.hash+"_CAROUSEL";e(a).length&&e("html, body").animate({scrollTop:e(a).offset().top-50},500)}function c(){e("#biographies-form").submit(function(a){a.preventDefault();window.location=e(this).attr("action")+"#"+e(this).serialize().replace("genders=MALE","genders1=checked").replace("genders=FEMALE","genders2=checked")})}function k(){var a=f.resource("home.primary.sources.path");if("academic"==EB.shared.getSiteType()){var b=f.locale();f.locale("en-UK");
a=f.resource("home.primary.sources.path");f.locale(b)}var c={},d=[];e.getJSON(a).then(function(a){a&&a.links&&Object.isArray(a.links)&&a.links.each(function(a){a={text:a.text,url:a.id&&a.path?"/levels/{level}/additionalcontent/primarysources?id={id}&path={path}".assign({id:a.id,path:a.path,level:q.level}):""};d.push(a)});c.links=d;c.keywords=a.keywords;q.primarySources(c)})}function g(){e.getJSON("/levels/{level}/new-and-revised-articles/ajax?count={count}".assign({level:q.level,count:f.resource("home."+
q.internalLevel+".nara.count")})).done(function(a){var b=[];a.groupBy(function(a){return Date.create(a.lastUpdate).format("{mon} {d}")},function(a,c){b.push({date:a,articles:c})});q.nara(b.first(2))})}function h(a){return q.featureOrder().length?e._Deferred().resolve():e.getJSON("/levels/{level}/feature-order/ajax?featureIds={featureIds}&overrideDate={overrideDate}".assign({level:q.level,featureIds:a,overrideDate:m()}))}function b(){var a;a=n()?e._Deferred().resolve():e.getJSON("/levels/{level}/components/ajax?overrideDate={overrideDate}".assign({level:q.level,
overrideDate:m()}));a.then(function(a){if(Object.isArray(a)){a=a.each(function(a){a.heroSpace=a.assetList.find(function(a){return"HEROSPACE_ONLINE"==a.assetSize});a.heroSpaceThumb=a.assetList.find(function(a){return"HEROSPACE_THUMB"==a.assetSize});a.fullSize=a.assetList.find(function(a){return"FULLSIZE"==a.assetSize});a.firstFrame=a.assetList.find(function(a){return"FIRSTFRAME"==a.assetSize});a.formattedDate=Date.create(a.date).format("{Month} {d}")});n(a.groupBy(function(a){return a.componentType}));
var b=[];Object.keys(n(),function(a,c){Object.isArray(c)&&c.length&&b.push(c[0].featureId)});b.length&&h(b.join(",")).then(function(a){a&&Object.isArray(a)&&q.featureOrder(a)})}})}var m=a.observable(""),n=a.observable(),p=a.observable(),q={level:null,internalLevel:null,primarySources:a.observableArray(),nara:a.observableArray(),components:n,featureOrder:a.observableArray(),getAnotherQuote:function(){e.getJSON("/levels/{level}/random-quote/ajax".assign({level:q.level})).done(function(a){if(!e.isEmptyObject(a)){var b=
Object.reject(n(),"QUOTATION"),c=[];Object.keys(b,function(a,b){Object.isArray(b)&&b.length&&b.each(function(a){c.push(a)})});c.push(a);n(c.groupBy(function(a){return a.componentType}))}})},showDetails:function(a){var b={};b.title=a.label;b.content=a.content.compact().removeTags();b.links="<ul>"+e(a.content).html()+"</ul>";p(b);return!1},selectedFeature:p},u=function(a){var b=e("#news-container");if(b.length){var c=b.data("feeds"),b=b.data("count");e("#news-container-content").load("/levels/"+a+"/feed/"+
c+"/"+b+"?fromPage=homepage")}};return{init:function(e){q.level=EB.shared.getLevelFromPath();q.internalLevel=e;q.country=EB.shared.getCountry();var f=Object.fromQueryString(window.location.href);m(f&&f.overrideDate?f.overrideDate:"");"high"===e&&(c(),b(),k(),g());u(e);"onhashchange"in window&&(window.onhashchange=d);(function(){d()}).delay(500);a.applyBindings(q)}}}(ko,jQuery,EB.i18n);EB=window.EB||{};
EB.intlHomepage=function(a,e,f){function d(){e.getJSON("/levels/{level}/new-and-revised-articles/ajax?count={count}".assign({level:z.level,count:f.resource("home."+z.internalLevel+".nara.count")})).done(function(b){var c=[];b.groupBy(function(a){return Date.create(a.lastUpdate).format("{d} "+f.string("nara.date.separator")+" {month} {yyyy}")},function(b,d){c.push({date:b,articles:a.observableArray(d)})});z.nara(c.first(2));z.naraShowTwoDays(10<c.first(1).length)})}function c(){f.resource("home."+
z.internalLevel+".feed.news").each(function(a){e.getJSON("/levels/{level}/feed/{name}/{count}/ajax".assign({level:z.level,name:a.name,count:a.count})).then(function(b){b&&Object.isArray(b)&&0<b.length&&(v().push({name:a.name,order:a.order,items:b}),v.valueHasMutated())})})}function k(a){e.getJSON("/levels/{level}/escolar-suggested-searches/ajax?count={count}".assign({level:z.level,count:a})).then(function(a){Array.isArray(a)&&x(a)})}function g(){e(".search-chooser input").click(function(){e("#searchCriteria").attr("action",
document.location+e(this).attr("value"))})}function h(){e(".homepage-lz-link a").click(function(){EB.shared.trackGaEvent(["escola","LearningZone load"]);var a;a=-1!=navigator.userAgent.indexOf("MSIE")?"location=0,menubar=0,toolbar=0,status=0,top=0,left=0,scrollbars=1,resizable=1,width="+screen.width+",height="+screen.height:"location=0,menubar=0,toolbar=0,status=0,top=0,left=0,scrollbars=1,resizable=1,width="+screen.width-5+",height="+screen.height-30;window.open("http://"+window.location.hostname.replace("-preview",
"")+"/aprender/LearningZone.jsp?categoryId=2&classId=1&studentId=1","lzPopupMain",a).focus();return!1})}function b(){e.getJSON("/levels/{level}/random-articles/ajax".assign({level:z.level})).then(function(a){Array.isArray(a)&&(r(a),E(a[0]))})}function m(){e.getJSON("/levels/{level}/random-assemblies/ajax".assign({level:z.level})).then(function(a){Array.isArray(a)&&(y(a),t(a.length?a[0]:null))})}function n(){e.getJSON("/levels/{level}/animal-otd/ajax".assign({level:z.level})).done(function(a){q(a)})}
function p(){e.getJSON("/levels/{level}/assembly-otd/ajax".assign({level:z.level})).then(function(a){a.firstFrame=a.assetList.find(function(a){return"FIRSTFRAME"==a.assetSize});u(a);setTimeout(function(){EB.MediaGallery.init("a[rel=media-gallery-image]")},500)})}var q=a.observable(null),u=a.observable(null),x=a.observableArray([]),v=a.observableArray(),r=a.observableArray([]),w=a.observable(0),y=a.observableArray(),t=a.observable(),D=a.observableArray(),B=a.observable(),E=a.observable(null),z={level:null,
internalLevel:null,featuredAnimal:q,featuredVideo:u,feeds:v,articleList:r,currentArticle:w,videoList:y,currentVideo:t,nara:D,naraShowTwoDays:B,getDYKHtml:function(a){var b=(a.assetList[0].credit?'<span class="italic">'+a.assetList[0].credit+"</span>":"")+(a.title?'<br/><span id="media-title" class="italic">'+a.title+"</span>":"")+(a.caption?'<br/><span class="italic">'+a.caption+"</span>":"");a.transcript?(b+='<div id="transcriptToggle">',b+='<a id="show"><i class="fontello-icon-plus-squared"></i>'+
f.string("handlebar.media.show.transcript.text")+"</a>",b+='<a id="hide"><i class="fontello-icon-minus-squared"></i>'+f.string("handlebar.media.hide.transcript.text")+"</a>",b+="</div>",b+='<p id="transcript">'+a.transcript+"</p>"):b+="<div>"+f.string("media.video.no.transcript.text")+"</div>";b+='<div id="media-metadata" class="media-metadata" data-assembly-id="'+a.assemblyId+'" data-assembly-type="'+a.assemblyType+'"data-is-favorite="'+(void 0!=a.isFavorite?a.isFavorite:!1)+'">';a.articleList&&
Object.isArray(a.articleList)&&a.articleList.length&&(b+="<p>"+f.string("video.appears.in.articles")+"</p>",b+="<ul>",a.articleList.each(function(a){b+='<li><a class="media-metadata-level '+z.internalLevel+'" href="/levels/'+z.level+"/article/"+a.articleId+'">'+a.title+"</a></li>"}),b+="</ul>");return b+="</div>"},suggestedSearches:x,ARTICLE_SEARCH_URL:"/levels/{level}/search/articles?query={query}&page=1",showTranscript:function(){var a=e("#transcriptToggle");a.children("#hide").is(":visible")?(a.children("#show").show(),
a.children("#hide").hide(),e("#transcript").hide()):(a.children("#hide").show(),a.children("#show").hide(),e("#transcript").show())},isLoggedIn:!1,toolbar:a.observable(null),randomArticle:E};return{init:function(f,t){Date.setLocale(EB.shared.getLanguage());z.level=EB.shared.getLevelFromPath();z.internalLevel=f;z.country=EB.shared.getCountry();z.isLoggedIn=EB.shared.isLoggedIn();"escolar"===t&&("elementary"===f?(n(),p(),k(3)):(k(4),b(),m(),d(),c()),"high"===f&&(1==e("#other-products-menu ul li").length?
(e("#other-products-menu").show(),e("#other-products-singlelink-header").css("display","block"),e("#other-products-menu ul").addClass("singlelink")):1<e("#other-products-menu ul li").length&&(e("#other-products-menu").show(),e("#other-products-menu-header").css("display","block"),e("#other-products-menu-header").click(function(){2<e("#other-products-menu ul li").length&&e("#other-products-menu ul").css("right",e(window).width()-e("#other-products-menu").offset().left-e("#other-products-menu").outerWidth());
e("#other-products-menu ul").toggle();return!1}),e("#other-products-menu ul").addClass("multiplelink"))));"escola"===t&&"elementary"===f&&(p(),b(),c(),g(),h());(function(){a.applyBindings(z)}).delay(100)}}}(ko,jQuery,EB.i18n);EB=window.EB||{};
EB.learn=function(a,e){function f(){var c=this;h=EB.shared.getLevelFromPath();c.currentPage=ko.observable(0);c.isLoadMoreVisible=ko.observable(!0);c.isThistleLoading=ko.observable(!0);c.levelFilters=ko.observableArray();c.subjectFilters=ko.observableArray();c.refreshVisible=ko.observable(!1);c.lessonPlans=ko.observableArray();c.init=function(){a.each(g,function(a,b){c.levelFilters.push(new GenericItem(b.value,b.label,!0))});var b="/levels/{level}/lessons/edit/getSelectables".inject({level:h});a.getJSON(b,
function(d){EB.shared.writeInternalStats({url:b});a.each(d.subjectAreaGroups,function(b,d){a.each(d,function(a,b){c.subjectFilters.push(new GenericItem(b.id,b.name,!0))})});c.loadLessonPlans()})};c.uncheckAllLevels=function(){c.refreshVisible(!0);a.each(c.levelFilters(),function(a,b){b.checked(!1)})};c.subjectFiltersClicked=function(a){c.refreshVisible(!0);a.checked(!a.checked())};c.levelFiltersClicked=function(a){c.refreshVisible(!0);a.checked(!a.checked())};c.uncheckAllSubjects=function(){c.refreshVisible(!0);
a.each(c.subjectFilters(),function(a,b){b.checked(!1)})};c.applyFilters=function(){c.lessonPlans([]);0===c._getLevelFiltersChecked().length&&a.each(c.levelFilters(),function(a,b){b.checked(!0)});0===c._getSubjectFiltersChecked().length&&a.each(c.subjectFilters(),function(a,b){b.checked(!0)});c.currentPage(0);c.loadLessonPlans();c.refreshVisible(!1)};c.loadLessonPlans=function(){c.isThistleLoading(!0);var d=c._getLevelFiltersChecked(),e=c._getSubjectFiltersChecked(),f="/levels/{level}/user/content/lessonPlans/ajax/{page}".inject({level:h,
page:c.currentPage()});a.getJSON(f,{levels:d.join(","),subjects:e.join(","),publicView:!0},function(d){EB.shared.writeInternalStats({url:f});d=a.map(d,function(a){return new b(a)});a.each(d,function(a,b){c.lessonPlans.push(b)});0<d.length&&c.currentPage(c.currentPage()+1);10>d.length&&c.isLoadMoreVisible(!1);c.isThistleLoading(!1)})};c._getLevelFiltersChecked=function(){var b=[];a.each(c.levelFilters(),function(a,c){!0===c.checked()&&b.push(c.id)});return b};c._getSubjectFiltersChecked=function(){var b=
[];a.each(c.subjectFilters(),function(a,c){!0===c.checked()&&b.push(c.id)});return b}}var d=a("#sidebar-learn-refresh"),c=a("#sidebar-learn"),k,g=EB.i18n.resource("my.content.grade.ranges"),h;GenericItem=function(a,b,c){this.id=a;this.value=b;this.checked=ko.observable(c)};var b=function(a){var b=this;b.lessonPlanId=a.lessonPlanId;b.dateCreatedTimestamp=a.creationDate;b.title=a.title;b.objective=a.objective;b.subjectsExplanation=a.subjectsExplanation;b.levelIds=a.gradeIds;b.durationExplanation=a.durationExplanation;
b.authorExplanation=a.authorExplanation;this.dateCreated=function(){return EB.userContent.getNiceDate(b.dateCreatedTimestamp)};this.targetUrl=function(){return"/levels/{level}/lessons/view/{id}".inject({level:h,id:b.lessonPlanId})};b.getGradeLabel=function(){return EB.myContentUtils.getGradeLabelById(b.levelIds)}};return{init:function(){function b(c,e){a(c).click(function(){var b=a(e),c=a(this).html();"Uncheck all"==c?(b.attr("checked",!1),c="Check all"):(b.attr("checked",!0),c="Uncheck all");a(this).html(c);
d.removeClass("visuallyhidden");return!1})}c.on("click","a",function(a){c.attr("action",a.target.href).submit();return!1});a('#sidebar-learn input[type="checkbox"]').change(function(){d.removeClass("visuallyhidden")});b("#toggle-all-lm-level-filters","input[name=levels]");b("#toggle-all-lm-subject-filters","input[name=subjects]");EB.shared.getLevelFromPath();k=new f;k.init();ko.applyBindings(k)}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.LearningMaterialBrowse=function(a,e,f){return{init:function(){function d(a,c,d,g,h){c=c.toLowerCase().dasherize();var k=".learning-material-browse-results."+c;c={id:a,name:e.string("learning-material."+c),itemClass:"learning-material-browse-subject games-"+c,data:{results:ko.observableArray([])},template:"browse/results",templateClass:["learning-material-browse-results",c].join(" "),afterRender:function(){setTimeout(function(){EB.Tools.updateScrollControlBindings(f(k+" .results"),k,"li")},0)}};
f.get(b+(h?"?subjects="+a:""),function(a){Array.isArray(a)&&(a=a.sortBy(function(a){return a.title.remove(/[^a-z0-9]/gi)}));this.data.results(a);d.fetchedCount++;d.fetchedCount==d.subjectCount&&g(d)}.bind(c));return c}function c(b){b.each(function(a){a.data.results().length||b.remove(a)});k.navView=new a(b.reverse(),0,"","span4 browse-node browse-node-sub learning-material-browse-subjects",null,"span8 content browse-node-articles-content","row-fluid learning-material-browse");ko.applyBindings(k)}
var k={},g=EB.shared.getLevelFromPath(),h="/levels/{level}/learn/{type}/subjects/json".assign({level:g,type:"games"}),b="/levels/{level}/learn/{type}/json".assign({level:g,type:"games"});f.get(h,function(a){if(Object.isArray(a)){var b=[];b.fetchedCount=0;b.subjectCount=a.length+1;a.each(function(a){b.push(d(a.id,a.subject,b,c,!0))}.bind(this));b.push(d(0,"ALL_SUBJECTS",b,c))}});EB.Tools.init()}}}(EB.NavView,EB.i18n,jQuery);EB=window.EB||{};
EB.lessonPlanBuilder=function(a,e){function f(){a("body").off("click","a.media-gallery-text-trigger[rel=media-gallery]");a("body").on("click","a.media-gallery-text-trigger[rel=media-gallery]",function(){var b=a("a.media-gallery-text-trigger[rel=media-gallery]").index(a(this));EB.MediaGallery.goToIndex(b);return!1});EB.MediaGallery.init("a.media-gallery-image-trigger[rel=media-gallery]")}function d(){var a=r()&&v()?v().id:C.contentType().id,b=r()&&v()?"lp-favorites":"lp-search";switch(a){case "image":case "video":C.template(b+
"-result-media");break;case "article":C.template(b+"-result-article");break;default:C.template(b+"-result-other")}}function c(b){var c="/levels/{level}/user/content/ajax/getLpContent/{lessonPlanId}".inject({level:p,lessonPlanId:b.currLessonPlanId});a.getJSON(c,function(d){EB.shared.writeInternalStats({url:c});var e={};d=a.map(d,function(a){if(0!=a.itemId)return"ARTICLE"==a.favoriteType&&(e.ARTICLE=e.ARTICLE?e.ARTICLE+1:1),"ASSEMBLY"==a.favoriteType&&(e[a.assetType]=e[a.assetType]?e[a.assetType]+1:
1),"ADDITIONALCONTENT"==a.favoriteType&&(e[a.additionalContentType]=e[a.additionalContentType]?e[a.additionalContentType]+1:1),new A(a)});b.sortableResources(d);B(e)})}function k(b){var d=EB.shared.getUrlParameter("lessonPlanId");u=-1<window.location.href.indexOf("customize")?!0:!1;if(null!==d){d=parseInt(d,10);b.currLessonPlanId=d;b.isEditMode(!u);b.showResources(!0);var f="/levels/{level}/lessons/load/{lessonId}?customize=true";u||(f="/levels/{level}/lessons/load/{lessonId}?customize=false",w(EB.userContent.getSimplifiedContentTypes()));
var g=f.assign({level:p,lessonId:d});a.getJSON(g).then(function(c){EB.shared.writeInternalStats({url:g});b.lessonPlan(new G(c));c.gradeIds&&Array.isArray(c.gradeIds)&&c.gradeIds.length&&D(t.find(function(a){return a.value==c.gradeIds.sort(function(a,b){return a-b}).join(",")}));a.each(c.lessonArticles,function(a,c){b.addedResources.push({id:c.articleId,type:"ARTICLE"})});a.each(c.lessonAssemblies,function(a,c){b.addedResources.push({id:c.assemblyId,type:"ASSEMBLY"})});a.each(c.lessonAddcontent,function(a,
c){b.addedResources.push({id:c.addcontentId,type:c.addcontentTypeId})});0<c.additionalSteps.length?a.each(c.additionalSteps,function(a,c){b.procedures.push(new z(a+1,"",e.string("lessons.planning.procedures.placeholder"),c))}):b.procedures.push(new z(1,"",e.string("lessons.planning.procedures.placeholder"),""));0<c.materials.length?a.each(c.materials,function(a,c){b.materials.push(new z(a+1,"","",c))}):b.materials.push(new z(1,"",e.string("lessons.planning.materials.placeholder"),""));a.each(c.additionalInformation,
function(a,c){b.selectedAdditionalFields.push(new z(a,"","",c))})});c(b);I()}else b.lessonPlan(new G({subjectAreaIds:[""],procedures:[""],materials:[""],sharingStatusId:1})),b.procedures.push(new z(1,"",e.string("lessons.planning.procedures.placeholder"),"")),b.materials.push(new z(1,"",e.string("lessons.planning.materials.placeholder"),""))}function g(b,c){if(null!=b){b=parseInt(b,10);var d="/levels/{level}/lessons/load/pack/{packId}".assign({level:p,packId:b});a.getJSON(d).then(function(a){EB.shared.writeInternalStats({url:d});
c.lessonPlan(new G({title:a.title,subjectAreaIds:void 0!=a.subjectAreaIds?a.subjectAreaIds:[""],procedures:[""],materials:[""],sharingStatusId:1,keywords:a.keywords,description:a.description,tag:a.tag}));a.gradeIds&&Array.isArray(a.gradeIds)&&a.gradeIds.length&&D(t.find(function(b){return a.gradeIds.find(function(a){return b.value==a})}));q=b})}c.procedures.push(new z(1,"",e.string("lessons.planning.procedures.placeholder"),""));c.materials.push(new z(1,"",e.string("lessons.planning.materials.placeholder"),
""))}function h(a){D(null);a.durationMins.removeAll();a.durationDays.removeAll();a.subjectGroups.removeAll();a.additionalFields.removeAll();a.procedures.removeAll();a.materials.removeAll();a.selectedAdditionalFields.removeAll();a.showDetailError(!1);a.showSubjectError(!1);r(!0);I()}function b(b){h(b);var c="/levels/{level}/lessons/edit/getSelectables".inject({level:p});a.getJSON(c,function(d){EB.shared.writeInternalStats({url:c});b.durationMins.push(new E(0,""));b.durationDays.push(new E(0,""));a.each(d.durationTimes,
function(a,c){b.durationMins.push(new E(c.id,c.name))});a.each(d.durationMultipliers,function(a,c){b.durationDays.push(new E(c.id,c.name))});a.each(d.subjectAreaGroups,function(c,d){b.subjects=ko.observableArray();a.each(d,function(a,c){b.subjects.push(new E(c.id,c.name))});b.subjectGroups.push(new E(c,b.subjects()))});a.each(d.additionalInfos,function(a,c){b.additionalFields.push(new z(c.id,c.name,c.placeholder,c.value))})})}function m(b){var c="/levels/{level}/lessons/content/reorder/{lessonPlanId}".assign({level:p,
lessonPlanId:U.currLessonPlanId});a.ajax({type:"POST",url:c,data:JSON.stringify(b),contentType:"application/json",dataType:"json"}).done(function(a){EB.shared.writeInternalStats({url:c})}).fail(function(){})}function n(b){b.addProcedure=function(){b.procedures.push(new z(b.procedures().length+1,"","",""))};b.addMaterials=function(){b.materials.push(new z(b.materials().length+1,"","",""))};b.addAdditionalField=function(){var c=!1;0<b.selectedAdditionalFields().length&&b.selectedAdditionalFields().map(function(a){parseInt(a.id)===
b.selectedAddtnlField()&&(c=!0)});a.each(b.additionalFields(),function(a,d){b.selectedAddtnlField()==d.id&&(c||b.selectedAdditionalFields.push(new z(d.id,d.name,d.placeholder,d.value)))})};b.onSortChange=function(b){var c={};a(b).children().each(function(b,d){var e=a("> .content-item",d),f=e.data("id"),g=e.data("favoriteType"),e=e.data("additionalContentType"),h={};h.itemId=f;h.updatedSequence=b;h.additionalContentType=e;switch(g){case "article":c.articleSequenceUpdates=c.articleSequenceUpdates?c.articleSequenceUpdates:
[];c.articleSequenceUpdates.push(h);break;case "assembly":c.assemblySequenceUpdates=c.assemblySequenceUpdates?c.assemblySequenceUpdates:[];c.assemblySequenceUpdates.push(h);break;default:c.addcontentSequenceUpdates=c.addcontentSequenceUpdates?c.addcontentSequenceUpdates:[],c.addcontentSequenceUpdates.push(h)}});m(c)};b.saveAndPublishLessonPlan=function(a){smoke.confirm(e.string("lessons.planning.publish.confirm.message"),function(c){c&&(x=!0,b.saveLessonPlan(a))});return!1};b.saveLessonPlan=function(c){a(".lesson-plan-error").show();
var d=ko.validation.group(b,{deep:!0});if(b.lessonPlan().title.isValid()&&b.lessonPlan().selectedGradeRange.isValid())if(b.lessonPlan().subjectAreaIds.isValid()){b.showDetailError(!1);b.showSubjectError(!1);var e={},f={};Object.keys(c,function(b,c){"lessonPlan"==b&&a.each(c(),function(a,b){"selectedGradeRange"==a?e.gradeIds=[b().value]:e[a]=ko.isObservable(b)?b():b});if("procedures"==b||"materials"==b){var d=ko.isObservable(c)?c():c;e[b]=a.map(d,function(a){if(void 0!=a.value&&0<a.value.trim().length)return a.value})}"selectedAdditionalFields"==
b&&(d=ko.isObservable(c)?c():c,d.map(function(a){void 0!=a.value&&0<a.value.trim().length&&(f[a.id]=a.value)}))});e.additionalInformation=f;e.packId=q;e.customize=u;e.publish=x;var g="/levels/{level}/lessons/save".assign({level:p});a.ajax({type:"POST",url:g,data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:function(a){EB.shared.writeInternalStats({url:g});b.isEditMode()?window.location.href="/levels/{level}/lessons/view/{lessonId}".inject({level:p,lessonId:b.currLessonPlanId}):
window.location.href="/levels/{level}/user/content/lessonPlans".inject({level:p})},error:function(){smoke.alert("Error saving Lesson Plan")}})}else return d.showAllMessages(!0),b.showSubjectError(!0),a("#lp-subject-duration").css("height","auto"),!1;else return d.showAllMessages(!0),b.showDetailError(!0),a("#lp-details").css("height","auto"),!1};b.toggleAccordion=function(){a(".accordion-body").on({show:function(){var b=a(this);b.prev().children(".accordion-toggle").addClass("open");0<b.find("#resource-list").length&&
setTimeout(function(){f()},300)},hide:function(){a(this).prev().children(".accordion-toggle").removeClass("open")}})};b.targetUrl=function(a){var b=a.itemId?a.itemId:a.contentId;a="EBOOK"==a.additionalContentType?EB.userContent.generateFavoriteUrlGeneric("ADDITIONALCONTENT",null,b,a.additionalContentType,null,a.additionalContentIdentifier):"MAGAZINE"==a.additionalContentType?EB.userContent.generateFavoriteUrlGeneric("ADDITIONALCONTENT",null,b,a.additionalContentType):EB.userContent.generateFavoriteUrlGeneric(a.favoriteType,
a.level,a.itemId,a.additionalContentType,a.articleIdForAssembly,a.articleUrlTitle,a.additionalContentIdentifier);return a};b.contentDoesntExist=function(a){return EB.userContent.favoriteDoesntExistAnymore(a)};b.deleteContentFromLP=function(d){smoke.confirm(e.string("lessons.planning.delete.item.warning"),function(e){if(e){var f=d.favoriteType;"ADDITIONALCONTENT"==f&&(f=d.additionalContentType);a.post("/levels/{level}/lessons/content/{lessonPlanId}/remove/{contentType}".inject({level:p,lessonPlanId:b.currLessonPlanId,
contentType:f}),{itemId:d.itemId},function(a){a?(b.addedResources.remove(function(a){return a.id==d.itemId&&a.type==f}),c(b)):smoke.signal("Error deleting item.")})}});return!1}}var p,q=null,u=!1,x=!1,v=ko.observable(null),r=ko.observable(!0),w=ko.observableArray([]),y=ko.observable(!1),t=EB.i18n.resource("my.content.grade.ranges"),D=ko.observable(),B=ko.observableArray([]),E=function(a,b){this.id=a;this.value=b},z=function(a,b,c,d){this.id=a;this.name=b;this.placeholder=c;this.value=d},G=function(a){var b=
a.subjectAreaIds.map(function(a){return a+""});this.lessonPlanId=a.lessonPlanId;this.parentIndividualId=a.parentIndividualId;this.title=ko.observable(a.title).extend({required:{message:e.string("lessons.planning.title.required")}});this.selectedGradeRange=D.extend({required:{message:e.string("lessons.planning.grade.required")}});this.durationTimeId=ko.observable(a.durationTimeId);this.durationMultiplierId=ko.observable(a.durationMultiplierId);this.subjectAreaIds=ko.observableArray(b).extend({required:{message:e.string("lessons.planning.subject.required")}});
this.objective=ko.observable(a.objective);this.assessment=ko.observable(a.assessment);this.sharingStatusId=a.sharingStatusId;this.keywords=a.keywords;this.description=a.description;this.tag=a.tag},C={contentType:ko.observable(""),level:ko.observable(""),query:ko.observable(""),results:ko.observableArray([]),pageSize:ko.observable(10),pageNumber:ko.observable(1),totalResults:ko.observable(),template:ko.observable("")},I=function(){C.query("");C.level("");C.results([]);C.totalResults(0);C.template("");
C.contentType(null);v(w().find(function(a){return"article"==a.id}))},R=function(a){var b=[];try{C.totalResults(a.SearchResponseMessage.SearchResult.Statistics.TotalHits),a.SearchResponseMessage.SearchResult.Statistics.TotalHits&&a.SearchResponseMessage.SearchResult.Data.Records.Record.each(function(a){var c={};c.id=a.Header.An;a.Items.Item.each(function(a){switch(a.Label){case "Title":c.title=a.Data;break;case "Abstract":c.description=a.Data;break;case "Authors":c.author=a.Data.searchLink.content}});
b.push(c)})}catch(c){}C.results(b)},P=function(){y(!0);var b=v()?v().id:"all";if("image"==b||"video"==b)b="assembly/"+b;var c={pageSize:C.pageSize(),page:C.pageNumber()},e="/levels/{level}/user/content/favorites/ajax/{contentType}".inject({level:p,contentType:b});a.getJSON(e,c,function(a){EB.shared.writeInternalStats({url:e});y(!1);1<C.pageNumber()&&a&&!a.length?(C.pageNumber(C.pageNumber()-1),C.totalResults(C.pageSize()*C.pageNumber()-1)):(C.results(a||[]),C.totalResults(a.length<C.pageSize()?C.pageSize()*
C.pageNumber()-1:C.pageSize()*C.pageNumber()+1),d(),"assembly/video"!=b&&"assembly/image"!=b||setTimeout(function(){f()},300))})},l=function(){if(r()&&v())P();else if(C.contentType()&&C.contentType().id&&C.level().compact()&&C.query().compact()){y(!0);var b="/levels/{level}/collection/search".assign({level:p}),c={searchType:C.contentType().id.toUpperCase(),levelId:C.level(),query:C.query(),pageSize:C.pageSize(),pageNumber:C.pageNumber()};a.getJSON(b,c,function(a){EB.shared.writeInternalStats({url:b});
y(!1);"magazine"==C.contentType().id?R(a):(C.results(a.results||[]),C.totalResults(a.totalResults||0));d();"video"!=C.contentType().id&&"image"!=C.contentType().id||setTimeout(function(){f()},300)})}},L=function(){C.pageNumber(1);l()};C.quickSearch=function(){l()};C.next=function(){C.pageNumber(C.pageNumber()+1);l()};C.prev=function(){C.pageNumber(C.pageNumber()-1);l()};C.isAdded=function(a){var b=r()&&v()?v().id:C.contentType()?C.contentType().id:"article",b=b.toUpperCase();return U.addedResources().find(function(c){var d=
"IMAGE"==b||"VIDEO"==b?"ASSEMBLY":b;return c.id==a&&c.type==d})};C.addResources=function(b){var d=r()&&v()?v().id:C.contentType().id,d=d.toUpperCase(),f={sequence:0,itemId:b},g="/levels/{level}/lessons/content/{lessonPlanId}/add/{type}".inject({level:p,lessonPlanId:U.currLessonPlanId,type:d});a.post(g,f).done(function(a){0<parseInt(a,10)?(U.addedResources.push({id:b,type:"IMAGE"==d||"VIDEO"==d?"ASSEMBLY":d}),c(U)):smoke.alert(e.string("lessons.planning.alerts.content.can.not.be.added"))}).fail(function(){smoke.alert(e.string("lessons.planning.alerts.content.can.not.be.added"))})};
C.getSearchAdditionalContentUrl=function(a){if(C.contentType())return"ebook"==C.contentType().id?EB.userContent.generateFavoriteUrlGeneric("ADDITIONALCONTENT",parseInt(C.level(),10),a.additionalContentId,C.contentType().id.toUpperCase(),null,a.html_url):"website"==C.contentType().id?EB.userContent.generateFavoriteUrlGeneric("ADDITIONALCONTENT",parseInt(C.level(),10),a.id,C.contentType().id.toUpperCase(),null,a.url):EB.userContent.generateFavoriteUrlGeneric("ADDITIONALCONTENT",parseInt(C.level(),10),
a.id,C.contentType().id.toUpperCase(),null,a.identifier)};C.getSearchArticleUrl=function(a,b){b=b||parseInt(C.level(),10);return"/levels/{level}/article/{id}".inject({level:EB.userContent.getLevelFromArticleJsonLevel(b),id:a})};r.subscribe(I);C.contentType.subscribe(function(a){C.pageNumber(1);"image"==a||"video"==a?C.pageSize(20):C.pageSize(10);L()});C.level.subscribe(L);C.query.subscribe(L);v.subscribe(function(a){a&&L()});var A=function(a){this.level=a.level;this.favoriteType=a.favoriteType;this.itemId=
a.itemId;this.sequence=a.sequence;this.thumbUrl=a.thumbUrl;this.title=a.title?EB.userContent.removeTags(a.title):"This content is temporarily unavailable. Please try again later.";this.articleUrlTitle=a.urlTitle;this.description=EB.userContent.removeTags(a.description);this.credits=EB.userContent.removeTags(a.credits);this.additionalContentType=a.additionalContentType;this.additionalContentIdentifier=a.additionalContentIdentifier;this.fullUrl=a.fullUrl;this.assetType=a.assetType;this.articleIdForAssembly=
a.articleIdForAssembly;this.transcript=a.transcript;this.noTranscriptMsg="";this.isFavoritedAssembly=a.isFavoritedAssembly;this.duration=a.duration;"es"===EB.shared.getLanguage()&&(this.noTranscriptMsg=e.string("media.video.no.transcript.text"));this.isVideo=function(){return"VIDEO"==this.assetType?!0:!1};this.isAudio=function(){return"AUDIO"==this.assetType};this.addContentTypeReadable=function(){var a;a=this.additionalContentType;a="MAGAZINE"===a?e.string("mycontent.add-content-type.magazine"):
"EBOOK"===a?e.string("mycontent.add-content-type.primary-source"):"";return a};this.templateToUse=function(){return"ARTICLE"==this.favoriteType?"article-template":"ASSEMBLY"==this.favoriteType?"assembly-template":"addcontent-template"}},U={selectedAddtnlField:ko.observable(),selectedAdditionalFields:ko.observableArray(),localGrades:t,durationMins:ko.observableArray(),durationDays:ko.observableArray(),subjectGroups:ko.observableArray(),additionalFields:ko.observableArray(),procedures:ko.observableArray(),
materials:ko.observableArray(),simplifiedContentTypes:w,lessonPlan:ko.observable(null),isAddContentTypeFavorites:r,showErrors:ko.observable(!1),searchForm:C,currLessonPlanId:ko.observable(null),isEditMode:ko.observable(!1),addedResources:ko.observableArray(),sortableResources:ko.observableArray(),showResources:ko.observable(!1),selectedFavoriteTypeForAddingContent:v,isLoadingResults:y,showDetailError:ko.observable(!1),showSubjectError:ko.observable(!1),contentTypeCounts:B};return{init:function(){p=
EB.shared.getLevelFromPath();b(U);k(U);n(U);ko.validation.init({registerExtenders:!0,messagesOnModified:!0,insertMessages:!1});ko.applyBindings(U)},initLessonPlanFromPack:function(a,c){p=EB.shared.getLevelFromPath();b(c);g(a,c);n(c)}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.lessonplanView=function(a,e){function f(){var b=this;b.isThistleLoading=ko.observable(!1);b.favorites=k;b.lessonplanId;b.shortUrl=ko.observable("");b.isShowAllActive=ko.observable(!0);b.noTranscriptMsg="";"es"===EB.shared.getLanguage()&&(b.noTranscriptMsg=e.string("media.video.no.transcript.text"));b.init=function(){b.lessonplanId=a(".lessonplan-details").data("lessonplanId");var d="/levels/{level}/url/shorten".inject({level:c});a.ajax({type:"POST",url:d,data:{pathToShorten:"/levels/{level}/lessons/view/{lessonPlanId}".inject({level:c,
lessonPlanId:b.lessonplanId})},success:function(a){EB.shared.writeInternalStats({url:d});b.shortUrl(a)}});b.loadFavorites()};b.onFavoriteTypeChange=function(){b.loadFavorites()};b.loadFavorites=function(){b.isThistleLoading(!0);var d="/levels/{level}/user/content/ajax/getLpContent/{lpId}".inject({level:c,lpId:b.lessonplanId});a.getJSON(d,{page:1,pageSize:1E4,labelId:b.lessonplanId},function(c){EB.shared.writeInternalStats({url:d});b.favorites.removeAll();c=a.map(c,function(a){return new h(a)});a.each(c,
function(a,c){b.favorites.push(c)});b.isThistleLoading(!1)})};b.afterFavoritesForeach=function(){};b.contentDoesntExist=function(a){return EB.userContent.favoriteDoesntExistAnymore(a)};b.targetUrl=function(a){return EB.userContent.generateFavoriteUrl(a)};b.selectTextboxContents=function(a,b){b.target.select()};b.generateRelatedArticleLink=function(a,b){return"/levels/{level}/article/{articleId}".inject({level:EB.userContent.getLevelFromArticleJsonLevel(a),articleId:b})};b.getGradeRange=function(a){return EB.myContentUtils.getGradeLabel(a)}}
var d,c,k=ko.observableArray([]),g=function(b){b.length&&(EB.MediaGallery.init("a[rel=media-gallery-img]","Lesson Plan View Overlay"),a("a[rel=media-gallery-text]").click(function(){var b=a("a[rel=media-gallery-text]").index(a(this));EB.MediaGallery.goToIndex(b);return!1}))}.debounce(50);k.subscribe(function(a){g(a)});var h=function(a){this.favoriteType=a.favoriteType;this.id=a.savedContentId;this.title=a.title?EB.userContent.removeTags(a.title):"This content is temporarily unavailable. Please try again later.";
this.articleUrlTitle=a.urlTitle;this.dateCreatedTimestamp=a.dateCreated;this.description=EB.userContent.removeTags(a.description);this.imageCredits=EB.userContent.removeTags(a.imageCredits);this.imagePath=a.thumbUrl;this.contentId=a.itemId;this.level={elementary:"ONE",middle:"TWO",high:"THREE"}[a.level];this.articleIdForAssembly=a.articleIdForAssembly;this.assetType=a.assetType;this.fullImagePath=a.fullUrl;this.relatedArticles=a.relatedArticles;this.isFavoriteAssembly=a.favoritedAssembly;this.transcript=
a.transcript;this.subjects=a.subjects;this.grades=a.grades;this.duration=a.duration;this.author=a.author;this.fullLessonPlan=a.fullLessonPlan;this.additionalContentType=a.additionalContentType;this.additionalContentIdentifier=a.additionalContentIdentifier;this.labelNote=ko.observable(a.labelNote);this.addContentTypeReadable=function(){return EB.userContent.getReadableContentType(this.additionalContentType)};this.getAddcontentIcon=function(){return EB.userContent.getAddcontentIcon(this.additionalContentType)};
this.templateToUse=function(){return"ARTICLE"==this.favoriteType?"article-template":"ASSEMBLY"==this.favoriteType?"assembly-template":"LESSONPLAN"==this.favoriteType?"lessonplan-template":"addcontent-template"};this.dateCreated=function(){return EB.userContent.getNiceDate(this.dateCreatedTimestamp)};this.isVideo=function(){return"VIDEO"==this.assetType?!0:!1};this.isAudio=function(){return"AUDIO"==this.assetType}};return{initView:function(){c=EB.shared.getLevelFromPath();d=new f;d.init();ko.applyBindings(d);
if(0<a("#customize-lesson-plan").size())a("#customize-lesson-plan").on("click",function(){var b=a(this);smoke.confirm("After customizing, your lesson plan can be found in the My Lesson Plans tab of your My Content page.",function(a){a&&(window.location.href=b.attr("href"))});return!1})}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.lessons=function(a,e){function f(){var d=this;d.FIND_TAB="FIND_TAB";d.CHOOSE_TAB="CHOOSE_TAB";d.ORDER_TAB="ORDER_TAB";d.selectedTab=ko.observable(d.FIND_TAB);d.isThistleLoading=ko.observable(!1);d.isPreviewThistleLoading=ko.observable(!1);d.labels=ko.observableArray();d.selectedLabel=ko.observable();d.favorites=ko.observableArray();d.favoriteTypes=ko.observableArray();d.selectedFavoriteType=ko.observable();d.sortableItems=ko.observableArray();d.sortableModified=ko.observable(!1);d.articlesInLP=
ko.observableArray();d.assembliesInLP=ko.observableArray();d.addcontentsInLP=ko.observableArray();d.getAddContentTypeReadable=function(a){return EB.userContent.getReadableContentType(a.additionalContentType)};d.getAddContentIcon=function(a){return EB.userContent.getAddcontentIcon(a.additionalContentType)};d.getLessonPlanContentIcon=function(a){return"ARTICLE"===a.favoriteType?"fontello-icon-doc-inv":"ASSEMBLY"===a.favoriteType?"fontello-icon-picture":EB.userContent.getAddcontentIcon(a.addcontentType)};
d.getLessonPlanContentTypeReadable=function(a){return"ARTICLE"===a.favoriteType?"Article":"ASSEMBLY"===a.favoriteType?"Media":EB.userContent.getReadableContentType(a.addcontentType)};d.dateCreated=function(a){return EB.userContent.getNiceDate(a.dateCreatedTimestamp)};d.targetUrl=function(a){return EB.userContent.generateFavoriteUrl(a)};d.showFindTab=function(){d._cleanSlateForEditContent();d.selectedTab(d.FIND_TAB)};d.showChooseTab=function(){d._cleanSlateForEditContent();d.selectedTab(d.CHOOSE_TAB)};
d.showOrderTab=function(){d._cleanSlateForEditContent();d.selectedTab(d.ORDER_TAB);d._loadOrderedLPContent()};d.favoriteClick=function(c){if("ARTICLE"===c.favoriteType)d.isPreviewThistleLoading(!0),a("#preview-content").empty(),a("#preview-content").load("/levels/3/article/{itemId}/preview/500".inject({itemId:c.contentId}),function(){d.isPreviewThistleLoading(!1)});else if("ASSEMBLY"===c.favoriteType)"VIDEO"!=c.assetType&&b(c.fullImagePath,c.title,c.description,c.imageCredits);else{var e=EB.userContent.generateFavoriteUrl(c);
m(e,c.title)}};d.isFavoriteInLp=function(a){return"ARTICLE"===a.favoriteType?0>d.articlesInLP.indexOf(a.contentId)?!1:!0:"ASSEMBLY"===a.favoriteType?0>d.assembliesInLP.indexOf(a.contentId)?!1:!0:0>d.addcontentsInLP.indexOf(d._getUniqueAddcontentId(a))?!1:!0};d.contentDoesntExist=function(a){return EB.userContent.favoriteDoesntExistAnymore(a)};d.addToLessonPlan=function(b){a.post("/levels/{level}/lessons/content/{lessonPlanId}/add/{type}".inject({level:c,lessonPlanId:k,type:d.selectedFavoriteType().id}),
{sequence:0,itemId:b.contentId},function(a){-1<parseInt(a)&&("article"===d.selectedFavoriteType().id?d.articlesInLP.push(b.contentId):"assembly"===d.selectedFavoriteType().id?d.assembliesInLP.push(b.contentId):d.addcontentsInLP.push(d._getUniqueAddcontentId(b)))})};d.removeFavoriteFromLessonPlan=function(a){d._removeFromLessonpPlan(d.selectedFavoriteType().id,a.contentId)};d.removeSortableFromLessonPlan=function(a){var b=a.favoriteType;"ARTICLE"!==a.favoriteType&&"ASSEMBLY"!==a.favoriteType&&(b=a.addcontentType);
d._removeFromLessonpPlan(b,a.itemId,function(){d.sortableItems.remove(function(b){return b.itemId==a.itemId&&b.favoriteType==a.favoriteType&&b.addcontentType==a.addcontentType});d._loadLessonPlanContentIds()})};d.filterFavorites=function(){d._loadFavorites()};d.templateToUse=function(){return"article"===d.selectedFavoriteType().id?"article-template":"assembly"===d.selectedFavoriteType().id?"assembly-template":"addcontent-template"};d.saveOrder=function(){d._saveOrder()};d.sortableMoved=function(){d.sortableModified(!0)};
d.saveForLater=function(){d._saveOrder(function(){window.location.href="/levels/{level}/user/content/lessonPlans".inject({level:c})});return!1};d.saveAndContinue=function(){return d._saveOrder(function(){window.location.href="/levels/{level}/lessons/procedures/{lessonId}".inject({level:c,lessonId:k})})};d.showSortablePreview=function(c){if("ASSEMBLY"===c.favoriteType)"IMAGE"===c.assetType&&b(c.fullUrl,c.title,c.description,c.credit);else if("ARTICLE"===c.favoriteType)d.isPreviewThistleLoading(!0),
a("#preview-content").empty(),a("#preview-content").load("/levels/3/article/{itemId}/preview/500".inject({itemId:c.itemId}),function(){d.isPreviewThistleLoading(!1)});else{var e=EB.userContent.generateFavoriteUrlGeneric(c.favoriteType,c.level,c.itemId,c.addcontentType,0,c.additionalContentIdentifier);m(e,c.title)}};d._saveOrder=function(b){var e={articleSequenceUpdates:[],assemblySequenceUpdates:[],addcontentSequenceUpdates:[]},f=0;a.each(d.sortableItems(),function(a,b){"ARTICLE"==b.favoriteType?
e.articleSequenceUpdates.push({itemId:b.itemId,updatedSequence:f}):"ASSEMBLY"==b.favoriteType?e.assemblySequenceUpdates.push({itemId:b.itemId,updatedSequence:f}):e.addcontentSequenceUpdates.push({itemId:b.itemId,updatedSequence:f,additionalContentType:b.addcontentType});f++});var g="/levels/"+c+"/lessons/content/reorder";a.ajax({type:"POST",url:g,data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:function(){EB.shared.writeInternalStats({url:g});d.sortableModified(!1);b&&
b()},error:function(){return!1}})};d._removeFromLessonpPlan=function(b,e,f){a.post("/levels/{level}/lessons/content/{lessonPlanId}/remove/{type}".inject({level:c,lessonPlanId:k,type:b}),{itemId:e},function(a){1==a&&("article"===b?d.articlesInLP.remove(function(a){return a==e}):"assembly"===b?d.assembliesInLP.remove(function(a){return a==e}):d.addcontentsInLP.remove(function(a){return a==b+":"+e}),f&&f())})};d._loadFavorites=function(){var b={page:1,pageSize:1E4};void 0!=d.selectedLabel()&&(b.labelId=
d.selectedLabel().id);d.isThistleLoading(!0);d.favorites.removeAll();var e="/levels/{level}/user/content/favorites/ajax/{type}".inject({level:c,type:d.selectedFavoriteType().id});a.getJSON(e,b,function(b){EB.shared.writeInternalStats({url:e});b=a.map(b,function(a){return new w(a)});a.each(b,function(a,b){d.favorites.push(b)});d.isThistleLoading(!1)})};d._loadAllLabels=function(b){var e="/levels/{level}/user/content/allLabels".inject({level:c});a.getJSON(e,function(c){EB.shared.writeInternalStats({url:e});
c=a.map(c,function(a){if(0!=a.id)return new v(a.id,a.text)});d.labels(c);b&&b()})};d._loadLessonPlanContentIds=function(){var b="/levels/{level}/lessons/view/ajax/{lessonPlanId}".inject({level:c,lessonPlanId:k});a.getJSON(b,function(c){EB.shared.writeInternalStats({url:b});d.articlesInLP(a.map(c.articleIds,function(a){return a}));d.assembliesInLP(a.map(c.assemblyIds,function(a){return a}));d.addcontentsInLP(a.map(c.addcontentIds,function(a){return a}))})};d._loadOrderedLPContent=function(b){var e=
"/levels/{level}/user/content/ajax/getLpContent/{lessonPlanId}".inject({level:c,lessonPlanId:k});a.getJSON(e,function(c){EB.shared.writeInternalStats({url:e});c=a.map(c,function(a){if(0!=a.id)return new y(a)});d.sortableItems(c);b&&b()})};d._getUniqueAddcontentId=function(a){return a.additionalContentType+":"+a.contentId};d._cleanSlateForEditContent=function(){a("#preview-content").empty()};d.init=function(){d.favoriteTypes().add([new r("article",e.string("lessons.search.type.article")),new r("assembly",
e.string("lessons.search.type.images-and-videos")),new r("magazine",e.string("lessons.search.type.magazines")),new r("ebook",e.string("lessons.search.type.primarysources")),new r("lm_study_guides",e.string("lessons.search.type.studyguides")),new r("lm_visual_learning",e.string("lessons.search.type.visuallearning")),new r("lm_manipulatives",e.string("lessons.search.type.manipulatives")),new r("lm_interactive_lessons",e.string("lessons.search.type.interactivelessons")),new r("lm_games",e.string("lessons.search.type.games"))]);
d._loadAllLabels(d._loadLessonPlanContentIds);d._loadOrderedLPContent(function(){0<d.sortableItems().length&&d.selectedTab(d.ORDER_TAB)})}}var d,c,k,g=1,h=function(a){var b=/^(.*)([0-9])+/g.exec(a);a=b[1];b=parseInt(b[2]);return a+(b+1)},b=function(b,c,d,e){var f=a("#preview-content");f.empty();var g=document.createElement("img");g.setAttribute("src",b);g.setAttribute("alt","preview image");f.append(g);b=a("#preview-content");b.prepend("<h3>"+c+"</h3>");b.append("<p class='credits'>"+e+"</p>");b.append("<p>"+
d+"</p>")},m=function(b,c){var d=a("#preview-content");d.empty();d.prepend("<h3>"+c+"</h3>");d.append("<p>No Preview available. Click on the link below to go to the Additional Content page.</p>");d.append('<a href="'+b+'" target="_blank">Click Here <i class="fontello-icon-link-ext"></i><a>')},n=function(b){var e=a("#search-type").val(),f=a("#search-level").val(),h=a.trim(a("#quick-search-text").val());g=b;var k="ARTICLE"===e?6:20;"LM_STUDY_GUIDES"===e||"LM_VISUAL_LEARNING"===e||"LM_MANIPULATIVES"===
e||"LM_INTERACTIVE_LESSONS"===e||"LM_GAMES"===e||"EBOOK"===e?k=6:"MAGAZINE"==e&&(k=3);h&&(b="/levels/"+c+"/lessons/search/?pageNumber="+b+"&pageSize="+k+"&query="+encodeURIComponent(h)+"&searchType="+e+"&levelToSearch="+f,a("#simple-search-results").load(b,function(){var b=null,b="ARTICLE"==e?d.articlesInLP():"VIDEO"==e||"IMAGE"==e?d.assembliesInLP():d.addcontentsInLP();x(b);a("#quick-search-prev").click(function(a){a.preventDefault();n(g-1)});a("#quick-search-next").click(function(a){a.preventDefault();
n(g+1)});a("#lesson-finder .item-content").click(function(){var b=a(this).data("itemType"),c=a(this).data("itemId"),d=a(this).data("title");"IMAGE"!==b&&"VIDEO"!==b&&("ARTICLE"===b?(a("#preview-content").empty(),a("#preview-content").load("/levels/3/article/{itemId}/preview/500".inject({itemId:c}))):(b=a(this).children("a")[0].href,m(b,d)))})}))},p=function(b){b=a(b.target).closest(".lesson-plan-result-status");var e=parseInt(b.data("itemId")),f=b.data("itemType");b.data("includedInLesson")?(b.removeClass("active"),
b.children(".added").hide(),b.children(".add").show(),b.data("includedInLesson",!1),q(k,e,f)):(u(b),a.post("/levels/"+c+"/lessons/content/"+k+"/add/"+("IMAGE"==f||"VIDEO"==f?"ASSEMBLY":f),{itemId:e,sequence:d.articlesInLP().length+d.assembliesInLP().length+d.addcontentsInLP.length}));return!1},q=function(b,e,f){b=f;"ARTICLE"==f?d.articlesInLP.remove(function(a){return a==e}):"IMAGE"==f||"VIDEO"==f?(b="ASSEMBLY",d.assembliesInLP.remove(function(a){return a==e})):d.addcontentsInLP.remove(function(a){return a==
e});a.post("/levels/"+c+"/lessons/content/"+k+"/remove/"+b,{itemId:e})},u=function(a){a.addClass("active");a.children(".added").show();a.children(".add").hide();a.data("includedInLesson",!0)},x=function(b){a(".results span.label").each(function(c,d){var e=a(d),f=parseInt(e.data("itemId"));-1<a.inArray(f,b)&&u(e)})},v=function(a,b){this.id=a;this.text=ko.observable(b);this.isActive=ko.observable(!1)},r=function(a,b){this.id=a;this.label=b},w=function(b){this.favoriteType=b.favoriteType;this.id=b.savedContentId;
this.title=b.title?EB.userContent.removeTags(b.title):"This content is temporarily unavailable. Please try again later.";this.dateCreatedTimestamp=b.dateCreated;this.description=EB.userContent.removeTags(b.description);this.imageCredits=EB.userContent.removeTags(b.imageCredits);this.imagePath=b.imagePath;this.contentId=b.contentId;this.level=b.level;this.articleId=b.articleId;this.assetType=b.assetType;this.fullImagePath=b.fullImagePath;this.transcript=b.transcript;this.duration=b.duration;this.noTranscriptMsg=
"";this.additionalContentType=b.additionalContentType;this.additionalContentIdentifier=b.additionalContentIdentifier;this.labels=ko.observableArray(a.map(b.labels,function(a){return new v(a.id,a.text)}));"es"===EB.shared.getLanguage()&&(this.noTranscriptMsg=e.string("media.video.no.transcript.text"))},y=function(a){this.level=a.level;this.favoriteType=a.favoriteType;this.itemId=a.itemId;this.sequence=a.sequence;this.thumbUrl=a.thumbUrl;this.title=a.title?EB.userContent.removeTags(a.title):"This content is temporarily unavailable. Please try again later.";
this.description=EB.userContent.removeTags(a.description);this.credits=a.credits;this.addcontentType=a.additionalContentType;this.additionalContentIdentifier=a.additionalContentIdentifier;this.fullUrl=a.fullUrl;this.assetType=a.assetType;this.transcript=a.transcript;this.noTranscriptMsg="";"es"===EB.shared.getLanguage()&&(this.noTranscriptMsg=e.string("media.video.no.transcript.text"));this.getThumbFile=function(){return void 0!==this.thumbUrl&&""!==this.thumbUrl?this.thumbUrl:"/resources/img/default_preview_thumb.png"}};
return{initProjectDetails:function(){a(".lesson-mid-text").placeholder();a("#btn-save-and-continue,#btn-save-for-later").click(function(){a("#title, #gradeLevels, #subjects").closest(".control-group").removeClass("error").end().tooltip("hide");var b=!0;""==a("#title").val()&&(a("#title").closest(".control-group").addClass("error"),a("#title").tooltip("show"),b=!1);""==a("#gradeLevels").val()&&(a("#gradeLevels").closest(".control-group").addClass("error"),a("#gradeLevels").tooltip("show"),b=!1);0==
a("#subjectsDiv input:checked").length&&(a("#subjects").closest(".control-group").addClass("error"),a("#subjects").tooltip("show"),b=!1);return b})},initEditContent:function(){c=EB.shared.getLevelFromPath();k=a("#lesson-finder").data("lessonId");d=new f;d.init();ko.applyBindings(d);a("#quick-search-text").placeholder();a("#quick-search-search-controls").on("click","button",function(){a("#preview-content").empty()});a("#search-type").change(function(b){a("#search-type option:selected").each(function(){a(this).val()})});
a("#quick-search-text").bind("keypress",function(a){13==a.keyCode&&n(1)});a("#quick-search-search-controls button").on("click",function(){n(1)});a("#simple-search-results").delegate(".lesson-plan-result-status,.add,.added","click",p)},initMaterials:function(){a(".additional-type-text").placeholder();a("#additional-information-buttons").on("click","li",function(b){b.preventDefault();a("#additional-information-buttons li").removeClass("active");b=a(b.target);b.parent("li").addClass("active");b=b.data("additionalTypeId");
a(".additional-type-text").addClass("hidden");a('.additional-type-text[data-additional-type-id="'+b+'"]').removeClass("hidden")});a("#add-material-button").click(function(b){b.preventDefault();b=a(".material-container").last();var c=b.clone(),d=c.find("input:text"),e=c.find(".item-label");d.val("");e.html(h(e.html()));c.insertAfter(b)});a("#saveAndContinue").click(function(){smoke.confirm("Publishing your lesson plan means it will be made available for other educators to view on Britannica School. <br> Click OK to proceed with publishing, or Cancel to return to the Lesson Plan Builder. ",
function(b){b&&(a("#hiddenSaveAndContinue").val("Save and Publish"),a("#lessonPlanMaterialsAndMisc").submit())});return!1})},initProcedures:function(){a("#add-procedure-textarea-button").click(function(b){b.preventDefault();b=a(".procedure-container").last();var c=b.clone(),d=c.find("textarea"),e=c.find("label");d.html("");var f=h(d.attr("id"));d.attr("id",f);e.attr("for",f);e.html(h(e.html()));c.insertAfter(b)})},initView:function(){a(".lesson-plan-content").click(function(){window.open(a(this).data("url"),
"_blank");window.focus()})}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.middleHomePage=function(a,e,f){function d(){f.resource("home."+w+".feed.news").each(function(a){e.getJSON("/levels/{level}/feed/{name}/{count}/ajax".assign({level:F.level,name:a.name,count:a.count})).then(function(b){b&&Object.isArray(b)&&(y().push({name:a.name,items:b}),y.valueHasMutated())})})}function c(){var a=f.resource("home.primary.sources.path"),b={},c=[];e.getJSON(a).then(function(a){a&&a.links&&Object.isArray(a.links)&&a.links.each(function(a){a={text:a.text,url:a.id&&a.path?"/levels/{level}/additionalcontent/primarysources?id={id}&path={path}".assign({id:a.id,
path:a.path,level:F.level}):""};c.push(a)});b.links=c;b.keywords=a.keywords;R(b)})}function k(a){return D().length?e._Deferred().resolve():e.getJSON("/levels/{level}/feature-order/ajax?featureIds={featureIds}&overrideDate={overrideDate}".assign({level:F.level,featureIds:a,overrideDate:Q()}))}function g(){P||(P=e.getJSON("/levels/{level}/compare-countries/ajax?overrideDate={overrideDate}".assign({level:F.level,overrideDate:Q()})));return P}function h(){var a=f.resource("home."+w+".nara.count");return e.getJSON("/levels/{level}/new-and-revised-articles/ajax?count={count}".assign({level:F.level,
count:a}))}function b(){var a;a=t()?e._Deferred().resolve():e.getJSON("/levels/{level}/components/ajax?overrideDate={overrideDate}".assign({level:F.level,overrideDate:Q()}));a.then(function(a){if(Object.isArray(a)){a=a.each(function(a){a.heroSpace=a.assetList.find(function(a){return"HEROSPACE_ONLINE"==a.assetSize});a.heroSpaceThumb=a.assetList.find(function(a){return"HEROSPACE_THUMB"==a.assetSize});a.fullSize=a.assetList.find(function(a){return"FULLSIZE"==a.assetSize});a.firstFrame=a.assetList.find(function(a){return"FIRSTFRAME"==
a.assetSize})});t(a.groupBy(function(a){return a.componentType}));var b=[];Object.keys(t(),function(a,c){Object.isArray(c)&&c.length&&b.push(c[0].featureId)});b.length&&k(b.join(",")).then(function(a){a&&Object.isArray(a)&&D(a)});r()}})}function m(){g().then(function(a){B(a)})}function n(){var a;a=E().length?e._Deferred().resolve():e.getJSON("/levels/{level}/places/ajax".assign({level:F.level}));a.then(function(a){a&&Object.isArray(a)&&E(a);g().done(function(){E().length&&B()&&B().placeIds&&(l(E().find(function(a){return a.placeId==
B().placeIds[0]})),L(E().find(function(a){return a.placeId==B().placeIds[1]})))})})}function p(){var a;a=z()?e._Deferred().resolve():e.getJSON("/levels/{level}/browse/biography/bio-browse-filters/ajax".assign({level:F.level}));a.then(function(a){z(a)})}function q(){e.getJSON("/levels/{level}/featured-bio/ajax?overrideDate={overrideDate}".assign({level:F.level,overrideDate:Q()})).then(function(a){G(a)})}function u(){h().then(function(a){C(a)})}function x(){e.getJSON("/levels/{level}/buzzword/ajax?overrideDate={overrideDate}".assign({level:F.level,
overrideDate:Q()})).then(function(a){I(a)})}function v(){var a=location.hash+"_CAROUSEL";e(a).length&&e("html, body").animate({scrollTop:e(a).offset().top-50},500)}function r(){setTimeout(function(){EB.MediaGallery.init("a.media-gallery-link")},100)}var w,y=a.observableArray([]),t=a.observable(),D=a.observableArray([]),B=a.observable(),E=a.observableArray([]),z=a.observable(),G=a.observable(null),C=a.observableArray([]),I=a.observable(),R=a.observableArray(),P,l=a.observable(null),L=a.observable(null),
A=a.observable(null),U=a.observable(null),H=a.observable(null),Q=a.observable(""),F={level:null,feeds:y,components:t,featureOrder:D,compareCountries:B,places:E,bioFilters:z,featuredBio:G,nara:C,buzzword:I,firstSelectedCountry:l,secondSelectedCountry:L,selectedEra:A,selectedNationality:U,selectedActivity:H,primarySources:R,toolbar:a.observable(null),levels:["elementary","middle","high"],goToIndex:function(a){EB.MediaGallery.goToIndex(a)},initMediaGallery:r};return{init:function(e){w=e;F.level=EB.shared.getLevelFromPath();
F.internalLevel=w;F.country=EB.shared.getCountry();e=Object.fromQueryString(window.location.href);Q(e&&e.overrideDate?e.overrideDate:"");"onhashchange"in window&&(window.onhashchange=v);(function(){v()}).delay(500);a.applyBindings(F);d();b();m();n();p();q();u();c();x()}}}(ko,jQuery,EB.i18n);EB=window.EB||{};
EB.multiTemplateHomepage=function(a){var e=a("#homepage-template-carousel"),f=a("#show-more-browse"),d=a("#homepage-browse-content"),c=a(".carousel-inner"),k=a(".video-container").data("poster"),g=a(".video-container").data("mimeType"),h=a(".video-container").data("videoUrl"),b=!1,m=function(){var b=null,d=!1,f=!1,g=function(){d||f||e.carousel("next")},h=function(){clearInterval(b);e.carousel("pause");b=setInterval(g,1E4)};e.carousel({interval:1E4,pause:"hover"});h();a(".slider-button-container > li").on("click",
function(){var b=Number(a(this).data("slideTo"));a(".slider-button.active").removeClass("active");a(this).addClass("active");e.carousel(b)});e.bind("slid",function(){n();d&&(d=!1);h();a(".slider-button.active").removeClass("active");var b=a("#homepage-template-carousel .item.active").index();a(".slider-button-container li:eq("+b+")").addClass("active")});c.click(function(){d=!0});c.hover(function(){f=!0;clearInterval(b);e.carousel("pause")},function(){f=!1;h()})},n=function(){if(!b){var c=a("#articleVocab .image-container img").height();
if(0!=c){var d=a("#articleVocab .image-container").height();a("#articleVocab .image-container").find("img").css("margin-top",-((c-d)/2));b=!0}}},p=function(){767<window.innerWidth&&980>window.innerWidth||513>window.innerWidth?a(".video-container").empty().html(Handlebars.templates["media/video"]({src:h,type:g,width:315,height:177,poster:k,autoplay:"false"})).find("video").mediaelementplayer():a("#videoDyk").find("video").mediaelementplayer()},q=function(b){var c=a("#news-container");if(0!==c.length){var d=
c.data("feeds"),c=c.data("count");a("#news-container-content").load("/levels/"+b+"/feed/"+d+"/"+c+"?fromPage=homepage")}},u=function(){var a=d.find("ul").height(),b=980<window.innerWidth?"-114":768>window.innerWidth&&6<d.find("ul").children().length?"-272":"-134";d.animate({height:a,marginTop:b},1E3,function(){});f.children("#expand").hide();f.children("#collapse").show()},x=function(){f.children("#collapse").is(":visible")&&(d.animate({height:160,marginBottom:980>window.innerWidth?"-50":"-20",marginTop:"20"},
1E3,function(){}),f.children("#expand").show(),f.children("#collapse").hide())},v=function(){var a=980>window.innerWidth?"-50px":"-20px";d.height("160px").css("margin-top","20px").css("margin-bottom",a);f.children("#expand").show();f.children("#collapse").hide();160<d.find("ul").height()?f.css("visibility","visible"):f.css("visibility","hidden")};return{init:function(c){EB.handlebars.init(Handlebars);m();"elementary"===c&&(n(),p(),a(window).load(function(){v();!a.storage.get("stopBrowseCtnAnimation")&&
160<d.find("ul").height()&&(u(),window.setTimeout(function(){x()},2E3),a.storage.set("stopBrowseCtnAnimation",!1,!1))}),q(c),a(window).resize(function(){v();p();b=!1;n()}),a(document).click(function(b){"homepage-browse-content"!=a(b.target).closest("div").attr("id")&&x()}),a(document).on("mejs-enter-fullscreen",function(){a("html").addClass("mejs-fullscreen")}),a(document).on("mejs-exit-fullscreen",function(){a("html").removeClass("mejs-fullscreen")}),f.on("click",function(){a(this).children("#expand").is(":visible")?
u():x()}),a("#articleVocab .btn, #nameIt .btn, #browseSubjects .btn, #videoDyk .btn, #wordWall .word .btn, #compareCountries .btn, #pickAPic a.reveal-answer").on("click",function(){var b=a(this).data("position");a(this).parent().parent().siblings(".pos"+b).removeClass("hidden");a(this).closest("ul").children().hide()}),a(".partOfSpeech a").on("click",function(){a(".wordInformation").addClass("hidden");a("#wordWall").find("ul.results").children().show()}))}}}(jQuery);EB=window.EB||{};
EB.myContentUtils=function(a){function e(a){return d.find(function(d){return a.find(function(a){return d.value==a})})}function f(a){return d.find(function(d){return d.value==a})}var d=a.resource("my.content.grade.ranges");return{getGradeLabel:function(a){return(a=e(a))&&a.label},getGradeLabelById:function(a){return(a=f(a))&&a.label}}}(EB.i18n);EB=window.EB||{};
EB.myPacks=function(a,e,f){function d(){t||(t=e.getJSON("/resourcepacks/load/subjects").done(function(a){Object.keys(a,function(a,b){b.forEach(function(a){a.territory.territoryName==k.toLowerCase()&&p.push({id:a.id,name:a.name})})})}));return t}function c(){e(window).on("scroll",function(){m&&e(window).scrollTop()+100>=e(document).height()-e(window).height()&&(w.pageNumber(w.pageNumber()+1),y())})}var k=e("body").data("country"),g=EB.i18n.resource("my.content.grade.ranges");f=EB.i18n.resource("my.packs.sort.filter");
var h=ko.observable(!1),b=ko.observable(!0),m=!1,n=ko.observableArray([]),p=[],q=ko.observable(null),u=null,x={article:"fontello-icon-list",image:"fontello-icon-picture",video:"fontello-icon-video",ebook:"fontello-icon-edit",interactive:"fontello-icon-retweet",magazine:"fontello-icon-book",website:"fontello-icon-bookmark",document:"fontello-icon-doc",link:"fontello-icon-link"},v=function(a){var b=ko.observable(),c=ko.observable();a.gradeIds&&Array.isArray(a.gradeIds)&&a.gradeIds.length&&b(g.find(function(b){return a.gradeIds.find(function(a){return a==
b.value})}));a.subjectIds&&Array.isArray(a.subjectIds)&&a.subjectIds.length&&c(p.find(function(b){return a.subjectIds.find(function(a){return a==b.id})}));var d=ko.computed(function(){return Object.findAll(a.contentTypeCounts,function(a,b){return!!b&&"ASSEMBLY"!=a})});n=ko.computed(function(){var a=Object.values(Object.map(d(),function(a,b){return{key:a,count:b,order:Object.keys(x).indexOf(a.toLowerCase()),icon:x[a.toLowerCase()]}})).sortBy("order");if(a&&6<a.length){var b,c=a[a.length-1].key.toLowerCase();
if("document"==a[a.length-2].key.toLowerCase())b=a.slice(0,4).concat(a.slice(a.length-2));else if("document"==c||"link"==c)b=a.slice(0,5).concat(a.slice(a.length-1));return b}return a});this.packId=a.packId;this.text=a.text;this.subject=c;this.gradeRange=b;this.packImgUrl=a.packImgUrl;this.contentTypeCounts=n;this.icons=x;this.isFavorite=a.isFavorite},r=function(){w.pageNumber(1);return y()}.debounce(100),w={pageSize:ko.observable(40),pageNumber:ko.observable(1),isCustom:ko.observable(!1),allSorts:f,
selectedSort:ko.observable("date"),myResourcePacks:ko.observableArray(),refreshPacks:r,isLoadingResults:b,noPackMessage:h,remove:function(a,b){b.stopImmediatePropagation();q(a);return!1},cancelRemove:function(a,b){b.stopImmediatePropagation();q(null);return!1},proceedToRemove:function(a,b){b.stopImmediatePropagation();var c=a.isFavorite?"/resourcepacks/favorite?packId={packId}".assign({packId:a.packId}):"/resourcepacks/delete/pack/{packId}".assign({packId:a.packId});e.ajax({type:"DELETE",url:c,dataType:"json",
success:function(b){b&&(w.myResourcePacks.remove(function(b){return b.packId==a.packId}),setTimeout(function(){r()},100))}});return!1},toBeRemoved:q};w.selectedSort.subscribe(function(){u.setRoute("/"+(w.selectedSort()||"All")+"/"+(w.isCustom()?"custom":"All"))}.debounce(100));w.isCustom.subscribe(function(){u.setRoute("/"+(w.selectedSort()||"All")+"/"+(w.isCustom()?"custom":"All"))}.debounce(100));var y=function(){b(!0);m=!1;h(!1);var a={pageNum:w.pageNumber(),pageSize:w.pageSize(),sortType:w.selectedSort()&&
"All"!=w.selectedSort()?w.selectedSort():"date",isCustom:w.isCustom()};return e.getJSON("/resourcepacks/getMyPacks",a).done(function(a){if(a)if(a.packs){var c=e.map(a.packs,function(a){return new v(a)});1<w.pageNumber()?e.each(c,function(a,b){w.myResourcePacks.push(b)}):w.myResourcePacks(c);a.totalCount>w.pageNumber()*w.pageSize()&&(m=!0);b(!1);h(!1)}else b(!1),m=!1,h(!0)})}.debounce(100),t=null,D=!0,B={"/":function(){d().done(function(){y()});arguments[arguments.length-1]();D?D=!1:EB.packDisplayShared.stats()},
"/:sort":function(a){w.selectedSort(a);2==arguments.length&&w.pageNumber(1);arguments[arguments.length-1]()},":sort/:filter":function(a,b){"custom"==b?w.isCustom(!0):w.isCustom(!1);w.pageNumber(1)}};return{init:function(){u=(new a(B)).configure({strict:!1,recurse:"forward",async:!0});u.init("/");ko.applyBindings(w);c();e(function(){e.scrollDepth({gtmOverride:!0,userTiming:!1})});EB.Sticky.init(".my-pack-browse-subheader",94)}}}(Router,jQuery,EB.i18n);EB=window.EB||{};
EB.articleOverlay=function(a,e,f,d){function c(){var a=979<window.innerWidth&&null!=document.querySelector(".navbar.navbar-fixed-top")?document.querySelector(".navbar.navbar-fixed-top").offsetHeight:0;if(I()){var b=window.innerHeight-a,c=document.querySelector(".article-overlay"),d=c.querySelector(".article-container"),e=d.querySelector(".article-overlay-left");c.style.top=a+"px";d.style.height=b+"px";e&&(e.style.minHeight=b+"px");A&&k()}}function k(){var a=document.querySelector(".article-overlay .article-container .article-overlay-left"),
b=document.querySelector(".article-overlay .article-container .article-overlay-right");b&&(b.style.height=a.offsetHeight+"px")}function g(){var a=document.querySelector(".article-content .levels-ctn .levels");if(a=a&&a.getElementsByClassName("level")){for(var b=0;b<a.length;b++)if(a[b].className.match(/(?:^|\s)active(?!\S)/))return a[b].getAttribute("data-level");return""}}function h(){function a(){var b=f(this).parents(".section-group");b.addClass("open");p(b)}function b(){var a=f(this).parents(".section-group");
a.find(".tts-play-stop").hasClass("playing")&&(a.find(".tts-play-stop").removeClass("playing"),EB.tts.stop());a.removeClass("open")}var c=f(".collapse"),d={show:a,hide:b};c.off("show",a);c.off("hide",b);A&&(c.off("hidden",k),c.off("shown",k),d.shown=k,d.hidden=k);c.on(d)}function b(){var a=P()&&P().tocId;if(a){var b=document.getElementsByClassName("section-toggle");(b=Array.prototype.slice.call(b).findIndex(function(b){return b.getAttribute("href").slice(1)==a}))&&n(b)}}function m(){var a=document.getElementsByClassName("section-toggle"),
b=document.querySelector(".article-overlay-right");2>a.length?(document.querySelector(".article-toc").style.display="none",b.className.match(/(?:^|\s)has-no-toc(?!\S)/)||(b.className+=" has-no-toc")):(b.className=b.className.replace(/(?:^|\s)has-no-toc(?!\S)/,""),a=Array.prototype.map.call(a,function(a,b){var c="",d=a.innerText||a.textContent;0===b&&(c="selected");return'<li><a data-bind="click: function () { openAccordionSection('+b+')}" href="#" class="'+c+'">'+d+"</a></li>"}).join(""),a="<ul data-bind=\"expandable: { more: '.show-more', less: '.show-less', height: 175 }\" class=\"collapse expanded\">"+
a+"</ul>",b=document.querySelector(".article-toc").querySelector(".article-toc-links"),b.innerHTML=a+b.innerHTML,e.applyBindings({openAccordionSection:n},b))}function n(a){var b=979<f(window).width()?f(".navbar.navbar-fixed-top").height():0;f(".section-toggle").eq(a).parents(".section-group").find(".collapse").collapse("show");f(".article-container").animate({scrollTop:f(".section-toggle").eq(a).offset().top-b},300)}function p(a){a=a||f(".section-group").first();if(!a||!a.data("carouselBuilt")){var b=
a.find(".assembly-list .inner-img-container");EB.shared.getAssemblyInfo(EB.shared.getAssemblyIdList(b),"/resourcepacks/getAssemblies?assemblies={assemblyIds}").then(function(b){L=L.concat(b);t(a);a.data("carouselBuilt",!0)})}}function q(a,b){if(a){var c=a.assets.find(function(a){return"FULLSIZE"==a.assetSize}),c=new EB.Cite({title:a.title,fullPath:c&&c.filename,mediaType:a.assets&&a.assets[0]&&a.assets[0].assetCategory,level:"packs",eventLabel:"Packs Article Overlay"});b.innerHTML="<div data-bind=\"template: '"+
c.template+"'\"/>";e.applyBindings(c,b)}}function u(a,b){if(a){var c=a.assets.find(function(a){return"TRANSCRIPT"==a.assetSize});c&&c.transcript?(b.innerHTML=c.transcript,d.removeClass("hide",b.parentNode)):d.addClass("hide",b.parentNode)}}function x(a,b){if(!b.querySelector("audio")){var c=a.assets.find(function(a){return"FULLSIZE"==a.assetSize&&"MP3"==a.mimeType}).filename,d=c.substr(c.lastIndexOf(".")+1);b.innerHTML=Handlebars.templates["media/audio-with-icon"]({src:c,type:d,autoplay:/webkit/.test(navigator.userAgent.toLowerCase())?
"":' autoplay="true"'});f(b).find("audio").mediaelementplayer()}}function v(a,b){if(!b.querySelector("video")){var c=a.assets.find(function(a){return"FULLSIZE"==a.assetSize&&"MP4"==a.mimeType}),d=a.assets.find(function(a){return"FIRSTFRAME"==a.assetSize}),e=c.filename,g=e.substr(e.lastIndexOf(".")+1);b.innerHTML=Handlebars.templates["media/video"]({src:e+"?t="+(new Date).getTime(),type:g,width:c.width,height:c.height,poster:d.filename});f(b).find("video").mediaelementplayer()}}function r(a){return L.find(function(b){return b.assemblyId==
a})}function w(a,b,c,d){d=d||0;(a=(a=this.querySelector('div[data-slick-index="'+(c||0)+'"] .inner-img-container'))&&a.querySelector("video, audio"))&&a.pause();a=this.querySelector('div[data-slick-index="'+d+'"] .img-credit').innerHTML;var e=(d=this.querySelector('div[data-slick-index="'+d+'"] .inner-img-container'))&&d.getAttribute("data-assembly-id"),f=this.nextElementSibling;if(f){b=f.querySelector(".current-slide-caption");var g=f.querySelector(".current-slide-credit");c=f.querySelector(".current-slide-citation-container .current-slide-citation");
f=f.querySelector(".current-slide-transcript-container .current-slide-transcript");g&&(g.innerHTML=a);a=r(e);b&&(b.innerHTML=a.caption);q(a,c);u(a,f);a&&(b=a.assets&&a.assets[0]&&"VIDEO"==a.assets[0].assetCategory,a.assets&&a.assets[0]&&"AUDIO"==a.assets[0].assetCategory?x(a,d):b&&v(a,d))}}function y(){Array.prototype.slice.call(document.getElementsByClassName("current-slide-info")).forEach(function(a){var b=a.querySelector(".current-slide-citation-container"),c=b.querySelector(".show-hide-citation"),
e=a.querySelector(".current-slide-transcript-container"),f=e.querySelector(".show-hide-transcript");d.removeClass("hide",a);c.addEventListener("click",function(){d.toggleClass("open",b);d.hasClass("open",b)?e.style.display="none":e.style.display=""});f.addEventListener("click",function(){d.toggleClass("open",e);d.hasClass("open",e)?b.style.display="none":b.style.display=""})})}function t(a){(function(){var b=f(".assembly-list",a);b.on("beforeChange",w);b.on("init",w);b.slick({centerMode:!0,slidesToShow:1,
variableWidth:!0,infinite:!1,nextArrow:'<div class="prev-next next"><span class="fontello-icon-right-open icon"></span></div>',prevArrow:'<div class="prev-next prev"><span class="fontello-icon-left-open icon"></span></div>'});c()}).delay(100)}function D(){!d.isTouchDevice||A?setTimeout(function(){EB.Sticky.init(".pinnable-sidebar",B,null,null,".article-container",E,!0)},300):EB.Sticky.destroy()}function B(){return document.querySelector(".has-no-toc")?0:document.querySelector(".article-toc").offsetHeight+
46}function E(){return 768>f(window).width()}function z(){var a=f(".tts-play-stop"),b=f(".tts-reverse"),c=f(".tts-forward");EB.tts.init();EB.tts.setTtsServerIp(document.querySelector(".article-content-inner").getAttribute("data-tts-server"));var d=function(a){a&&EB.shared.trackEvent({eventName:"Read aloud",eventType:a})};a.on({click:function(a){a.preventDefault();a=f(this);a.hasClass("loaded")||(EB.tts.stop(),EB.tts.load(a.parents(".section-group").find(".section-heading a.section-toggle span.header, .section-body .section-inner > p, .section-body .section-inner > h3, .section-body .section-inner > h2, .section-body .section-inner #contributors > h3, .section-body .section-inner #contributors > p, .section-body .section-inner table.profile-table th, .section-body .section-inner table.profile-table td, .section-body .section-inner .profile-footnotes,#biblio .section-inner > hgroup h2, #biblio .section-inner ul p, #biblio .section-inner footer")),
f(".tts-play-stop").removeClass("loaded"),a.addClass("loaded"),EB.tts.setSelectedElement(a));a.hasClass("playing")?(d("Click on TTS stop button"),a.removeClass("playing"),a.removeClass("fontello-icon-pause").addClass("fontello-icon-play"),EB.tts.stop()):(d("Click on TTS play button"),f(".tts-play-stop").removeClass("playing"),a.addClass("playing"),a.removeClass("fontello-icon-play").addClass("fontello-icon-pause"),EB.tts.play());return!1}});b.on({click:function(a){a.preventDefault();f(this).next().hasClass("playing")&&
(d("Click on TTS rewind button"),EB.tts.rewind(),EB.tts.play());return!1}});c.on({click:function(a){a.preventDefault();f(this).prev().hasClass("playing")&&(d("Click on TTS fast forward button"),EB.tts.fastForward(),EB.tts.play());return!1}})}function G(){var a=979<window.innerWidth?document.querySelector(".navbar.navbar-fixed-top").offsetHeight:0,a=window.innerHeight-a;document.querySelector(".article-overlay .article-content").style.minHeight=a+"px"}function C(c){G.delay(30);A=EB.CSSUtil.isStyleSupported("position",
"sticky",!0);f.get("/resourcepacks/article/"+c).then(function(c){R(c);setTimeout(function(){var c=document.querySelector(".article-content .levels-ctn .levels");if(c=c&&c.getElementsByClassName("level"))for(var d=document.location.hash.remove(I()),e=0;e<c.length;e++){var f=c[e].getAttribute("data-article-id");c[e].setAttribute("href",d+f)}h();e=a.string("packs.grades");c=a.string("packs.note");a.string("packs.view.on.britannica");d=P()&&P().labelNote;document.domain.replace("packs.","school.");g();
I();e='<div class="pack-info-top row-fluid"><div class="span12 top-left"><a class="text" href="#/pinboard">'+l().text+'</a> &bull; <span class="pack-grade">'+e+" "+l().gradeRange+"</span></div>";e+="</div>";d&&(e+='<div class="note"><div class="title">'+c+"</div> "+d+"</div>");document.querySelector(".article-content-top").innerHTML=e;m();c="/resourcepacks/"+g()+"/growlbox/mw/dictionary";EB.shared.initPopupDictionary(null,c,!0,'<span class="fontello-icon-cancel"/>',!0);z();EB.Tools.init();p();y();
c=document.getElementsByClassName("adl-content");c=Array.prototype.slice.call(c);d=c.length;for(e=0;e<d;e++)(f=c[e].id.replace("adl-",""))&&document.getElementById(f)&&(document.getElementById(f).innerHTML=c[e].innerHTML);D();b.delay(200)},50)})}var I=e.observable(null),R=e.observable(null),P=e.observable(null),l=e.observable(null),L=[],A=!1;I.subscribe(function(a){a&&C(a)});f(window).on("resize",c);return{articleId:I,articleContent:R,articleInfo:P,packInfo:l}}(EB.i18n,ko,jQuery,EB.Dom);
EB=window.EB||{};
EB.packDisplay=function(a,e,f,d){var c,k=window.location.pathname.split("/").remove("").last(),g,h,b,m={pinboard:"pinboard",custom:"custom"},n={views:m,view:f.observable(""),data:f.observable(null)},p=!0,q={"/":function(){n.view("");n.data(null);var a=d(".jGrowl-close");0<a.length&&a.parent().trigger("jGrowl.close");d("body").removeClass("no-scroll");d(".no-touch .levels a").tooltip("hide");p?p=!1:EB.packDisplayShared.stats()},"/:view":{on:function(a){m[a]&&(n.view(m[a]),b=h[a],b.init(g,k),n.data(b.model))},
"/overlay/article/:id":function(a,c){b["/article/:id"](a,c)},"/overlay/magazine/:id":function(a,c){b["/magazine/:id"](a,c)},"/overlay/primarysources/:id":function(a,c){d("body").addClass("no-scroll");b["/primarysources/:id"](a,c)},"/assembly/:id":function(a,c){b["/assembly/:id"](a,c)},"/:type":{on:function(a,c){b["/:type"](a,c)},"/overlay/article/:id":function(a,c,d){b["/article/:id"](a,d)},"/overlay/magazine/:id":function(a,c,d){b["/magazine/:id"](a,d)},"/overlay/primarysources/:id":function(a,c,
e){d("body").addClass("no-scroll");b["/primarysources/:id"](a,e)}}}};return{init:function(){h={pinboard:EB.packDisplayPinBoard,custom:EB.packDisplayCustom};n.user={id:EB.shared.getIndividualId(),name:EB.shared.getIndividualName()};d.getJSON("/resourcepacks/custom/pack?packId="+k).done(function(b){g=b;c=(new a(q)).configure({strict:!1,recurse:"forward"});c.init("/pinboard");f.applyBindings(n)})}}}(Router,EB.i18n,ko,jQuery);EB=window.EB||{};
EB.packDisplayCustom=function(a,e,f,d,c){function k(){if(!F("edit-mode-alert")){var a=document.querySelector(".navbar-inner .container .brand"),b=e.offset(a);b.top+=48;setTimeout(function(){f(G("packs.custom.mode.popover"),b,250)},1E3);J("edit-mode-alert")}}function g(){setTimeout(function(){X&&X.layout()},30)}function h(a){return a.type+"-"+a.contentId}function b(a){a=a||0;return H().map(function(a){return a.size}).reduce(function(a,b){return a+b},a)}function m(b){b.note=a.observable("");b.userNote=
a.observable("");b.userNoteIndividual={};return b}function n(a){setTimeout(function(){var b=document.getElementById(h(a));X&&X.prepended(b);setTimeout(function(){O(function(){F("edit-mode-new-content-alert")||(f(G("packs.custom.content.added.popover"),b,250,"bottom"),J("edit-mode-new-content-alert"))})},500)},30)}function p(){N.error({});var a={};EB.packDisplayShared.isValidURL(EB.packDisplayShared.urlize(N.url()))||(a.url=G("packs.custom.link.validation.message"));N.cardTitle()||(a.title=G("packs.custom.card.title.validation.message"));
N.error(a);return!(a.url||a.title)}function q(){M.error({});M.exceededLimit(!1);M.totalSize(0);T(0);var a=document.getElementById(M.fileElementID);if(a&&a.files.length)if(a=a.files[0],M.name(a.name||""),M.size(a.size||0),-1===Z.indexOf(a.type))M.error({file:G("packs.custom.upload.format.supported.message",{filename:M.name()})});else if(a.size>S)M.error({file:G("packs.custom.upload.file.too.large.message",{filename:M.name()})});else if(b(a.size)>ba)M.totalSize(b(a.size)),M.exceededLimit(!0);else return!0;
else M.error({file:G("packs.custom.upload.no.file.message")});return!1}function u(){M.cardTitle("");M.cardDescription("");document.getElementById(M.fileElementID).value="";M.name("");M.size("");M.legalAccepted(!1);M.percentVal("0%");M.error({})}function x(){if(q()){if(M.cardTitle())return M.uploading(!0),!0;M.error({title:G("packs.custom.card.title.validation.message")})}return!1}function v(a){$.post("/resourcepacks/custom/tempDocument/discard",{s3Key:a}).then(function(a){console.log(a)})}function r(a,
b){var c=document.getElementById(h(a));X&&(X.once("layoutComplete",function(){var c=A().find(function(b){return b.contentId==a.contentId});if(c){"uploaded_document"===c.type&&v(c.s3Key);var d=A().filter(function(a){return c.contentId!==a.contentId});A(d)}else L.push(a);P(null);b&&Object.isFunction(b)&&b()}),a.isFeatured?c.parentNode.removeChild(c):X.remove(c),X.stamp(document.querySelectorAll(".pack-display .stamp")),X.layout())}function w(a){var b={};b.pack={assetId:I().assetId,note:I().note(),gradeIds:[I().gradeRange().value],
keywords:I().keywords||null,packId:a?I().packId:null,packImgUrl:I().packImgUrl,subjectIds:I().subjectIds,tags:I().tags,text:I().text().trim(),userNote:I().userNote(),userNoteIndividual:I().userNoteIndividual};a||(b.pack.sourcePackId=I().packId);b.packItems=[];aa.items().each(function(a){var c;-1!==a.contentId&&(c="uploaded_document"===a.type?{mimeType:a.mimeType,originalFilename:a.originalFilename,favoriteType:a.favoriteType,title:a.title,description:a.description,s3Key:a.s3Key}:"external_link"===
a.type?{url:a.url,favoriteType:a.favoriteType,title:a.title,description:a.description}:{contentId:a.contentId,favoriteType:a.favoriteType},a.additionalContentType&&(c.additionalContentType=a.additionalContentType),a.savedContentId&&(c.savedContentId=a.savedContentId),c.labelNote=a.note(),c.userNote=a.userNote(),c.userNoteIndividual=a.userNoteIndividual,b.packItems.push(c))});return b}function y(a){window.location=window.location.protocol+"//"+window.location.host+"/resourcepacks/"+a}function t(){var a=
!1;if(A().length||L().length||I().text()!==B.pack.text||!B.pack.gradeIds&&I().gradeRange().value||I().gradeRange().value!==B.pack.gradeIds[0]||(I().note()||B.pack.note)&&I().note()!=B.pack.note||(I().userNote()||B.pack.userNote)&&I().userNote()!=B.pack.userNote)return!0;l().each(function(b){if(-1!==b.contentId){var c=B.packItems.find(function(a){a=b.s3Key?b.s3Key==a.s3Key:b.url?b.url==a.url:b.contentId==a.contentId;return a});if((b.note()||c.labelNote)&&b.note()!=c.labelNote||(b.userNote()||c.userNote)&&
b.userNote()!=c.userNote)return a=!0,!1}});return a}function D(b){B=b;_data=Object.clone(b,!0);L([]);A([]);_data.packItems.each(function(b,c){b.type="ADDITIONALCONTENT"==b.favoriteType?b.additionalContentType:"ASSEMBLY"==b.favoriteType?b.assetType:b.favoriteType;b.type=b.type.toLowerCase();b.order=c;b.isFeatured=0===c;b.note=a.observable(b.note||b.labelNote||"");b.userNote=a.observable(b.userNote||"");b.contentId=b.contentId||EB.packDisplayShared.generateUUID();b.userNoteIndividual=b.userNoteIndividual||
{};b.title=b.title||b.originalFilename});l(_data.packItems);l.push({contentId:-1,type:"custom-content"});_data.pack&&(_data.pack.gradeRange=a.observable(C.find(function(a){return _data.pack.gradeIds&&_data.pack.gradeIds.find(function(b){return a.value==b})})),_data.pack.text=a.observable(_data.pack.text),_data.pack.note=a.observable(_data.pack.note||""),_data.pack.userNote=a.observable(_data.pack.userNote||""),I(_data.pack));V();O(k);EB.Sticky.init(".pack-display .pack-display-pinnable",146)}var B,
E,z=c.resource,G=c.string,C=z("my.content.grade.ranges");G("packs.grades");var I=a.observable(),R=a.observable(!1),P=a.observable(null),l=a.observableArray([]),L=a.observableArray([]),A=a.observableArray([]),U=a.computed(function(){return A().union(l()).exclude(function(a){return L().find(function(b){return b.contentId==a.contentId})})}),H=a.computed(function(){return U().filter(function(a){return"uploaded_document"==a.type})});c=a.observable(null);var z=a.observable(!1),Q=a.observable(!1);c.subscribe(function(a){g();
a&&setTimeout(function(){var b=document.getElementById(h(a));(b=b&&b.querySelector("textarea.add-note-input"))&&b.focus()},30)});var F,J,O,N={url:a.observable(""),cardTitle:a.observable(""),cardDescription:a.observable(""),legalAccepted:a.observable(!1),error:a.observable({}),modalID:"add-link-modal",validateURL:p,submit:function(){if(p()){var a=EB.packDisplayShared.generateUUID(),b={};b.title=N.cardTitle();b.description=N.cardDescription();b.url=N.url();b.type="external_link";b.favoriteType="EXTERNAL_LINK";
b.contentId=a;A.unshift(m(b));$("#"+N.modalID).modal("hide");n(b)}},openModal:function(){$("#"+N.modalID).modal("show");$("#"+N.modalID).one("hidden",function(){N.url("");N.cardTitle("");N.cardDescription("");N.error({})})}};N.url.subscribe(function(a){var b=N.error(),c=EB.packDisplayShared.urlize(N.url());a&&!EB.packDisplayShared.isValidURL(c)?b.url=G("packs.custom.link.validation.message"):b.url=null;N.error(b)});var T=a.observable(0),M={name:a.observable(""),size:a.observable(""),cardTitle:a.observable(""),
cardDescription:a.observable(""),legalAccepted:a.observable(!1),percentVal:a.observable("0%"),error:a.observable(""),fileElementID:"file-uploader",formID:"upload-document-form",modalID:"upload-document-modal",validateDocument:q,triggerFileChooser:function(){$("#"+M.fileElementID).click();return!1},submit:function(){var a={beforeSubmit:x,dataType:"json",uploadProgress:function(a,b,c,d){M.percentVal(d+"%")},success:function(a){M.percentVal("100%");M.uploading(!1);var b=EB.packDisplayShared.generateUUID();
a.title=M.cardTitle();a.description=M.cardDescription();a.type=a.favoriteType.toLowerCase();a.contentId=b;A.unshift(m(a));$("#"+M.modalID).modal("hide");n(a)}};$("#"+M.formID).ajaxSubmit(a);return!1},documents:H,totalSize:a.observable(0),exceededLimit:a.observable(!1),deleteDocument:function(a){T(a&&a.s3Key||-1)},deleteCancel:function(){T(0)},deleteConfirm:function(a){a?r(a,q):(u(),q())},link:function(a){return"/resourcepacks/custom/fetch/document/{indId}/{docId}/{originalFilename}".inject({indId:I().owner.individualId,
docId:a.savedContentId,originalFilename:a.originalFilename})},deleteDocumentId:T,uploading:a.observable(!1),openModal:function(){$("#"+M.modalID).modal("show");$("#"+M.modalID).one("hidden",function(){u()})}},Z="application/vnd.oasis.opendocument.text application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document application/rtf text/plain application/pdf".split(" "),S=20971520,ba=20971520,aa={info:I,items:U,typeIcons:{article:"fontello-icon-list",image:"fontello-icon-picture",
video:"fontello-icon-video",ebook:"fontello-icon-edit",magazine:"fontello-icon-book",interactive:"fontello-icon-retweet",website:"fontello-icon-bookmark",uploaded_document:"fontello-icon-doc-inv",external_link:"fontello-icon-link"},gradeRanges:C,remove:function(a){P(a)},cancelRemove:function(){P(null)},proceedToRemove:r,save:function(){if(!Q()){var a=EB.shared.getIndividualId(),b=I().owner.individualId==a;b&&!t()?y(E):(a=w(b),Q(!0),$.ajax({type:"POST",url:"/resourcepacks/custom/pack",data:JSON.stringify(a),
contentType:"application/json",dataType:"json",success:function(a){Q(!1);if(a.result)b||J("new-custom-pack-added"),y(a.newPackId||E);else if(a.errorMessage){var c=document.querySelector(".resource-pack-top .pack-title ");f(a.errorMessage,c,200,"left","error");R(!0)}else d(G("packs.custom.generic.error.title"),G("packs.custom.generic.error.message"))},error:function(){Q(!1);d(G("packs.custom.generic.error.title"),G("packs.custom.generic.error.message"))}}))}},saving:Q,discard:function(){if(t()){var a=
[{label:G("packs.custom.discard.changes.cancel"),onClick:function(){}},{label:G("packs.custom.discard.changes.confirm"),onClick:function(){A().each(function(a){"uploaded_document"===a.type&&v(a.contentId)});document.location.hash="#/pinboard"}}];d(G("packs.custom.discard.changes.modal.title"),G("packs.custom.discard.changes.modal.body"),null,a,!0)}else document.location.hash="#/pinboard"},toBeRemoved:P,documentManager:M,linkManager:N,switchArticle:function(a,b){if(a.contentId!==b){var c=document.getElementById(h(a)),
d=Object.clone(B.extraPackItems.find(function(a){return a.contentId==b}),!0),e=L().find(function(a){return a.contentId==b}),d=d||e;d.type=d.favoriteType.toLowerCase();e?(e=L().filter(function(a){return a.contentId!==d.contentId}),L(e)):A.push(d);setTimeout(function(){var b=document.getElementById(h(d));X&&(X.once("layoutComplete",function(){L.push(a)}),X.remove(c),X.prepended(b))},10)}},editedItem:c,editingUserNote:z,layout:g,titleError:R,view:a.observable("custom")},X=null,V=function(){X&&X.destroy();
X=new Masonry(".pack-display .items",{columnWidth:".pack-display .item",itemSelector:".pack-display .pinboard-item",stamp:".pack-display .stamp"})}.debounce(200);return{init:function(a,b){E=b;EB.packDisplayShared.onCustomize(E);F=EB.packDisplayShared.getSessionVar;J=EB.packDisplayShared.setSessionVar;O=EB.packDisplayShared.popoverConditionCheck;M.formatFileSize=EB.packDisplayShared.formatFileSize;D(a)},model:aa,onView:D}}(ko,EB.Dom,EB.Alert,EB.Overlay,EB.i18n);EB=window.EB||{};
EB.packDisplayPinBoard=function(a,e,f){function d(){var a=document.getElementById("my-saved-packs");!r("edit-mode-save-alert")&&r("new-custom-pack-added")&&(e(D("packs.custom.pack.saved.popover"),a,250,"top"),w("edit-mode-save-alert"))}function c(){var a=document.getElementById("my-saved-packs");r("edit-mode-favorite-alert")||(e(D("packs.custom.pack.favorited.popover"),a,250,"top"),w("edit-mode-favorite-alert"))}function k(a){var b=Object.map(L,function(b,c){return c.intersect(a).length});parseInt(Object.max(b),
10)}function g(){var a="/resourcepacks/email/pack/"+l;$("#emailCriteria").uniform();$("#emailCriteria").submit(function(){$(this).hasClass("failedSubmit")?EB.shared.trackEvent({eventName:"Email - Resource Packs",eventType:"Incorrect completion of email Pack form"}):(EB.shared.trackEvent({eventName:"Email - Resource Packs",eventType:"Click on submit button in Email popover"}),$.ajax({url:a,type:this.method,data:$(this).serialize(),dataType:"json",beforeSend:function(){$("#share-pack-modal").modal("hide")},
success:function(a){$.jGrowl(a.message,{life:3E3,position:"bottom-right"})}}));return!1})}function h(){$.ajax({type:"POST",url:"/resourcepacks/url/shorten",data:{pathToShorten:"/resourcepacks/"+l},success:function(a){I(a);b()}})}function b(){var a=f.string("packs.share.copied"),b=navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)?f.string("packs.share.could.not.copy.safari"):f.string("packs.share.could.not.copy"),c=new Clipboard(".copy-url-btn");c.on("success",function(b){$(b.trigger).tooltip({placement:"bottom",
title:a}).tooltip("show");setTimeout(function(){$("#share-pack-modal").modal("hide");$(b.trigger).tooltip("destroy")},1E3);b.clearSelection()});c.on("error",function(a){$(a.trigger).tooltip({placement:"bottom",title:b}).tooltip("show")})}function m(a){function b(){a.removeClass("animated fadeIn")}var c=EB.Dom.getAnimationEndEvent();a.off(c,b);a.on(c,b)}function n(a){a.addClass("animated fadeIn")}function p(a){$.getJSON("/resourcepacks/custom/favorite?packId={packId}".assign({packId:a})).then(function(a){A(!!a.result)})}
function q(){EB.MediaGallery.init(".resourcepacks .pack-display .media .overlay-link[rel=media-overlay-img]","Resource Packs Media Overlay");$(".resourcepacks .pack-display .media a[rel=media-overlay-pinboard], .media a[rel=media-overlay-text]").click(function(){var a=$(this).attr("rel"),a=$(".resourcepacks .pack-display .media a[rel="+a+"]").index($(this));EB.MediaGallery.goToIndex(a);return!1})}function u(a){if(a&&Array.isArray(a)&&a.length){var b=f.string("packs.header.differentiated.crosslinks.or"),
c=f.string("packs.grades"),d=a.map(function(a){return'<a href="'+a.packId+'">'+c+" "+a.grade+"</a>"});if(3>a.length)return d.join(" "+b+" ");d[d.length-1]=b+" "+d[d.length-1];return d.join(", ")}return""}function x(a){v=Object.clone(a,!0);v.packItems.each(function(a,b){a.type="ADDITIONALCONTENT"==a.favoriteType?a.additionalContentType:"ASSEMBLY"==a.favoriteType?a.assetType:a.favoriteType;a.type=a.type.toLowerCase();a.order=b;a.title=a.title||a.originalFilename});G(v.packItems.groupBy("type"));v.pack&&
(v.pack.gradeRange=v.pack.gradeIds?B.find(function(a){return v.pack.gradeIds.find(function(b){return a.value==b})}).shortLabel:"",k(v.pack.gradeIds),a=Object.values(Object.map(v.pack.differentiatedPackIdsForGradeRanges,function(a,b){return{grade:B.find(function(b){return a==b.value}).shortLabel,packId:b}})),a=u(a),v.pack.differentiatedPacksHtml=a,C(v.pack),EB.articleOverlay.packInfo(v.pack),EB.genericOverlay.packInfo(v.pack));H.articleId=EB.articleOverlay.articleId;H.articleContent=EB.articleOverlay.articleContent;
H.articleId.subscribe(function(a){EB.articleOverlay.articleInfo(G()&&G().article&&G().article.find(function(b){return b.contentId==a}))});H.assemblyId.subscribe(function(a){EB.MediaGallery.init(".resourcepacks .pack-display .media .overlay-link[rel=media-overlay-img]","Resource Packs Media Overlay");a=$(".resourcepacks .pack-display .media a.overlay-link[rel=media-overlay-img]").index($('.resourcepacks .pack-display .media a.overlay-link[rel=media-overlay-img][data-assembly-id="{0}"]'.format(a)));
EB.MediaGallery.goToIndex(a)});H.genericId=EB.genericOverlay.genericId;H.genericType=EB.genericOverlay.genericType;H.genericContent=EB.genericOverlay.genericContent;H.genericId.subscribe(function(a){EB.genericOverlay.genericInfo(G()&&(G().ebook&&G().ebook.find(function(b){return b.contentId==a})||G().magazine&&G().magazine.find(function(b){return b.contentId==a})))});EB.shared.isLoggedIn()&&(p(l),U(C().owner.individualId==EB.shared.getIndividualId()));F();setTimeout(function(){g();EB.Sticky.init(".pack-display .pack-display-pinnable",
140,m,n)},300);h()}var v,r,w,y,t=f.resource,D=f.string,B=t("my.content.grade.ranges"),E={uploaded_document:"fontello-icon-doc",external_link:"fontello-icon-link",article:"fontello-icon-list",image:"fontello-icon-picture",video:"fontello-icon-video",ebook:"fontello-icon-edit",magazine:"fontello-icon-book",interactive:"fontello-icon-retweet",website:"fontello-icon-bookmark"},z=a.observable(""),G=a.observable({}),C=a.observable({}),I=a.observable(""),R=a.observable(!1),P=a.observable(!0),l,L=t("resource.packs.levels.to.grades"),
t={article:function(a){return"#/"+H.view()+(z()?"/"+z():"")+"/overlay/article/"+a.contentId},image:function(a){return a.fullImagePath||a.imagePath},ebook:function(a){return"#/"+H.view()+(z()?"/"+z():"")+"/overlay/primarysources/"+a.contentId+"?path="+(window.location.protocol+"//"+document.domain.replace("packs.","media1.packs."))+a.additionalContentIdentifier},magazine:function(a){return"#/"+H.view()+(z()?"/"+z():"")+"/overlay/magazine/"+a.contentId},interactive:function(a){return a.fullImagePath},
website:function(a){0!=a.additionalContentIdentifier.trim().indexOf("http")&&(a.additionalContentIdentifier="http://"+a.additionalContentIdentifier);return a.additionalContentIdentifier},external_link:function(a){0!=a.url.trim().indexOf("http")&&(a.url="http://"+a.url);return a.url},uploaded_document:function(a){return"/resourcepacks/custom/fetch/document/{indId}/{docId}/{originalFilename}".inject({indId:C().owner.individualId,docId:a.savedContentId,originalFilename:a.originalFilename})}};t.video=
t.image;var A=a.observable(!1),U=a.observable(!1),H={view:a.observable("pinboard"),info:C,shortUrl:I,copying:R,animate:P,items:a.computed(function(){Object.isEmpty(G())||(setTimeout(function(){P(!1)},500),P(!0));return z()&&G()[z()]||Object.values(G()).flatten().sortBy("order")}),type:z,types:a.computed(function(){return[{key:"",count:Object.values(G()).flatten().length,order:-1,icon:""}].union(Object.values(Object.map(G(),function(a,b){return{key:a,count:b.length,order:Object.keys(E).indexOf(a),
icon:E[a]}})).sortBy("order"))}),urlMakers:t,urlMakersForArticleId:{article:function(a){return"#/"+H.view()+(z()?"/"+z():"")+"/overlay/article/"+a}},isFavorite:A,isCustom:U,favoriteManager:function(){EB.shared.isLoggedIn()?A()?$.ajax({type:"DELETE",url:"/resourcepacks/custom/favorite?packId={packId}".assign({packId:l}),dataType:"json"}).then(function(a){A(!a.result)}):$.post("/resourcepacks/custom/favorite?packId={packId}".assign({packId:l})).then(function(a){A(!!a.result);y(c)}):individual.showPacksLoginBox(EBStat.accountId,
window.location.protocol+"//"+window.location.hostname+"/resourcepacks/"+l)},onCustomize:function(){return EB.packDisplayShared.onCustomize(l)},assemblyId:a.observable(null)},Q=null,F=function(){Q&&Q.destroy();Q=new Masonry(".pack-display .items",{columnWidth:".pack-display .item",itemSelector:".pack-display .item",stamp:".pack-display .stamp"})}.debounce(200);H.items.subscribe(function(a){F();q()});return{init:function(a,b){l=b;x(a);z("");H.articleId("");H.assemblyId("");H.articleContent(null);H.genericId("");
H.genericType("");H.genericContent(null);r=EB.packDisplayShared.getSessionVar;w=EB.packDisplayShared.setSessionVar;y=EB.packDisplayShared.popoverConditionCheck;y(d)},model:H,onView:x,"/article/:id":function(a,b){$("body").addClass("no-scroll");H.articleId(b)},"/assembly/:id":function(a,b){H.assemblyId(b)},"/magazine/:id":function(a,b){$("body").addClass("no-scroll");H.genericId(b);H.genericType("magazine")},"/primarysources/:id":function(a,b){$("body").addClass("no-scroll");H.genericId(b);H.genericType("primarysources")},
"/:type":function(a,b){b&&G()[b]&&z(b)}}}(ko,EB.Alert,EB.i18n);EB=window.EB||{};
EB.packDisplayShared=function(){var a=$.getJSON("/resourcepacks/getMyPacksCount");return{onCustomize:function(a){if(EB.shared.isLoggedIn())return!0;individual.showPacksLoginBox(EBStat.accountId,window.location.protocol+"//"+window.location.hostname+"/resourcepacks/"+a);return!1},stats:function(){var a=window.location.href.remove("#");EB.shared.writeAjaxStats(null,a)}.debounce(200),getSessionVar:function(a){return $.storage.get(a)},setSessionVar:function(a){$.storage.set(a,!0)},generateUUID:function(){var a=
(new Date).getTime();return"yxxx-xxxx-xxxx".replace(/[xy]/g,function(f){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==f?d:d&3|8).toString(16)})},urlize:function(a,f){f=f||"http";return a&&a.has(/(http|ftp|https):\/\//)?a:f+"://"+a},isValidURL:function(a){return/(((http|ftp|https):\/{2})+(([0-9a-z_-]+\.)+(aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mn|mo|mp|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|nom|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ra|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw|arpa)(:[0-9]+)?((\/([~0-9a-zA-Z\#\+\%@\.\/_-]+))?(\?[0-9a-zA-Z\+\%@\/&\[\];=_-]+)?)?))\b/i.test(a)},
popoverConditionCheck:function(e){a.then(function(a){a&&(6<=a.CUSTOM||12<=a.FAVORITE)||e()})},formatFileSize:function(a){var f="",d=0;1024>a?(f="B",d=a):1048576>a?(f="KB",d=a/1024):1073741824>a&&(f="MB",d=a/1048576);Math.floor(d)!=d&&(d=d.toFixed(2));return d+f}}}();EB=window.EB||{};
EB.genericOverlay=function(a,e,f,d){function c(){return 979<window.innerWidth&&null!=document.querySelector(".navbar.navbar-fixed-top")?document.querySelector(".navbar.navbar-fixed-top").offsetHeight:0}function k(){var a=c();if(m()){var b=window.innerHeight-a,d=document.querySelector(".article-overlay"),e=d.querySelector(".article-container"),f=e.querySelector(".article-overlay-left");d.style.top=a+"px";e.style.height=b+"px";f&&(f.style.minHeight=b+"px");x&&(a=document.querySelector(".article-overlay .article-container .article-overlay-left"),
(b=document.querySelector(".article-overlay .article-container .article-overlay-right"))&&(b.style.height=a.offsetHeight+"px"))}}function g(){!d.isTouchDevice||x?setTimeout(function(){EB.Sticky.init(".pinnable-sidebar",0,null,null,".article-container",h,!0)},300):EB.Sticky.destroy()}function h(){return 768>f(window).width()}function b(b){x=EB.CSSUtil.isStyleSupported("position","sticky",!0);f.get("/resourcepacks/"+n()+"/"+b).then(function(b){p(b);setTimeout(function(){k();var b=a.string("packs.grades"),
d=a.string("packs.note"),e=q()&&q().labelNote,b='<div class="pack-info-top row-fluid"><div class="span6 top-left"><a class="text" href="#/pinboard">'+u().text+'</a> &bull; <span class="pack-grade">'+b+" "+u().gradeRange+"</span></div></div></div>";e&&"primarysources"!==n()&&(b+='<div class="note"><div class="title">'+d+"</div> "+e+"</div>");document.querySelector(".article-content-top").innerHTML=b;EB.Tools.init();"primarysources"==n()?(d=window.location.hash.replace(/^.*?path=(.*?)$/,"$1"),e=document.querySelector(".content-container"),
b=window.innerHeight-c()-120,e.style.minHeight=b+"px",e.innerHTML='<iframe src="'+d+'" width="100%" height="'+b+'"/>'):g()},50)})}var m=e.observable(null),n=e.observable(null),p=e.observable(null),q=e.observable(null),u=e.observable(null),x=!1;m.subscribe(function(a){a&&b(a)});f(window).on("resize",k);return{genericId:m,genericType:n,genericContent:p,genericInfo:q,packInfo:u}}(EB.i18n,ko,jQuery,EB.Dom);EB=window.EB||{};
EB.packs=function(a,e,f){function d(a){function b(c){e(c.target).hasClass("pack-browse-subheader")&&a.removeClass("animated fadeIn")}function c(){e(".pack-feedback",a).removeClass("animated fadeIn")}var d=EB.Dom.getAnimationEndEvent();a.off(d,b);a.off(d,".pack-feedback",c);a.on(d,b);a.on(d,".pack-feedback",c)}function c(a){a.addClass("animated fadeIn");e(".pack-feedback",a).addClass("animated fadeIn")}function k(){e("a.pack-feedback[href=#pack-feedback-modal]").click(function(){e("#pack-feedback-modal").modal("show");
return!1})}function g(a){window.location.hash.remove("#")!=a&&(G.setRoute(a),F())}function h(a){var b=[];a.forEach(function(a){b.push(a.shortLabel)});return 0<b.length?b.join("---"):"All"}function b(a){var b=[],c="";a.split("---").forEach(function(a){var d=y.find(function(b){return b.shortLabel==a});d&&(c=""!=c?c+","+d.value:d.value,b.push(d))});A.selectedGrades(c);A.selectedGradeLevels(b)}function m(){e(window).on("scroll",function(){B&&e(window).scrollTop()+100>=e(document).height()-e(window).height()&&
(A.pageNumber(A.pageNumber()+1),n(),F())})}function n(){D(!0);B=!1;t(!1);C("");R([]);I(!1);1==A.pageNumber()&&(A.excludedPackIds=[]);var a={grades:A.selectedGrades(),subjects:A.selectedSubject(),tag:A.selectedTag()&&"All"!=A.selectedTag()?A.selectedTag():"-1",pageNum:A.pageNumber(),pageSize:A.pageSize(),searchTerm:A.searchTerm().compact(),excludedPackIds:A.excludedPackIds.join(",")};return e.getJSON("/resourcepacks/getPacks",a).done(function(a){if(a)if(a.packs){var b=e.map(a.packs,function(a){return new l(a)});
1<A.pageNumber()?e.each(b,function(a,b){A.resourcePacks.push(b)}):A.resourcePacks(b);a.totalCount>A.pageNumber()*A.pageSize()&&(B=!0);a.packsIdsToExclude&&0<a.packsIdsToExclude.length&&(A.excludedPackIds=a.packsIdsToExclude);D(!1);t(!1);C(a.suggestedTerms);R(a.suggestedTermsList);A.searchTerm().compact()&&EB.shared.trackGaEvent(["Resource Packs","Search","Term: "+(A.searchTerm().compact()+" | Grade: "+(A.selectedGrades()?A.selectedGrades():"All")+" | Tag: "+(A.selectedTag()&&"All"!=A.selectedTag()?
A.selectedTag():"-1"))+" | Results Count: "+a.totalCount]);a.stripFilters&&(U.selectize.clear(),I(!0))}else p(),D(!1),B=!1,t(!0)})}function p(){EB.shared.trackEvent({eventName:"Search - Resource Packs with no result",eventType:"Click on search button or input a search topic",eventLabel:"These filters have no matched packs - Search term:"+A.searchTerm().compact()+" Grade:"+(A.selectedGrades()?A.selectedGrades():"All")+" Tag:"+A.selectedTag()&&"All"!=A.selectedTag()?A.selectedTag():"-1"});var a={grades:A.selectedGrades(),
subjects:A.selectedSubject(),tag:A.selectedTag()&&"All"!=A.selectedTag()?A.selectedTag():"-1",pageNum:1,pageSize:A.pageSize(),searchTerm:""};return e.getJSON("/resourcepacks/getPacks",a).done(function(a){a&&a.packs&&(a=e.map(a.packs,function(a){return new l(a)}),A.resourcePacks(a))})}function q(){e("#packFeedback").submit(function(){if(e(this).hasClass("failedSubmit"))EB.shared.trackEvent({eventName:"Email - Resource Packs Feedback",eventType:"Incorrect completion of Pack feedback form"});else{EB.shared.trackEvent({eventName:"Email - Resource Packs Feedback",
eventType:"Click on submit button in feedback form"});var a={feedbackTopic:A.packFeedback().topic(),subjects:A.packFeedback().feedbackSubjects(),gradeRange:A.packFeedback().feedbackGrades(),feedbackExperience:A.packFeedback().experience(),whoAmI:A.packFeedback().user(),contactEmail:A.packFeedback().contactEmail()};e.ajax({url:"/resourcepacks/email/feedback",type:this.method,data:a,dataType:"json",beforeSend:function(){e("#pack-feedback-modal").modal("hide")},success:function(a){e.jGrowl(a.message,
{life:3E3,position:"bottom-right"})}})}return!1})}function u(){J||(J=e.getJSON("/resourcepacks/load/subjects").done(function(a){Object.keys(a,function(a,b){b.forEach(function(a){a.territory.territoryName==w.toLowerCase()&&z.push({id:a.id,name:a.name})})})}));return J}function x(){return e.getJSON("/resourcepacks/getPackSubject").done(function(a){A.selectedSubject(a);u().done(function(){z.forEach(function(a){a.id!=A.selectedSubject()&&A.localSubjects.push(a)})})})}function v(){return e.getJSON("/resourcepacks/load/tags",
{grades:A.selectedGrades(),subjectAreaId:A.selectedSubject()}).done(function(a){var b=[];a.forEach(function(a){b.push({id:a.tagId,name:a.tagName})});A.tags(b)})}function r(){var a=[];return e.getJSON("/resourcepacks/load/gradeIds",{tagId:A.selectedTag()&&"All"!=A.selectedTag()?A.selectedTag():-1}).done(function(b){b.forEach(function(b){var c=y.find(function(a){return a.value==b});c&&a.push(c)});a.remove(function(a){return A.selectedGradeLevels().find(function(b){return b.value==a.value})});A.availableGrades(a)})}
var w=e("body").data("country"),y=EB.i18n.resource("my.content.grade.ranges"),t=ko.observable(!1),D=ko.observable(!1),B=!1,E=ko.observableArray([]),z=[],G=null,C=ko.observable(""),I=ko.observable(!1),R=ko.observableArray([]),P={article:"fontello-icon-list",image:"fontello-icon-picture",video:"fontello-icon-video",ebook:"fontello-icon-edit",interactive:"fontello-icon-retweet",magazine:"fontello-icon-book",website:"fontello-icon-bookmark"},l=function(a){var b=ko.observable(),c=ko.observable();a.gradeIds&&
Array.isArray(a.gradeIds)&&a.gradeIds.length&&b(y.find(function(b){return a.gradeIds.find(function(a){return a==b.value})}));var d=ko.computed(function(){return Object.findAll(a.contentTypeCounts,function(a,b){return!!b&&"ASSEMBLY"!=a})});E=ko.computed(function(){return[{key:"",count:Object.values(d()).flatten().length,order:-1,icon:""}].union(Object.values(Object.map(d(),function(a,b){return{key:a,count:b,order:Object.keys(P).indexOf(a.toLowerCase()),icon:P[a.toLowerCase()]}})).sortBy("order"))});
z.forEach(function(a){a.id==A.selectedSubject()&&(c=a.name)});this.labelId=a.labelId;this.text=a.text;this.keywords=a.keywords;this.description=a.description;this.tag=a.tag;this.subjectName=c;this.gradeRange=b;this.packImgUrl=a.packImgUrl;this.contentTypeCounts=E;this.icons=P},L=function(){A.pageNumber(1);return n()}.debounce(100),A={allGrades:y,availableGrades:ko.observableArray(),localSubjects:ko.observableArray(),tags:ko.observableArray(),selectedGrade:ko.observable(""),selectedGrades:ko.observable(""),
selectedGradeLevels:ko.observableArray(),unselectGrade:function(a){A.selectedGradeLevels.remove(a);A.availableGrades.push(a);A.availableGrades.sort(function(a,b){return a.value==b.value?0:a.value<b.value?-1:1})},selectedSubject:ko.observable(),selectedTag:ko.observable(),pageSize:ko.observable(40),pageNumber:ko.observable(1),resourcePacks:ko.observableArray(),searchTerm:ko.observable(""),refreshPacks:L,isLoadingResults:D,noPackMessage:t,packFeedback:ko.observable(new function(){this.topic=ko.observable("");
this.experience=ko.observable("");this.contactEmail=ko.observable("");this.user=ko.observable("Educator");this.feedbackGrades=ko.observable("");this.feedbackSubjects=ko.observable("")}),suggestedTerm:C,suggestedTermList:R,searchWithNoFilters:I,excludedPackIds:[]},U={selectize:null,$select:e("#pack-category-select"),optionValue:"id",optionText:"name",values:A.tags},H=function(a){if(a.selectize){var b=a.selectize.getValue();a.selectize.clearOptions(!0);a.selectize.renderCache={};a.selectize.load(function(c){c(a.values().map(function(b){return{value:b[a.optionValue],
text:b[a.optionText]}}));(function(){b&&a.selectize.setValue(b,!0)}).delay(0)})}else a.selectize=a.$select.selectize(Object.merge({plugins:{clear_selection:{title:f.string("option.selectize.clear.title")}}},a.options)),a.selectize=a.selectize[0].selectize;(function(){e.placeholder.shim()}).delay(1)},Q=function(){H(U)}.debounce(100),F=function(){var a={};a.gradeId=A.selectedGrades();a.tag=A.selectedTag()&&"All"!=A.selectedTag()?A.selectedTag():"-1";a.pageNum=A.pageNumber();a.pageSize=A.pageSize();
a.searchTerm=A.searchTerm().compact();a.noPacksFound=!1;a.subjectId=A.selectedSubject();EB.shared.writeAjaxStats(a)}.debounce(100);A.tags.subscribe(Q);A.selectedGrade.subscribe(function(a){if(a){var b=y.find(function(b){return b.value==a});b&&(A.selectedGradeLevels.push(b),A.availableGrades.remove(b))}});A.selectedGradeLevels.subscribe(function(){g("/"+A.selectedSubject()+"/"+h(A.selectedGradeLevels())+"/"+(A.selectedTag()||"All")+"/"+EB.shared.urlUtil.toUrl(A.searchTerm(),!0))}.debounce(100));A.selectedTag.subscribe(function(){g("/"+
A.selectedSubject()+"/"+h(A.selectedGradeLevels())+"/"+(A.selectedTag()||"All")+"/"+EB.shared.urlUtil.toUrl(A.searchTerm(),!0))}.debounce(100));A.searchTerm.subscribe(function(a){g("/"+A.selectedSubject()+"/"+h(A.selectedGradeLevels())+"/"+(A.selectedTag()||"All")+"/"+EB.shared.urlUtil.toUrl(a,!0))}.debounce(100));var J=null,O={"/":function(){1==arguments.length&&x().done(function(){v();n();r()});arguments[arguments.length-1]()},"/:subject":function(a){A.selectedSubject(a);u().done(function(){z.forEach(function(a){a.id!=
A.selectedSubject()&&A.localSubjects.push(a)})});2==arguments.length&&(v(),n(),r());arguments[arguments.length-1]()},":subject/:grade":function(a,c){b(c);3==arguments.length&&L();var d=arguments;v().done(function(){d[d.length-1]()})},":subject/:grade/:tag":function(a,c,d){A.selectedTag(d);r().done(function(){b(c)});4==arguments.length&&L();arguments[arguments.length-1]()},":subject/:grade/:tag/:search":function(a,b,c,d){A.searchTerm(EB.shared.urlUtil.fromUrl(d));L()}};return{init:function(){EB.Sticky.init(".pack-browse-subheader",
210,d,c);G=(new a(O)).configure({strict:!1,recurse:"forward",async:!0});G.init("/");ko.applyBindings(A);m();q();e(function(){e.scrollDepth({gtmOverride:!0,userTiming:!1})});k.delay(100)},ResourcePack:l}}(Router,jQuery,EB.i18n);EB=window.EB||{};EB.refererPasswordLogin=function(){return{init:function(){$("#password").placeholder();$("#password").focus()}}}();EB=window.EB||{};
EB.related=function(a){var e=null,f=/\?page=(\d+)/,d=a("#related-content").data("level"),c=!1,k=function(b){a.ajax({url:b,success:function(b){var c=e.find(".browse-node-articles-content");c.css("display","none").empty();0!==a.trim(b).length&&(c.append(b).fadeIn(1E3),"elementary"===d&&(c=e.find(".browse-node-articles-content"),b=a("> ul",c),EB.Tools.updateScrollControlBindings(b,c,"li")))}})},g=function(b,c){a.ajax({url:b+(void 0==c?"":"?page="+c),success:function(c){var f=e.find(".browse-node-articles-content");
f.css("display","none").empty();0!==a.trim(c).length&&(f.append(c).fadeIn(1E3),"elementary"===d&&h(f,b))}})},h=function(b,c){var d=1,e=a("> .results",b),f=e.innerHeight(),g=b.find("ul").data("pages");EB.Tools.updateScrollControlBindings(e,".content","li",{buttonScrollUp:!0,buttonScrollDown:!1,pages:g});a(".accordion-footing",b).on("click","a.dn",function(){var b=e.scrollTop();d<g&&(0===b||e.get(0).scrollHeight-b===f)?a.ajax({url:c,data:{ajax:!0,page:++d},success:function(b){e.append(b);a.each(["p",
"a"],function(a,b){var c=e.find(b);c.css("font-size",c.first().css("font-size"))});EB.Tools.animateScrollDown(e,a(".accordion-footing"),d<g)}}):EB.Tools.animateScrollDown(e,a(".accordion-footing"),d<g);return!1})};return{init:function(){EB.Tools.init();e=a("#browse-node-articles");$resourcesCtn=a("#resources-node");EB.browse.swapIn("#resources-node");e.find(".browse-node-articles-content").on({click:function(b){var c=a(b.target);"A"!==b.target.nodeName&&(c=c.parent());c.parent().is(".disabled, .active")||
(b=f.exec(c.attr("href")),a.bbq.pushState({page:b[1]}));return!1}},"nav.pagination a");$resourcesCtn.on("click",'ul.nav li a:not([class="inactive"])',function(){a.bbq.pushState({nodeId:a(this).attr("id"),page:1});return!1});c=!0;a(window).bind("hashchange",function(){var b=a.bbq.getState();if(a.isEmptyObject(b))a.bbq.pushState({nodeId:"main",page:1}),c||window.history.back();else{var e=b.nodeId,b=b.page;a("#resources-node").find("a").removeClass("selected");if("main"===e){var f=a("#"+e);f.addClass("selected");
e="/levels/"+d+"/article/"+f.data("articleId")+"/related/"+e;g(e,b)}else f=a("#"+e),f.addClass("selected"),e="/levels/"+d+"/article/"+f.data("articleId")+"/related/"+e,k(e);a.scrollTo(0);c=!1}});a(window).trigger("hashchange")}}}(jQuery);EB=window.EB||{};
EB.removeCookie=function(){return{init:function(){$("#remove-cookie").click(function(){var a=-1!==location.hostname.indexOf(".com",location.hostname.length-4)?-2:-3,a="."+location.hostname.split(".").slice(a).join(".");$.removeCookie("AuthTokenExpirable2",{path:"/",domain:a});document.location="/"})}}}();EB=window.EB||{};
EB.Gallery=function(a,e){var f=null,d=null,c=null,k=0,g=0,h=!1,b=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,m=/[^\.]\.(swf)\s*$/i,n=/[^\.]\.(flv)\s*$/i,p=/[^\.]\.(mp3)\s*$/i,q=/[^\.]\.(mp4)\s*$/i,u=/[^\.]\.(mov)\s*$/i,x=/[^\.]\.(wmv)\s*$/i,v=/[^\.]\.(dcr)\s*$/i,r=/iP(ad|od|hone)/,w=/[^\.]\.(html)\s*$/i,y=function(){d.elastislide({minItems:2,onClick:function(a){if(h)return!1;h=!0;B(a);g=a.index();EB.favorites&&EB.favorites.toggleFavoriteIcon(a.find("img").data("isFavorite"),"assembly");a.trigger("carousel:item:click")}});
1<k&&d.show();d.elastislide("setCurrent",g)},t=function(){1<k&&f.find(".rg-image").touchwipe({wipeLeft:function(){D(1)},wipeRight:function(){D(-1)},preventDefaultEvents:!1})},D=function(a){if(h)return!1;h=!0;g+=a;g=g>=k?0:0>g?k-1:g;B(c.eq(g))},B=function(b){E();var k=f.find(".rg-loading").show();c.removeClass("selected");b.addClass("selected");var m=b.find("img"),n=m.parent().get(0).href,p=m.data("assemblyTitle"),l=b.find("a").data("mediaType"),l=a.extend({},m.data(),{mediaCounterText:e.string("handlebar.media.counter.text"),
downloadtext:e.string("handlebar.media.download.text"),largeImageLinkText:e.string("handlebar.media.view.large.text"),index:m.parent().data("index"),showCounter:m.parent().data("showCounter"),relatedArticles:b.find(".gallery-media-articles-wrapper").html(),relativePath:"VIDEO"!==l||navigator.userAgent.match(r)?"":m.data("relativePath"),showTranscriptText:e.string("handlebar.media.show.transcript.text"),hideTranscriptText:e.string("handlebar.media.hide.transcript.text")});f.find(".gallery-media-metadata").empty().html(Handlebars.templates["media/metadata"](l));
l=z(b.find("a").get(0).href);switch(l){case "image":f.find(".rg-image").empty().append(a("<img />",{src:n,alt:p}));break;case "mp3":f.find(".rg-image").empty().html(Handlebars.templates["media/audio"]({src:n,type:l,autoplay:/webkit/.test(navigator.userAgent.toLowerCase())?"":' autoplay="true"'})).find("audio").mediaelementplayer();break;case "mp4":f.find(".rg-image").empty().html(Handlebars.templates["media/video"]({src:n+"?t="+(new Date).getTime(),type:l,width:m.data("videoWidth"),height:m.data("videoHeight"),
poster:m.get(0).src,autoplay:' autoplay="true"'})).find("video").mediaelementplayer();break;case "mov":f.find(".rg-image").empty().html(Handlebars.templates["media/embed"]({src:n,width:m.data("videoWidth"),height:m.data("videoHeight")+20,quicktime:!0}));break;case "wmv":f.find(".rg-image").empty().html(Handlebars.templates["media/video"]({src:n,type:l,width:m.data("videoWidth"),height:m.data("videoHeight"),poster:m.get(0).src,autoplay:EB.shared.isIE8()?"":' autoplay="true"'})).find("video").mediaelementplayer();
break;case "flv":f.find(".rg-image").empty().html(Handlebars.templates["media/flash"]({src:n,width:m.data("videoWidth"),height:m.data("videoHeight")+20}));break;case "swf":f.find(".rg-image").empty().html(Handlebars.templates["media/embed"]({src:n,width:600<m.data("videoWidth")?600:m.data("videoWidth"),height:m.data("videoHeight"),type:"application/x-shockwave-flash"}));break;case "dcr":f.find(".rg-image").empty().html(Handlebars.templates["media/embed"]({src:n,width:m.data("videoWidth"),height:m.data("videoHeight"),
type:"application/x-director"}));break;case "html":f.find(".rg-image").empty().html(Handlebars.templates["media/iframe"]({src:n,width:m.data("videoWidth"),height:m.data("videoHeight"),backlink:encodeURIComponent("http://"+document.location.hostname+"/levels/{0}/article/".format(EB.shared.getLevelFromPath()))}))}k.hide();var q=a("#transcriptToggle");q.click(function(){q.children("#hide").is(":visible")?(q.children("#show").show(),q.children("#hide").hide(),a("#transcript").hide()):(q.children("#hide").show(),
q.children("#show").hide(),a("#transcript").show())});d.elastislide("reload");g=b.index();d.elastislide("setCurrent",g);h=!1},E=function(){f.find("audio, video").each(function(){a.browser.msie?this.player&&this.player.pause:this.player&&this.player.pause&&this.player.pause()})},z=function(c){return c.match(b)?"image":c.match(m)?"swf":c.match(n)?"flv":c.match(p)?"mp3":c.match(q)?"mp4":c.match(u)?"mov":c.match(x)?"wmv":c.match(v)?"dcr":c.match(w)?"html":a(obj).hasClass("iframe")?"iframe":0===c.indexOf("#")?
"inline":"ajax"};return{init:function(){f=a("#rg-gallery");d=f.find("div.es-carousel-wrapper");c=d.find("ul > li");k=c.length;c.add('<img src="/resources/img/gallery/ajax-loader.gif"/><img src="/resources/img/gallery/black.png"/>');t();y();var b=EB.shared.getUrlParameter("assemblyId");null===b&&B(c.eq(g));EB.favorites&&(null!==b?(b=parseInt(b,10),c.find("img").each(function(){var c=a(this);c.data("assemblyId")===b&&EB.favorites.toggleFavoriteIcon(c.data("isFavorite"),"assembly")})):EB.favorites.toggleFavoriteIcon(c.eq(g).find("img").data("isFavorite"),
"assembly"))},addItems:function(b){d.find("ul").append(b);c=c.add(a(b));k=c.length;d.elastislide("add",b)},navigateToIndex:function(a){if(h)return!1;h=!0;g=a;B(c.eq(g))},stopMedia:E,toggleThumbIsFavorite:function(a){c&&c.eq(g).find("img").data("isFavorite",a)}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.search=function(a){function e(b){b.preventDefault();b=a(b.target);var c={};""!==EB.shared.getIndividualId()&&(c.individualId=EB.shared.getIndividualId());c.articleId=b.data("articleId");c.tocId=b.data("tocId");c.orderOnPage=b.data("order");c.page=null==EB.shared.getUrlParameter("page")?1:EB.shared.getUrlParameter("page");c.searchTerm=EB.shared.getUrlParameter("query");c.level=k;c.eventType="click";I(c);window.location=b.attr("href")}function f(a,b){return-1!==a.indexOf(b,a.length-b.length)}var d=
a("#sidebar-search-refresh"),c=a("#preview"),k=a("#search-content").data("level"),g=a("#search-content").data("pages"),h=a("#sidebar-search"),b=h.serialize(),m=a("#advanced-search-link"),n=a("#advanced-search-box"),p=a("#advanced-search-box input"),q=a("#advanced-search-box .close-popup-button"),u=a("#advanced-search-btn"),x=a("#advanced-search-all"),v=a("#advanced-search-exact"),r=a("#advanced-search-any"),w=a("#advanced-search-without"),y=a("#advanced-search-near"),t=a(".content").data("resultType"),
D=isNaN(parseInt(a("#lexile-range-val").data("lexileRangeMin"),10))?parseInt(a.storage.get("rangeLexileMin"),10):parseInt(a("#lexile-range-val").data("lexileRangeMin"),10),B=isNaN(parseInt(a("#lexile-range-val").data("lexileRangeMax"),10))?parseInt(a.storage.get("rangeLexileMax"),10):parseInt(a("#lexile-range-val").data("lexileRangeMax"),10),E=isNaN(parseInt(a.storage.get("searchLexileMin"),10))?parseInt(a("#show-lexile-filter").data("lexileSearchMin"),10):parseInt(a.storage.get("searchLexileMin"),
10),z=isNaN(parseInt(a.storage.get("searchLexileMax"),10))?parseInt(a("#show-lexile-filter").data("lexileSearchMax"),10):parseInt(a.storage.get("searchLexileMax"),10),G=a("#show-lexile-filter").data("lexileSearchLevel"),C=a("#show-lexile-filter").data("hideLexile"),I=function(a){writeStat(null,{accountId:EBStat.accountId,hostnameOverride:EBStat.host,domain:EBStat.domain,requestUrl:window.location.href,hitCount:1,json:JSON.stringify(a)})},R=function(c){var d=a(c.target);c=d.data("articleId");var e=
d.closest("li").find(".more-results"),f="/levels/{level}/search/articles/{articleId}".inject({level:k,articleId:c})+"?"+b;a.ajax({url:f,type:"GET",success:function(a){EB.shared.writeInternalStats({url:f});d.parent().empty();e.html(a).fadeIn(1E3)}})},P=function(){var a=[];0<x.val().trim().length&&a.push(x.val().split(" ").join(" and "));0<v.val().trim().length&&a.push('"{0}"'.format(v.val().trim()));0<r.val().trim().length&&a.push(r.val().split(" ").join(" or "));0<w.val().trim().length&&a.push("not "+
w.val().split(" ").join(" not "));0<y.val().trim().length&&a.push(y.val().trim());0<a.length&&(a=a.join(" and "),a=encodeURIComponent(a),window.location="/levels/{0}/search/{1}?query={2}".format(k,t,a))},l=function(){a.storage.set("rangeLexileMin",D,!1);a.storage.set("rangeLexileMax",B,!1);a.storage.set("searchLexileMin",E,!1);a.storage.set("searchLexileMax",z,!1);a("#lexileMin").val(E);a("#lexileMax").val(z);a("#lexile-range-val").html(E+" - "+z);a(".min-lexile").html(D);a(".max-lexile").html(B);
var b=E,c=z;a.storage.get("searchLexileLevel")!=G&&window.location.pathname.endsWith("articles")&&(a("#lexileMin").val(D),a("#lexileMax").val(B),a("#lexile-range-val").html(D+" - "+B),b=D,c=B);a("#rangeSlider").slider({range:!0,min:D,max:B,values:[b,c],slide:function(b,c){a("#lexile-range-val").html(c.values[0]+" - "+c.values[1])},change:function(b,c){a("#lexileMin").val(c.values[0]);a("#lexileMax").val(c.values[1]);a.storage.set("searchLexileMin",c.values[0],!1);a.storage.set("searchLexileMax",c.values[1],
!1);a.storage.set("searchLexileLevel",G,!1);EB.shared.trackEvent({eventName:"Lexile Tool - "+k,eventType:"Click range slide in Level "+a("#lexile-range-slider").data("tabbedLevel")});var d=a("#sidebar-search").attr("action");a("#sidebar-search").attr("action",d+"#show-lexile-filter");a("#sidebar-search").submit()}});!C&&a.storage.get("showLexileFilter")&&(a(".show-lexile").show(),a("#lexile-range-slider-container").show(),a("#show-lexile-filter").find("i").remove().end().append('<i class="fontello-icon-up-dir"></i>'));
window.location.pathname.endsWith("articles")||(a("#rangeSlider").slider({disabled:!0}),a("#show-lexile-filter").addClass("disabled"));a("#show-lexile-filter").on("click",function(b){a("#lexile-range-slider-container").is(":visible")?(a.storage.remove("showLexileFilter"),a("#lexileMin").val(null),a("#lexileMax").val(null)):(a.storage.set("showLexileFilter",!0,!1),b=a("#sidebar-search").attr("action"),a("#sidebar-search").attr("action",b+"#show-lexile-filter"));a("#sidebar-search").submit()})},L=function(){a(".iguide-preview-btn").on({mouseenter:function(){c.html(A(this.href))},
mouseleave:function(){c.empty()},click:function(){c.html(A(this.href));return!1}})},A=function(b){return a('<img class="preview-image" />').attr("src",b)},U=function(){var b=window.location.pathname;if(f(b,"images")||f(b,"videos"))a("#tool-font-up").hide(),a("#tool-font-down").hide(),a(".tool-font-increase").hide(),a(".tool-font-decrease").hide()};return{init:function(){var c={thumbnailArrange:ko.observable(a.storage.get("imageToolsThumbnailArrange",!0)||"grid"),suppressViewToggle:"elementary"==k||
window.location.href.has(/(\/search\/articles\?)|(\/search\/videos\?)/),thumbnailSize:ko.observable(a.storage.get("imageToolsThumbnailSize",!0)||10),thumbnailSizeSliderOptions:{min:10,max:20,range:"min",continuous:!0},i18n:EB.i18n};c.thumbnailArrange.subscribe(function(b){a.storage.set("imageToolsThumbnailArrange",b,!0);EB.shared.fetchAssemblyMetadata("ul.results.media li.thumb > a",function(){EB.MediaGallery.init("ul.results.media li.thumb > a","Search Results Overlay")})});c.thumbnailSize.subscribe(function(b){a.storage.set("imageToolsThumbnailSize",
b,!0);(function(){EB.shared.trackEvent({eventName:"Thumbnail Size Control - "+k,eventType:"Change thumbnail size",eventLabel:b})}).debounce(100)()});ko.applyBindings(c,document.getElementsByTagName("html")[0]);EB.Tools.init();U();l();EB.shared.fetchAssemblyMetadata("ul.results.media li.thumb > a",function(){EB.MediaGallery.init("ul.results.media li.thumb > a","Search Results Overlay")});EB.MediaGallery.init("ul.results.media li.thumb > a","Search Results Overlay");a('#sidebar-search input[type="checkbox"]').change(function(){d.removeClass("visuallyhidden")});
L();a(".level-tabs li").bind("click",function(b){b.preventDefault();a.storage.remove("rangeLexileMin");a.storage.remove("rangeLexileMax");a.storage.remove("searchLexileMin");a.storage.remove("searchLexileMax");a.storage.remove("showLexileFilter");a.storage.remove("searchLexileLevel");a(this).find("form").submit()});a(".search-more a").on("click",function(a){a.preventDefault();R(a)});m.on("click",function(a){a.preventDefault();n.show()});q.on("click",function(a){n.hide()});u.on("click",function(a){P()});
p.bind("keypress",function(a){13==a.keyCode&&P()});a("#search-content-level-radio-chooser form input").change(function(){a(this).attr("name",a(this).val());a(this).attr("value","true");a(this).parents("form").submit()});if("elementary"===k){var f=1,t=h.attr("action"),r=a(".content > .results"),v=r.innerHeight();EB.Tools.updateScrollControlBindings(r,".content","li, dt, dd",{buttonScrollUp:!0,buttonScrollDown:!1,pages:g});a(".accordion-footing").on("click","a.dn",function(){var c=r.scrollTop();if(f<
g&&(0===c||r.get(0).scrollHeight-c===v)){var d=t+"?"+b.replace(/NaN/g,"");a.ajax({url:d,data:{ajax:!0,page:++f},success:function(b){EB.shared.writeInternalStats({url:d});r.append(b);a.storage.get("showLexileFilter")&&a(".show-lexile").show();a.each("p a i cite time dt dd dfn".split(" "),function(a,b){var c=r.find(b);c.css("font-size",c.first().css("font-size"))});EB.Tools.animateScrollDown(r,a(".accordion-footing"),f<g);EB.MediaGallery.init(".results.media a[rel=result-group]","Search Results Overlay");
a(".search-more a").on("click",function(a){a.preventDefault();R(a)});var c={eventType:"click",page:f,searchTerm:EB.shared.getUrlParameter("query"),level:k};""!==EB.shared.getIndividualId()&&(c.individualId=EB.shared.getIndividualId());a(".primary-article-link").on("click",function(b){b.preventDefault();b=a(b.target);c.articleId=b.data("articleId");c.tocId=b.data("tocId");c.orderOnPage=b.data("order");I(c);window.location=b.attr("href")});a("li.thumb").on("click",function(b){b=a(b.target).closest("a");
c.assemblyId=b.data("assemblyId");c.orderOnPage=b.data("order");I(c)})}})}else EB.Tools.animateScrollDown(r,a(".accordion-footing"),f<g)});if(!a.storage.get("elementarySearchResultsInterfaceJumpWarning"))a(".elementary-higher-level-article .primary-article-link").one("click",function(b){if(!a.storage.get("elementarySearchResultsInterfaceJumpWarning"))return a.storage.set("elementarySearchResultsInterfaceJumpWarning",!0),a("#interface-jump-warning").modal("show"),a("#interface-jump-warning-ok").click(function(){a("#interface-jump-warning").modal("hide");
e(b)}),a("#interface-jump-warning-cancel").click(function(){a("#interface-jump-warning").modal("hide");return!1}),!1})}a(".primary-article-link:not(.elementary-higher-level-article .primary-article-link)").on("click",e);a("li.thumb").on("click",function(b){b=a(b.target).closest("a");var c={};""!==EB.shared.getIndividualId()&&(c.individualId=EB.shared.getIndividualId());c.assemblyId=b.data("assemblyId");c.orderOnPage=b.data("order");c.page=null==EB.shared.getUrlParameter("page")?1:EB.shared.getUrlParameter("page");
c.searchTerm=EB.shared.getUrlParameter("query");c.level=k;c.eventType="click";I(c)});a("#b2IqLink").on("click",function(a){a={};""!==EB.shared.getIndividualId()&&(a.individualId=EB.shared.getIndividualId());a.eventType="click";a.eventName="iqLink";I(a)})},initDictionary:function(){var b=a("#search-content .fontello-icon-volume-up");a.each(b,function(b,c){EB.shared.initAudioPlayback(a(c),EB.shared.getLevelFromPath())})},initTool:function(){a("#doWhackAMole").click(function(b){a("#searchForm").attr("action",
"/levels/{0}/search/tool".format(EB.shared.getLevelFromPath()));a("#searchForm").attr("method","POST");a("#searchForm").submit()})}}}(jQuery);EB=window.EB||{};
EB.shared=function(a,e,f){function d(a){var b={eventType:"ajax",version:"2.0"};""!==EB.shared.getIndividualId()&&(b.individualId=EB.shared.getIndividualId());writeStat(null,{accountId:EBStat.accountId,hostnameOverride:EBStat.host,domain:EBStat.domain,requestUrl:a.url,hitCount:2,json:JSON.stringify(b)})}function c(a,b){b=b||document.location.href;a=a||{};a.eventType="ajax";a.version="2.0";""!==EB.shared.getIndividualId()&&(a.individualId=EB.shared.getIndividualId());try{writeStat(null,{accountId:EBStat.accountId,
hostnameOverride:EBStat.host,domain:EBStat.domain,requestUrl:b,hitCount:2,json:JSON.stringify(a)})}catch(c){console.log(c.message)}}function k(a){if(a.length){var b=S||"";a[0]+=b&&" - "+b;window.ga?window.ga.apply(null,["send","event"].union(a)):window.console&&window.console.log(a)}}function g(b){if(Q){var c=Q.pageY||Q.originalEvent.pageY,d=Q.pageX||Q.originalEvent.pageX,e=window.innerHeight,f={bottom:"",right:"",position:"absolute",top:c+15,left:d+5};b&&e<c+100&&(f.top=c-200,f.left=d+5);a("#jGrowl").css(f)}}
function h(){var b=a("#jGrowl");0>b.offset().left?b.css("left",0):b.offset().left+b.outerWidth()>F&&b.css({left:"",right:0})}function b(){a("#additional-gallery").on("shown",function(){a("#additional-gallery div.modal-body").scrollTop(0)});a("a.tblref, a.adlref").click(function(){var b=a("div#adl-"+a(this).attr("href"));a("#additional-gallery div.span12").hide();b.show();a("#additional-gallery").modal("show");a("img.lazy").lazyload({container:b});a("#toolbar-content").hide().html("");return!1})}function m(){var a=
document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css";b.styleSheet.cssText=':before, :after { content: "" !important; }';a.appendChild(b);window.setTimeout(function(){a.removeChild(b)},0)}function n(){window.onpageshow=function(a){a.persisted&&(document.body.style.display="none",location.reload())}}function p(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return a}function q(){return a("body").data("language")}
function u(){function b(c){try{return(a.trim(c.attr("title"))||a.trim(c.data("originalTitle"))||a.trim(c.closest("a").attr("title"))||a.trim(c.closest("a").text())||a.trim(c.prev().children().length?a(c.prev().children()[0]).text():c.prev().text())||a.trim(c.next().children().length?a(c.next().children()[0]).text():c.next().text())||a.trim(c.parent().prev().children().length?a(c.parent().prev().children()[0]).text():c.parent().prev().text())||a.trim(c.parent().next().children().length?a(c.parent().next().children()[0]).text():
c.parent().next().text())||(c.attr("src")?c.attr("src").replace(/.*\/|\..*$/g,"").titleize():"")).compact().truncate(80,!1)}catch(d){console.error(d.message)}}a('img:not([alt]), img[alt=""]').each(function(){var c=a(this);c.attr("alt",b(c));c.attr("data-generated-alt",!0)});a("a").filter(function(){return a(this).text().isBlank()}).each(function(){var c=b(a(this));if(c){var d=document.createElement("span");d.className="visuallyhidden";d.innerText=c;this.appendChild(d)}})}function x(){return a("body").data("siteType")}
function v(b){var c=[];a(b).each(function(b,d){var e=a(d).data("assemblyId");e&&c.push(e)});return c}function r(b,c){c=c||pa;return a.getJSON(c.assign({assemblyIds:b.join(",")}))}function w(b,c,d){var f=["one","two","three"],g=c&&c.favoriteAssemblyIds||[];c&&c.assemblyInfos&&c.assemblyInfos.each(function(c){var d=a(b+"[data-assembly-id="+c.assemblyId+"]");g.any(c.assemblyId)&&d.attr("data-is-favorite",!0);var h=c.assets.find(function(a){return"FULLSIZE"==a.assetSize&&"AUDIO"==a.assetCategory}),k=
c.assets.find(function(a){return"FULLSIZE"==a.assetSize&&"VIDEO"==a.assetCategory&&"MP4"==a.mimeType}),l=c.assets.find(function(a){return"FULLSIZE"==a.assetSize&&"INTERACTIVE"==a.assetCategory&&"HTML"==a.mimeType||"LARGE"==a.assetSize&&"INTERACTIVE"==a.assetCategory&&"SWF"==a.mimeType}),k=k||l,l=c.assets.find(function(a){return"TRANSCRIPT"==a.assetSize}),m=c.assets.find(function(a){return"FULLSIZE"==a.assetSize});m&&m.credit&&d.attr("data-credit",m.credit);(m=c.assets.find(function(a){return"LARGE"==
a.assetSize&&"IMAGE"==a.assetCategory}))&&d.attr("data-large-path",m.filename);c.title&&d.attr("title",c.title);c.caption&&d.attr("data-caption",c.caption);d.attr("data-media-type",c.assets&&c.assets[0]&&c.assets[0].assetCategory);h&&d.attr("data-full-path",h.filename);k&&(d.attr("data-full-path",k.filename),d.attr("data-width",k.width),d.attr("data-height",k.height),k.duration&&(d.attr("data-duration",k.duration),a("#video-duration-"+c.assemblyId).text(k.duration)));l&&d.attr("data-transcript",l.transcript);
h=(c.relatedArticles||[]).exclude(function(a){return window.location.pathname.split("/").any(a.articleId+"")});if(ga()||ia())var k={primaria:1,secundaria:2},l={academica:3},n=ga()?k[S]:l[S],h=(h||[]).exclude(function(a){return a.tierId!=n});h.length&&0==a("#media-metadata-"+c.assemblyId).length&&d.append('<div id="media-metadata-{assemblyId}" class="gallery-media-articles-wrapper hidden"><div class="media-metadata"><p>{alsoIn}</p><ul>'.assign({assemblyId:c.assemblyId,alsoIn:e.string("assembly.{mediaType}.related.articles.info".assign({mediaType:d.data("mediaType").toLowerCase()}))})+
h.map(function(a){return'<li><a class="media-metadata-level {cssClassName}" href="/levels/{level}/article/{urlTitle}/{articleId}" rel title data-article-id="{articleId}" data-article-url-title="${article.urlTitle}"><span>{tierId}</span>{articleTitle}</a></li>'.assign({articleId:a.articleId,urlTitle:a.urlTitle,tierId:a.tierId,articleTitle:a.articleTitle,level:S,cssClassName:f[a.tierId-1]})}).join("")+"</ul></div></div>")});Object.isFunction(d)&&d()}a.ajaxSetup({cache:!1});window.typeOf=function(a){return null==
a?a:a.constructor};window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));Function.prototype.method=function(a,b){if(!this.prototype[a])return this.prototype[a]=b,this};String.method("format",function(){var a=arguments;return this.replace(/\{(\d+)\}/g,function(b,c){return"undefined"!==typeof a[c]?a[c]:b})});String.method("inject",function(a){var b=this,c;for(c in a)a.hasOwnProperty(c)&&(b=b.replace(new RegExp("{"+
c+"}","g"),a[c]));return b});String.method("unescapeHTML",function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")});a.fn.serializeObject=function(b){var c={},d=this.serializeArray();a.each(d,function(){b&&0===this.name.indexOf("_")||(void 0!==c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||"")):c[this.name]=this.value||"")});return c};(function(){Modernizr.addTest("realtouch",function(){return Modernizr.touch&&!EB.Dom.isWin10})})();
var y={pageLoadFlags:"pageLoadFlags",firstPageAfterLogin:"firstPageAfterLogin"},t=function(b){if(a.browser.msie){var c=document.createElement("a");c.href=b;document.body.appendChild(c);c.click()}else window.location=b},D=!0;window.onhashchange=function(a){"hashchange"==a.type&&(D?D=!1:c())};a("body").on("click","*[data-ga]",function(b){var c=b.currentTarget,d=a(c).data("ga").split("|"),e=a(c).data("ga-selector");!d.length||e&&!a(b.target).closest(e).length||(k(d),"a"==c.tagName.toLowerCase()&&c.href&&
"#"!=c.href&&!c.target&&(b.preventDefault(),setTimeout(function(){t(c.href)},100)))});a("body").on("touchstart.dropdown",".dropdown-menu",function(a){a.stopPropagation()});a("body").on("click","a.disabled",function(){return!1});a("form.uniForm").uniform({prevent_submit:!0,prevent_submit_callback:function(){return!1},error_class:"error",holder_class:"control-group"});var B=function(){var b=function(a){var b=a.indexOf("?");0<b?a=a.slice(0,b):(b=a.indexOf("#"),0<b&&(a.slice(b),a=a.slice(0,b)));return a},
c=function(b){b=b.split("/");var c;a.each(b,function(a,b){var d=parseInt(b);"number"===typeof d&&isFinite(d)&&(c=b)});b=c?a.grep(b,function(a){return c!==a}):b;return a.trim(b.join(" "))};a(".lesson-plan-view-alert").on("click",function(b){b.preventDefault();a("#lesson-plan-display-alert").modal("show")});a("#login-link").on("click",function(a){a.preventDefault();d(EB.shared.getLandingPageForLoginBox())});a(".my-content-link, .my-research-btn[data-target=loginbox]").on("click",function(a){a.preventDefault();
a="http://{host}/levels/{level}/user/content/favorites".inject({host:window.location.host,level:S});d(a)});var d=function(d){a("#lesson-plan-display-alert").modal("hide");var e;e=window.location.href;var f=S,g=e.indexOf(f);null!=f?(e=e.slice(g+f.length),e=b(e),e=c(e)||"home"):e="home";Y({eventName:"Login - "+f,eventType:e});"school"===a("body").data("site-type")?individual.showB2LoginBox(EBStat.accountId,d,null,q()):"academic"!==a("body").data("site-type")&&"library"!==a("body").data("site-type")||
individual.showLibraryLoginBox(EBStat.accountId,d)};a(".my-content-signup-link").on("click",function(d){d.preventDefault();a("#lesson-plan-display-alert").modal("hide");var e;e=window.location.href;d=S;var f=e.indexOf(d);e=e.slice(f+d.length);e=b(e);e=c(e)||"home";Y({eventName:"Login - "+d,eventType:e});"school"===a("body").data("site-type")?individual.showB2LoginBox(EBStat.accountId,EB.shared.getLandingPageForLoginBox(),"show",q()):"library"===a("body").data("site-type")&&individual.showLibraryLoginBox(EBStat.accountId,
EB.shared.getLandingPageForLoginBox(),"show")});a("#login-help").fancybox({autoScale:!1,autoDimensions:!1,hideOnOverlayClick:!0,overlayOpacity:0,center:!1,height:70,width:380,padding:5,speedIn:100,speedOut:100});var e=a("#logout-link");e.length&&e.attr("href",function(){var b="";a(this).attr("data-host-prefices").split(",").forEach(function(a){0<=window.location.hostname.indexOf(a+".")&&(b=window.location.hostname.replace(a+".","individual."))});var c="";return c=(c=window.location.port)?window.location.protocol+
"//"+b+":"+c+"/login/out/remove/sessionId":window.location.protocol+"//"+b+"/login/out/remove/sessionId"})},E=a(".nav-user-content"),z=a(".fade-left"),G=a("#toggle-my-britannica i"),C=a("#level-chooser-box"),I=function(){a("#my-britannica, #toggle-my-britannica").on("click",function(b){b.preventDefault();a.storage.get("hide-my-britannica")?(R(),a.storage.remove("hide-my-britannica")):(E.fadeOut(1E3),z.animate({right:0},1200),z.addClass("fade-right"),a.storage.set("hide-my-britannica",!0,!1),G.removeClass("fontello-icon-right-dir").addClass("fontello-icon-left-dir"),
C.hide())})},R=function(){E.fadeIn(1500);z.show();z.animate({right:E.outerWidth()},1200);z.removeClass("fade-right");G.removeClass("fontello-icon-left-dir").addClass("fontello-icon-right-dir")},P=function(){C.hide();a("ul.nav-user-content li a").on("click",function(b){var c=a(this);if(c.attr("href").startsWith("/levels//"))if(b.preventDefault(),C.is(":visible")&&C.attr("target-text")==c.text())C.hide();else{C.attr("target-text",c.text());var d=C.find("ul").first();d.empty();a("#welcome-content nav ul.nav-pills a").each(function(b){b=
"<li><a href='"+(a(this).attr("href")+c.attr("href").substring(8))+"'>"+a(this).text()+"</a></li>";d.append(b)});b=C.find(".fontello-icon-up-dir").first();d.css("left",c.offset().left-80);b.css("left",c.offset().left+c.width()/2-7);b.css("top",a("#toggle-my-britannica").offset().top+a("#toggle-my-britannica").outerHeight()-7);C.show()}})},l=function(b){a.browser.webkit&&a(b).bind("webkitspeechchange",function(){this.form.submit()})};a.widget("custom.catcomplete",a.ui.autocomplete,{_renderMenu:function(b,
c){var d=this,e="";a.each(c,function(c,f){f.category!=e&&(""!==e&&(a("body").hasClass("welcome")&&"Popular searches"===f.category||b.append("<li class='ui-menu-item'><hr/></li>")),"BR"==a("body").data("country")||"ES"==a("body").data("country")||a("body").hasClass("welcome")&&"Popular searches"===f.category||(b.append("<li class='ui-autocomplete-category'><i class='"+f.icon+"'/><span>"+f.category+"</span></li>"),e=f.category));d._renderItem(b,f)})},_renderItem:function(b,c){var d="<a>"+c.label+"</a>";
if(""!=c.filename)return d="<a><img width=100 title='"+c.label+"' src='"+c.filename+"'/></a>","Videos"===c.category&&(d="<a><i class='fontello-icon-play'></i><img width=100 title='"+c.label+"' src='"+c.filename+"'/></a>"),a("<li></li>").addClass("media").data("item.autocomplete",c).append(d).appendTo(b);if(!a("body").hasClass("welcome")||"Popular searches"!==c.category)return a("<li></li>").data("item.autocomplete",c).append(d).appendTo(b)}});var L=function(b,c){var d=a(b);d.catcomplete({minLength:1,
source:"/levels/{level}/search/autocomplete".assign({level:c}),select:function(a,b){a.preventDefault();var d="/levels/{level}/article/{articleId}".assign({level:c,articleId:b.item.value});"Popular searches"===b.item.category&&(d="/levels/{level}/search/articles?query={query}".assign({level:c,query:b.item.label}));if("Images"===b.item.category||"Videos"===b.item.category)d="/levels/{level}/article/{articleId}/media?assemblyId={assemblyId}".assign({level:c,articleId:b.item.articleLink,assemblyId:b.item.value});
var e="Go to the link of an autocomplete item - "+c;"Popular searches"===b.item.category&&(e="Go to the link of a popular item - "+c);Y({eventType:"Search - Autocomplete",eventName:e,eventLabel:b.item.label+": "+d});setTimeout(function(){t(d)},100)},focus:function(a){a.preventDefault()},position:{collision:"none"}});d.on({focus:function(){a(this).siblings(".icon-search").hide()},blur:function(){var b=a(this);0===b.val().length&&b.siblings(".icon-search").show()}})},A=function(b){a(b).placeholder()},
U=function(b,c){a(b).submit(function(b){""===a.trim(a(c).val())&&b.preventDefault()})},H=!1,Q,F=a(window).width(),J=function(b,c,d,e,f){a.jGrowl.defaults.position="bottom-right";a.jGrowl.defaults.closer=!1;a.jGrowl.defaults.closeTemplate=e||"";a.jGrowl.defaults.openDuration=0;a.jGrowl.defaults.closeDuration=0;a.jGrowl.defaults.pool=1;var g=!1;e=function(d){Q=d;a("html[lang=es-ES]").length?(d=Z(),O("rae",b,d,c,f)):(d=Z(),O("mw",b,d,c,f))};["#atlas-container",".user-content-favorites",".lessons",".learn"].forEach(function(b){a(b).length&&
(g=!0)});if(!g){var h=a(".no-realtouch"),k=a(".realtouch");d&&h.length&&h.find("#article-content, .content, .gallery-media-metadata, .h1body, .sidebar, .article-overlay").off("dblclick");if(h.length)h.find("#article-content, .content, .gallery-media-metadata, .h1body, .sidebar, .article-overlay").on("dblclick",e);k.length&&k.find("#article-content, .content, .gallery-media-metadata, .h1body, .sidebar, .article-overlay").taphold(e,1E3)}a("body").on("jGrowl.close",function(){Y({eventName:ca,eventType:"Close pop-up dictionary"});
a("#jGrowl").detach()})},O=function(b,c,d,k,l){function m(b){b=b||e.string("institution.dictionary.feature.word.not.found");var k=a(".jGrowl-close");0<k.length&&(k.parent().trigger("jGrowl.close"),a("#jGrowl").css({top:"",left:"",right:"0",bottom:"0",position:"fixed"}));a.jGrowl(b,{sticky:!0,beforeOpen:function(){g(l)},afterOpen:function(){M(c,d);N(c);document.getElementById("play-dictionary-audio")&&ra(a("#play-dictionary-audio"),c);h();f.applyBindings({},document.getElementById("jGrowl"))}})}if(d&&
!H){Y({eventName:ca,eventType:"Open pop-up dictionary"});H=!0;var n={query:encodeURI(d)};b=k||"/levels/{level}/growlbox/{service}/dictionary".inject({service:b,level:c});a.get(b,n).always(m)}},N=function(b){a("#growlbox-dictionary-more > a").on("click",function(a){Y({eventName:ca,eventType:"Click on Read full definition link",trackedEvent:a})})},T=function(b,c,d,e){c&&!H&&(H=!0,a.ajax({type:"POST",url:"/dtl/detl.aspx",data:Handlebars.templates["shared/melingo/data"]({langCode:d,query:c}),dataType:"xml",
contentType:"text/xml; charset=UTF-8",complete:function(f){f={words:a(f.responseXML).find("res").text()||e,query:c,showSpanishButton:"ES"==d,showArabicButton:"AR"==d,langCode:d.toLowerCase()};f=Handlebars.templates["shared/melingo/popup"](f);var k=a(".jGrowl-close");0<k.length&&k.parent().trigger("jGrowl.close");a.jGrowl(f,{sticky:!0,beforeOpen:g,afterOpen:function(){M(b,c);h()}})}}))},M=function(b,c){var d=a("button#growlbox-dictionary-switcher-arabic");d.hasClass("active")||(d.addClass("bound-function"),
d.click(function(){Y({eventName:ca,eventType:"Click on Arabic tab"});T(b,c,"AR","     .")}));d=a("button#growlbox-dictionary-switcher-spanish");d.hasClass("active")||(d.addClass("bound-function"),d.click(function(){Y({eventName:ca,eventType:"Click on Espanol tab"});if(a("html[lang=es-ES]").length){var d=Z();O("rae",b,d,void 0,void 0)}else T(b,c,"ES","La palabra que has introducido no est en el diccionario.")}));d=a("button#growlbox-dictionary-switcher-english");d.hasClass("active")||
(d.addClass("bound-function"),d.click(function(){O("mw",b,c,void 0,void 0)}));a("button#growlbox-dictionary-switcher-english").length&&a("div.jGrowl-notification").addClass("jGrowl-notification-with-tabs");H=!1},Z=function(){if(window.getSelection)return window.getSelection().toString();if(document.getSelection)return document.getSelection();if(document.selection)return document.selection.createRange().text},S=null,ba=function(){var a=/^\/levels\/(\w+)\/?/.exec(window.location.pathname);a&&(S=a[1])},
aa=function(){if(0<a("body").find(".cobrand-top").length&&!a("body").hasClass("elementary"))if(979<a(window).width()){var b=a(".cobrand-top").outerHeight(!0);a(".banner").css("padding-top",46+b+"px")}else a(".banner").css("padding-top",0)},X=function(b){var c=[],d=a("body").data(y.pageLoadFlags);d&&0<d.length&&(c=decodeURIComponent(d).split(","));return-1<c.indexOf(b)},V=function(){if(X(y.firstPageAfterLogin)){var b=S;b&&a.ajax({type:"GET",url:"/levels/{level}/welcome/intro".inject({level:b}),success:function(c){if(a.trim(c)){var d=
a(c);d.on("shown",function(){a("#welcome-overlay-get-started").click(function(){a("#opt-out-checkbox").prop("checked")&&a.ajax({type:"POST",url:"/levels/{level}/welcome/intro/exclude".inject({level:b})});d.modal("hide");return!1})});d.modal("show")}}})}},Y=function(b){if(window.ga&&b){if(b.eventName&&b.eventType&&window.ga&&window.ga(["send","event",b.eventName,b.eventType,b.eventLabel]),b.trackedEvent){var c=a(b.trackedEvent.target).attr("href");if(c)return b.trackedEvent.preventDefault(),setTimeout(function(){t(c)},
100),!1}}else b&&window.console&&window.console.log([b.eventName,b.eventType,b.eventLabel])},ca,da=function(b){a("html[lang=es-ES]").length&&function(){a("html[lang=es-ES]").removeClass("tall");a("#shared-wrapper").height()>a("html[lang=es-ES]").height()&&a("html[lang=es-ES]").addClass("tall")}.delay(b||300)},ga=function(){return!(!a("html[lang=es-ES]").length||!window.location.origin.has("escolar"))},ia=function(){return!(!a("html[lang=es-ES]").length||!window.location.origin.has("moderna"))},ja=
function(){return!!a("html[lang=pt-BR]").length},ka=function(){return/MSIE 8\.0/.test(navigator.userAgent)},na=function(a){a=a.replace("http://media.merriam-webster.com/audio/prons/en/us/mp3/","http://media.merriam-webster.com/soundc11/");return a=a.replace(".mp3",".wav")},ra=function(a,b){var c=a.siblings("audio"),d=a.siblings("iframe");0==d.length&&(d=a.parent().siblings("iframe"));var e=function(){Y({eventName:"Playback buzzword - "+b,eventType:"Play buzzword audio"})};if(EB.shared.isIE8())a.click(function(){e();
var a=na(c.attr("src"));d.attr("src","/levels/"+b+"/audio/specialCase?src="+encodeURIComponent(a));return!1});else{var f=p();c.attr("id",f);var g=new MediaElementPlayer("#"+f);a.click(function(){e();g.play();return!1})}},oa=function(){function a(d,e){d=d.compact();if(b.test(d)){var f;if(!0===e){var g="";f=d.encodeBase64();for(var h=0;h<f.length;h++)g+=f.charCodeAt(h).toString(16);f="-"+g}else f=d.replace(c,"");d=f}return d}var b=/[^a-z0-9_\-\s\.]/i,c=/[^a-z0-9_\-\s\.]/gi,d=/^\-[0-9A-Fa-f]+$/;return{regEx:/(.*?)(?:--|$|\/)/i,
normalize:a,fromUrl:function(a){if(d.test(a)){a=a.from(1);var b="";a.length%2&&(a="0"+a);for(var c=0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));a=b.decodeBase64()}return a.replace(/\-/gi," ")},toUrl:function(b,c){return a(b,c).replace(/\s/gi,"-")||""}}}(),pa="";a(document).ajaxComplete(function(a,b,c){a=!1;c.url&&(b=c.url.split("/"),"levels"==b[1]&&"search"==b[3]&&b[4].startsWith("autocomplete?term=")&&(a=!0));1==a&&d({url:c.url})});return{getLevelFromPath:function(){return S},
initShared:function(){a("html[lang=es-ES].middle").length&&(da(),a(document).ajaxComplete(da.debounce(200)));EB.handlebars.init(Handlebars);a(".chzn-select").chosen({width:"100%"});a(".chzn-select-deselect").chosen({allow_single_deselect:!0});ba();pa="/levels/"+S+"/getAssemblies?assemblies={assemblyIds}";B();a("body").hasClass("widget")||L(".search-query",S);A(".search-query");l(".search-query");U("#searchCriteria",".search-query");V();X(y.firstPageAfterLogin)?R():a.storage.get("hide-my-britannica")?
(z.show(),z.addClass("fade-right"),G.removeClass("fontello-icon-right-dir").addClass("fontello-icon-left-dir"),C.hide()):(E.show(),z.show(),z.css("right",E.outerWidth()),z.removeClass("fade-right"),G.removeClass("fontello-icon-left-dir").addClass("fontello-icon-right-dir"));a("img.lazy").lazyload();I();P();b();a(".no-realtouch .brand a").tooltip();a(window).load(function(){aa()});a(window).resize(function(){aa()});ja()||(J(S),ca="Pop-up dictionary - "+S);u();a(document).ajaxSuccess(u);ka()&&m();/iphone|ipod|ipad/gi.test(navigator.userAgent)&&
n()},speech:l,autocomplete:L,placeholder:A,relocateWithReferrer:t,validateSearch:U,removeFromArray:function(a,b){var c=b.indexOf(a);-1<c&&b.splice(c,1)},clearForm:function(a){a.find("input:text, input:password, input:file, select, textarea").val("");a.find("input:radio, input:checkbox").removeAttr("checked").removeAttr("selected")},constants:y,getUrlParameter:function(a){var b=EB.uriUtils.parse(window.location).queryString;return b&&b[a]?b[a]:null},isIE:function(){return/MSIE/.test(navigator.userAgent)},
isIE8:ka,trackEvent:Y,initAudioPlayback:ra,getLanguage:q,getCountry:function(){return a("body").data("country")},replaceLevelNames:function(){var b=e.locale(),c=x();"en-UK"==b&&"school"==c&&a(":not(textarea):not(input)").replaceText(/((elementary)|(foundation)|(primary))( )+((school)|(School))/g,e.string(c+".level1.name.lower")).replaceText(/((Elementary)|(Foundation)|(Primary))( )+((school)|(School))/g,e.string(c+".level1.name.capital")).replaceText(/((middle)|(intermediate))( )+((school)|(School))/g,
e.string(c+".level2.name.lower")).replaceText(/((Middle)|(Intermediate))( )+((school)|(School))/g,e.string(c+".level2.name.capital")).replaceText(/((high)|(advanced)|(secondary))( )+((school)|(School))/g,e.string(c+".level3.name.lower")).replaceText(/((High)|(Advanced)|(Secondary))( )+((school)|(School))/g,e.string(c+".level3.name.capital")).replaceText(/middle( )+and( )+((high)|(secondary))( )+school/gi,e.string(c+".level2.name.lower")+" and "+e.string(c+".level3.name.lower"));"en-US"==b&&"library"!=
c||a(":not(textarea):not(input)").replaceText(/elementary/g,e.string(c+".level1.name.lower")).replaceText(/Elementary/g,e.string(c+".level1.name.capital")).replaceText(/middle(( )+|\.|,|;)/g,e.string(c+".level2.name.lower")+" ").replaceText(/Middle(( )+|\.|,|;)/g,e.string(c+".level2.name.capital")+" ").replaceText(/high(( )+|\.|,|;)/g,e.string(c+".level3.name.lower")+" ").replaceText(/High(( )+|\.|,|;)/g,e.string(c+".level3.name.capital")+" ").replaceText(/favorite/g,e.string("spell.favorite.lower")).replaceText(/Favorite/g,
e.string("spell.favorite.capital"));"library"==c&&a(":not(textarea):not(input)").replaceText(/students/g,"users").replaceText(/student/g,"user").replaceText(/Students/g,"Users").replaceText(/Student/g,"User").replaceText(/school/g,"library").replaceText(/educators/g,"librarians").replaceText(/School/g,"Library");"academic"==c&&a(":not(textarea):not(input)").replaceText(/School/g,"Institution").replaceText(/Britannica Institution/g,"Britannica Academic").replaceText(/high(( )+|\.|,|;)/g,e.string(c+
".level3.name.lower")+" ").replaceText(/High(( )+|\.|,|;)/g,e.string(c+".level3.name.capital")+" ").replaceText(/students/g,"users").replaceText(/student/g,"user").replaceText(/Students/g,"Users").replaceText(/Student/g,"User").replaceText(/school/g,"institution").replaceText(/educators/g,"users");a(":not(textarea):not(input)").replaceText(/((Student)|(Teens)|(Intermediate)|(Young Adults))( )+East/g,"Middle East")},removeWordsForK8:function(){a(":not(textarea):not(input)").replaceText(/(( )+((and)|(or))( )+((high)( )+|(advanced)|(secondary)|(level( )+3))(( )+school)*)|(\(((middle)|(intermediate)|(level( )+2))(( )+school)*( )+and( )+((elementary)|(foundation)|(primary)|(level( )+1))( )+only\))/gi,
"")},getIndividualId:function(){return a("body").data("individualId")},getIndividualName:function(){return a("body").data("individualName")},getMWWavFilename:na,getMWMP3Filename:function(a){a=a.replace("http://media.merriam-webster.com/soundc11/","http://media.merriam-webster.com/audio/prons/en/us/mp3/");return a=a.replace(".wav",".mp3")},isLoggedIn:function(){return""!==a("body").data("individualId")},getLandingPageForLoginBox:function(){var a=window.location.href;-1<a.indexOf("#")&&(a=a.substring(0,
a.indexOf("#")));var b=EB.shared.constants.pageLoadFlags+"="+EB.shared.constants.firstPageAfterLogin,b="{0}{1}".format(-1<a.indexOf("?")?"&":"?",b);return a+=encodeURI(b)},getSiteType:x,setEscolarPageLengthStatus:da,isEscolar:ga,isModerna:ia,isEscola:ja,urlUtil:oa,trackGaEvent:k,fetchAssemblyMetadata:function(a,b){r(v(a)).then(function(c){w(a,c,b)})},writeAjaxStats:c,writeInternalStats:d,initPopupDictionary:J,getSiteName:function(){return window.location.origin.has("moderna")?e.string("academic.name"):
e.string(EB.shared.getSiteType()+".name")},getIsInternal:function(){return a("body").data("isInternal")},getAssemblyInfo:r,getAssemblyIdList:v,getPublishDate:function(){return new Date(parseInt(a("body").data("publishTimestamp")))}}}(jQuery,EB.i18n,ko);EB=window.EB||{};
EB.tagManager=function(a,e){function f(){k.subjects([]);var a="/levels/{level}/collection/load/subjects".assign({level:g});$.getJSON(a,{},function(a){var b=[];$.each(a,function(a,c){b=b.concat($.map(c,function(a){if(a.territory.territoryName.toLowerCase()==h.toLowerCase())return a}))});k.subjects(b)})}function d(){k.tags([]);var a="/levels/{level}/user/content/tag/listAllForCurrentTerritory".assign({level:g});$.getJSON(a,{},function(a){$.each(a,function(a,c){k.tags.push(ko.observable(new b(c)))})})}
function c(){var a=this;a.comingFromCustomizePack=ko.observable(!1);a.isTeacher=EB.userContentConfig.isTeacher;a.isMaster=EB.userContentConfig.isMaster;a.subjects=ko.observableArray([]);a.selectedSubject=ko.observable();a.tags=ko.observableArray([]);a.filterInput=ko.observable("");a.filterKeyword=ko.observable("");a.newTagName=ko.observable("");a.applyFilter=function(){a.filterKeyword(a.filterInput())};a.clearFilter=function(){a.filterKeyword("");a.filterInput("")};a.editClicked=function(a){a.editing(!0)};
a.saveEditClicked=function(a){$.ajax({type:"POST",url:"/levels/{level}/user/content/tag/rename".inject({level:g}),data:{tagId:a.id,tagName:a.name},dataType:"json",success:function(b){1==b?e(null,"Category successfully renamed",null,[],!0):(a.name(a.originalName),e(null,"Such name already exists",null,[],!0))}});a.editing(!1)};a.cancelSaveClicked=function(a){a.name(a.originalName);a.editing(!1)};a.deleteClicked=function(b){var c=!0;0<b.numOfPacks&&(c=confirm("This will delete category from all packs that are linked to it"));
1==c&&$.ajax({type:"POST",url:"/levels/{level}/user/content/tag/delete".inject({level:g}),data:{tagId:b.id},dataType:"json",success:function(c){1==c?(e(null,"Category successfully deleted",null,[],!0),a.tags.remove(function(a){return a().id==b.id})):e(null,"Error. Try again.",null,[],!0)}})};a.addNewTagClicked=function(){$.ajax({type:"POST",url:"/levels/{level}/user/content/tag/create".inject({level:g}),data:{tagName:a.newTagName(),subjectAreaId:a.selectedSubject().id},dataType:"json",success:function(c){c?
(e(null,"Category successfully added",null,[],!0),k.tags.push(ko.observable(new b(c))),a.newTagName("")):e(null,"Such name already exists",null,[],!0)}})}}var k,g,h,b=function(a){var b=this;b.id=a.id;b.subjectAreaId=a.subjectAreaId;b.originalName=a.name;b.numOfPacks=a.numOfPacks;b.name=ko.observable(a.name);b.editing=ko.observable(!1);b.hasSubstring=function(a){return 0<=b.name().toLowerCase().indexOf(a.toLowerCase())}};return{init:function(){g=EB.shared.getLevelFromPath();h=$("body").data("country");
k=new c;ko.applyBindings(k);f();d()}}}(EB.i18n,EB.Overlay);EB=window.EB||{};
EB.timelineDisplay=function(a,e){function f(a,b){var c,d,e,f,g,k=(""+a).split(" "),v=k[0],k=k[1]||"";v&&(e=v.split("-"),c=e[0]||"",d=e[1]||"",e=e[2]||"","bc"==b||"bc2"==b)&&(c=-c);k&&(g=k.split(":"),f=g[0]||"",g=g[1]||"");return{year:c,month:d,day:e,hour:f,minute:g,second:"",millisecond:"",format:""}}function d(a){if("string"==typeof a)return a;if(Object.isArray(a))return a.flatten().join(" ").replace(/(\s)([,.?!])/g,"$2");if("string"==typeof a.content)return a.content;if(Object.isArray(a.content))return a.content.join(" ").replace(/(\s)([,.?!])/g,
"$2")}function c(a){if(a=a.thumbasm)return{caption:d(a.thumbcap),credit:a.thumbcred,url:a.asset.deployfullfilename}}function k(a){return a.map(function(a){var e={},g=a.date;e.start_date=g&&f(g.start,g.startera);e.end_date=g&&g.end&&f(g.end,g.endera);e.text={headline:d(a.entrytitle).stripTags(),text:d(a.entrytext)};e.media=c(a.entrytext);return e})}var g=window.location.pathname.split("/").remove("").last();return{init:function(){var f=EB.shared.getLevelFromPath();e.getJSON("/levels/"+f+"/timeline/ajax/"+
g).done(function(b){var e=b&&b.article||{};b=Object.isArray(e.entry)&&k(e.entry)||[];var f=b.find(function(a){return a.media}),e={text:{headline:(e.title&&e.title.titltxt&&d(e.title.titltxt)).stripTags(),text:e.titledesc&&d(e.titledesc)||""},background:{url:(e.title&&e.title.titltxt&&c(e.title.titltxt)||f&&f.media).url,color:"#000"}};document.title=document.title.replace(/(.+)--(.+)/,e.text.headline+" -- $2");a.applyBindings({});new TL.Timeline("timeline-embed",{events:b,title:e},{height:500,width:"100%",
hash_bookmark:!0})})}}}(ko,jQuery);EB=window.EB||{};EB.timelines=function(a,e){return{init:function(){var f=EB.shared.getLevelFromPath();e.getJSON("/levels/"+f+"/timeline").done(function(d){d=Object.isArray(d)&&d||[];d.each(function(a){a.url="/levels/"+f+"/timeline/view/"+a.id});a.applyBindings({timelines:d})})}}}(ko,jQuery);EB=window.EB||{};
EB.Tools=function(a,e){var f=!1,d=!1,c=!1,k=!1,g=!1,h=!1,b=!1,m=!1,n=!1,p=!1,q=!1,u=!1,x=!1,v=!1,r=!1,w=!1,y=!1,t=!1,D,B=a("#toolbar-content"),E,z=[71.4285714,78.5714286,85.7142857,92.8571429,100,107.1428571,114.2857143,121.4285714,128.5714286],G=4,C=z.length-1,I=21,R=function(){if(y)B.css("z-index","1500"),B.css("right",0);else if(B.length){a("#header-tools-container").length?B.css("right",0):B.css("right",a(window).width()-(D.offset().left+D.outerWidth()));B.css("z-index","1500");var b=a("#header-toolbar");
b.length&&!B.hasClass("sticky-toolbar")&&B.css("top",b.outerHeight()+a(".levels-ctn").outerHeight())}},P=3,l=function(b){b=G+b;0<=b&&b<=C&&(G=b,a(".resizable-content").css("font-size",z[G]+"%"))},L=function(b,c,d,e){return a(b).find(c).css("font-size",function(a,b){return parseInt(b,10)+d*e})},A=function(d){var e=null,l="",t="",y={};f&&(e=L(".accordion-inner","p",d,3),l=I+3*d,a(".accordion-inner").find("p").css("line-height",l+"px"),I=l,l=".accordion-body",t="p");u&&(e=L(".modal","p, .rg-credit, b, h3, h4",
d,3));if(g||h||b||m)e=L(".content","p:visible, .shortCaption",d,2),l=".content",t="li",y={buttonScrollUp:!0,buttonScrollDown:!1};n||c||k||p||r||w?(e=L(".results, .magazine-article, .content","p, a, .shortCaption, i, cite, time, dt, dd, dfn, li, .browse-animals-type, h3, td",d,2),l=".content",t=c?"p":"li, dt, dd",y={buttonScrollUp:!0,buttonScrollDown:!1}):x||v?L(".content","p:visible, a, li, label, span, h2, h3, h4, h5",d,3):q&&L(".help-results","p:visible, a, span, h2, h3, h4, h5",d,3);T(e.parent(),
l,t,y)},U=function(){a(".search.elementary .accordion-footing a.dn").click()}.throttle(1E3),H=function(b,c){b.mousewheel(function(d,e){var f=d.target.nodeName!==b.get(0).nodeName?a(d.target).parentsUntil(c).last():a(d.target),g=f.scrollTop(),h=f.get(0).scrollHeight,k=f.innerHeight();0>e&&h-g===k?U():f.scrollTop(g-40*e);return!1})},Q=new a.Deferred,F=function(b,c){var d=b.find("a");d.find("img").show();a("html").hasClass("no-realtouch")&&d.tooltip();b.find("a.up").addClass("disabled");b.find("a.dn").removeClass("disabled");
if(c.buttonScrollDown)b.on("click","a.dn",function(){Q.then(J(a(this).parent().prevAll(".results:visible, .accordion-inner, .magazine-article"),b,!1));return!1});if(c.buttonScrollUp)b.on("click","a.up",function(){Q.then(O(a(this).parent().prevAll(".results:visible, .accordion-inner, .magazine-article"),b));return!1})},J=function(a,b,c){a.animate({scrollTop:"+="+a.height()},{duration:1500,specialEasing:{width:"linear",height:"easeInOutQuad"},complete:function(){var d=a.outerHeight(),e=a[0].scrollHeight;
a.scrollTop()>=e-d&&!c&&b.find("a.dn").addClass("disabled");b.find("a.up").removeClass("disabled")}})},O=function(a,b){a.animate({scrollTop:"-="+a.height()},{duration:1500,specialEasing:{width:"linear",height:"easeInOutQuad"},complete:function(){0==a.scrollTop()&&b.find("a.up").addClass("disabled");b.find("a.dn").removeClass("disabled")}})},N=function(a,b){a.find("a.up, a.dn").addClass("disabled").find("img").hide();b.buttonScrollDown&&a.off("click","a.dn");b.buttonScrollUp&&a.off("click","a.up")},
T=function(b,c,d,e){e=a.extend({buttonScrollUp:!0,buttonScrollDown:!0,pages:1},e);b.each(function(){var b=a(this),f=b.height(),g=parseFloat(b.css("padding-top"));b.find(d).each(function(){g+=a(this).outerHeight(!0)});var h=!1;b.find("#article-media").each(function(){a(this).outerHeight(!0)>f&&(h=!0)});g>f||1<e.pages||h?(H(b,c),F(b.nextAll(".accordion-footing"),e)):(b.unmousewheel(),N(b.nextAll(".accordion-footing"),e))})};return{init:function(){function z(a){return a&&a[0].toUpperCase()+a.slice(1)}
D=a("#article-content, #article-media-content, #lesson-plan-details");B=a("#toolbar-content");var C=a("body");f=C.hasClass("article");d=C.hasClass("media");c=C.hasClass("magazine");k=C.hasClass("search");g=C.hasClass("browse");h=C.hasClass("browse-index");m=C.hasClass("browse-list");b=C.hasClass("browse-games");n=C.hasClass("compare");p=C.hasClass("related");q=C.hasClass("help");u=C.find("#media-gallery.modal").length;x=C.hasClass("teacher");v=C.hasClass("educators");r=C.hasClass("lessons");w=C.hasClass("resources");
y=C.find(".article-overlay-left").length;t=C.find(".resizable-content").length;E=EB.shared.getLevelFromPath();var I="Email - "+E,F="Tools menu - "+E,G="Translate - "+E,H=a("#header-tools-container"),J=a("#header-tools"),O=a("#remove-toolbar");a.storage.get("toolbar_off")&&H.addClass("toolbar-off");H.find(".not-hideable.item").length||H.addClass("no-hideable-item");a(J).on("click",function(){EB.shared.trackEvent({eventName:F,eventType:"Open Tools menu"});H.removeClass("toolbar-off");a.storage.remove("toolbar_off")});
a(O).click(function(){EB.shared.trackEvent({eventName:F,eventType:"Close Tools menu"});H.addClass("toolbar-off");a.storage.set("toolbar_off",!0)});a("#tool-print").click(function(b){b.preventDefault();EB.shared.trackEvent({eventName:"Print - "+E,eventType:"Open Print popover"});if(d||a("body").hasClass("modal-open")){b=a("#media-citation");Date.setLocale(EB.shared.getLanguage());var c=Date.create().format(e.string("handlebar.cite.date.year.format")),g=Date.create().format(e.string("handlebar.cite.date.month.format")),
h=Date.create().format(e.string("handlebar.cite.date.mon.format")),k=Date.create().format(e.string("handlebar.cite.date.day.format")),l=a(".gallery-media-metadata h3").text(),m=a(this).parent().parent().find(".tool-cite").attr("citeType"),n=EB.shared.getPublishDate(),p=n.format(e.string("handlebar.cite.date.year.format")),q=n.format(e.string("handlebar.cite.date.mon.format")),n=n.format(e.string("handlebar.cite.date.day.format")),c={heading:e.string("header.tools.cite"),intro:e.string("handlebar.cite.intro"),
mlaFormat:e.string("handlebar.cite.assembly.mla.format").assign({assemblyTitle:l,assemblyType:m,year:c,day:k,mon:h,month:g,pubYear:p,pubDay:n,pubMon:q,url:a(this).parent().parent().find(".tool-cite").attr("citeLink"),urlWithoutProtocol:a(this).parent().parent().find(".tool-cite").attr("citeLink").replace(/.*?:\/\//g,"")}),apaFormat:e.string("handlebar.cite.assembly.apa.format").assign({assemblyTitle:l,assemblyType:m,year:c,day:k,mon:h,month:g,url:a(this).parent().parent().find(".tool-cite").attr("citeLink")}),
harvardFormat:e.string("handlebar.cite.assembly.harvard.format").assign({assemblyTitle:l,assemblyType:m,year:c,day:k,mon:h,month:g,url:a(this).parent().parent().find(".tool-cite").attr("citeLink")}),chicagoFormat:e.string("handlebar.cite.assembly.chicago.format").assign({assemblyTitle:l,assemblyType:m,year:c,day:k,mon:h,month:g,url:a(this).parent().parent().find(".tool-cite").attr("citeLink")}),abntFormat:e.string("handlebar.cite.assembly.abnt.format").assign({assemblyTitle:l,assemblyType:m,year:c,
day:k,month:g,siteTitle:EB.shared.getSiteName(),url:a(this).parent().parent().find(".tool-cite").attr("citeLink")})};b.html(Handlebars.templates["tools/citeMediaPrint"](c));EB.Tools.getCitationCookie();EB.shared.isEscola()||(b=EB.Tools.getCitationCookie(),void 0!==b&&null!==b?(a("#media-citation li").hide(),a("#"+b+"-citation").show()):(a("#media-citation li").hide(),a("#mla-citation").show()));window.print()}else f||y?(b=a(this).attr("printLink"),window.open(b,"_blank")):window.print()});a(".tool-cite").click(function(){var b=
"Cite - "+E;EB.shared.trackEvent({eventName:b,eventType:"Open Cite popover"});Date.setLocale(EB.shared.getLanguage());var c=Date.create().format(e.string("handlebar.cite.date.year.format")),d=Date.create().format(e.string("handlebar.cite.date.month.format")),f=Date.create().format(e.string("handlebar.cite.date.mon.format")),g=Date.create().format(e.string("handlebar.cite.date.day.format")),h={};if("article"===a(this).attr("citeType")){var k=z(a.trim(a("h1.banner-title").text())),l,h=a("#article-content, #history-content, #magazine-content, .article-content-inner").data("publishTimestamp");
l=void 0!==h&&0===h.length?EB.shared.getPublishDate():void 0!==h?new Date(parseInt(h)):new Date;var h=l.format(e.string("handlebar.cite.date.year.format")),m=l.format(e.string("handlebar.cite.date.mon.format"));l=l.format(e.string("handlebar.cite.date.day.format"));h={heading:e.string("header.tools.cite"),intro:e.string("handlebar.cite.intro"),label:e.string("handlebar.cite.select.label"),mlaFormat:e.string("handlebar.cite.article.mla.format").assign({title:k,year:c,day:g,mon:f,month:d,pubYear:h,
pubDay:l,pubMon:m,siteTitle:EB.shared.getSiteName(),url:document.location,urlWithoutProtocol:document.location.href.replace(/.*?:\/\//g,"")}),apaFormat:e.string("handlebar.cite.article.apa.format").assign({title:k,year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:document.location}),harvardFormat:e.string("handlebar.cite.article.harvard.format").assign({title:k,year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:document.location}),chicagoFormat:e.string("handlebar.cite.article.chicago.format").assign({title:k,
year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:document.location}),abntFormat:e.string("handlebar.cite.article.abnt.format").assign({title:k,year:c,day:g,month:d,siteTitle:EB.shared.getSiteName(),url:document.location})}}else{var k=a(".gallery-media-metadata h3").text(),n=a(this).attr("citeType");l=EB.shared.getPublishDate();h=l.format(e.string("handlebar.cite.date.year.format"));m=l.format(e.string("handlebar.cite.date.mon.format"));l=l.format(e.string("handlebar.cite.date.day.format"));
h={heading:e.string("header.tools.cite"),intro:e.string("handlebar.cite.intro"),label:e.string("handlebar.cite.select.label"),mlaFormat:e.string("handlebar.cite.assembly.mla.format").assign({assemblyTitle:k,assemblyType:n,year:c,day:g,mon:f,month:d,pubYear:h,pubDay:l,pubMon:m,siteTitle:EB.shared.getSiteName(),url:a(this).attr("citeLink"),urlWithoutProtocol:a(this).attr("citeLink").replace(/.*?:\/\//g,"")}),apaFormat:e.string("handlebar.cite.assembly.apa.format").assign({assemblyTitle:k,assemblyType:n,
year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:a(this).attr("citeLink")}),harvardFormat:e.string("handlebar.cite.assembly.harvard.format").assign({assemblyTitle:k,assemblyType:n,year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:a(this).attr("citeLink")}),chicagoFormat:e.string("handlebar.cite.assembly.chicago.format").assign({assemblyTitle:k,assemblyType:n,year:c,day:g,mon:f,month:d,siteTitle:EB.shared.getSiteName(),url:a(this).attr("citeLink")}),abntFormat:e.string("handlebar.cite.assembly.abnt.format").assign({assemblyTitle:k,
assemblyType:n,year:c,day:g,month:d,siteTitle:EB.shared.getSiteName(),url:a(this).attr("citeLink")})}}B.html(Handlebars.templates["tools/cite"](h));c=a("#citation-select");c.on("focus",function(){EB.shared.trackEvent({eventName:b,eventType:"Click on dropdown menu in Cite popover"})});c.change(function(){var c=a("#citation-select").val();a("#toolbar-content ul li").hide();a("#"+c+"-citation").show();EB.shared.trackEvent({eventName:b,eventType:"Citation style selected from Cite popover",eventLabel:"Selected citation style - "+
c});a.cookie("citationFormat",c,{expires:3650,path:"/"})});a("#toolbar-content-close").click(function(){B.hide().html("")});EB.shared.isEscola()||(void 0!==a.cookie("citationFormat")&&null!==a.cookie("citationFormat")?(d=a.cookie("citationFormat"),c.val(d),a("#toolbar-content ul li").hide(),a("#"+d+"-citation").show()):(a("#citation-select option").first().attr("selected","selected"),a("#toolbar-content ul li").first().show()));R();y?B.css("width","550px"):"700"<D.width()?(B.css("max-width","700px"),
B.css("width","auto")):B.css("width",D.width());B.show();setTimeout(function(){B.find("#citation-select").focus()},600)});var N=a("#email-modal").modal({keyboard:!0,show:!1});a(".tool-email").click(function(){EB.shared.trackEvent({eventName:I,eventType:"Open Email popover"});N.modal("show");EB.shared.placeholder("#recipients");EB.shared.placeholder("#senderName");EB.shared.placeholder("#senderEmail");return!1});a('#emailCriteria button[type="reset"]').on("click",function(){EB.shared.trackEvent({eventName:I,
eventType:"Click on cancel button in Email popover"})});a("#emailCriteria").submit(function(){if(a(this).hasClass("failedSubmit"))EB.shared.trackEvent({eventName:I,eventType:"Incorrect completion of email article form"});else{EB.shared.trackEvent({eventName:I,eventType:"Click on submit button in Email popover"});var b=this.action;a.ajax({url:b,type:this.method,data:a(this).serialize(),dataType:"json",beforeSend:function(){N.modal("hide")},success:function(c){EB.shared.writeInternalStats({url:b});
a.jGrowl(c.message,{life:3E3,position:"bottom-right"})}})}return!1});a("#email-modal").on("hidden",function(){var b=a(this);EB.shared.clearForm(a("#emailCriteria"));b.find("input, textarea").parent().removeClass("invalid error");b.find("span.help-inline").addClass("visuallyhidden")});a("#tool-font-down").click(function(a){a.preventDefault();t?l(-1):6>P++?f?L("article.content","p:visible, a, span, li, label, figcaption, h1, h2, h3, h4, h5, td",-1,1):g?L(".content","p:visible, .shortCaption",-1,1):
h||b?L(".content","p:visible, .entry",-1,1):y?L(".article-content .article-overlay-left .article-title-container, .article-content .article-overlay-left article","p:visible, a, span, li, h1, h2, h3, h4, h5, td",-1,1):L(".content, .gallery-media-metadata, .compare-content, #help-content","p:visible, a, span, li, .shortCaption, label, figcaption, h1, h2, h3, h4, h5, td, .assembly-caption, .assembly-credit",-1,1):P=6});a("#tool-font-up").click(function(a){a.preventDefault();t?l(1):0<P--?f?L("article.content",
"p:visible, a, span, li, label, figcaption, h1, h2, h3, h4, h5, td",1,1):g?L(".content","p:visible, .shortCaption",1,1):h||b?L(".content","p:visible, .entry",1,1):y?L(".article-content .article-overlay-left .article-title-container, .article-content .article-overlay-left article","p:visible, a, span, li, h1, h2, h3, h4, h5, td",1,1):L(".content, .gallery-media-metadata, .compare-content, #help-content","p:visible, a, span, li, .shortCaption, label, figcaption, h1, h2, h3, h4, h5, td, .assembly-caption, .assembly-credit",
1,1):P=0});a(".no-realtouch .tool a, .no-realtouch .tts-controls a, .no-realtouch .toc-invoker").tooltip();a(".no-realtouch .levels a").tooltip({placement:"bottom"});if(f||c||k||g||h||b||m||n||p||q||u||x||v||r||w)a(".tool-font-increase").click(function(a){a.preventDefault();t?l(1):6>P++?A(1):P=6;return!1}),a(".tool-font-decrease").click(function(a){a.preventDefault();t?l(-1):0<P--?A(-1):P=0;return!1});a("#tool-translate").click(function(){EB.shared.trackEvent({eventName:G,eventType:"Open Translate popover"});
B.html(a("#translate-dialog").clone());B.children().show();a("#google_translate_element").length&&a.getScript("http://translate.google.com/translate_a/element.js?cb=EB.Tools.googleTranslateElementInit");a("#bing_translate_element").length&&a.getScript("http://www.microsofttranslator.com/ajax/v3/widgetv3.ashx?siteData=ueOIGRSKkd965FeEGM5JtQ**",function(){Microsoft.Translator.Widget.GetLanguagesForTranslate("en",function(b){for(var c in b)a("#bing_translate_element select").append("<option value='"+
b[c].Code+"'>"+b[c].Name+"</option>")},null)});a("#bing_translate_element select").change(function(){a("body").addClass("ltr");Microsoft.Translator.Widget.Translate("en",a(this).val())});EB.Tools.setToolbarContentPosition();B.css("width","220px").show();a("#toolbar-content-close").click(function(){B.hide().html("")})});C.on("focus","select.goog-te-combo",function(){EB.shared.trackEvent({eventName:G,eventType:"Click on language dropdown menu in Translate popover"})});C.on("change","select.goog-te-combo",
function(){var b=a("select.goog-te-combo"),c=b.val(),d="";b.find("option").each(function(){var b=a(this);if(b.val()===c)return d=b.text(),!1});EB.shared.trackEvent({eventName:G,eventType:"Language selected from dropdown menu in Translate popover",eventLabel:d});window.innerHeight+window.scrollY>=document.body.offsetHeight&&a(window).scrollTop(0)})},setToolbarContentPosition:R,setDynamicToolbarContentPosition:function(b,c){B.length&&(a("body").append(B),b+B.width()>a(window).width()&&0<b-B.width()?
(B.css("left",""),B.css("right",a(window).width()-b)):(b+B.width()<a(window).width()?B.css("left",b):B.css("left",(a(window).width()-B.width())/2),B.css("right","")),B.css("top",c+15),B.css("z-index","1000"),B.css("position","absolute"))},updateScrollControlBindings:T,disableScrollButtons:N,animateScrollDown:J,animateScrollUp:O,getCitationCookie:function(){if(void 0!==a.cookie("citationFormat")&&null!==a.cookie("citationFormat"))return a.cookie("citationFormat")},googleTranslateElementInit:function(){a("#google_translate_element").html("");
new google.translate.TranslateElement({pageLanguage:"en"},"google_translate_element")},resetFontIndex:function(){P=3;G=4;I=21}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.tts=function(){var a="down",e,f,d,c=0,k,g,h,b=null,m=null,n=null,p=!1,q=!1,u=!1,x=function(a){var b="http://{host}/generate?format={fileType}&speaker_id={speakerId}&text={text}".replace("{host}",g),b=b.replace("{text}",a);if(0===d)b=b.replace("{fileType}","10");else if(2===d)b=b.replace("{fileType}","18");else if(1===d||3===d)b=b.replace("{fileType}","1");var c;if("US"===EB.shared.getCountry()||"CA"===EB.shared.getCountry()||"AS"===EB.shared.getCountry()||"IN"===EB.shared.getCountry())c="103";
else if("UK"===EB.shared.getCountry()||"AU"===EB.shared.getCountry()||"NZ"===EB.shared.getCountry())c="500";return b=b.replace("{speakerId}",c)},v=function(){f=$("#tts-object-player")[0];f.attachEvent("playStateChange",r);e=null},r=function(){8===f.playstate&&window.setTimeout(y,50)},w=function(){y()},y=function(){var a=k.pop();if(a){var b=c,d=$("#tts-"+(b-1)),b=$("#tts-"+b);0<d.length&&d.removeClass("highlight");b.addClass("highlight");u=!1;e?($.browser.webkit&&-1===navigator.userAgent.indexOf("Chrome")&&
-1!==navigator.userAgent.indexOf("Windows")&&(e=new Audio,e.addEventListener("ended",w)),e.src=x(encodeURIComponent(a)),e.autoplay=!0,e.play&&e.play()):f&&(f.URL=x(encodeURIComponent(a)));c+=1}else z()},t=function(a){var b=[],c="";if((a=a.split(" "))&&a instanceof Array)for(var d=a.length,e=0;e<d;e++){var f=$.trim(a[e]);f&&(2<f.length&&/[\.!,\?;:"]/g.test(f.charAt(f.length-1))||/(\.")/g.test(f)?(c+=f,b.push(c),c=""):c+=f+" ")}$.trim(c)&&b.push($.trim(c));return b},D=function(){if(q||""==m)q||""!=
m||($("#tts-play-pause i").toggleClass("fontello-icon-pause"),$("#tts-play-pause i").toggleClass("fontello-icon-play"));else{void 0!=h?h.removeClass("fontello-icon-play").addClass("fontello-icon-pause"):($("#tts-play-pause i").hasClass("fontello-icon-play")&&($("#tts-play-pause i").removeClass("fontello-icon-play"),$("#tts-play-pause i").addClass("fontello-icon-pause")),$(".tts-toggle").hasClass("fontello-icon-play")&&($(".tts-toggle").removeClass("fontello-icon-play"),$(".tts-toggle").addClass("fontello-icon-stop")));
q=!0;n=m.html();m.addClass("tts-cur-read-par");var b,d;d=m.text();b=[{find:/[]/g,replaceWith:'"'},{find:/(|)/g,replaceWith:"-"},{find:/[]/g,replaceWith:"ae"}];for(var e in b)d=d.replace(b[e].find,b[e].replaceWith);if(p)b="<span class='tts-cur-read'>"+G(d)+"</span>";else{e=String(d);b="";if((e=t(e))&&e instanceof Array)for(var f=e.length,g=0;g<f;g++){var r=$.trim(e[g]);r&&(b+="<span id='tts-"+g+"'>"+r+"</span> ")}b="<span class='tts-cur-read'>"+b+"</span>"}m.html("<span class='ttsPara'>"+b+"</span>");
if(d=d.replace(/[^\000-\177]/gi,""))try{u=!0;if(p)c=0,k=d.split(" ").reverse();else{c=0;var v=t(d);k=v?v.reverse():[d]}y()}catch(w){}else"down"==a?z():E()}},B=function(){if(!1===u)try{if(e&&e.pause)e.pause();else if(f)try{f.controls.stop()}catch(a){}q&&(m.html(n),m.removeClass("tts-cur-read-par"),q=!1);void 0!=h?h.removeClass("fontello-icon-pause").addClass("fontello-icon-play"):($("#tts-play-pause i").hasClass("fontello-icon-pause")&&($("#tts-play-pause i").removeClass("fontello-icon-pause"),$("#tts-play-pause i").addClass("fontello-icon-play")),
$(".tts-toggle").hasClass("fontello-icon-stop")&&($(".tts-toggle").removeClass("fontello-icon-stop"),$(".tts-toggle").addClass("fontello-icon-play")))}catch(a){}},E=function(){B();a="up";if(!1===u){var c=b.index(m)-1;m=0<=c?b.eq(c):b.first()}},z=function(){B();a="down";if(!1===u){var c=b.index(m)+1;b.length>c?(m=b.eq(c),D()):m=b.first()}},G=function(a){a=String(a);var b="";a=a.split(/\s+/);$.each(a,function(a,c){0<$.trim(c).length&&(b+="<span id='tts-"+a+"'>"+c+"</span> ")});return b};return{init:function(){g=
$("#article-content").data("ttsServer");$.browser.msie?(d=3,v()):"Audio"in window?(e=new Audio,e.canPlayType&&e.canPlayType('audio/ogg; codecs="vorbis"').replace(/no/,"")?d=0:e.canPlayType&&e.canPlayType('audio/wav; codecs="1"').replace(/no/,"")?d=1:e.canPlayType&&e.canPlayType("audio/mp4").replace(/no/,"")&&(d=2),e.addEventListener("ended",w)):(d=4,v())},load:function(a){b=a;m=0<b.filter("label.selected").length?b.filter("label.selected").first():b.first()},play:D,stop:B,rewind:E,fastForward:z,setWordByWordPlayback:function(a){p=
a},setTtsServerIp:function(a){g=a},setSelectedElement:function(a){h=a}}}();EB=window.EB||{};
EB.uriUtils=function(a){var e=function(a){var d="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(String(a));for(var c={},e=14;e--;)c[d[e]]=a[e]||"";c.queryString={};c[d[12]].replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,d,b){d&&(c.queryString[d]=
b)});return c};return{parse:e,hasAnchor:function(a){return 0!==e(a).anchor.length},anchorToQuery:function(a){var d=e(a);return d.anchor.length?d.directory+"?anchor="+d.anchor:a}}}(jQuery);EB=window.EB||{};
EB.userContent=function(a,e){function f(a,b){$(b.target).parents("[role=overlay]").addClass("hide")}function d(){$(".ud-row-activecontent").removeClass("hide");$("#ud-delete-question").addClass("hide");$("#ud-delete-question-bottom-margin").addClass("hide");$("#ud-delete-question").insertAfter($("#ud-bottom-row"));$("#ud-delete-question-bottom-margin").insertAfter($("#ud-delete-question"))}function c(a,b){document.getElementById("file-uploader").value="";d();f(a,b)}function k(a){var b="",c="";1024>
a?(b="B",c=a):1048576>a?(b="KB",c=a/1024):1073741824>a&&(b="MB",c=a/1048576);Math.floor(c)!=c&&(c=c.toFixed(2));return c+b}function g(){P.addClass("hide");E(!1);var b=document.getElementById("file-uploader"),c=b.files[0],d=new FormData;d.append("document",c);var f="/levels/{level}/user/content/upload/document".inject({level:F});$.ajax({url:f,type:"POST",data:d,processData:!1,contentType:!1,success:function(c){EB.shared.writeInternalStats({url:f});b.value="";c={contentId:c.savedContentId,contentType:"UPLOADED_DOCUMENT",
packId:W().id};var d="/levels/{level}/favorites/addContentToPack".inject({level:F});$.post(d,c).done(function(b){0<parseInt(b,10)?ya():e(null,a.string("my.content.alerts.content.can.not.be.added"))}).fail(function(){e(null,a.string("my.content.alerts.content.can.not.be.added"))})},error:function(a,c,d){b.value="";console.log(d)}})}function h(){Object.keys(ia).each(function(a){ja[a]=ko.observable()})}function b(){var a=fa()&&V()?V().id:K.contentType().id,b=fa()?"favorites":"search";switch(a){case "image":case "video":K.template(b+
"-result-media");break;case "article":K.template(b+"-result-article");break;default:K.template(b+"-result-other")}}function m(a,b){if(W()&&ka()){var c=ka()[a].map(function(a){return a.id+""});b?W().subjectIds(W().subjectIds().concat(c).unique()):W().subjectIds(W().subjectIds().subtract(c).unique())}}function n(a){var b="/levels/{level}/collection/load/subjects".assign({level:F});$.getJSON(b,{},function(b){var c=[];Object.keys(b,function(a,b){c.add(Object.keys(b.groupBy(function(a){return a.territory.territoryName})));
oa[a]=ko.observable(!1);oa[a].subscribe(function(b){m(a,b)});b.forEach(function(a){a.territory.territoryName==O.toLowerCase()&&pa.push({id:a.id,name:a.name})})});na(c.unique());ka(b);$.each(b,function(a,b){$.each(b,function(b,c){c.territory.territoryName==O.toLowerCase()&&B[a].add(c.id)})});a()})}function p(){this.isEscolar=EB.shared.isEscolar();this.isTeacher=N=EB.userContentConfig.isTeacher;this.isMaster=EB.userContentConfig.isMaster;this.isStudent=EB.userContentConfig.isStudent;this.currentPage=
ko.observable(0);this.isLoadMoreVisible=ko.observable(!0);this.noTranscriptMsg="";"es"===EB.shared.getLanguage()&&(this.noTranscriptMsg=a.string("media.video.no.transcript.text"))}function q(){var b=this;b.selectedFavoriteType=ba;b.selectedFavoriteTypeForAddingContent=V;b.availableFavoriteTypes=aa;b.simplifiedContentTypes=X;b.favorites=ca;b.openEmailModal=Pa;b.openSharePackModal=Qa;b.openUploadDocumentDialog=Ra;b.fetchUploadedDocument=Sa;b.loadUploadedDocuments=ya;b.loadAllUploadedDocuments=Ta;b.uploadedDocuments=
Ba;b.allUploadedDocuments=Ca;b.doUploadDocument=g;b.allowedExtensions=D;b.documentUploadLegalDisclaimerAccepted=E;b.fileUploadDocumentSizePassesMaxSizeCheck=I;b.fileUploadFileName=z;b.fileUploadFileSize=G;b.fileUploadCurrentTotalSize=C;b.fileUploadMaxTotalSize=104857600;b.formatFileSize=k;b.closeParentOverlay=f;b.closeDocumentUploadOverlay=c;b.clearDeleteInChooserTableRow=d;b.allowPublishing=Z;b.editPackMode=la;b.localGrades=ga;b.allowedSubjects=ko.observableArray();$.each(B,function(a,c){b.allowedSubjects.push(a)});
b.isInternal=EB.shared.getIsInternal();b.selectedAllGrades=ja;b.allGradeIds=ia;b.country=O;b.allSubjects=ka;b.localSubjects=ko.observableArray();b.subjectTerritories=na;b.selectedSingleSubject=ra;b.selectedGradeRange=ko.observableArray();b.internalSubjects=oa;b.currentPack=W;b.contentTypeCounts=Oa;b.onSortChange=Ua;b.visiblePackPointer=Y;b.labels=da;b.unfilteredLabels=[];b.labelsLoading=ko.observable(!1);b.allFavoritesCount=ko.observable(0);b.isThistleLoading=T;b.isLoadingResults=M;b.newLabelName=
ko.observable("");b.labelNameRequired=ko.observable(!1);b.isEditingCollectionName=ko.observable(!1);b.collectionName=ko.observable("");b.isAddingCollection=ko.observable(!1);b.newCollectionName=ko.observable("");b.shortUrl=ko.observable("");b.filtersVisible=ko.observable(!1);b.filterThistleVisible=ko.observable(!1);b.searchKeyword=ko.observable("");b.lastEditedChoices=[{id:1,name:"Past day"},{id:7,name:"Past week"},{id:30,name:"Past month"}];b.selectedLocalSubjects=ko.observableArray();b.selectedGrades=
ko.observableArray();b.selectedLastEditedDates=ko.observableArray();b.availableTagsForCurrentTerritory=ko.observableArray();b.availableTagsForSubject=ko.observable({});$.each(B,function(a,c){b.availableTagsForSubject()[a]=ko.observableArray([])});b.selectedTag=ko.observable({});$.each(B,function(a,c){b.selectedTag()[a]=ko.observableArray([])});b.convertToLpHeader=ko.observable();b.convertToLpMode=ko.observable(!1);b.selectedAddtnlField=ko.observable();b.selectedAdditionalFields=ko.observableArray();
b.gradeLevels=ko.observableArray();b.durationMins=ko.observableArray();b.durationDays=ko.observableArray();b.subjectGroups=ko.observableArray();b.additionalFields=ko.observableArray();b.procedures=ko.observableArray();b.materials=ko.observableArray();b.lessonPlan=ko.observable(null);b.showErrors=ko.observable(!1);b.currLessonPlanId=ko.observable(null);b.isEditMode=ko.observable(!1);b.showResources=ko.observable(!1);b.showDetailError=ko.observable(!1);b.showSubjectError=ko.observable(!1);b.comingFromCustomizePack=
v;b.isEscolar=EB.shared.isEscolar();b.isModerna=EB.shared.isModerna();b.isEscola=EB.shared.isEscola();b.backToPacks=w;b.getSubjectFromAllSubjects=function(a){return b.allSubjects()[a].find(function(a){return a.territory.territoryName==O.toLowerCase()})};b.linkTag=function(a){var c="/levels/{level}/user/content/tag/link".inject({level:F});$.ajax({type:"POST",url:c,data:{tagId:b.selectedTag()[a]().id,packId:b.currentPack().id},dataType:"json",success:function(d){EB.shared.writeInternalStats({url:c});
d?(b.currentPack().tags.push(b.selectedTag()[a]()),b.filterSelectedTags(),b.filterAvailableTags()):alert("Error")}})};b.unlinkTag=function(a){var c="/levels/{level}/user/content/tag/unlink".inject({level:F});$.ajax({type:"POST",url:c,data:{tagId:a.id,packId:b.currentPack().id},dataType:"json",success:function(d){EB.shared.writeInternalStats({url:c});d?(b.currentPack().tags.remove(function(b){return b.id==a.id}),b.filterSelectedTags(),b.filterAvailableTags()):alert("Error")}})};b.filterAvailableTags=
function(){var a=[];$.each(b.currentPack().tags(),function(b,c){a.add(c.id)});$.each(B,function(c,d){b.availableTagsForSubject()[c]([]);var e=[];$.each(b.availableTagsForCurrentTerritory(),function(b,c){-1<d.indexOf(c.subjectAreaId)&&-1==a.indexOf(c.id)&&e.push(c)});b.availableTagsForSubject()[c](e)})};b.filterSelectedTags=function(){$.each(B,function(a,c){b.currentPack().visibleTags()[a]([]);$.each(b.currentPack().tags(),function(d,e){-1<c.indexOf(e.subjectAreaId)&&b.currentPack().visibleTags()[a].push(e)})})};
b.loadAllTagsForCurrentTerritory=function(a){b.availableTagsForCurrentTerritory([]);$.ajax({type:"GET",url:"/levels/{level}/user/content/tag/listAllForCurrentTerritory".inject({level:F}),dataType:"json",success:function(c){c.sort(function(a,b){return a.name.toLowerCase()>b.name.toLowerCase()?1:-1});b.availableTagsForCurrentTerritory(c);a&&a()}})};b.isConversionToLpAllowed=function(){return!b.isMaster&&!b.isEscolar&&!b.isModerna&&!b.isEscola&&b.isTeacher&&"library"!=EB.shared.getSiteType()&&!v()};
b.contentDoesntExist=function(a){return Da(a)};this.targetUrl=function(a){return Ea(a)};b.scrollUp=function(){var a=$("#collection-list")[0].scrollTop-100;$("#collection-list").animate({scrollTop:a},"300","swing")};b.scrollDown=function(){var a=$("#collection-list")[0].scrollTop+100;$("#collection-list").animate({scrollTop:a},"300","swing");Y(Y()+2)};b.showNoFavoritesMessage=function(){return 0==b.favorites().length&&!T()};b.renameSelectedCollection=function(){b.isEditingCollectionName(!0);b.collectionName(b.getActiveLabelsText())};
b.renamingKeypress=function(a,c){13===c.keyCode&&b.finishRenaming();return!0};b.finishRenaming=function(){if(""===b.collectionName())$("#rename-collection-textbox").tooltip("show");else{var c=W(),d="/levels/{level}/user/content/renameLabel".inject({level:F});$.ajax({type:"POST",url:d,data:{labelId:c.id,newName:$("#rename-collection-textbox").val()},dataType:"json",success:function(f){EB.shared.writeInternalStats({url:d});f?(c.text(b.collectionName()),b.collectionName(""),b.isEditingCollectionName(!1)):
e(null,a.string("my.content.alerts.item.can.not.be.renamed"))}})}};b.addNewCollection=function(){b.isAddingCollection(!0)};b.deleteSelectedCollection=function(){b._cancelAllRenaming();var c=W();e(null,a.string("mycontent.remove-collection.are-you-sure"),null,[{label:a.string("mycontent.remove-collection.are-you-sure.cancel")},{label:a.string("mycontent.remove-collection.are-you-sure.ok"),onClick:function(){var d="/levels/{level}/user/content/label/{labelId}".inject({level:F,labelId:c.id});$.ajax({type:"DELETE",
url:d,dataType:"json",success:function(f){EB.shared.writeInternalStats({url:d});f?(b.labels.remove(function(a){return a.id==c.id}),window.location.hash="/"):e(null,a.string("my.content.alerts.item.can.not.be.removed"))}})}}])};b.togglePublish=function(){var b=W(),c="/levels/{level}/favorites/publishPack",d=a.string("my.content.alerts.resource.pack.publish.error");b&&b.shared()&&(c="/levels/{level}/favorites/unpublishPack",d=a.string("my.content.alerts.resource.pack.unpublish.error"));if(b){var f=
c.inject({level:F});$.ajax({type:"POST",data:{packId:b.id},url:f,dataType:"json",success:function(a){EB.shared.writeInternalStats({url:f});a?b.shared(!b.shared()):e(null,d)}})}else e(null,a.string("my.content.alerts.no.resource.pack.selected"))};b.onFavoriteTypeChange=function(a){b.currentPage(0);b.isLoadMoreVisible(!0);b.favorites.removeAll();b.loadFavorites()};b.getActiveLabelsText=function(){var b=a.string("mycontent.all-my-favorites"),c=W();void 0!=c&&(b=c.text());return b};b.searchForm=K;b.isAddContentSearchTypeFavorites=
fa;b._cleanUp=function(){b._cancelAllRenaming();b.currentPack(null);b.lessonPlan(null);b.currentPage(0);fa(!0);v(!1);b.isLoadMoreVisible(!0);b.favorites.removeAll();la(!1);b.convertToLpMode(!1);xa();$("body").removeClass("edit-pack-mode");b.selectedGradeRange(null);ea=null;document.body.scrollTop=0};b._cleanUpEditPack_FromCustomizePack=function(){b._cleanUp();fa(!1);v(!0);b.loadFavorites();$("body").addClass("edit-pack-mode")};b._cleanUpEditPack=function(){b._cleanUp();b.loadFavorites();$("body").addClass("edit-pack-mode")};
b._cleanUpForShowAll=function(){b._cleanUp()};b._cleanUpForLp=function(){b._cancelAllRenaming();b.currentPage(0);b.isLoadMoreVisible(!0);b.favorites.removeAll();b.convertToLpMode(!1);la(!1);xa();$("body").removeClass("edit-pack-mode");b.selectedGradeRange(null);document.body.scrollTop=0};b.loadMore=function(){b.loadFavorites({pageToLoad:b.currentPage()+1})};b.selectTextboxContents=function(a,b){b.target.select()};b.editPackHandler=function(a){la(!0);b.loadFavoritesByLabel(a);b.loadUploadedDocuments()};
b.convertToLpHandler=function(c){EB.shared.writeAjaxStats();b.convertToLpMode(!0);var d=a.string("lessons.planning.convert.header").assign({packLabel:b.getActiveLabelsText()});b.convertToLpHeader(d);EB.lessonPlanBuilder.initLessonPlanFromPack(c,J)};b.savePack=function(c,d,f){if(""===W().text())return document.body.scrollTop=document.documentElement.scrollTop=0,$("#rename-collection-textbox").tooltip("show"),!1;$("#rename-collection-textbox").tooltip("hide");var g={};Object.keys(c,function(a,b){g[a]=
ko.isObservable(b)?b():b});delete g.count;delete g.shared;delete g.readOnly;delete g.addedItems;g.assetId||delete g.assetId;g.gradeIds=Object.values(ja).map(function(a){return a()&&a().value}).compact();var h="/levels/{level}/user/content/pack/edit".assign({level:F});$.ajax({type:"POST",url:h,data:JSON.stringify(g),contentType:"application/json",dataType:"json",success:function(){EB.shared.writeInternalStats({url:h});if(f)window.location.hash="/pack/convert/lp/"+c.id;else{var d=function(a){function d(){Q.removeClass("hide");
y(!1)}a=a?d:null;b.loadFavorites();b._loadAllLabels(a);window.location.hash="/collection/"+c.id};if(v())y(!0),d(!0);else{var g=a.string("my.content.alerts.resource.pack.updated");N&&!c.count()&&(g=a.string("my.content.alerts.please.add.content"));EB.i18n.string("alert.ok.close");e(null,g,d,[{label:EB.i18n.string("alert.ok.close")}])}}},error:function(){e(null,a.string("my.content.alerts.resource.pack.update.error"),null,[{label:EB.i18n.string("alert.ok.close")}])}})};b.saveAndConvertToLp=function(a,
c){b.savePack(a,c,!0)};b.loadFavoritesByLabel=function(a){ea=a;b.currentPage(0);b._loadCurrentPack();Fa()};b.viewPackHandler=function(a){b.loadFavoritesByLabel(a);b.loadUploadedDocuments();$("#emailCriteria").attr("action","/levels/"+F+"/email/collection/"+a);var c="/levels/{level}/url/shorten".inject({level:F});$.ajax({type:"POST",url:c,data:{pathToShorten:"/levels/{level}/collection/view/{collectionId}".inject({level:F,collectionId:a})},success:function(a){EB.shared.writeInternalStats({url:c});
b.shortUrl(a)}})};b.loadFavorites=function(a){var c=10;a&&a.pageSize?c=a.pageSize:ea&&(c=100);var d={pageSize:c,page:1};a&&a.pageToLoad&&(d.page=a.pageToLoad);!0===$("#usercontent-container").data("isLoggedin")&&0==da().length&&b._loadAllLabels();ea&&(d.labelId=ea);a&&a.labelId&&(d.labelId=a.labelId);if(a=$.deparam.querystring().favId)d.favId=a;b.isThistleLoading(!0);a=ba()?ba().id:"all";if("image"==a||"video"==a||"html5"==a)a="assembly/"+a;var e="/levels/{level}/user/content/favorites/ajax/{contentType}".inject({level:F,
contentType:a});$.getJSON(e,d,function(a){EB.shared.writeInternalStats({url:e});0===b.currentPage()&&b.favorites.removeAll();var d=null;W()&&(d=W().id);var f=$.map(a,function(a){if(null==d)return new Ga(a);var b=!1;$.each(a.labels,function(a,c){c.id==d&&(b=!0)});return b?new Ga(a):null});$.each(f,function(a,c){if(null!=d){var e=!1;$.each(b.favorites(),function(a,b){b.id==c.id&&(e=!0)});if(e)return}b.favorites.push(c);if(W()){var f="ADDITIONALCONTENT"==c.favoriteType?c.additionalContentType:"ASSEMBLY"==
c.favoriteType?c.assetType:c.favoriteType;W().addedItems.push({id:c.contentId,type:f})}});0<a.length&&b.currentPage(b.currentPage()+1);a.length<c&&b.isLoadMoreVisible(!1);b.isThistleLoading(!1);setTimeout(function(){ha()},100)})};b.addNewLabel=function(c,d){b.labelNameRequired(!1);if(""!==b.newLabelName()){var f="/levels/{level}/user/content/label".inject({level:F});$.ajax({type:"POST",url:f,data:{name:b.newLabelName()},dataType:"json",success:function(c){EB.shared.writeInternalStats({url:f});c?(J.labels.unshift(new sa(c)),
b.newLabelName(""),b.isAddingCollection(!1),window.location.hash="/pack/edit/"+c.id):(e(null,a.string("mycontent.label-already-exists"),null,[{label:EB.i18n.string("alert.ok.close")}]),b.labelNameRequired(!0))}})}else b.labelNameRequired(!0),$("#new-label-textbox").tooltip("show")};b.cancelAddNewLabel=function(){b.newLabelName("");b.isAddingCollection(!1)};b.deleteFavorite=function(c){W()?e(null,a.string("mycontent.remove-item.from-collection.are-you-sure"),null,[{label:a.string("mycontent.remove-collection.are-you-sure.cancel")},
{label:a.string("mycontent.remove-collection.are-you-sure.ok"),onClick:function(){b._unlinkLabel(c.id,c.favoriteType.toLowerCase(),W().id,c.contentId)}}]):e(null,a.string("mycontent.delete-favorite-warning"),null,[{label:a.string("mycontent.remove-collection.are-you-sure.cancel")},{label:a.string("mycontent.remove-collection.are-you-sure.ok"),onClick:function(){var a;a="ADDITIONALCONTENT"==c.favoriteType?"/levels/{level}/favorites/additionalcontent/{addContentType}/{contentId}".inject({level:F,addContentType:c.additionalContentType.toLowerCase(),
contentId:c.contentId}):"/levels/{level}/favorites/{contentType}/{contentId}".inject({level:F,contentType:c.favoriteType.toLowerCase(),contentId:c.contentId});$.ajax({type:"DELETE",url:a,success:function(d){EB.shared.writeInternalStats({url:a});d?(J.favorites.remove(function(a){return a.id==c.id}),b._loadAllLabels()):e(null,"Error deleting item.")}})}}])};b.updateLabelNote=function(a){var b="/levels/{level}/favorites/updateLabelNote".inject({level:F});$.ajax({type:"POST",url:b,dataType:"json",data:{favoriteType:a.favoriteType,
savedContentId:a.id,labelId:W().id,text:a.labelNote()},success:function(a){EB.shared.writeInternalStats({url:b});!0!==a&&alert("Comment cannot be updated. Please try again later.")}})};b.updateTocId=function(a){var b="/levels/{level}/favorites/updateTocId".inject({level:F});$.ajax({type:"POST",url:b,dataType:"json",data:{savedContentId:a.id,labelId:W().id,tocId:a.tocId},success:function(a){EB.shared.writeInternalStats({url:b});!0!==a&&alert("Toc Id cannot be updated. Please try again later.")}})};
b._unlinkLabel=function(a,c,d,e){var f="/levels/{level}/favorites/{contentType}/{contentId}/label/{labelId}".inject({level:F,contentType:c,contentId:a,labelId:d});$.ajax({type:"DELETE",url:f,dataType:"json",success:function(c){EB.shared.writeInternalStats({url:f});if(1==c&&(b.favorites.remove(function(b){return b.id==a}),W())){W().count(W().count()-1);c=W().addedItems().find(function(a){return a.id==e}).type;c="IMAGE"==c||"VIDEO"==c?"ASSEMBLY":c;var d=W().contentTypeCounts();--d[c];W().contentTypeCounts(d)}}})};
b.afterFavoritesForeach=function(){};b.showListItem=function(a){1===a.nodeType&&$(a).hide().slideDown()};b.hideListItem=function(a){1===a.nodeType&&$(a).slideUp(function(){$(a).remove()})};b.afterLabelsForeach=function(){$(".droppable").droppable({hoverClass:"drop-hover",tolerance:"pointer",drop:function(a,c){var d=c.draggable.data("id"),e=c.draggable.data("favoriteType"),f=$(this).data("labelId"),g=c.draggable.data("contentId");b._linkLabel(d,e,f,g)}})};b.generateRelatedArticleLink=function(a,b,
c){return Ha(a,b,c)};b.showHideFilters=function(a,c){b.filtersVisible(!b.filtersVisible())};b.filterPacks=function(){Y(0);var a=[];0<b.selectedLocalSubjects().length&&(a=b.selectedLocalSubjects().map(function(a){return a.id}));var c=[];0<b.selectedGrades().length&&b.selectedGrades().forEach(function(a){a.value.split(",").forEach(function(a){c.push(parseInt(a))})});var d=-1;if(0<b.selectedLastEditedDates().length)var e=b.selectedLastEditedDates()[0].id,d=(Date.now?Date.now():(new Date).getTime())-
864E5*e;var f="";b.searchKeyword()&&0<b.searchKeyword().trim().length&&(f=b.searchKeyword().toLowerCase());e=b.unfilteredLabels;if(""!=f||0<a.length||0<c.length||-1<d)e=_.filter(b.unfilteredLabels,function(b){if(""!=f&&(b.text()&&-1<b.text().toLowerCase().indexOf(f)||b.keywords()&&-1<b.keywords().toLowerCase().indexOf(f)||b.description()&&-1<b.description().toLowerCase().indexOf(f)))return!0;if(0<a.length){var e=b.subjectIds().map(function(a){return parseInt(a)}),e=_.intersection(e,a);if(0<e.length)return!0}return 0<
c.length&&(e=_.intersection(b.gradeIds,c),0<e.length)?!0:-1<d&&b.dateModified()>=d?!0:!1});b.labels(e)};b.clearFilters=function(){b.selectedLocalSubjects([]);b.selectedGrades([]);b.selectedLastEditedDates([]);b.searchKeyword("")};b._loadCurrentPack=function(){if(ea){var a="/levels/{level}/user/content/pack/{packId}".assign({level:F,packId:ea});$.get(a,{comingFromCustomizePack:v()}).done(function(a){if(a&&a.id){var c=new sa(a);c.gradeIds&&Array.isArray(c.gradeIds)&&c.gradeIds.length?(Object.keys(ia).each(function(a){var b=
ja[a];b&&b(ia[a].find(function(a){return c.gradeIds.find(function(b){return b==a.value})}))}),a=ga.find(function(a){return c.gradeIds.find(function(b){return b==a.value})}),b.selectedGradeRange(a)):(b.selectedGradeRange(null),h());W(c);b.isMaster&&Va(c.assetId());b.filterSelectedTags();b.loadAllTagsForCurrentTerritory(function(){b.filterAvailableTags()})}})}};b._linkLabel=function(c,d,f,g){var h="/levels/{level}/favorites/{contentType}/{favoriteId}/label/{labelId}".inject({level:F,contentType:d,favoriteId:c,
labelId:f});$.ajax({type:"PUT",url:h,dataType:"json",success:function(c){EB.shared.writeInternalStats({url:h});if(1==c){if(c=b.labels().find(function(a){return a.id==f})){c.count(c.count()+1);var d=b.favorites().find(function(a){return a.contentId==g});if(d){var d="ADDITIONALCONTENT"==d.favoriteType?d.additionalContentType:d.favoriteType,d="IMAGE"==d||"VIDEO"==d?"ASSEMBLY":d,k=c.contentTypeCounts();k[d]+=1;c.contentTypeCounts(k)}}}else e(null,a.string("my.content.alerts.content.already.exists"))}})};
b._loadAllLabels=function(a){b.labelsLoading(!0);var c="/levels/{level}/user/content/allLabels".inject({level:F});$.getJSON(c,function(d){EB.shared.writeInternalStats({url:c});d=$.map(d,function(a){if(0!=a.id)return a.contentTypeCounts={},new sa(a);b.allFavoritesCount(a.count)});b.labelsLoading(!1);b.labels(d);b.unfilteredLabels=d;a&&a()})};b._cancelAllRenaming=function(){b.isAddingCollection(!1);b.isEditingCollectionName(!1)};b._populateFavoriteTypes=function(){var c=[new ma("article",a.string("mycontent.content-type-ddl.articles")),
new ma("image",a.string("mycontent.content-type-ddl.images")),new ma("video",a.string("mycontent.content-type-ddl.videos"))];if("es"!==EB.shared.getLanguage()&&"pt"!==EB.shared.getLanguage()){c.add(new ma("html5",a.string("mycontent.content-type-ddl.html5")));b.isTeacher&&c.push(new ma("lessonplan",a.string("mycontent.content-type-ddl.lesson-plans")));var d=Ia();$.each(d,function(b,d){c.push(new ma(d.type,a.string(d.label)))})}aa().add(c)};b.confirmDeletionDialog=function(a){R(a);U.removeClass("hide");
return!1};b.confirmDeletionInChooserTableRow=function(b,c){R(b);var d=$("#ud-delete-question"),e=$("#ud-delete-question-bottom-margin");d.find("#ud-delete-question-text").text(a.string("mycontent.upload.document.total-usage-exceeds-limit.error.delete.question").assign({name:c}));var f=$("#ud-"+b);d.insertAfter(f);e.insertAfter(d);$(".ud-row-activecontent").removeClass("hide");f.addClass("hide");d.removeClass("hide");e.removeClass("hide");return!1};b.deleteUploadedDocumentWithCallback=function(a,c){var d=
R();if(d){var f="/levels/{level}/user/content/upload/document/{id}".inject({level:F,id:d});$.ajax({type:"DELETE",url:f,dataType:"json",success:function(d){EB.shared.writeInternalStats({url:f});d?(b.loadUploadedDocuments(),b.loadAllUploadedDocuments(),"function"===typeof a&&a(c)):e(null,"Error deleting document.")}})}};b.deleteUploadedDocument=function(){b.deleteUploadedDocumentWithCallback(null,null)};b.deleteUploadedDocumentFromChooserTableRow=function(){b.clearDeleteInChooserTableRow();b.deleteUploadedDocumentWithCallback(b.uploadDocumentSizeCheck,
!1)};b.uploadDocument=function(){var a=document.getElementById("file-uploader");if(a&&a.files.length){var c=a.files[0];b.fileUploadFileName(c.name||"");b.fileUploadFileSize(c.size||0);10485760<c.size?(A.removeClass("hide"),a.value=""):0>$.inArray(c.type,t)?(l.removeClass("hide"),a.value=""):b.uploadDocumentSizeCheck(!0)}};b.uploadDocumentSizeCheck=function(a){var c="/levels/{level}/user/content/ajax/uploads/totalsize".inject({level:F});$.getJSON(c,function(d){EB.shared.writeInternalStats({url:c});
b.fileUploadCurrentTotalSize(d.total);b.fileUploadDocumentSizePassesMaxSizeCheck(104857600>parseInt(b.fileUploadCurrentTotalSize())+parseInt(b.fileUploadFileSize()));a&&(b.fileUploadDocumentSizePassesMaxSizeCheck()?b.uploadDocumentLoadLegalDialog():(b.loadAllUploadedDocuments(),L.removeClass("hide")))})};b.uploadDocumentLoadLegalDialog=function(){L.addClass("hide");P.removeClass("hide")};b.setAnchorContent=function(a){var b="/levels/{level}/user/content/setAnchorContent".inject({level:F});$.ajax({type:"POST",
url:b,dataType:"json",data:{savedContentId:a,labelId:W().id},success:function(c){EB.shared.writeInternalStats({url:b});!0===c?W().anchorSavedContentId(a):alert("anchorSavedContentId cannot be updated. Please try again later.")}})};b.init=function(){b._populateFavoriteTypes();X(Ja());ba.subscribe(function(a){b.onFavoriteTypeChange()});Router({"/collection/:collectionId":{before:b._cleanUp,on:b.viewPackHandler},"/pack/edit/:collectionId":{before:b._cleanUpEditPack,on:b.editPackHandler},"/pack/edit/:collectionId/fromCustomizePack":{before:b._cleanUpEditPack_FromCustomizePack,
on:b.editPackHandler},"/":{before:b._cleanUpForShowAll,on:Fa},"/pack/convert/lp/:collectionId":{before:b._cleanUpForLp,on:b.convertToLpHandler}}).init("/");n(function(){pa.forEach(function(a){b.localSubjects.push(a)})});b.loadUploadedDocuments()}}function u(){var b=this;b.levelFilters=ko.observableArray();b.lessonPlans=ko.observableArray();b.subjectFilters=ko.observableArray();b.refreshVisible=ko.observable(!1);b.isThistleLoading=ko.observable(!0);b.init=function(){b.isTeacher=N=EB.userContentConfig.isTeacher;
$.each(ga,function(a,c){b.levelFilters.push(new Ka(c.value,c.label,!0))});$.getJSON("/levels/{level}/lessons/edit/getSelectables".inject({level:F}),function(a){$.each(a.subjectAreaGroups,function(a,c){$.each(c,function(a,c){b.subjectFilters.push(new Ka(c.id,c.name,!0))})});b.loadLessonPlans()})};b.uncheckAllLevels=function(){b.refreshVisible(!0);$.each(b.levelFilters(),function(a,b){b.checked(!1)})};b.uncheckAllSubjects=function(){b.refreshVisible(!0);$.each(b.subjectFilters(),function(a,b){b.checked(!1)})};
b.levelFiltersClicked=function(a){b.refreshVisible(!0);a.checked(!a.checked())};b.subjectFiltersClicked=function(a){b.refreshVisible(!0);a.checked(!a.checked())};b.applyFilters=function(){b.lessonPlans([]);0===b._getLevelFiltersChecked().length&&$.each(b.levelFilters(),function(a,b){b.checked(!0)});0===b._getSubjectFiltersChecked().length&&$.each(b.subjectFilters(),function(a,b){b.checked(!0)});b.currentPage(0);b.loadLessonPlans();b.refreshVisible(!1)};b.loadLessonPlans=function(){var a=b._getLevelFiltersChecked(),
c=b._getSubjectFiltersChecked(),d="/levels/{level}/user/content/lessonPlans/ajax/{page}".inject({level:F,page:b.currentPage()});$.getJSON(d,{levels:a.join(","),subjects:c.join(",")},function(a){EB.shared.writeInternalStats({url:d});a=$.map(a,function(a){return new Wa(a)});$.each(a,function(a,c){b.lessonPlans.push(c)});0<a.length&&b.currentPage(b.currentPage()+1);10>a.length&&b.isLoadMoreVisible(!1);b.isThistleLoading(!1)})};b.deleteLessonPlan=function(c){e(null,a.string("mycontent.remove-lesson-plan.are-you-sure"),
null,[{label:a.string("mycontent.remove-collection.are-you-sure.cancel")},{label:a.string("mycontent.remove-collection.are-you-sure.ok"),onClick:function(){var a="/levels/{level}/lessons/delete/{id}".inject({level:F,id:c.lessonPlanId});$.ajax({type:"DELETE",url:a,dataType:"json",success:function(d){EB.shared.writeInternalStats({url:a});d?b.lessonPlans.remove(function(a){return a.lessonPlanId==c.lessonPlanId}):e(null,"Error deleting lesson plan.")}})}}])};b.afterLessonplansForeach=function(){ha();
setTimeout(function(){ha()},1E3)};b._getLevelFiltersChecked=function(){var a=[];$.each(b.levelFilters(),function(b,c){!0===c.checked()&&a.push(c.id)});return a};b._getSubjectFiltersChecked=function(){var a=[];$.each(b.subjectFilters(),function(b,c){!0===c.checked()&&a.push(c.id)});return a}}function x(a,b){for(var c in a)b[c]=a[c];return b}var v=ko.observable(!1),r=!!$.storage.get("seenPackPopup"),w=ko.observable(!1),y=ko.observable(!1),t="application/vnd.oasis.opendocument.text application/msword application/vnd.openxmlformats-officedocument.wordprocessingml.document application/rtf text/rtf text/plain application/pdf".split(" "),
D=".odt .doc .docx .rtf .txt .pdf".split(" "),B={mathematics:[],special_education:[],social_sciences:[],history:[],religion:[],foreign_languages:[],physical_education:[],ecology:[],information_technology:[],language_arts:[],geography:[],science:[],english:[],fine_arts:[],design_and_technology:[]},E=ko.observable(!1),z=ko.observable(""),G=ko.observable(""),C=ko.observable(""),I=ko.observable(!1),R=ko.observable(""),P=$("#legal-disclaimer-overlay"),l=$("#type-error-overlay"),L=$("#total-usage-exceeds-limit-error-overlay"),
A=$("#file-too-large-error-overlay"),U=$("#delete-document-overlay"),H=$("#welcome-packs-user-overlay"),Q=$("#your-pack-lives-here-overlay"),F,J,O=EB.shared.getCountry(),N,T=ko.observable(!1),M=ko.observable(!1),Z=ko.observable(!0),S=!0,ba=ko.observable(null),aa=ko.observableArray([]),X=ko.observableArray([]),V=ko.observable(null),Y=ko.observable(0),ca=ko.observableArray(),da=ko.observableArray(),ga=EB.i18n.resource("my.content.grade.ranges"),ia=EB.i18n.resource("my.content.grades.all"),ja={},ka=
ko.observable(null),na=ko.observableArray([]),ra=ko.observable(),oa={},pa=[],W=ko.observable(null),ea=null,Ba=ko.observableArray([]),Ca=ko.observableArray([]),la=ko.observable(!1),Oa=ko.computed(function(){return W()?Object.findAll(W().contentTypeCounts(),function(a,b){return!!b}):null}),fa=ko.observable(!0),wa=function(a){a.length&&(EB.shared.fetchAssemblyMetadata("a[rel=media-gallery-img]",function(){EB.MediaGallery.init("a[rel=media-gallery-img]","My Content Overlay");$("a[rel=media-gallery-text]").click(function(){var a=
$("a[rel=media-gallery-text]").index($(this));EB.MediaGallery.goToIndex(a);return!1})}),ha(),setTimeout(function(){ha()},1E3))}.debounce(50),K={contentType:ko.observable(""),level:ko.observable(""),query:ko.observable(""),results:ko.observableArray([]),pageSize:ko.observable(10),pageNumber:ko.observable(1),totalResults:ko.observable(),template:ko.observable("")},xa=function(){K.query("");K.level("");K.results([]);K.totalResults(0);K.template("");K.contentType(null);V(X().find(function(a){return"article"==
a.id}));setTimeout(ha,300)},Pa=function(){$("#email-modal").modal("show");EB.shared.placeholder("#recipients");EB.shared.placeholder("#senderName");EB.shared.placeholder("#senderEmail");return!1},Qa=function(){$("#share-pack-modal").modal("show");return!1},Ra=function(){$("#file-uploader").click();return!1},Sa=function(a,b,c){a="/levels/{level}/user/content/fetch/document/{indId}/{docId}/{originalFilename}".inject({level:F,indId:b,docId:c,originalFilename:a});window.open(a);return!1},Ta=function(){ya(Ca,
!1)},ya=function(a,b){var c="undefined"!==typeof a?a:Ba,d={pageSize:100,page:1};("undefined"!==typeof b?b:1)&&null!=ea&&(d.labelId=ea);var e="/levels/{level}/user/content/ajax/uploads".inject({level:F});$.getJSON(e,d,function(a){EB.shared.writeInternalStats({url:e});c.removeAll();$.each(a,function(a,b){c.push(b)})})},Ja=function(){var b=[{id:"article",label:a.string("mycontent.content-type-ddl.articles")},{id:"image",label:a.string("mycontent.content-type-ddl.images")},{id:"video",label:a.string("mycontent.content-type-ddl.videos")}];
EB.shared.isEscolar()||EB.shared.isModerna()||EB.shared.isEscola()||(b.push({id:"magazine",label:a.string("mycontent.content-type-ddl.magazines")}),b.push({id:"ebook",label:a.string("mycontent.content-type-ddl.primary-sources")}),b.push({id:"website",label:a.string("mycontent.content-type-ddl.websites")}));return b},Fa=function(){EB.shared.writeAjaxStats();S?S=!1:ba()?ba(void 0):ba.valueHasMutated()},Va=function(a){if(a){var b="/levels/{level}/user/content/ajax/assetExists/{assetId}".assign({level:F,
assetId:a});$.get(b).done(function(a){EB.shared.writeInternalStats({url:b});Z(!!a)}).fail(function(){Z(!1)})}else Z(!1)},Xa=function(a){var b="/levels/{level}/user/content/ajax/reorderPackContent/{packId}".assign({level:F,packId:W().id});$.ajax({type:"POST",url:b,data:JSON.stringify(a),contentType:"application/json",dataType:"json"}).done(function(a){EB.shared.writeInternalStats({url:b})}).fail(function(){})},Ua=function(a){var b={};$(a).children().each(function(a,c){var d=$("> .content-item",c),
e=d.data("id"),d=d.data("favoriteType"),f={};f.favoriteId=e;f.sequence=a;switch(d){case "article":b.reorderedFavoritedArticles=b.reorderedFavoritedArticles?b.reorderedFavoritedArticles:[];b.reorderedFavoritedArticles.push(f);break;case "assembly":b.reorderedFavoritedAssemblies=b.reorderedFavoritedAssemblies?b.reorderedFavoritedAssemblies:[];b.reorderedFavoritedAssemblies.push(f);break;default:b.reorderedFavoritedAddcontent=b.reorderedFavoritedAddcontent?b.reorderedFavoritedAddcontent:[],b.reorderedFavoritedAddcontent.push(f)}});
Xa(b)},Ya=function(a){var b=[];try{K.totalResults(a.SearchResponseMessage.SearchResult.Statistics.TotalHits),a.SearchResponseMessage.SearchResult.Statistics.TotalHits&&a.SearchResponseMessage.SearchResult.Data.Records.Record.each(function(a){var c={};c.id=a.Header.An;a.Items.Item.each(function(a){switch(a.Label){case "Title":c.title=a.Data;break;case "Abstract":c.description=a.Data;break;case "Authors":c.author=a.Data.searchLink.content}});b.push(c)})}catch(c){}K.results(b)},Za=function(){M(!0);var a=
V()?V().id:"all",c=a;if("image"==a||"video"==a)c="assembly/"+a;var d={pageSize:K.pageSize(),page:K.pageNumber()};v()&&ea&&(d.labelId=ea);var e="/levels/{level}/user/content/favorites/ajax/{contentType}".inject({level:F,contentType:c});$.getJSON(e,d,function(c){EB.shared.writeInternalStats({url:e});M(!1);1<K.pageNumber()&&c&&!c.length?(K.pageNumber(K.pageNumber()-1),K.totalResults(K.pageSize()*K.pageNumber()-1)):(K.results(c||[]),K.totalResults(c.length<K.pageSize()?K.pageSize()*K.pageNumber()-1:K.pageSize()*
K.pageNumber()+1),b(),"video"!=a&&"image"!=a||setTimeout(function(){wa(K.results())},300));setTimeout(ha,300)})},za=function(){if(fa()&&V())Za();else if(K.contentType()&&K.contentType().id&&K.level().compact()&&K.query().compact()){M(!0);var a="/levels/{level}/collection/search".assign({level:F}),c={searchType:K.contentType().id.toUpperCase(),levelId:K.level(),query:K.query(),pageSize:K.pageSize(),pageNumber:K.pageNumber()};$.getJSON(a,c,function(c){EB.shared.writeInternalStats({url:a});M(!1);"magazine"==
K.contentType().id?Ya(c):(K.results(c.results||[]),K.totalResults(c.totalResults||0));b();"video"!=K.contentType().id&&"image"!=K.contentType().id||setTimeout(function(){wa(K.results())},300);setTimeout(ha,300)})}},ta=function(){K.pageNumber(1);za()};K.next=function(){K.pageNumber(K.pageNumber()+1);za()};K.prev=function(){K.pageNumber(K.pageNumber()-1);za()};K.add=function(b,c){var d=fa()&&V()?V().id:K.contentType().id,d=d.toUpperCase(),f={contentId:b,contentType:c,packId:W().id,additionalContentType:d},
g="/levels/{level}/favorites/addContentToPack".inject({level:F});$.post(g,f).done(function(c){0<parseInt(c,10)?(W().addedItems.push({id:b,type:d}),W().count(W().count()+1),c=W().contentTypeCounts(),c[d]+=1,W().contentTypeCounts(c)):e(null,a.string("my.content.alerts.content.can.not.be.added"))}).fail(function(){e(null,a.string("my.content.alerts.content.can.not.be.added"))})};K.isAdded=function(a){if(fa()&&v())return!0;var b=fa()&&V()?V().id:K.contentType()?K.contentType().id:"",b=b.toUpperCase();
return W().addedItems().find(function(c){return c.id==a&&c.type==b})};K.getSearchAdditionalContentUrl=function(a){if(K.contentType())return"ebook"==K.contentType().id?qa("ADDITIONALCONTENT",parseInt(K.level(),10),a.additionalContentId,K.contentType().id.toUpperCase(),null,null,a.html_url):"website"==K.contentType().id?qa("ADDITIONALCONTENT",parseInt(K.level(),10),a.id,K.contentType().id.toUpperCase(),null,null,a.url):qa("ADDITIONALCONTENT",parseInt(K.level(),10),a.id,K.contentType().id.toUpperCase(),
null,null,a.identifier)};K.getSearchArticleUrl=function(a,b){b=b||parseInt(K.level(),10);return"/levels/{level}/article/{id}".inject({level:ua(b),id:a})};ca.subscribe(function(a){wa(a)});fa.subscribe(xa);K.contentType.subscribe(function(a){"IMAGE"==a||"VIDEO"==a?K.pageSize(20):K.pageSize(10);la()&&a&&ta()});K.level.subscribe(ta);K.query.subscribe(ta);V.subscribe(function(a){la()&&a?ta():la()&&K.results([])});var ma=function(a,b){this.id=a;this.label=b},Ka=function(a,b,c){this.id=a;this.value=b;this.checked=
ko.observable(c)},Ga=function(a){var b=this;this.favoriteType=a.favoriteType;this.id=a.savedContentId;this.title=a.title?va(a.title):"This content is temporarily unavailable. Please try again later.";this.dateCreatedTimestamp=a.dateCreated;this.description=va(a.description);this.imageCredits=va(a.imageCredits);this.imagePath=a.imagePath;this.contentId=a.contentId;this.level=a.level;this.tocId=a.tocId;this.articleIdForAssembly=a.articleId;this.articleUrlTitle=a.urlTitle;this.assetType=a.assetType;
this.fullImagePath=a.fullImagePath;this.transcript=a.transcript;this.relatedArticles=a.relatedArticles;this.isFavoriteAssembly=!0;this.subjects=a.subjects;this.grades=a.grades;this.duration=a.duration;this.author=a.author;this.fullLessonPlan=a.fullLessonPlan;this.additionalContentType=a.additionalContentType;this.additionalContentIdentifier=a.additionalContentIdentifier;this.labels=ko.observableArray($.map(a.labels,function(a){return new sa(a)}));this.labelNote=ko.observable(a.labelNote);this.addContentTypeReadable=
function(){return La(this.additionalContentType)};this.getAddcontentIcon=function(){return Ma(this.additionalContentType)};this.templateToUse=function(){return"ARTICLE"==this.favoriteType?"article-template":"ASSEMBLY"==this.favoriteType?"assembly-template":"LESSONPLAN"==this.favoriteType?"lessonplan-template":"addcontent-template"};this.dateCreated=function(){return Aa(this.dateCreatedTimestamp)};this.isVideo=function(){return"VIDEO"==this.assetType};this.isAudio=function(){return"AUDIO"==this.assetType};
this.isInteractive=function(){return"INTERACTIVE"==this.assetType};this.remainingLabels=ko.computed(function(){return $.map(J.labels(),function(a){if(!Na(a,b.labels()))return a})});this.attachedLabels=ko.computed(function(){return $.map(J.labels(),function(a){if(Na(a,b.labels()))return a})});this.getGradeLabel=function(){var a=b.grades.split(",");return EB.myContentUtils.getGradeLabel(a)}},sa=function(a){var b=this;this.id=a.id;this.text=ko.observable(a.text);this.readOnly=EB.userContentConfig.isReadOnly;
this.shared=ko.observable(a.isShared);this.keywords=ko.observable(a.keywords);this.description=ko.observable(a.description);this.gradeIds=a.gradeIds?a.gradeIds:[];this.subjectIds=ko.observableArray(a.subjectIds&&a.subjectIds.map(function(a){return""+a})||[]);this.tags=ko.observableArray(a.tags);this.visibleTags=ko.observable({});$.each(B,function(a,c){b.visibleTags()[a]=ko.observableArray([])});this.assetId=ko.observable(a.assetId||"");this.dateModified=ko.observable(a.dateModified);this.addedItems=
ko.observableArray([]);a.contentTypeCounts.ASSEMBLY?delete a.contentTypeCounts.ASSEMBLY:this.count=ko.observable(a.count);this.count=ko.observable(a.count);this.contentTypeCounts=ko.observable(a.contentTypeCounts);this.editorialPackCategoryId=ko.observable(a.editorialPackCategoryId);this.anchorSavedContentId=ko.observable(a.anchorSavedContentId)},Wa=function(a){var b=this;b.lessonPlanId=a.lessonPlanId;b.dateCreatedTimestamp=a.creationDate;b.title=a.title;b.objective=a.objective;b.subjectsExplanation=
a.subjectsExplanation;b.levelIds=a.gradeIds;b.durationExplanation=a.durationExplanation;b.authorExplanation=a.authorExplanation;this.dateCreated=function(){return Aa(b.dateCreatedTimestamp)};this.targetUrl=function(){return"/levels/{level}/lessons/view/{id}".inject({level:F,id:b.lessonPlanId})};this.getGradeLabel=function(){return EB.myContentUtils.getGradeLabelById(b.levelIds)}},Ha=function(a,b,c){return"/levels/{level}/article/{urlTitle}/{articleId}".inject({level:ua(a),urlTitle:b,articleId:c})},
ha=function(){$(".usercontent-left-side").height($(".usercontent-right-side").height())},ua=function(a){var b=EB.shared.getSiteType(),c,d="elementary",e="middle",f="high",g="children",h="youngadults",k="referencecenter";"UK"==O?(d="foundation",e="intermediate",f="advanced",g="junior",h="student",k="adult"):"AU"==O?(d="primary",e="middle",f="high",g="kids",h="teens",k="adults"):"IN"==O?(d="primary",e="middle",f="senior",g="kids",h="teens",k="adults"):"NZ"==O?(d="primary",e="middle",f="secondary",g=
"kids",h="teens",k="adults"):"AS"==O?(d="elementary",e="middle",f="high",g="kids",h="teens",k="adults"):"ES"==O?(d="primaria",e="secundaria",f="academica"):"BR"==O&&(d="fundamental");if("school"==b)if("ONE"==a||1==a||"elementary"==a)c=d;else if("TWO"==a||2==a||"middle"==a)c=e;else{if("THREE"==a||3==a||"high"==a)c=f}else if("library"==b)if("ONE"==a||1==a||"elementary"==a)c=g;else if("TWO"==a||2==a||"middle"==a)c=h;else{if("THREE"==a||3==a||"high"==a)c=k}else"academic"==b&&(c="collegiate");return c},
Aa=function(a){a=new Date(a);return a.getDate()+" "+"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getUTCMonth()]+", "+a.getFullYear()},Na=function(a,b){for(var c=0;c<b.length;c++)if(a.id==b[c].id)return!0;return!1},va=function(a){return a?a.replace(/<\/?[^>]+(>|$)/g," "):""},Ea=function(a){return qa(a.favoriteType,a.level,a.contentId,a.additionalContentType,a.articleIdForAssembly,a.articleUrlTitle,a.additionalContentIdentifier)},qa=function(a,b,c,d,e,f,g){b=b?ua(b):EB.shared.getLevelFromPath();
return"ARTICLE"==a?"/levels/{level}/article/{urlTitle}/{id}".inject({level:b,urlTitle:f,id:c}):"ASSEMBLY"==a?("ONE"===b?"/levels/{level}/article/{urlTitle}/{articleId}/?assemblyId={id}":"/levels/{level}/article/{articleId}/media?assemblyId={id}").inject({level:b,urlTitle:f,articleId:e,id:c}):"LESSONPLAN"==a?"/levels/{level}/lessons/view/{lessonplanId}".inject({level:b,lessonplanId:c}):"MAGAZINE"==d?"/levels/{level}/magazine/article/{id}".inject({level:b,id:c}):"EBOOK"==d?"/levels/{level}/additionalcontent/primarysources?id={id}&path={path}".inject({level:b,
id:c,path:g}):"WEBSITE"==d?(0!=g.trim().indexOf("http")&&(g="http://"+g),g):"LM_GAMES"==d?"/levels/{level}/additionalcontent/lm-games?id={id}&path={path}".inject({level:b,id:c,path:g}):"LM_INTERACTIVE_LESSONS"==d?"/levels/{level}/additionalcontent/lm-interactivelessons?id={id}&path={path}".inject({level:b,id:c,path:g}):"LM_VISUAL_LEARNING"==d?"/levels/{level}/visual/{id}".inject({level:b,id:g}):"LM_MANIPULATIVES"==d?"/levels/{level}/additionalcontent/lm-manipulatives?id={id}&path={path}".inject({level:b,
id:c,path:g}):"LM_STUDY_GUIDES"==d?"/levels/{level}/additionalcontent/lm-studyguides?id={id}&path={path}".inject({level:b,id:c,path:g}):""},Ma=function(a){return"MAGAZINE"===a?"fontello-icon-book":"EBOOK"===a?"fontello-icon-edit":"LM_GAMES"===a?"fontello-icon-award":"LM_INTERACTIVE_LESSONS"===a?"fontello-icon-retweet":"LM_VISUAL_LEARNING"===a?"fontello-icon-eye":"LM_MANIPULATIVES"===a?"fontello-icon-move":"LM_STUDY_GUIDES"===a?"fontello-icon-pencil":"WEBSITE"===a?"fontello-icon-bookmark":""},La=function(b){return"MAGAZINE"===
b?a.string("mycontent.add-content-type.magazine"):"EBOOK"===b?a.string("mycontent.add-content-type.primary-source"):"WEBSITE"===b?a.string("mycontent.add-content-type.website"):""},Da=function(a){return"This content is temporarily unavailable. Please try again later."===a.title},Ia=function(){var a=[];a.push({type:"magazine",label:"mycontent.content-type-ddl.magazines"});a.push({type:"ebook",label:"mycontent.content-type-ddl.primary-sources"});a.push({type:"website",label:"mycontent.content-type-ddl.websites"});
return a};return{init:function(){h();F=EB.shared.getLevelFromPath();J=x(new p,new q);J.init();ko.validation.init({registerExtenders:!0,messagesOnModified:!0,insertMessages:!1});ko.applyBindings(J);$(function(){$('[data-toggle="popover"]').popover()});w(document.referrer.startsWith(/(http|s):\/\/packs./)?document.referrer:$.storage.get("packsReferrer"));v()&&($.storage.set("packsReferrer",!!w()),r||(H.removeClass("hide"),$.storage.set("seenPackPopup",!0)))},initLessonsPage:function(){F=EB.shared.getLevelFromPath();
J=x(new p,new u);J.init();ko.applyBindings(J)},initEditCollection:function(){F=EB.shared.getLevelFromPath();J=new EditCollectionViewModel;J.init();ko.applyBindings(J)},removeTags:va,generateFavoriteUrl:Ea,generateFavoriteUrlGeneric:qa,getReadableContentType:La,getNiceDate:Aa,favoriteDoesntExistAnymore:Da,getAddcontentIcon:Ma,getLevelFromArticleJsonLevel:ua,generateRelatedArticleLink:Ha,fetchSuitableAdditionalContentTypes:Ia,getSimplifiedContentTypes:Ja}}(EB.i18n,EB.Overlay);EB=window.EB||{};
EB.visualLearning=function(a,e,f){var d=function(c,d){var e="/levels/{0}/assembly/{1}/assets".format(c,d);a.ajax({type:"GET",url:e,dataType:"html",data:{},success:function(b){EB.shared.writeInternalStats({url:e});a("#assembly-full").html(b)}})},c=function(){a("#assembly-content").empty();a("#player").empty();a("#player").remove();var c=a(this).attr("id"),d=a(this).val(),e=a(this).data("width"),b=a(this).data("height");"video-flash"==c&&a("#assembly-content").append(a('<embed id="player" height="'+
b+'" width="'+e+'" type="application/x-shockwave-flash" src="/resources/swf/player.swf" allowfullscreen="true" allowscriptaccess="always" wmode="transparent" quality="high" bgcolor="white" flashvars="width='+e+"&height="+b+"repeat=false&file="+d+'&autostart=true"></embed>'));"video-wmv"==c&&a("#assembly-content").append(a('<embed id="player" height="'+b+'" width="'+e+'" controller="true" loop="false" autoplay="true" pluginspage="http://www.apple.com/quicktime/download/" qtsrc="'+d+'" src="'+d+'"></embed>'));
"video-mp4"==c&&a("#assembly-content").append(a('<embed id="player" height="'+b+'" width="'+e+'" controller="true" loop="false" autoplay="true" pluginspage="http://www.apple.com/quicktime/download/" qtsrc="'+d+'" src="'+d+'"></embed>'));"video-dcr"==c&&a("#assembly-content").append(a('<embed id="player" height="'+b+'" width="'+e+'" src="'+d+'" type="application/x-director"></embed>'));a("#video-download").attr("href",d)};return{init:function(){f.applyBindings(new function(){});var e=a("#assembly-full").data("level"),
g=a("#assembly-full").data("assemblyId");d(e,g);a("#assembly-full").delegate("input[@name='mediaRadio']:radio","click",c)},getAssembly:d,playVideo:c}}(jQuery,EB.i18n,ko);EB=window.EB||{};
EB.welcome=function(a,e){var f=function(){a(this).siblings().children("ul").hide().end().end().children("ul").show()},d=function(){a(this).parent().siblings().children("a").removeClass("library-search");a(this).addClass("library-search")},c=function(){var c=a("#library-knowledge").outerHeight(),d=a("#library-copy-content").outerHeight();a("#library-copy-content").css("margin-top",(c-d)/2)};return{init:function(){a(window).load(function(){c()});a(window).resize(function(){c()});a(".subnav .dropdown").hover(f);
a(".subnav .library-level").hover(d);var k=EB.shared.getSiteType();EB.shared.autocomplete("#queryElementary",e.string(k+".level1.name.lower"));EB.shared.validateSearch("#formElementary","#queryElementary");EB.shared.autocomplete("#queryMiddle",e.string(k+".level2.name.lower"));EB.shared.validateSearch("#formMiddle","#queryMiddle");EB.shared.autocomplete("#queryHigh",e.string(k+".level3.name.lower"));EB.shared.validateSearch("#formHigh","#queryHigh");EB.shared.placeholder("#queryElementary, #queryMiddle, #queryHigh");
a(".library-level input").on("click",function(c){c.preventDefault();a(this).select()});a(".library-level input").keydown(function(c){13==c.keyCode&&(c.preventDefault(),a(this).closest("form").submit())});1==a("#other-products-menu ul li").length?(a("#other-products-menu").show(),a("#other-products-singlelink-header").css("display","block"),a("#other-products-menu ul").addClass("singlelink")):1<a("#other-products-menu ul li").length&&(a("#other-products-menu").show(),a("#other-products-menu-header").css("display",
"block"),a("#other-products-menu-header").click(function(){2<a("#other-products-menu ul li").length&&a("#other-products-menu ul").css("right",a(window).width()-a("#other-products-menu").offset().left-a("#other-products-menu").outerWidth());a("#other-products-menu ul").toggle();return!1}),a("#other-products-menu ul").addClass("multiplelink"))}}}(jQuery,EB.i18n);EB=window.EB||{};
EB.widgets=function(){return{init:function(){$("form#searchCriteria").submit(function(){if($.trim($(this).find("#query").val())){var a=$(this).attr("action")+"?"+$(this).serialize(),e=$.trim($(this).find("#proxy").val());e&&(a=e+encodeURIComponent("http://"+document.location.hostname+a));window.ga?(e="Widgets - "+EB.shared.getLevelFromPath(),window.ga&&window.ga("send","event",e,"Searchbox submit"),setTimeout(function(){window.open(a)},100)):window.open(a)}return!1});$("a").click(function(){return!1})},
initPackSearch:function(){$("form#searchCriteria").submit(function(){if($.trim($(this).find("#query").val())){var a=$(this).attr("action")+"/"+$.trim($(this).find("#query").val()),e=$.trim($(this).find("#proxy").val());e&&(a=e+encodeURIComponent("http://"+document.location.hostname+a));window.ga?(window.ga&&window.ga("send","event","Widgets - Resource Packs","Searchbox submit"),setTimeout(function(){window.open(a)},100)):window.open(a)}return!1});$("a").click(function(){return!1})}}}();